2024-05-02 23:29:13,674:INFO: Effective parameters:
2024-05-02 23:29:13,675:INFO:   <<< batch_size: 1
2024-05-02 23:29:13,675:INFO:   <<< batch_size_val: 16
2024-05-02 23:29:13,675:INFO:   <<< cache_dir: 
2024-05-02 23:29:13,675:INFO:   <<< coef_lr: 0.001
2024-05-02 23:29:13,675:INFO:   <<< cross_model: cross-base
2024-05-02 23:29:13,675:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 23:29:13,675:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 23:29:13,675:INFO:   <<< datatype: msrvtt
2024-05-02 23:29:13,675:INFO:   <<< do_eval: True
2024-05-02 23:29:13,675:INFO:   <<< do_lower_case: False
2024-05-02 23:29:13,675:INFO:   <<< do_pretrain: False
2024-05-02 23:29:13,675:INFO:   <<< do_train: False
2024-05-02 23:29:13,675:INFO:   <<< epochs: 2
2024-05-02 23:29:13,675:INFO:   <<< eval_frame_order: 0
2024-05-02 23:29:13,676:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 23:29:13,676:INFO:   <<< feature_framerate: 1
2024-05-02 23:29:13,676:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 23:29:13,676:INFO:   <<< fp16: False
2024-05-02 23:29:13,676:INFO:   <<< fp16_opt_level: O1
2024-05-02 23:29:13,676:INFO:   <<< freeze_layer_num: 0
2024-05-02 23:29:13,676:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 23:29:13,676:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 23:29:13,676:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-02 23:29:13,676:INFO:   <<< linear_patch: 2d
2024-05-02 23:29:13,676:INFO:   <<< local_rank: 0
2024-05-02 23:29:13,676:INFO:   <<< loose_type: True
2024-05-02 23:29:13,676:INFO:   <<< lr: 0.0001
2024-05-02 23:29:13,676:INFO:   <<< lr_decay: 0.9
2024-05-02 23:29:13,676:INFO:   <<< margin: 0.1
2024-05-02 23:29:13,676:INFO:   <<< max_frames: 90
2024-05-02 23:29:13,676:INFO:   <<< max_words: 32
2024-05-02 23:29:13,677:INFO:   <<< n_display: 100
2024-05-02 23:29:13,677:INFO:   <<< n_gpu: 1
2024-05-02 23:29:13,677:INFO:   <<< n_pair: 1
2024-05-02 23:29:13,677:INFO:   <<< negative_weighting: 1
2024-05-02 23:29:13,677:INFO:   <<< num_thread_reader: 0
2024-05-02 23:29:13,677:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 23:29:13,677:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 23:29:13,677:INFO:   <<< rank: 0
2024-05-02 23:29:13,677:INFO:   <<< resume_model: None
2024-05-02 23:29:13,677:INFO:   <<< sampled_use_mil: False
2024-05-02 23:29:13,677:INFO:   <<< seed: 42
2024-05-02 23:29:13,677:INFO:   <<< sim_header: meanP
2024-05-02 23:29:13,677:INFO:   <<< slice_framepos: 2
2024-05-02 23:29:13,677:INFO:   <<< task_type: retrieval
2024-05-02 23:29:13,677:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 23:29:13,677:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 23:29:13,677:INFO:   <<< train_frame_order: 0
2024-05-02 23:29:13,678:INFO:   <<< use_mil: False
2024-05-02 23:29:13,678:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 23:29:13,678:INFO:   <<< video_dim: 1024
2024-05-02 23:29:13,678:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 23:29:13,678:INFO:   <<< warmup_proportion: 0.1
2024-05-02 23:29:13,678:INFO:   <<< world_size: 1
2024-05-02 23:29:13,678:INFO: device: cuda:0 n_gpu: 1
2024-05-02 23:29:41,217:INFO: Effective parameters:
2024-05-02 23:29:41,217:INFO:   <<< batch_size: 1
2024-05-02 23:29:41,217:INFO:   <<< batch_size_val: 16
2024-05-02 23:29:41,217:INFO:   <<< cache_dir: 
2024-05-02 23:29:41,217:INFO:   <<< coef_lr: 0.001
2024-05-02 23:29:41,217:INFO:   <<< cross_model: cross-base
2024-05-02 23:29:41,217:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 23:29:41,217:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 23:29:41,217:INFO:   <<< datatype: msrvtt
2024-05-02 23:29:41,217:INFO:   <<< do_eval: True
2024-05-02 23:29:41,217:INFO:   <<< do_lower_case: False
2024-05-02 23:29:41,218:INFO:   <<< do_pretrain: False
2024-05-02 23:29:41,218:INFO:   <<< do_train: False
2024-05-02 23:29:41,218:INFO:   <<< epochs: 2
2024-05-02 23:29:41,218:INFO:   <<< eval_frame_order: 0
2024-05-02 23:29:41,218:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 23:29:41,218:INFO:   <<< feature_framerate: 1
2024-05-02 23:29:41,218:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 23:29:41,218:INFO:   <<< fp16: False
2024-05-02 23:29:41,218:INFO:   <<< fp16_opt_level: O1
2024-05-02 23:29:41,218:INFO:   <<< freeze_layer_num: 0
2024-05-02 23:29:41,218:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 23:29:41,218:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 23:29:41,218:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-02 23:29:41,218:INFO:   <<< linear_patch: 2d
2024-05-02 23:29:41,218:INFO:   <<< local_rank: 0
2024-05-02 23:29:41,218:INFO:   <<< loose_type: True
2024-05-02 23:29:41,218:INFO:   <<< lr: 0.0001
2024-05-02 23:29:41,218:INFO:   <<< lr_decay: 0.9
2024-05-02 23:29:41,218:INFO:   <<< margin: 0.1
2024-05-02 23:29:41,218:INFO:   <<< max_frames: 90
2024-05-02 23:29:41,218:INFO:   <<< max_words: 32
2024-05-02 23:29:41,218:INFO:   <<< n_display: 100
2024-05-02 23:29:41,218:INFO:   <<< n_gpu: 1
2024-05-02 23:29:41,218:INFO:   <<< n_pair: 1
2024-05-02 23:29:41,218:INFO:   <<< negative_weighting: 1
2024-05-02 23:29:41,218:INFO:   <<< num_thread_reader: 0
2024-05-02 23:29:41,218:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 23:29:41,218:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 23:29:41,218:INFO:   <<< rank: 0
2024-05-02 23:29:41,218:INFO:   <<< resume_model: None
2024-05-02 23:29:41,218:INFO:   <<< sampled_use_mil: False
2024-05-02 23:29:41,218:INFO:   <<< seed: 42
2024-05-02 23:29:41,218:INFO:   <<< sim_header: meanP
2024-05-02 23:29:41,218:INFO:   <<< slice_framepos: 2
2024-05-02 23:29:41,218:INFO:   <<< task_type: retrieval
2024-05-02 23:29:41,218:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 23:29:41,218:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 23:29:41,218:INFO:   <<< train_frame_order: 0
2024-05-02 23:29:41,218:INFO:   <<< use_mil: False
2024-05-02 23:29:41,218:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 23:29:41,218:INFO:   <<< video_dim: 1024
2024-05-02 23:29:41,218:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 23:29:41,218:INFO:   <<< warmup_proportion: 0.1
2024-05-02 23:29:41,218:INFO:   <<< world_size: 1
2024-05-02 23:29:41,218:INFO: device: cuda:0 n_gpu: 1
2024-05-02 23:29:48,395:INFO: Effective parameters:
2024-05-02 23:29:48,395:INFO:   <<< batch_size: 1
2024-05-02 23:29:48,395:INFO:   <<< batch_size_val: 16
2024-05-02 23:29:48,395:INFO:   <<< cache_dir: 
2024-05-02 23:29:48,395:INFO:   <<< coef_lr: 0.001
2024-05-02 23:29:48,396:INFO:   <<< cross_model: cross-base
2024-05-02 23:29:48,396:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 23:29:48,396:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 23:29:48,396:INFO:   <<< datatype: msrvtt
2024-05-02 23:29:48,396:INFO:   <<< do_eval: True
2024-05-02 23:29:48,396:INFO:   <<< do_lower_case: False
2024-05-02 23:29:48,396:INFO:   <<< do_pretrain: False
2024-05-02 23:29:48,396:INFO:   <<< do_train: False
2024-05-02 23:29:48,396:INFO:   <<< epochs: 2
2024-05-02 23:29:48,396:INFO:   <<< eval_frame_order: 0
2024-05-02 23:29:48,396:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 23:29:48,396:INFO:   <<< feature_framerate: 1
2024-05-02 23:29:48,396:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 23:29:48,396:INFO:   <<< fp16: False
2024-05-02 23:29:48,396:INFO:   <<< fp16_opt_level: O1
2024-05-02 23:29:48,396:INFO:   <<< freeze_layer_num: 0
2024-05-02 23:29:48,396:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 23:29:48,397:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 23:29:48,397:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-02 23:29:48,397:INFO:   <<< linear_patch: 2d
2024-05-02 23:29:48,397:INFO:   <<< local_rank: 0
2024-05-02 23:29:48,397:INFO:   <<< loose_type: True
2024-05-02 23:29:48,397:INFO:   <<< lr: 0.0001
2024-05-02 23:29:48,397:INFO:   <<< lr_decay: 0.9
2024-05-02 23:29:48,397:INFO:   <<< margin: 0.1
2024-05-02 23:29:48,397:INFO:   <<< max_frames: 90
2024-05-02 23:29:48,397:INFO:   <<< max_words: 32
2024-05-02 23:29:48,397:INFO:   <<< n_display: 100
2024-05-02 23:29:48,397:INFO:   <<< n_gpu: 1
2024-05-02 23:29:48,397:INFO:   <<< n_pair: 1
2024-05-02 23:29:48,397:INFO:   <<< negative_weighting: 1
2024-05-02 23:29:48,397:INFO:   <<< num_thread_reader: 0
2024-05-02 23:29:48,397:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 23:29:48,397:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 23:29:48,398:INFO:   <<< rank: 0
2024-05-02 23:29:48,398:INFO:   <<< resume_model: None
2024-05-02 23:29:48,398:INFO:   <<< sampled_use_mil: False
2024-05-02 23:29:48,398:INFO:   <<< seed: 42
2024-05-02 23:29:48,398:INFO:   <<< sim_header: meanP
2024-05-02 23:29:48,398:INFO:   <<< slice_framepos: 2
2024-05-02 23:29:48,398:INFO:   <<< task_type: retrieval
2024-05-02 23:29:48,398:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 23:29:48,398:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 23:29:48,398:INFO:   <<< train_frame_order: 0
2024-05-02 23:29:48,398:INFO:   <<< use_mil: False
2024-05-02 23:29:48,398:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 23:29:48,398:INFO:   <<< video_dim: 1024
2024-05-02 23:29:48,398:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 23:29:48,398:INFO:   <<< warmup_proportion: 0.1
2024-05-02 23:29:48,398:INFO:   <<< world_size: 1
2024-05-02 23:29:48,399:INFO: device: cuda:0 n_gpu: 1
2024-05-02 23:43:33,570:INFO: Effective parameters:
2024-05-02 23:43:33,570:INFO:   <<< batch_size: 1
2024-05-02 23:43:33,571:INFO:   <<< batch_size_val: 16
2024-05-02 23:43:33,571:INFO:   <<< cache_dir: 
2024-05-02 23:43:33,571:INFO:   <<< coef_lr: 0.001
2024-05-02 23:43:33,571:INFO:   <<< cross_model: cross-base
2024-05-02 23:43:33,571:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 23:43:33,571:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 23:43:33,571:INFO:   <<< datatype: msrvtt
2024-05-02 23:43:33,571:INFO:   <<< do_eval: True
2024-05-02 23:43:33,571:INFO:   <<< do_lower_case: False
2024-05-02 23:43:33,571:INFO:   <<< do_pretrain: False
2024-05-02 23:43:33,571:INFO:   <<< do_train: False
2024-05-02 23:43:33,571:INFO:   <<< epochs: 2
2024-05-02 23:43:33,571:INFO:   <<< eval_frame_order: 0
2024-05-02 23:43:33,571:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 23:43:33,572:INFO:   <<< feature_framerate: 1
2024-05-02 23:43:33,572:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 23:43:33,572:INFO:   <<< fp16: False
2024-05-02 23:43:33,572:INFO:   <<< fp16_opt_level: O1
2024-05-02 23:43:33,572:INFO:   <<< freeze_layer_num: 0
2024-05-02 23:43:33,572:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 23:43:33,572:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 23:43:33,572:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-02 23:43:33,572:INFO:   <<< linear_patch: 2d
2024-05-02 23:43:33,572:INFO:   <<< local_rank: 0
2024-05-02 23:43:33,572:INFO:   <<< loose_type: True
2024-05-02 23:43:33,572:INFO:   <<< lr: 0.0001
2024-05-02 23:43:33,572:INFO:   <<< lr_decay: 0.9
2024-05-02 23:43:33,572:INFO:   <<< margin: 0.1
2024-05-02 23:43:33,572:INFO:   <<< max_frames: 90
2024-05-02 23:43:33,573:INFO:   <<< max_words: 32
2024-05-02 23:43:33,573:INFO:   <<< n_display: 100
2024-05-02 23:43:33,573:INFO:   <<< n_gpu: 1
2024-05-02 23:43:33,573:INFO:   <<< n_pair: 1
2024-05-02 23:43:33,573:INFO:   <<< negative_weighting: 1
2024-05-02 23:43:33,573:INFO:   <<< num_thread_reader: 0
2024-05-02 23:43:33,573:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 23:43:33,573:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 23:43:33,573:INFO:   <<< rank: 0
2024-05-02 23:43:33,573:INFO:   <<< resume_model: None
2024-05-02 23:43:33,573:INFO:   <<< sampled_use_mil: False
2024-05-02 23:43:33,573:INFO:   <<< seed: 42
2024-05-02 23:43:33,573:INFO:   <<< sim_header: meanP
2024-05-02 23:43:33,573:INFO:   <<< slice_framepos: 2
2024-05-02 23:43:33,573:INFO:   <<< task_type: retrieval
2024-05-02 23:43:33,574:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 23:43:33,574:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 23:43:33,574:INFO:   <<< train_frame_order: 0
2024-05-02 23:43:33,574:INFO:   <<< use_mil: False
2024-05-02 23:43:33,574:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 23:43:33,574:INFO:   <<< video_dim: 1024
2024-05-02 23:43:33,574:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 23:43:33,574:INFO:   <<< warmup_proportion: 0.1
2024-05-02 23:43:33,574:INFO:   <<< world_size: 1
2024-05-02 23:43:33,574:INFO: device: cuda:0 n_gpu: 1
2024-05-02 23:44:24,003:INFO: Effective parameters:
2024-05-02 23:44:24,003:INFO:   <<< batch_size: 1
2024-05-02 23:44:24,003:INFO:   <<< batch_size_val: 16
2024-05-02 23:44:24,003:INFO:   <<< cache_dir: 
2024-05-02 23:44:24,003:INFO:   <<< coef_lr: 0.001
2024-05-02 23:44:24,003:INFO:   <<< cross_model: cross-base
2024-05-02 23:44:24,003:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 23:44:24,003:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 23:44:24,003:INFO:   <<< datatype: msrvtt
2024-05-02 23:44:24,003:INFO:   <<< do_eval: True
2024-05-02 23:44:24,004:INFO:   <<< do_lower_case: False
2024-05-02 23:44:24,004:INFO:   <<< do_pretrain: False
2024-05-02 23:44:24,004:INFO:   <<< do_train: False
2024-05-02 23:44:24,004:INFO:   <<< epochs: 2
2024-05-02 23:44:24,004:INFO:   <<< eval_frame_order: 0
2024-05-02 23:44:24,004:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 23:44:24,004:INFO:   <<< feature_framerate: 1
2024-05-02 23:44:24,004:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 23:44:24,004:INFO:   <<< fp16: False
2024-05-02 23:44:24,004:INFO:   <<< fp16_opt_level: O1
2024-05-02 23:44:24,004:INFO:   <<< freeze_layer_num: 0
2024-05-02 23:44:24,004:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 23:44:24,004:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 23:44:24,004:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-02 23:44:24,004:INFO:   <<< linear_patch: 2d
2024-05-02 23:44:24,004:INFO:   <<< local_rank: 0
2024-05-02 23:44:24,004:INFO:   <<< loose_type: True
2024-05-02 23:44:24,005:INFO:   <<< lr: 0.0001
2024-05-02 23:44:24,005:INFO:   <<< lr_decay: 0.9
2024-05-02 23:44:24,005:INFO:   <<< margin: 0.1
2024-05-02 23:44:24,005:INFO:   <<< max_frames: 90
2024-05-02 23:44:24,005:INFO:   <<< max_words: 32
2024-05-02 23:44:24,005:INFO:   <<< n_display: 100
2024-05-02 23:44:24,005:INFO:   <<< n_gpu: 1
2024-05-02 23:44:24,005:INFO:   <<< n_pair: 1
2024-05-02 23:44:24,005:INFO:   <<< negative_weighting: 1
2024-05-02 23:44:24,005:INFO:   <<< num_thread_reader: 0
2024-05-02 23:44:24,005:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 23:44:24,005:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 23:44:24,005:INFO:   <<< rank: 0
2024-05-02 23:44:24,005:INFO:   <<< resume_model: None
2024-05-02 23:44:24,005:INFO:   <<< sampled_use_mil: False
2024-05-02 23:44:24,005:INFO:   <<< seed: 42
2024-05-02 23:44:24,005:INFO:   <<< sim_header: meanP
2024-05-02 23:44:24,005:INFO:   <<< slice_framepos: 2
2024-05-02 23:44:24,006:INFO:   <<< task_type: retrieval
2024-05-02 23:44:24,006:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 23:44:24,006:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 23:44:24,006:INFO:   <<< train_frame_order: 0
2024-05-02 23:44:24,006:INFO:   <<< use_mil: False
2024-05-02 23:44:24,006:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 23:44:24,006:INFO:   <<< video_dim: 1024
2024-05-02 23:44:24,006:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 23:44:24,006:INFO:   <<< warmup_proportion: 0.1
2024-05-02 23:44:24,006:INFO:   <<< world_size: 1
2024-05-02 23:44:24,006:INFO: device: cuda:0 n_gpu: 1
2024-05-02 23:44:24,184:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 23:44:24,734:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 23:44:24,734:WARNING: Test retrieval by loose type.
2024-05-02 23:44:24,735:WARNING: 	 embed_dim: 512
2024-05-02 23:44:24,735:WARNING: 	 image_resolution: 224
2024-05-02 23:44:24,735:WARNING: 	 vision_layers: 12
2024-05-02 23:44:24,735:WARNING: 	 vision_width: 768
2024-05-02 23:44:24,735:WARNING: 	 vision_patch_size: 32
2024-05-02 23:44:24,735:WARNING: 	 context_length: 77
2024-05-02 23:44:24,735:WARNING: 	 vocab_size: 49408
2024-05-02 23:44:24,735:WARNING: 	 transformer_width: 512
2024-05-02 23:44:24,735:WARNING: 	 transformer_heads: 8
2024-05-02 23:44:24,735:WARNING: 	 transformer_layers: 12
2024-05-02 23:44:24,735:WARNING: 		 linear_patch: 2d
2024-05-02 23:44:24,735:WARNING: 	 cut_top_layer: 0
2024-05-02 23:44:25,723:WARNING: 	 sim_header: meanP
2024-05-02 23:46:20,543:INFO: Effective parameters:
2024-05-02 23:46:20,544:INFO:   <<< batch_size: 1
2024-05-02 23:46:20,544:INFO:   <<< batch_size_val: 16
2024-05-02 23:46:20,544:INFO:   <<< cache_dir: 
2024-05-02 23:46:20,544:INFO:   <<< coef_lr: 0.001
2024-05-02 23:46:20,544:INFO:   <<< cross_model: cross-base
2024-05-02 23:46:20,544:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 23:46:20,544:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 23:46:20,544:INFO:   <<< datatype: msrvtt
2024-05-02 23:46:20,544:INFO:   <<< do_eval: True
2024-05-02 23:46:20,544:INFO:   <<< do_lower_case: False
2024-05-02 23:46:20,544:INFO:   <<< do_pretrain: False
2024-05-02 23:46:20,544:INFO:   <<< do_train: False
2024-05-02 23:46:20,544:INFO:   <<< epochs: 2
2024-05-02 23:46:20,545:INFO:   <<< eval_frame_order: 0
2024-05-02 23:46:20,545:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 23:46:20,545:INFO:   <<< feature_framerate: 1
2024-05-02 23:46:20,545:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 23:46:20,545:INFO:   <<< fp16: False
2024-05-02 23:46:20,545:INFO:   <<< fp16_opt_level: O1
2024-05-02 23:46:20,545:INFO:   <<< freeze_layer_num: 0
2024-05-02 23:46:20,545:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 23:46:20,545:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 23:46:20,546:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-02 23:46:20,546:INFO:   <<< linear_patch: 2d
2024-05-02 23:46:20,546:INFO:   <<< local_rank: 0
2024-05-02 23:46:20,546:INFO:   <<< loose_type: True
2024-05-02 23:46:20,546:INFO:   <<< lr: 0.0001
2024-05-02 23:46:20,546:INFO:   <<< lr_decay: 0.9
2024-05-02 23:46:20,546:INFO:   <<< margin: 0.1
2024-05-02 23:46:20,546:INFO:   <<< max_frames: 90
2024-05-02 23:46:20,546:INFO:   <<< max_words: 32
2024-05-02 23:46:20,546:INFO:   <<< n_display: 100
2024-05-02 23:46:20,547:INFO:   <<< n_gpu: 1
2024-05-02 23:46:20,547:INFO:   <<< n_pair: 1
2024-05-02 23:46:20,547:INFO:   <<< negative_weighting: 1
2024-05-02 23:46:20,547:INFO:   <<< num_thread_reader: 0
2024-05-02 23:46:20,547:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 23:46:20,547:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 23:46:20,547:INFO:   <<< rank: 0
2024-05-02 23:46:20,547:INFO:   <<< resume_model: None
2024-05-02 23:46:20,547:INFO:   <<< sampled_use_mil: False
2024-05-02 23:46:20,548:INFO:   <<< seed: 42
2024-05-02 23:46:20,548:INFO:   <<< sim_header: meanP
2024-05-02 23:46:20,548:INFO:   <<< slice_framepos: 2
2024-05-02 23:46:20,548:INFO:   <<< task_type: retrieval
2024-05-02 23:46:20,548:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 23:46:20,548:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 23:46:20,548:INFO:   <<< train_frame_order: 0
2024-05-02 23:46:20,548:INFO:   <<< use_mil: False
2024-05-02 23:46:20,548:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 23:46:20,549:INFO:   <<< video_dim: 1024
2024-05-02 23:46:20,549:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 23:46:20,549:INFO:   <<< warmup_proportion: 0.1
2024-05-02 23:46:20,549:INFO:   <<< world_size: 1
2024-05-02 23:46:20,549:INFO: device: cuda:0 n_gpu: 1
2024-05-02 23:46:20,691:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 23:46:21,170:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 23:46:21,170:WARNING: Test retrieval by loose type.
2024-05-02 23:46:21,171:WARNING: 	 embed_dim: 512
2024-05-02 23:46:21,171:WARNING: 	 image_resolution: 224
2024-05-02 23:46:21,171:WARNING: 	 vision_layers: 12
2024-05-02 23:46:21,171:WARNING: 	 vision_width: 768
2024-05-02 23:46:21,171:WARNING: 	 vision_patch_size: 32
2024-05-02 23:46:21,171:WARNING: 	 context_length: 77
2024-05-02 23:46:21,171:WARNING: 	 vocab_size: 49408
2024-05-02 23:46:21,171:WARNING: 	 transformer_width: 512
2024-05-02 23:46:21,171:WARNING: 	 transformer_heads: 8
2024-05-02 23:46:21,171:WARNING: 	 transformer_layers: 12
2024-05-02 23:46:21,171:WARNING: 		 linear_patch: 2d
2024-05-02 23:46:21,171:WARNING: 	 cut_top_layer: 0
2024-05-02 23:46:22,166:WARNING: 	 sim_header: meanP
2024-05-03 00:06:46,129:INFO: Effective parameters:
2024-05-03 00:06:46,129:INFO:   <<< batch_size: 1
2024-05-03 00:06:46,129:INFO:   <<< batch_size_val: 16
2024-05-03 00:06:46,129:INFO:   <<< cache_dir: 
2024-05-03 00:06:46,129:INFO:   <<< coef_lr: 0.001
2024-05-03 00:06:46,129:INFO:   <<< cross_model: cross-base
2024-05-03 00:06:46,129:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 00:06:46,129:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 00:06:46,129:INFO:   <<< datatype: msrvtt
2024-05-03 00:06:46,129:INFO:   <<< do_eval: True
2024-05-03 00:06:46,130:INFO:   <<< do_lower_case: False
2024-05-03 00:06:46,130:INFO:   <<< do_pretrain: False
2024-05-03 00:06:46,130:INFO:   <<< do_train: False
2024-05-03 00:06:46,130:INFO:   <<< epochs: 2
2024-05-03 00:06:46,130:INFO:   <<< eval_frame_order: 0
2024-05-03 00:06:46,130:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 00:06:46,130:INFO:   <<< feature_framerate: 1
2024-05-03 00:06:46,130:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 00:06:46,130:INFO:   <<< fp16: False
2024-05-03 00:06:46,130:INFO:   <<< fp16_opt_level: O1
2024-05-03 00:06:46,130:INFO:   <<< freeze_layer_num: 0
2024-05-03 00:06:46,130:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 00:06:46,130:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 00:06:46,130:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 00:06:46,130:INFO:   <<< linear_patch: 2d
2024-05-03 00:06:46,130:INFO:   <<< local_rank: 0
2024-05-03 00:06:46,130:INFO:   <<< loose_type: True
2024-05-03 00:06:46,131:INFO:   <<< lr: 0.0001
2024-05-03 00:06:46,131:INFO:   <<< lr_decay: 0.9
2024-05-03 00:06:46,131:INFO:   <<< margin: 0.1
2024-05-03 00:06:46,131:INFO:   <<< max_frames: 90
2024-05-03 00:06:46,131:INFO:   <<< max_words: 32
2024-05-03 00:06:46,131:INFO:   <<< n_display: 100
2024-05-03 00:06:46,131:INFO:   <<< n_gpu: 1
2024-05-03 00:06:46,131:INFO:   <<< n_pair: 1
2024-05-03 00:06:46,131:INFO:   <<< negative_weighting: 1
2024-05-03 00:06:46,131:INFO:   <<< num_thread_reader: 0
2024-05-03 00:06:46,131:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 00:06:46,131:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 00:06:46,131:INFO:   <<< rank: 0
2024-05-03 00:06:46,131:INFO:   <<< resume_model: None
2024-05-03 00:06:46,131:INFO:   <<< sampled_use_mil: False
2024-05-03 00:06:46,131:INFO:   <<< seed: 42
2024-05-03 00:06:46,131:INFO:   <<< sim_header: meanP
2024-05-03 00:06:46,131:INFO:   <<< slice_framepos: 2
2024-05-03 00:06:46,132:INFO:   <<< task_type: retrieval
2024-05-03 00:06:46,132:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 00:06:46,132:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 00:06:46,132:INFO:   <<< train_frame_order: 0
2024-05-03 00:06:46,132:INFO:   <<< use_mil: False
2024-05-03 00:06:46,132:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 00:06:46,132:INFO:   <<< video_dim: 1024
2024-05-03 00:06:46,132:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 00:06:46,132:INFO:   <<< warmup_proportion: 0.1
2024-05-03 00:06:46,132:INFO:   <<< world_size: 1
2024-05-03 00:06:46,132:INFO: device: cuda:0 n_gpu: 1
2024-05-03 00:06:46,267:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 00:06:46,738:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 00:06:46,738:WARNING: Test retrieval by loose type.
2024-05-03 00:06:46,739:WARNING: 	 embed_dim: 512
2024-05-03 00:06:46,739:WARNING: 	 image_resolution: 224
2024-05-03 00:06:46,739:WARNING: 	 vision_layers: 12
2024-05-03 00:06:46,739:WARNING: 	 vision_width: 768
2024-05-03 00:06:46,739:WARNING: 	 vision_patch_size: 32
2024-05-03 00:06:46,739:WARNING: 	 context_length: 77
2024-05-03 00:06:46,739:WARNING: 	 vocab_size: 49408
2024-05-03 00:06:46,739:WARNING: 	 transformer_width: 512
2024-05-03 00:06:46,739:WARNING: 	 transformer_heads: 8
2024-05-03 00:06:46,739:WARNING: 	 transformer_layers: 12
2024-05-03 00:06:46,740:WARNING: 		 linear_patch: 2d
2024-05-03 00:06:46,740:WARNING: 	 cut_top_layer: 0
2024-05-03 00:06:47,715:WARNING: 	 sim_header: meanP
2024-05-03 00:09:17,759:INFO: Effective parameters:
2024-05-03 00:09:17,760:INFO:   <<< batch_size: 1
2024-05-03 00:09:17,760:INFO:   <<< batch_size_val: 16
2024-05-03 00:09:17,760:INFO:   <<< cache_dir: 
2024-05-03 00:09:17,760:INFO:   <<< coef_lr: 0.001
2024-05-03 00:09:17,760:INFO:   <<< cross_model: cross-base
2024-05-03 00:09:17,760:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 00:09:17,760:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 00:09:17,760:INFO:   <<< datatype: msrvtt
2024-05-03 00:09:17,760:INFO:   <<< do_eval: True
2024-05-03 00:09:17,760:INFO:   <<< do_lower_case: False
2024-05-03 00:09:17,760:INFO:   <<< do_pretrain: False
2024-05-03 00:09:17,760:INFO:   <<< do_train: False
2024-05-03 00:09:17,760:INFO:   <<< epochs: 2
2024-05-03 00:09:17,760:INFO:   <<< eval_frame_order: 0
2024-05-03 00:09:17,760:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 00:09:17,760:INFO:   <<< feature_framerate: 1
2024-05-03 00:09:17,761:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 00:09:17,761:INFO:   <<< fp16: False
2024-05-03 00:09:17,761:INFO:   <<< fp16_opt_level: O1
2024-05-03 00:09:17,761:INFO:   <<< freeze_layer_num: 0
2024-05-03 00:09:17,761:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 00:09:17,761:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 00:09:17,761:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 00:09:17,761:INFO:   <<< linear_patch: 2d
2024-05-03 00:09:17,761:INFO:   <<< local_rank: 0
2024-05-03 00:09:17,761:INFO:   <<< loose_type: True
2024-05-03 00:09:17,761:INFO:   <<< lr: 0.0001
2024-05-03 00:09:17,761:INFO:   <<< lr_decay: 0.9
2024-05-03 00:09:17,761:INFO:   <<< margin: 0.1
2024-05-03 00:09:17,761:INFO:   <<< max_frames: 90
2024-05-03 00:09:17,761:INFO:   <<< max_words: 32
2024-05-03 00:09:17,761:INFO:   <<< n_display: 100
2024-05-03 00:09:17,761:INFO:   <<< n_gpu: 1
2024-05-03 00:09:17,761:INFO:   <<< n_pair: 1
2024-05-03 00:09:17,762:INFO:   <<< negative_weighting: 1
2024-05-03 00:09:17,762:INFO:   <<< num_thread_reader: 0
2024-05-03 00:09:17,762:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 00:09:17,762:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 00:09:17,762:INFO:   <<< rank: 0
2024-05-03 00:09:17,762:INFO:   <<< resume_model: None
2024-05-03 00:09:17,762:INFO:   <<< sampled_use_mil: False
2024-05-03 00:09:17,762:INFO:   <<< seed: 42
2024-05-03 00:09:17,762:INFO:   <<< sim_header: meanP
2024-05-03 00:09:17,762:INFO:   <<< slice_framepos: 2
2024-05-03 00:09:17,762:INFO:   <<< task_type: retrieval
2024-05-03 00:09:17,762:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 00:09:17,762:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 00:09:17,762:INFO:   <<< train_frame_order: 0
2024-05-03 00:09:17,762:INFO:   <<< use_mil: False
2024-05-03 00:09:17,762:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 00:09:17,762:INFO:   <<< video_dim: 1024
2024-05-03 00:09:17,763:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 00:09:17,763:INFO:   <<< warmup_proportion: 0.1
2024-05-03 00:09:17,763:INFO:   <<< world_size: 1
2024-05-03 00:09:17,763:INFO: device: cuda:0 n_gpu: 1
2024-05-03 00:09:17,902:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 00:09:18,382:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 00:09:18,382:WARNING: Test retrieval by loose type.
2024-05-03 00:09:18,383:WARNING: 	 embed_dim: 512
2024-05-03 00:09:18,383:WARNING: 	 image_resolution: 224
2024-05-03 00:09:18,383:WARNING: 	 vision_layers: 12
2024-05-03 00:09:18,383:WARNING: 	 vision_width: 768
2024-05-03 00:09:18,383:WARNING: 	 vision_patch_size: 32
2024-05-03 00:09:18,383:WARNING: 	 context_length: 77
2024-05-03 00:09:18,383:WARNING: 	 vocab_size: 49408
2024-05-03 00:09:18,383:WARNING: 	 transformer_width: 512
2024-05-03 00:09:18,383:WARNING: 	 transformer_heads: 8
2024-05-03 00:09:18,383:WARNING: 	 transformer_layers: 12
2024-05-03 00:09:18,383:WARNING: 		 linear_patch: 2d
2024-05-03 00:09:18,384:WARNING: 	 cut_top_layer: 0
2024-05-03 00:09:19,353:WARNING: 	 sim_header: meanP
2024-05-03 03:55:49,840:INFO: Effective parameters:
2024-05-03 03:55:49,840:INFO:   <<< batch_size: 1
2024-05-03 03:55:49,840:INFO:   <<< batch_size_val: 16
2024-05-03 03:55:49,840:INFO:   <<< cache_dir: 
2024-05-03 03:55:49,840:INFO:   <<< coef_lr: 0.001
2024-05-03 03:55:49,840:INFO:   <<< cross_model: cross-base
2024-05-03 03:55:49,840:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 03:55:49,840:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 03:55:49,840:INFO:   <<< datatype: msrvtt
2024-05-03 03:55:49,840:INFO:   <<< do_eval: True
2024-05-03 03:55:49,841:INFO:   <<< do_lower_case: False
2024-05-03 03:55:49,841:INFO:   <<< do_pretrain: False
2024-05-03 03:55:49,841:INFO:   <<< do_train: False
2024-05-03 03:55:49,841:INFO:   <<< epochs: 2
2024-05-03 03:55:49,841:INFO:   <<< eval_frame_order: 0
2024-05-03 03:55:49,841:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 03:55:49,841:INFO:   <<< feature_framerate: 1
2024-05-03 03:55:49,841:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 03:55:49,841:INFO:   <<< fp16: False
2024-05-03 03:55:49,841:INFO:   <<< fp16_opt_level: O1
2024-05-03 03:55:49,841:INFO:   <<< freeze_layer_num: 0
2024-05-03 03:55:49,841:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 03:55:49,841:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 03:55:49,841:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 03:55:49,842:INFO:   <<< linear_patch: 2d
2024-05-03 03:55:49,842:INFO:   <<< local_rank: 0
2024-05-03 03:55:49,842:INFO:   <<< loose_type: True
2024-05-03 03:55:49,842:INFO:   <<< lr: 0.0001
2024-05-03 03:55:49,842:INFO:   <<< lr_decay: 0.9
2024-05-03 03:55:49,842:INFO:   <<< margin: 0.1
2024-05-03 03:55:49,842:INFO:   <<< max_frames: 90
2024-05-03 03:55:49,842:INFO:   <<< max_words: 32
2024-05-03 03:55:49,842:INFO:   <<< n_display: 100
2024-05-03 03:55:49,842:INFO:   <<< n_gpu: 1
2024-05-03 03:55:49,842:INFO:   <<< n_pair: 1
2024-05-03 03:55:49,842:INFO:   <<< negative_weighting: 1
2024-05-03 03:55:49,842:INFO:   <<< num_thread_reader: 0
2024-05-03 03:55:49,842:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 03:55:49,843:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 03:55:49,843:INFO:   <<< rank: 0
2024-05-03 03:55:49,843:INFO:   <<< resume_model: None
2024-05-03 03:55:49,843:INFO:   <<< sampled_use_mil: False
2024-05-03 03:55:49,843:INFO:   <<< seed: 42
2024-05-03 03:55:49,843:INFO:   <<< sim_header: meanP
2024-05-03 03:55:49,843:INFO:   <<< slice_framepos: 2
2024-05-03 03:55:49,843:INFO:   <<< task_type: retrieval
2024-05-03 03:55:49,843:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 03:55:49,843:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 03:55:49,843:INFO:   <<< train_frame_order: 0
2024-05-03 03:55:49,843:INFO:   <<< use_mil: False
2024-05-03 03:55:49,843:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 03:55:49,843:INFO:   <<< video_dim: 1024
2024-05-03 03:55:49,843:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 03:55:49,844:INFO:   <<< warmup_proportion: 0.1
2024-05-03 03:55:49,844:INFO:   <<< world_size: 1
2024-05-03 03:55:49,844:INFO: device: cuda:0 n_gpu: 1
2024-05-03 03:55:49,976:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 03:55:50,450:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 03:55:50,450:WARNING: Test retrieval by loose type.
2024-05-03 03:55:50,451:WARNING: 	 embed_dim: 512
2024-05-03 03:55:50,451:WARNING: 	 image_resolution: 224
2024-05-03 03:55:50,451:WARNING: 	 vision_layers: 12
2024-05-03 03:55:50,451:WARNING: 	 vision_width: 768
2024-05-03 03:55:50,451:WARNING: 	 vision_patch_size: 32
2024-05-03 03:55:50,451:WARNING: 	 context_length: 77
2024-05-03 03:55:50,451:WARNING: 	 vocab_size: 49408
2024-05-03 03:55:50,451:WARNING: 	 transformer_width: 512
2024-05-03 03:55:50,451:WARNING: 	 transformer_heads: 8
2024-05-03 03:55:50,451:WARNING: 	 transformer_layers: 12
2024-05-03 03:55:50,451:WARNING: 		 linear_patch: 2d
2024-05-03 03:55:50,451:WARNING: 	 cut_top_layer: 0
2024-05-03 03:55:51,439:WARNING: 	 sim_header: meanP
2024-05-03 04:00:02,018:INFO: Effective parameters:
2024-05-03 04:00:02,019:INFO:   <<< batch_size: 1
2024-05-03 04:00:02,019:INFO:   <<< batch_size_val: 16
2024-05-03 04:00:02,019:INFO:   <<< cache_dir: 
2024-05-03 04:00:02,019:INFO:   <<< coef_lr: 0.001
2024-05-03 04:00:02,019:INFO:   <<< cross_model: cross-base
2024-05-03 04:00:02,019:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:00:02,019:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:00:02,019:INFO:   <<< datatype: msrvtt
2024-05-03 04:00:02,019:INFO:   <<< do_eval: True
2024-05-03 04:00:02,019:INFO:   <<< do_lower_case: False
2024-05-03 04:00:02,019:INFO:   <<< do_pretrain: False
2024-05-03 04:00:02,019:INFO:   <<< do_train: False
2024-05-03 04:00:02,019:INFO:   <<< epochs: 2
2024-05-03 04:00:02,019:INFO:   <<< eval_frame_order: 0
2024-05-03 04:00:02,020:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:00:02,020:INFO:   <<< feature_framerate: 1
2024-05-03 04:00:02,020:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:00:02,020:INFO:   <<< fp16: False
2024-05-03 04:00:02,020:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:00:02,020:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:00:02,020:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:00:02,020:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:00:02,020:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:00:02,020:INFO:   <<< linear_patch: 2d
2024-05-03 04:00:02,020:INFO:   <<< local_rank: 0
2024-05-03 04:00:02,020:INFO:   <<< loose_type: True
2024-05-03 04:00:02,020:INFO:   <<< lr: 0.0001
2024-05-03 04:00:02,020:INFO:   <<< lr_decay: 0.9
2024-05-03 04:00:02,021:INFO:   <<< margin: 0.1
2024-05-03 04:00:02,021:INFO:   <<< max_frames: 90
2024-05-03 04:00:02,021:INFO:   <<< max_words: 32
2024-05-03 04:00:02,021:INFO:   <<< n_display: 100
2024-05-03 04:00:02,021:INFO:   <<< n_gpu: 1
2024-05-03 04:00:02,021:INFO:   <<< n_pair: 1
2024-05-03 04:00:02,021:INFO:   <<< negative_weighting: 1
2024-05-03 04:00:02,021:INFO:   <<< num_thread_reader: 0
2024-05-03 04:00:02,021:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:00:02,021:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:00:02,021:INFO:   <<< rank: 0
2024-05-03 04:00:02,021:INFO:   <<< resume_model: None
2024-05-03 04:00:02,021:INFO:   <<< sampled_use_mil: False
2024-05-03 04:00:02,021:INFO:   <<< seed: 42
2024-05-03 04:00:02,021:INFO:   <<< sim_header: meanP
2024-05-03 04:00:02,021:INFO:   <<< slice_framepos: 2
2024-05-03 04:00:02,021:INFO:   <<< task_type: retrieval
2024-05-03 04:00:02,021:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:00:02,022:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:00:02,022:INFO:   <<< train_frame_order: 0
2024-05-03 04:00:02,022:INFO:   <<< use_mil: False
2024-05-03 04:00:02,022:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:00:02,022:INFO:   <<< video_dim: 1024
2024-05-03 04:00:02,022:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:00:02,022:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:00:02,022:INFO:   <<< world_size: 1
2024-05-03 04:00:02,022:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:00:02,154:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:00:02,634:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:00:02,634:WARNING: Test retrieval by loose type.
2024-05-03 04:00:02,635:WARNING: 	 embed_dim: 512
2024-05-03 04:00:02,635:WARNING: 	 image_resolution: 224
2024-05-03 04:00:02,635:WARNING: 	 vision_layers: 12
2024-05-03 04:00:02,635:WARNING: 	 vision_width: 768
2024-05-03 04:00:02,635:WARNING: 	 vision_patch_size: 32
2024-05-03 04:00:02,635:WARNING: 	 context_length: 77
2024-05-03 04:00:02,636:WARNING: 	 vocab_size: 49408
2024-05-03 04:00:02,636:WARNING: 	 transformer_width: 512
2024-05-03 04:00:02,636:WARNING: 	 transformer_heads: 8
2024-05-03 04:00:02,636:WARNING: 	 transformer_layers: 12
2024-05-03 04:00:02,636:WARNING: 		 linear_patch: 2d
2024-05-03 04:00:02,636:WARNING: 	 cut_top_layer: 0
2024-05-03 04:00:03,623:WARNING: 	 sim_header: meanP
2024-05-03 04:03:15,279:INFO: Effective parameters:
2024-05-03 04:03:15,280:INFO:   <<< batch_size: 1
2024-05-03 04:03:15,280:INFO:   <<< batch_size_val: 16
2024-05-03 04:03:15,280:INFO:   <<< cache_dir: 
2024-05-03 04:03:15,280:INFO:   <<< coef_lr: 0.001
2024-05-03 04:03:15,280:INFO:   <<< cross_model: cross-base
2024-05-03 04:03:15,280:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:03:15,280:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:03:15,280:INFO:   <<< datatype: msrvtt
2024-05-03 04:03:15,280:INFO:   <<< do_eval: True
2024-05-03 04:03:15,280:INFO:   <<< do_lower_case: False
2024-05-03 04:03:15,280:INFO:   <<< do_pretrain: False
2024-05-03 04:03:15,281:INFO:   <<< do_train: False
2024-05-03 04:03:15,281:INFO:   <<< epochs: 2
2024-05-03 04:03:15,281:INFO:   <<< eval_frame_order: 0
2024-05-03 04:03:15,281:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:03:15,281:INFO:   <<< feature_framerate: 1
2024-05-03 04:03:15,281:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:03:15,281:INFO:   <<< fp16: False
2024-05-03 04:03:15,281:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:03:15,281:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:03:15,281:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:03:15,281:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:03:15,281:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:03:15,281:INFO:   <<< linear_patch: 2d
2024-05-03 04:03:15,281:INFO:   <<< local_rank: 0
2024-05-03 04:03:15,281:INFO:   <<< loose_type: True
2024-05-03 04:03:15,282:INFO:   <<< lr: 0.0001
2024-05-03 04:03:15,282:INFO:   <<< lr_decay: 0.9
2024-05-03 04:03:15,282:INFO:   <<< margin: 0.1
2024-05-03 04:03:15,282:INFO:   <<< max_frames: 90
2024-05-03 04:03:15,282:INFO:   <<< max_words: 32
2024-05-03 04:03:15,282:INFO:   <<< n_display: 100
2024-05-03 04:03:15,282:INFO:   <<< n_gpu: 1
2024-05-03 04:03:15,282:INFO:   <<< n_pair: 1
2024-05-03 04:03:15,282:INFO:   <<< negative_weighting: 1
2024-05-03 04:03:15,282:INFO:   <<< num_thread_reader: 0
2024-05-03 04:03:15,282:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:03:15,282:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:03:15,282:INFO:   <<< rank: 0
2024-05-03 04:03:15,282:INFO:   <<< resume_model: None
2024-05-03 04:03:15,283:INFO:   <<< sampled_use_mil: False
2024-05-03 04:03:15,283:INFO:   <<< seed: 42
2024-05-03 04:03:15,283:INFO:   <<< sim_header: meanP
2024-05-03 04:03:15,283:INFO:   <<< slice_framepos: 2
2024-05-03 04:03:15,283:INFO:   <<< task_type: retrieval
2024-05-03 04:03:15,283:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:03:15,283:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:03:15,283:INFO:   <<< train_frame_order: 0
2024-05-03 04:03:15,283:INFO:   <<< use_mil: False
2024-05-03 04:03:15,283:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:03:15,283:INFO:   <<< video_dim: 1024
2024-05-03 04:03:15,283:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:03:15,283:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:03:15,283:INFO:   <<< world_size: 1
2024-05-03 04:03:15,284:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:03:15,417:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:03:15,891:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:03:15,891:WARNING: Test retrieval by loose type.
2024-05-03 04:03:15,892:WARNING: 	 embed_dim: 512
2024-05-03 04:03:15,892:WARNING: 	 image_resolution: 224
2024-05-03 04:03:15,892:WARNING: 	 vision_layers: 12
2024-05-03 04:03:15,892:WARNING: 	 vision_width: 768
2024-05-03 04:03:15,892:WARNING: 	 vision_patch_size: 32
2024-05-03 04:03:15,892:WARNING: 	 context_length: 77
2024-05-03 04:03:15,892:WARNING: 	 vocab_size: 49408
2024-05-03 04:03:15,892:WARNING: 	 transformer_width: 512
2024-05-03 04:03:15,892:WARNING: 	 transformer_heads: 8
2024-05-03 04:03:15,892:WARNING: 	 transformer_layers: 12
2024-05-03 04:03:15,892:WARNING: 		 linear_patch: 2d
2024-05-03 04:03:15,892:WARNING: 	 cut_top_layer: 0
2024-05-03 04:03:16,881:WARNING: 	 sim_header: meanP
2024-05-03 04:05:05,575:INFO: Effective parameters:
2024-05-03 04:05:05,575:INFO:   <<< batch_size: 1
2024-05-03 04:05:05,575:INFO:   <<< batch_size_val: 16
2024-05-03 04:05:05,575:INFO:   <<< cache_dir: 
2024-05-03 04:05:05,575:INFO:   <<< coef_lr: 0.001
2024-05-03 04:05:05,575:INFO:   <<< cross_model: cross-base
2024-05-03 04:05:05,575:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:05:05,575:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:05:05,575:INFO:   <<< datatype: msrvtt
2024-05-03 04:05:05,575:INFO:   <<< do_eval: True
2024-05-03 04:05:05,576:INFO:   <<< do_lower_case: False
2024-05-03 04:05:05,576:INFO:   <<< do_pretrain: False
2024-05-03 04:05:05,576:INFO:   <<< do_train: False
2024-05-03 04:05:05,576:INFO:   <<< epochs: 2
2024-05-03 04:05:05,576:INFO:   <<< eval_frame_order: 0
2024-05-03 04:05:05,576:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:05:05,576:INFO:   <<< feature_framerate: 1
2024-05-03 04:05:05,576:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:05:05,576:INFO:   <<< fp16: False
2024-05-03 04:05:05,576:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:05:05,576:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:05:05,576:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:05:05,576:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:05:05,576:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:05:05,576:INFO:   <<< linear_patch: 2d
2024-05-03 04:05:05,576:INFO:   <<< local_rank: 0
2024-05-03 04:05:05,576:INFO:   <<< loose_type: True
2024-05-03 04:05:05,577:INFO:   <<< lr: 0.0001
2024-05-03 04:05:05,577:INFO:   <<< lr_decay: 0.9
2024-05-03 04:05:05,577:INFO:   <<< margin: 0.1
2024-05-03 04:05:05,577:INFO:   <<< max_frames: 90
2024-05-03 04:05:05,577:INFO:   <<< max_words: 32
2024-05-03 04:05:05,577:INFO:   <<< n_display: 100
2024-05-03 04:05:05,577:INFO:   <<< n_gpu: 1
2024-05-03 04:05:05,577:INFO:   <<< n_pair: 1
2024-05-03 04:05:05,577:INFO:   <<< negative_weighting: 1
2024-05-03 04:05:05,577:INFO:   <<< num_thread_reader: 0
2024-05-03 04:05:05,577:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:05:05,577:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:05:05,577:INFO:   <<< rank: 0
2024-05-03 04:05:05,577:INFO:   <<< resume_model: None
2024-05-03 04:05:05,577:INFO:   <<< sampled_use_mil: False
2024-05-03 04:05:05,577:INFO:   <<< seed: 42
2024-05-03 04:05:05,577:INFO:   <<< sim_header: meanP
2024-05-03 04:05:05,578:INFO:   <<< slice_framepos: 2
2024-05-03 04:05:05,578:INFO:   <<< task_type: retrieval
2024-05-03 04:05:05,578:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:05:05,578:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:05:05,578:INFO:   <<< train_frame_order: 0
2024-05-03 04:05:05,578:INFO:   <<< use_mil: False
2024-05-03 04:05:05,578:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:05:05,578:INFO:   <<< video_dim: 1024
2024-05-03 04:05:05,578:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:05:05,578:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:05:05,578:INFO:   <<< world_size: 1
2024-05-03 04:05:05,578:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:05:05,713:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:05:06,195:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:05:06,195:WARNING: Test retrieval by loose type.
2024-05-03 04:05:06,196:WARNING: 	 embed_dim: 512
2024-05-03 04:05:06,196:WARNING: 	 image_resolution: 224
2024-05-03 04:05:06,196:WARNING: 	 vision_layers: 12
2024-05-03 04:05:06,196:WARNING: 	 vision_width: 768
2024-05-03 04:05:06,196:WARNING: 	 vision_patch_size: 32
2024-05-03 04:05:06,197:WARNING: 	 context_length: 77
2024-05-03 04:05:06,197:WARNING: 	 vocab_size: 49408
2024-05-03 04:05:06,197:WARNING: 	 transformer_width: 512
2024-05-03 04:05:06,197:WARNING: 	 transformer_heads: 8
2024-05-03 04:05:06,197:WARNING: 	 transformer_layers: 12
2024-05-03 04:05:06,197:WARNING: 		 linear_patch: 2d
2024-05-03 04:05:06,197:WARNING: 	 cut_top_layer: 0
2024-05-03 04:05:07,186:WARNING: 	 sim_header: meanP
2024-05-03 04:07:40,660:INFO: Effective parameters:
2024-05-03 04:07:40,660:INFO:   <<< batch_size: 1
2024-05-03 04:07:40,660:INFO:   <<< batch_size_val: 16
2024-05-03 04:07:40,660:INFO:   <<< cache_dir: 
2024-05-03 04:07:40,660:INFO:   <<< coef_lr: 0.001
2024-05-03 04:07:40,661:INFO:   <<< cross_model: cross-base
2024-05-03 04:07:40,661:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:07:40,661:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:07:40,661:INFO:   <<< datatype: msrvtt
2024-05-03 04:07:40,661:INFO:   <<< do_eval: True
2024-05-03 04:07:40,661:INFO:   <<< do_lower_case: False
2024-05-03 04:07:40,661:INFO:   <<< do_pretrain: False
2024-05-03 04:07:40,661:INFO:   <<< do_train: False
2024-05-03 04:07:40,661:INFO:   <<< epochs: 2
2024-05-03 04:07:40,661:INFO:   <<< eval_frame_order: 0
2024-05-03 04:07:40,661:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:07:40,661:INFO:   <<< feature_framerate: 1
2024-05-03 04:07:40,661:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:07:40,661:INFO:   <<< fp16: False
2024-05-03 04:07:40,661:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:07:40,662:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:07:40,662:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:07:40,662:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:07:40,662:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:07:40,662:INFO:   <<< linear_patch: 2d
2024-05-03 04:07:40,662:INFO:   <<< local_rank: 0
2024-05-03 04:07:40,662:INFO:   <<< loose_type: True
2024-05-03 04:07:40,662:INFO:   <<< lr: 0.0001
2024-05-03 04:07:40,662:INFO:   <<< lr_decay: 0.9
2024-05-03 04:07:40,662:INFO:   <<< margin: 0.1
2024-05-03 04:07:40,662:INFO:   <<< max_frames: 90
2024-05-03 04:07:40,662:INFO:   <<< max_words: 32
2024-05-03 04:07:40,662:INFO:   <<< n_display: 100
2024-05-03 04:07:40,662:INFO:   <<< n_gpu: 1
2024-05-03 04:07:40,662:INFO:   <<< n_pair: 1
2024-05-03 04:07:40,662:INFO:   <<< negative_weighting: 1
2024-05-03 04:07:40,662:INFO:   <<< num_thread_reader: 0
2024-05-03 04:07:40,663:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:07:40,663:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:07:40,663:INFO:   <<< rank: 0
2024-05-03 04:07:40,663:INFO:   <<< resume_model: None
2024-05-03 04:07:40,663:INFO:   <<< sampled_use_mil: False
2024-05-03 04:07:40,663:INFO:   <<< seed: 42
2024-05-03 04:07:40,663:INFO:   <<< sim_header: meanP
2024-05-03 04:07:40,663:INFO:   <<< slice_framepos: 2
2024-05-03 04:07:40,663:INFO:   <<< task_type: retrieval
2024-05-03 04:07:40,663:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:07:40,663:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:07:40,663:INFO:   <<< train_frame_order: 0
2024-05-03 04:07:40,663:INFO:   <<< use_mil: False
2024-05-03 04:07:40,663:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:07:40,663:INFO:   <<< video_dim: 1024
2024-05-03 04:07:40,663:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:07:40,664:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:07:40,664:INFO:   <<< world_size: 1
2024-05-03 04:07:40,664:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:07:40,798:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:07:41,275:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:07:41,275:WARNING: Test retrieval by loose type.
2024-05-03 04:07:41,275:WARNING: 	 embed_dim: 512
2024-05-03 04:07:41,276:WARNING: 	 image_resolution: 224
2024-05-03 04:07:41,276:WARNING: 	 vision_layers: 12
2024-05-03 04:07:41,276:WARNING: 	 vision_width: 768
2024-05-03 04:07:41,276:WARNING: 	 vision_patch_size: 32
2024-05-03 04:07:41,276:WARNING: 	 context_length: 77
2024-05-03 04:07:41,276:WARNING: 	 vocab_size: 49408
2024-05-03 04:07:41,276:WARNING: 	 transformer_width: 512
2024-05-03 04:07:41,276:WARNING: 	 transformer_heads: 8
2024-05-03 04:07:41,276:WARNING: 	 transformer_layers: 12
2024-05-03 04:07:41,276:WARNING: 		 linear_patch: 2d
2024-05-03 04:07:41,276:WARNING: 	 cut_top_layer: 0
2024-05-03 04:07:42,264:WARNING: 	 sim_header: meanP
2024-05-03 04:08:09,491:INFO: Effective parameters:
2024-05-03 04:08:09,491:INFO:   <<< batch_size: 1
2024-05-03 04:08:09,491:INFO:   <<< batch_size_val: 16
2024-05-03 04:08:09,491:INFO:   <<< cache_dir: 
2024-05-03 04:08:09,491:INFO:   <<< coef_lr: 0.001
2024-05-03 04:08:09,491:INFO:   <<< cross_model: cross-base
2024-05-03 04:08:09,491:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:08:09,491:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:08:09,491:INFO:   <<< datatype: msrvtt
2024-05-03 04:08:09,491:INFO:   <<< do_eval: True
2024-05-03 04:08:09,491:INFO:   <<< do_lower_case: False
2024-05-03 04:08:09,491:INFO:   <<< do_pretrain: False
2024-05-03 04:08:09,492:INFO:   <<< do_train: False
2024-05-03 04:08:09,492:INFO:   <<< epochs: 2
2024-05-03 04:08:09,492:INFO:   <<< eval_frame_order: 0
2024-05-03 04:08:09,492:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:08:09,492:INFO:   <<< feature_framerate: 1
2024-05-03 04:08:09,492:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:08:09,492:INFO:   <<< fp16: False
2024-05-03 04:08:09,492:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:08:09,492:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:08:09,492:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:08:09,492:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:08:09,492:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:08:09,492:INFO:   <<< linear_patch: 2d
2024-05-03 04:08:09,492:INFO:   <<< local_rank: 0
2024-05-03 04:08:09,492:INFO:   <<< loose_type: True
2024-05-03 04:08:09,492:INFO:   <<< lr: 0.0001
2024-05-03 04:08:09,493:INFO:   <<< lr_decay: 0.9
2024-05-03 04:08:09,493:INFO:   <<< margin: 0.1
2024-05-03 04:08:09,493:INFO:   <<< max_frames: 90
2024-05-03 04:08:09,493:INFO:   <<< max_words: 32
2024-05-03 04:08:09,493:INFO:   <<< n_display: 100
2024-05-03 04:08:09,493:INFO:   <<< n_gpu: 1
2024-05-03 04:08:09,493:INFO:   <<< n_pair: 1
2024-05-03 04:08:09,493:INFO:   <<< negative_weighting: 1
2024-05-03 04:08:09,493:INFO:   <<< num_thread_reader: 0
2024-05-03 04:08:09,493:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:08:09,493:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:08:09,493:INFO:   <<< rank: 0
2024-05-03 04:08:09,493:INFO:   <<< resume_model: None
2024-05-03 04:08:09,493:INFO:   <<< sampled_use_mil: False
2024-05-03 04:08:09,493:INFO:   <<< seed: 42
2024-05-03 04:08:09,493:INFO:   <<< sim_header: meanP
2024-05-03 04:08:09,493:INFO:   <<< slice_framepos: 2
2024-05-03 04:08:09,493:INFO:   <<< task_type: retrieval
2024-05-03 04:08:09,494:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:08:09,494:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:08:09,494:INFO:   <<< train_frame_order: 0
2024-05-03 04:08:09,494:INFO:   <<< use_mil: False
2024-05-03 04:08:09,494:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:08:09,494:INFO:   <<< video_dim: 1024
2024-05-03 04:08:09,494:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:08:09,494:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:08:09,494:INFO:   <<< world_size: 1
2024-05-03 04:08:09,494:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:08:09,626:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:08:10,099:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:08:10,099:WARNING: Test retrieval by loose type.
2024-05-03 04:08:10,100:WARNING: 	 embed_dim: 512
2024-05-03 04:08:10,100:WARNING: 	 image_resolution: 224
2024-05-03 04:08:10,100:WARNING: 	 vision_layers: 12
2024-05-03 04:08:10,100:WARNING: 	 vision_width: 768
2024-05-03 04:08:10,100:WARNING: 	 vision_patch_size: 32
2024-05-03 04:08:10,100:WARNING: 	 context_length: 77
2024-05-03 04:08:10,100:WARNING: 	 vocab_size: 49408
2024-05-03 04:08:10,101:WARNING: 	 transformer_width: 512
2024-05-03 04:08:10,101:WARNING: 	 transformer_heads: 8
2024-05-03 04:08:10,101:WARNING: 	 transformer_layers: 12
2024-05-03 04:08:10,101:WARNING: 		 linear_patch: 2d
2024-05-03 04:08:10,101:WARNING: 	 cut_top_layer: 0
2024-05-03 04:08:11,071:WARNING: 	 sim_header: meanP
2024-05-03 04:10:40,574:INFO: Effective parameters:
2024-05-03 04:10:40,574:INFO:   <<< batch_size: 16
2024-05-03 04:10:40,574:INFO:   <<< batch_size_val: 16
2024-05-03 04:10:40,574:INFO:   <<< cache_dir: 
2024-05-03 04:10:40,574:INFO:   <<< coef_lr: 0.001
2024-05-03 04:10:40,574:INFO:   <<< cross_model: cross-base
2024-05-03 04:10:40,574:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:10:40,574:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:10:40,575:INFO:   <<< datatype: msrvtt
2024-05-03 04:10:40,575:INFO:   <<< do_eval: True
2024-05-03 04:10:40,575:INFO:   <<< do_lower_case: False
2024-05-03 04:10:40,575:INFO:   <<< do_pretrain: False
2024-05-03 04:10:40,575:INFO:   <<< do_train: False
2024-05-03 04:10:40,575:INFO:   <<< epochs: 2
2024-05-03 04:10:40,575:INFO:   <<< eval_frame_order: 0
2024-05-03 04:10:40,575:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:10:40,575:INFO:   <<< feature_framerate: 1
2024-05-03 04:10:40,575:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:10:40,575:INFO:   <<< fp16: False
2024-05-03 04:10:40,575:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:10:40,575:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:10:40,575:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:10:40,575:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:10:40,575:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:10:40,575:INFO:   <<< linear_patch: 2d
2024-05-03 04:10:40,575:INFO:   <<< local_rank: 0
2024-05-03 04:10:40,576:INFO:   <<< loose_type: True
2024-05-03 04:10:40,576:INFO:   <<< lr: 0.0001
2024-05-03 04:10:40,576:INFO:   <<< lr_decay: 0.9
2024-05-03 04:10:40,576:INFO:   <<< margin: 0.1
2024-05-03 04:10:40,576:INFO:   <<< max_frames: 12
2024-05-03 04:10:40,576:INFO:   <<< max_words: 32
2024-05-03 04:10:40,576:INFO:   <<< n_display: 100
2024-05-03 04:10:40,576:INFO:   <<< n_gpu: 1
2024-05-03 04:10:40,576:INFO:   <<< n_pair: 1
2024-05-03 04:10:40,576:INFO:   <<< negative_weighting: 1
2024-05-03 04:10:40,576:INFO:   <<< num_thread_reader: 0
2024-05-03 04:10:40,576:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:10:40,576:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:10:40,576:INFO:   <<< rank: 0
2024-05-03 04:10:40,576:INFO:   <<< resume_model: None
2024-05-03 04:10:40,576:INFO:   <<< sampled_use_mil: False
2024-05-03 04:10:40,576:INFO:   <<< seed: 42
2024-05-03 04:10:40,577:INFO:   <<< sim_header: meanP
2024-05-03 04:10:40,577:INFO:   <<< slice_framepos: 2
2024-05-03 04:10:40,577:INFO:   <<< task_type: retrieval
2024-05-03 04:10:40,577:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:10:40,577:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:10:40,577:INFO:   <<< train_frame_order: 0
2024-05-03 04:10:40,577:INFO:   <<< use_mil: False
2024-05-03 04:10:40,577:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:10:40,577:INFO:   <<< video_dim: 1024
2024-05-03 04:10:40,577:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:10:40,577:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:10:40,577:INFO:   <<< world_size: 1
2024-05-03 04:10:40,577:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:10:40,677:INFO: ***** Running test *****
2024-05-03 04:10:40,678:INFO:   Num examples = 29
2024-05-03 04:10:40,678:INFO:   Batch size = 16
2024-05-03 04:10:40,678:INFO:   Num steps = 2
2024-05-03 04:10:40,678:INFO: ***** Running val *****
2024-05-03 04:10:40,678:INFO:   Num examples = 29
2024-05-03 04:11:42,255:INFO: Effective parameters:
2024-05-03 04:11:42,255:INFO:   <<< batch_size: 16
2024-05-03 04:11:42,255:INFO:   <<< batch_size_val: 16
2024-05-03 04:11:42,255:INFO:   <<< cache_dir: 
2024-05-03 04:11:42,256:INFO:   <<< coef_lr: 0.001
2024-05-03 04:11:42,256:INFO:   <<< cross_model: cross-base
2024-05-03 04:11:42,256:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:11:42,256:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:11:42,256:INFO:   <<< datatype: msrvtt
2024-05-03 04:11:42,256:INFO:   <<< do_eval: True
2024-05-03 04:11:42,256:INFO:   <<< do_lower_case: False
2024-05-03 04:11:42,256:INFO:   <<< do_pretrain: False
2024-05-03 04:11:42,256:INFO:   <<< do_train: False
2024-05-03 04:11:42,256:INFO:   <<< epochs: 2
2024-05-03 04:11:42,256:INFO:   <<< eval_frame_order: 0
2024-05-03 04:11:42,256:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:11:42,256:INFO:   <<< feature_framerate: 1
2024-05-03 04:11:42,256:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:11:42,256:INFO:   <<< fp16: False
2024-05-03 04:11:42,256:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:11:42,256:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:11:42,257:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:11:42,257:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:11:42,257:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:11:42,257:INFO:   <<< linear_patch: 2d
2024-05-03 04:11:42,257:INFO:   <<< local_rank: 0
2024-05-03 04:11:42,257:INFO:   <<< loose_type: True
2024-05-03 04:11:42,257:INFO:   <<< lr: 0.0001
2024-05-03 04:11:42,257:INFO:   <<< lr_decay: 0.9
2024-05-03 04:11:42,257:INFO:   <<< margin: 0.1
2024-05-03 04:11:42,257:INFO:   <<< max_frames: 12
2024-05-03 04:11:42,257:INFO:   <<< max_words: 32
2024-05-03 04:11:42,257:INFO:   <<< n_display: 100
2024-05-03 04:11:42,257:INFO:   <<< n_gpu: 1
2024-05-03 04:11:42,257:INFO:   <<< n_pair: 1
2024-05-03 04:11:42,257:INFO:   <<< negative_weighting: 1
2024-05-03 04:11:42,257:INFO:   <<< num_thread_reader: 0
2024-05-03 04:11:42,258:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:11:42,258:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:11:42,258:INFO:   <<< rank: 0
2024-05-03 04:11:42,258:INFO:   <<< resume_model: None
2024-05-03 04:11:42,258:INFO:   <<< sampled_use_mil: False
2024-05-03 04:11:42,258:INFO:   <<< seed: 42
2024-05-03 04:11:42,258:INFO:   <<< sim_header: meanP
2024-05-03 04:11:42,258:INFO:   <<< slice_framepos: 2
2024-05-03 04:11:42,258:INFO:   <<< task_type: retrieval
2024-05-03 04:11:42,258:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:11:42,258:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:11:42,258:INFO:   <<< train_frame_order: 0
2024-05-03 04:11:42,258:INFO:   <<< use_mil: False
2024-05-03 04:11:42,258:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:11:42,258:INFO:   <<< video_dim: 1024
2024-05-03 04:11:42,259:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:11:42,259:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:11:42,259:INFO:   <<< world_size: 1
2024-05-03 04:11:42,259:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:11:42,483:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:11:42,946:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:11:42,946:WARNING: Test retrieval by loose type.
2024-05-03 04:11:42,947:WARNING: 	 embed_dim: 512
2024-05-03 04:11:42,947:WARNING: 	 image_resolution: 224
2024-05-03 04:11:42,947:WARNING: 	 vision_layers: 12
2024-05-03 04:11:42,947:WARNING: 	 vision_width: 768
2024-05-03 04:11:42,947:WARNING: 	 vision_patch_size: 32
2024-05-03 04:11:42,947:WARNING: 	 context_length: 77
2024-05-03 04:11:42,947:WARNING: 	 vocab_size: 49408
2024-05-03 04:11:42,947:WARNING: 	 transformer_width: 512
2024-05-03 04:11:42,947:WARNING: 	 transformer_heads: 8
2024-05-03 04:11:42,947:WARNING: 	 transformer_layers: 12
2024-05-03 04:11:42,948:WARNING: 		 linear_patch: 2d
2024-05-03 04:11:42,948:WARNING: 	 cut_top_layer: 0
2024-05-03 04:11:43,925:WARNING: 	 sim_header: meanP
2024-05-03 04:11:49,956:INFO: ***** Running test *****
2024-05-03 04:11:49,956:INFO:   Num examples = 29
2024-05-03 04:11:49,956:INFO:   Batch size = 16
2024-05-03 04:11:49,957:INFO:   Num steps = 2
2024-05-03 04:11:49,957:INFO: ***** Running val *****
2024-05-03 04:11:49,957:INFO:   Num examples = 29
2024-05-03 04:13:27,155:INFO: Effective parameters:
2024-05-03 04:13:27,155:INFO:   <<< batch_size: 16
2024-05-03 04:13:27,155:INFO:   <<< batch_size_val: 16
2024-05-03 04:13:27,155:INFO:   <<< cache_dir: 
2024-05-03 04:13:27,155:INFO:   <<< coef_lr: 0.001
2024-05-03 04:13:27,155:INFO:   <<< cross_model: cross-base
2024-05-03 04:13:27,155:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:13:27,155:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:13:27,155:INFO:   <<< datatype: msrvtt
2024-05-03 04:13:27,155:INFO:   <<< do_eval: True
2024-05-03 04:13:27,155:INFO:   <<< do_lower_case: False
2024-05-03 04:13:27,156:INFO:   <<< do_pretrain: False
2024-05-03 04:13:27,156:INFO:   <<< do_train: False
2024-05-03 04:13:27,156:INFO:   <<< epochs: 2
2024-05-03 04:13:27,156:INFO:   <<< eval_frame_order: 0
2024-05-03 04:13:27,156:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:13:27,156:INFO:   <<< feature_framerate: 1
2024-05-03 04:13:27,156:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:13:27,156:INFO:   <<< fp16: False
2024-05-03 04:13:27,156:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:13:27,156:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:13:27,156:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:13:27,156:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:13:27,156:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:13:27,156:INFO:   <<< linear_patch: 2d
2024-05-03 04:13:27,156:INFO:   <<< local_rank: 0
2024-05-03 04:13:27,156:INFO:   <<< loose_type: True
2024-05-03 04:13:27,156:INFO:   <<< lr: 0.0001
2024-05-03 04:13:27,157:INFO:   <<< lr_decay: 0.9
2024-05-03 04:13:27,157:INFO:   <<< margin: 0.1
2024-05-03 04:13:27,157:INFO:   <<< max_frames: 12
2024-05-03 04:13:27,157:INFO:   <<< max_words: 32
2024-05-03 04:13:27,157:INFO:   <<< n_display: 100
2024-05-03 04:13:27,157:INFO:   <<< n_gpu: 1
2024-05-03 04:13:27,157:INFO:   <<< n_pair: 1
2024-05-03 04:13:27,157:INFO:   <<< negative_weighting: 1
2024-05-03 04:13:27,157:INFO:   <<< num_thread_reader: 0
2024-05-03 04:13:27,157:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:13:27,157:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:13:27,157:INFO:   <<< rank: 0
2024-05-03 04:13:27,157:INFO:   <<< resume_model: None
2024-05-03 04:13:27,157:INFO:   <<< sampled_use_mil: False
2024-05-03 04:13:27,157:INFO:   <<< seed: 42
2024-05-03 04:13:27,157:INFO:   <<< sim_header: meanP
2024-05-03 04:13:27,157:INFO:   <<< slice_framepos: 2
2024-05-03 04:13:27,158:INFO:   <<< task_type: retrieval
2024-05-03 04:13:27,158:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:13:27,158:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:13:27,158:INFO:   <<< train_frame_order: 0
2024-05-03 04:13:27,158:INFO:   <<< use_mil: False
2024-05-03 04:13:27,158:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:13:27,158:INFO:   <<< video_dim: 1024
2024-05-03 04:13:27,158:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:13:27,158:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:13:27,158:INFO:   <<< world_size: 1
2024-05-03 04:13:27,158:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:13:27,375:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:13:27,833:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:13:27,833:WARNING: Test retrieval by loose type.
2024-05-03 04:13:27,834:WARNING: 	 embed_dim: 512
2024-05-03 04:13:27,834:WARNING: 	 image_resolution: 224
2024-05-03 04:13:27,834:WARNING: 	 vision_layers: 12
2024-05-03 04:13:27,834:WARNING: 	 vision_width: 768
2024-05-03 04:13:27,834:WARNING: 	 vision_patch_size: 32
2024-05-03 04:13:27,834:WARNING: 	 context_length: 77
2024-05-03 04:13:27,834:WARNING: 	 vocab_size: 49408
2024-05-03 04:13:27,834:WARNING: 	 transformer_width: 512
2024-05-03 04:13:27,834:WARNING: 	 transformer_heads: 8
2024-05-03 04:13:27,834:WARNING: 	 transformer_layers: 12
2024-05-03 04:13:27,834:WARNING: 		 linear_patch: 2d
2024-05-03 04:13:27,834:WARNING: 	 cut_top_layer: 0
2024-05-03 04:13:28,814:WARNING: 	 sim_header: meanP
2024-05-03 04:13:34,867:INFO: ***** Running test *****
2024-05-03 04:13:34,867:INFO:   Num examples = 29
2024-05-03 04:13:34,868:INFO:   Batch size = 16
2024-05-03 04:13:34,868:INFO:   Num steps = 2
2024-05-03 04:13:34,868:INFO: ***** Running val *****
2024-05-03 04:13:34,868:INFO:   Num examples = 29
2024-05-03 04:19:06,701:INFO: Effective parameters:
2024-05-03 04:19:06,701:INFO:   <<< batch_size: 16
2024-05-03 04:19:06,701:INFO:   <<< batch_size_val: 16
2024-05-03 04:19:06,701:INFO:   <<< cache_dir: 
2024-05-03 04:19:06,702:INFO:   <<< coef_lr: 0.001
2024-05-03 04:19:06,702:INFO:   <<< cross_model: cross-base
2024-05-03 04:19:06,702:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:19:06,702:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:19:06,702:INFO:   <<< datatype: msrvtt
2024-05-03 04:19:06,702:INFO:   <<< do_eval: True
2024-05-03 04:19:06,702:INFO:   <<< do_lower_case: False
2024-05-03 04:19:06,702:INFO:   <<< do_pretrain: False
2024-05-03 04:19:06,702:INFO:   <<< do_train: False
2024-05-03 04:19:06,702:INFO:   <<< epochs: 2
2024-05-03 04:19:06,702:INFO:   <<< eval_frame_order: 0
2024-05-03 04:19:06,702:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:19:06,702:INFO:   <<< feature_framerate: 1
2024-05-03 04:19:06,702:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:19:06,702:INFO:   <<< fp16: False
2024-05-03 04:19:06,702:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:19:06,702:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:19:06,703:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:19:06,703:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:19:06,703:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:19:06,703:INFO:   <<< linear_patch: 2d
2024-05-03 04:19:06,703:INFO:   <<< local_rank: 0
2024-05-03 04:19:06,703:INFO:   <<< loose_type: True
2024-05-03 04:19:06,703:INFO:   <<< lr: 0.0001
2024-05-03 04:19:06,703:INFO:   <<< lr_decay: 0.9
2024-05-03 04:19:06,703:INFO:   <<< margin: 0.1
2024-05-03 04:19:06,703:INFO:   <<< max_frames: 12
2024-05-03 04:19:06,703:INFO:   <<< max_words: 32
2024-05-03 04:19:06,703:INFO:   <<< n_display: 100
2024-05-03 04:19:06,703:INFO:   <<< n_gpu: 1
2024-05-03 04:19:06,703:INFO:   <<< n_pair: 1
2024-05-03 04:19:06,703:INFO:   <<< negative_weighting: 1
2024-05-03 04:19:06,703:INFO:   <<< num_thread_reader: 0
2024-05-03 04:19:06,703:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:19:06,703:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:19:06,704:INFO:   <<< rank: 0
2024-05-03 04:19:06,704:INFO:   <<< resume_model: None
2024-05-03 04:19:06,704:INFO:   <<< sampled_use_mil: False
2024-05-03 04:19:06,704:INFO:   <<< seed: 42
2024-05-03 04:19:06,704:INFO:   <<< sim_header: meanP
2024-05-03 04:19:06,704:INFO:   <<< slice_framepos: 2
2024-05-03 04:19:06,704:INFO:   <<< task_type: retrieval
2024-05-03 04:19:06,704:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:19:06,704:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:19:06,704:INFO:   <<< train_frame_order: 0
2024-05-03 04:19:06,704:INFO:   <<< use_mil: False
2024-05-03 04:19:06,704:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:19:06,704:INFO:   <<< video_dim: 1024
2024-05-03 04:19:06,704:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:19:06,704:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:19:06,704:INFO:   <<< world_size: 1
2024-05-03 04:19:06,705:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:19:06,925:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:19:07,382:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:19:07,382:WARNING: Test retrieval by loose type.
2024-05-03 04:19:07,383:WARNING: 	 embed_dim: 512
2024-05-03 04:19:07,383:WARNING: 	 image_resolution: 224
2024-05-03 04:19:07,383:WARNING: 	 vision_layers: 12
2024-05-03 04:19:07,383:WARNING: 	 vision_width: 768
2024-05-03 04:19:07,383:WARNING: 	 vision_patch_size: 32
2024-05-03 04:19:07,383:WARNING: 	 context_length: 77
2024-05-03 04:19:07,383:WARNING: 	 vocab_size: 49408
2024-05-03 04:19:07,383:WARNING: 	 transformer_width: 512
2024-05-03 04:19:07,383:WARNING: 	 transformer_heads: 8
2024-05-03 04:19:07,383:WARNING: 	 transformer_layers: 12
2024-05-03 04:19:07,383:WARNING: 		 linear_patch: 2d
2024-05-03 04:19:07,384:WARNING: 	 cut_top_layer: 0
2024-05-03 04:19:08,348:WARNING: 	 sim_header: meanP
2024-05-03 04:19:14,359:INFO: ***** Running test *****
2024-05-03 04:19:14,359:INFO:   Num examples = 29
2024-05-03 04:19:14,359:INFO:   Batch size = 16
2024-05-03 04:19:14,359:INFO:   Num steps = 2
2024-05-03 04:19:14,359:INFO: ***** Running val *****
2024-05-03 04:19:14,359:INFO:   Num examples = 29
2024-05-03 04:20:13,364:INFO: Effective parameters:
2024-05-03 04:20:13,365:INFO:   <<< batch_size: 16
2024-05-03 04:20:13,365:INFO:   <<< batch_size_val: 16
2024-05-03 04:20:13,365:INFO:   <<< cache_dir: 
2024-05-03 04:20:13,365:INFO:   <<< coef_lr: 0.001
2024-05-03 04:20:13,365:INFO:   <<< cross_model: cross-base
2024-05-03 04:20:13,365:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:20:13,365:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:20:13,365:INFO:   <<< datatype: msrvtt
2024-05-03 04:20:13,365:INFO:   <<< do_eval: True
2024-05-03 04:20:13,365:INFO:   <<< do_lower_case: False
2024-05-03 04:20:13,365:INFO:   <<< do_pretrain: False
2024-05-03 04:20:13,365:INFO:   <<< do_train: False
2024-05-03 04:20:13,365:INFO:   <<< epochs: 2
2024-05-03 04:20:13,365:INFO:   <<< eval_frame_order: 0
2024-05-03 04:20:13,366:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:20:13,366:INFO:   <<< feature_framerate: 1
2024-05-03 04:20:13,366:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:20:13,366:INFO:   <<< fp16: False
2024-05-03 04:20:13,366:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:20:13,366:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:20:13,366:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:20:13,366:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:20:13,366:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:20:13,366:INFO:   <<< linear_patch: 2d
2024-05-03 04:20:13,366:INFO:   <<< local_rank: 0
2024-05-03 04:20:13,366:INFO:   <<< loose_type: True
2024-05-03 04:20:13,366:INFO:   <<< lr: 0.0001
2024-05-03 04:20:13,366:INFO:   <<< lr_decay: 0.9
2024-05-03 04:20:13,366:INFO:   <<< margin: 0.1
2024-05-03 04:20:13,366:INFO:   <<< max_frames: 12
2024-05-03 04:20:13,366:INFO:   <<< max_words: 32
2024-05-03 04:20:13,367:INFO:   <<< n_display: 100
2024-05-03 04:20:13,367:INFO:   <<< n_gpu: 1
2024-05-03 04:20:13,367:INFO:   <<< n_pair: 1
2024-05-03 04:20:13,367:INFO:   <<< negative_weighting: 1
2024-05-03 04:20:13,367:INFO:   <<< num_thread_reader: 0
2024-05-03 04:20:13,367:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:20:13,367:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:20:13,367:INFO:   <<< rank: 0
2024-05-03 04:20:13,367:INFO:   <<< resume_model: None
2024-05-03 04:20:13,367:INFO:   <<< sampled_use_mil: False
2024-05-03 04:20:13,367:INFO:   <<< seed: 42
2024-05-03 04:20:13,367:INFO:   <<< sim_header: meanP
2024-05-03 04:20:13,367:INFO:   <<< slice_framepos: 2
2024-05-03 04:20:13,367:INFO:   <<< task_type: retrieval
2024-05-03 04:20:13,367:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:20:13,368:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:20:13,368:INFO:   <<< train_frame_order: 0
2024-05-03 04:20:13,368:INFO:   <<< use_mil: False
2024-05-03 04:20:13,368:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:20:13,368:INFO:   <<< video_dim: 1024
2024-05-03 04:20:13,368:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:20:13,368:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:20:13,368:INFO:   <<< world_size: 1
2024-05-03 04:20:13,368:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:20:13,589:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:20:14,049:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:20:14,049:WARNING: Test retrieval by loose type.
2024-05-03 04:20:14,050:WARNING: 	 embed_dim: 512
2024-05-03 04:20:14,050:WARNING: 	 image_resolution: 224
2024-05-03 04:20:14,050:WARNING: 	 vision_layers: 12
2024-05-03 04:20:14,050:WARNING: 	 vision_width: 768
2024-05-03 04:20:14,051:WARNING: 	 vision_patch_size: 32
2024-05-03 04:20:14,051:WARNING: 	 context_length: 77
2024-05-03 04:20:14,051:WARNING: 	 vocab_size: 49408
2024-05-03 04:20:14,051:WARNING: 	 transformer_width: 512
2024-05-03 04:20:14,051:WARNING: 	 transformer_heads: 8
2024-05-03 04:20:14,051:WARNING: 	 transformer_layers: 12
2024-05-03 04:20:14,051:WARNING: 		 linear_patch: 2d
2024-05-03 04:20:14,051:WARNING: 	 cut_top_layer: 0
2024-05-03 04:20:15,034:WARNING: 	 sim_header: meanP
2024-05-03 04:20:21,104:INFO: ***** Running test *****
2024-05-03 04:20:21,104:INFO:   Num examples = 29
2024-05-03 04:20:21,104:INFO:   Batch size = 16
2024-05-03 04:20:21,104:INFO:   Num steps = 2
2024-05-03 04:20:21,104:INFO: ***** Running val *****
2024-05-03 04:20:21,104:INFO:   Num examples = 29
2024-05-03 04:42:32,845:INFO: Effective parameters:
2024-05-03 04:42:32,845:INFO:   <<< batch_size: 16
2024-05-03 04:42:32,845:INFO:   <<< batch_size_val: 16
2024-05-03 04:42:32,845:INFO:   <<< cache_dir: 
2024-05-03 04:42:32,845:INFO:   <<< coef_lr: 0.001
2024-05-03 04:42:32,845:INFO:   <<< cross_model: cross-base
2024-05-03 04:42:32,845:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:42:32,846:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:42:32,846:INFO:   <<< datatype: msrvtt
2024-05-03 04:42:32,846:INFO:   <<< do_eval: True
2024-05-03 04:42:32,846:INFO:   <<< do_lower_case: False
2024-05-03 04:42:32,846:INFO:   <<< do_pretrain: False
2024-05-03 04:42:32,846:INFO:   <<< do_train: False
2024-05-03 04:42:32,846:INFO:   <<< epochs: 2
2024-05-03 04:42:32,846:INFO:   <<< eval_frame_order: 0
2024-05-03 04:42:32,846:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:42:32,846:INFO:   <<< feature_framerate: 1
2024-05-03 04:42:32,846:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:42:32,846:INFO:   <<< fp16: False
2024-05-03 04:42:32,846:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:42:32,846:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:42:32,846:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:42:32,846:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:42:32,846:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:42:32,847:INFO:   <<< linear_patch: 2d
2024-05-03 04:42:32,847:INFO:   <<< local_rank: 0
2024-05-03 04:42:32,847:INFO:   <<< loose_type: True
2024-05-03 04:42:32,847:INFO:   <<< lr: 0.0001
2024-05-03 04:42:32,847:INFO:   <<< lr_decay: 0.9
2024-05-03 04:42:32,847:INFO:   <<< margin: 0.1
2024-05-03 04:42:32,847:INFO:   <<< max_frames: 12
2024-05-03 04:42:32,847:INFO:   <<< max_words: 32
2024-05-03 04:42:32,847:INFO:   <<< n_display: 100
2024-05-03 04:42:32,847:INFO:   <<< n_gpu: 1
2024-05-03 04:42:32,847:INFO:   <<< n_pair: 1
2024-05-03 04:42:32,847:INFO:   <<< negative_weighting: 1
2024-05-03 04:42:32,847:INFO:   <<< num_thread_reader: 0
2024-05-03 04:42:32,847:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:42:32,847:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:42:32,847:INFO:   <<< rank: 0
2024-05-03 04:42:32,847:INFO:   <<< resume_model: None
2024-05-03 04:42:32,848:INFO:   <<< sampled_use_mil: False
2024-05-03 04:42:32,848:INFO:   <<< seed: 42
2024-05-03 04:42:32,848:INFO:   <<< sim_header: meanP
2024-05-03 04:42:32,848:INFO:   <<< slice_framepos: 2
2024-05-03 04:42:32,848:INFO:   <<< task_type: retrieval
2024-05-03 04:42:32,848:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:42:32,848:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:42:32,848:INFO:   <<< train_frame_order: 0
2024-05-03 04:42:32,848:INFO:   <<< use_mil: False
2024-05-03 04:42:32,848:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:42:32,848:INFO:   <<< video_dim: 1024
2024-05-03 04:42:32,848:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:42:32,848:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:42:32,848:INFO:   <<< world_size: 1
2024-05-03 04:42:32,848:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:42:33,068:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:42:33,526:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:42:33,526:WARNING: Test retrieval by loose type.
2024-05-03 04:42:33,527:WARNING: 	 embed_dim: 512
2024-05-03 04:42:33,527:WARNING: 	 image_resolution: 224
2024-05-03 04:42:33,527:WARNING: 	 vision_layers: 12
2024-05-03 04:42:33,527:WARNING: 	 vision_width: 768
2024-05-03 04:42:33,527:WARNING: 	 vision_patch_size: 32
2024-05-03 04:42:33,528:WARNING: 	 context_length: 77
2024-05-03 04:42:33,528:WARNING: 	 vocab_size: 49408
2024-05-03 04:42:33,528:WARNING: 	 transformer_width: 512
2024-05-03 04:42:33,528:WARNING: 	 transformer_heads: 8
2024-05-03 04:42:33,528:WARNING: 	 transformer_layers: 12
2024-05-03 04:42:33,528:WARNING: 		 linear_patch: 2d
2024-05-03 04:42:33,528:WARNING: 	 cut_top_layer: 0
2024-05-03 04:42:34,509:WARNING: 	 sim_header: meanP
2024-05-03 04:42:40,572:INFO: ***** Running test *****
2024-05-03 04:42:40,572:INFO:   Num examples = 29
2024-05-03 04:42:40,572:INFO:   Batch size = 16
2024-05-03 04:42:40,572:INFO:   Num steps = 2
2024-05-03 04:42:40,572:INFO: ***** Running val *****
2024-05-03 04:42:40,572:INFO:   Num examples = 29
2024-05-03 04:45:45,147:INFO: Effective parameters:
2024-05-03 04:45:45,147:INFO:   <<< batch_size: 16
2024-05-03 04:45:45,147:INFO:   <<< batch_size_val: 16
2024-05-03 04:45:45,147:INFO:   <<< cache_dir: 
2024-05-03 04:45:45,147:INFO:   <<< coef_lr: 0.001
2024-05-03 04:45:45,147:INFO:   <<< cross_model: cross-base
2024-05-03 04:45:45,147:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:45:45,147:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:45:45,148:INFO:   <<< datatype: msrvtt
2024-05-03 04:45:45,148:INFO:   <<< do_eval: True
2024-05-03 04:45:45,148:INFO:   <<< do_lower_case: False
2024-05-03 04:45:45,148:INFO:   <<< do_pretrain: False
2024-05-03 04:45:45,148:INFO:   <<< do_train: False
2024-05-03 04:45:45,148:INFO:   <<< epochs: 2
2024-05-03 04:45:45,148:INFO:   <<< eval_frame_order: 0
2024-05-03 04:45:45,148:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:45:45,148:INFO:   <<< feature_framerate: 1
2024-05-03 04:45:45,148:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:45:45,148:INFO:   <<< fp16: False
2024-05-03 04:45:45,148:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:45:45,148:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:45:45,148:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:45:45,148:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:45:45,149:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:45:45,149:INFO:   <<< linear_patch: 2d
2024-05-03 04:45:45,149:INFO:   <<< local_rank: 0
2024-05-03 04:45:45,149:INFO:   <<< loose_type: True
2024-05-03 04:45:45,149:INFO:   <<< lr: 0.0001
2024-05-03 04:45:45,149:INFO:   <<< lr_decay: 0.9
2024-05-03 04:45:45,149:INFO:   <<< margin: 0.1
2024-05-03 04:45:45,149:INFO:   <<< max_frames: 12
2024-05-03 04:45:45,149:INFO:   <<< max_words: 32
2024-05-03 04:45:45,149:INFO:   <<< n_display: 100
2024-05-03 04:45:45,149:INFO:   <<< n_gpu: 1
2024-05-03 04:45:45,149:INFO:   <<< n_pair: 1
2024-05-03 04:45:45,149:INFO:   <<< negative_weighting: 1
2024-05-03 04:45:45,150:INFO:   <<< num_thread_reader: 0
2024-05-03 04:45:45,150:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:45:45,150:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:45:45,150:INFO:   <<< rank: 0
2024-05-03 04:45:45,150:INFO:   <<< resume_model: None
2024-05-03 04:45:45,150:INFO:   <<< sampled_use_mil: False
2024-05-03 04:45:45,150:INFO:   <<< seed: 42
2024-05-03 04:45:45,150:INFO:   <<< sim_header: meanP
2024-05-03 04:45:45,150:INFO:   <<< slice_framepos: 2
2024-05-03 04:45:45,150:INFO:   <<< task_type: retrieval
2024-05-03 04:45:45,150:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:45:45,150:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:45:45,150:INFO:   <<< train_frame_order: 0
2024-05-03 04:45:45,150:INFO:   <<< use_mil: False
2024-05-03 04:45:45,150:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:45:45,151:INFO:   <<< video_dim: 1024
2024-05-03 04:45:45,151:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:45:45,151:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:45:45,151:INFO:   <<< world_size: 1
2024-05-03 04:45:45,151:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:45:45,370:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:45:45,833:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:45:45,833:WARNING: Test retrieval by loose type.
2024-05-03 04:45:45,834:WARNING: 	 embed_dim: 512
2024-05-03 04:45:45,834:WARNING: 	 image_resolution: 224
2024-05-03 04:45:45,834:WARNING: 	 vision_layers: 12
2024-05-03 04:45:45,834:WARNING: 	 vision_width: 768
2024-05-03 04:45:45,834:WARNING: 	 vision_patch_size: 32
2024-05-03 04:45:45,834:WARNING: 	 context_length: 77
2024-05-03 04:45:45,834:WARNING: 	 vocab_size: 49408
2024-05-03 04:45:45,834:WARNING: 	 transformer_width: 512
2024-05-03 04:45:45,834:WARNING: 	 transformer_heads: 8
2024-05-03 04:45:45,834:WARNING: 	 transformer_layers: 12
2024-05-03 04:45:45,834:WARNING: 		 linear_patch: 2d
2024-05-03 04:45:45,835:WARNING: 	 cut_top_layer: 0
2024-05-03 04:45:46,815:WARNING: 	 sim_header: meanP
2024-05-03 04:45:52,898:INFO: ***** Running test *****
2024-05-03 04:45:52,898:INFO:   Num examples = 29
2024-05-03 04:45:52,899:INFO:   Batch size = 16
2024-05-03 04:45:52,899:INFO:   Num steps = 2
2024-05-03 04:45:52,899:INFO: ***** Running val *****
2024-05-03 04:45:52,899:INFO:   Num examples = 29
2024-05-03 04:56:47,427:INFO: Effective parameters:
2024-05-03 04:56:47,427:INFO:   <<< batch_size: 1
2024-05-03 04:56:47,427:INFO:   <<< batch_size_val: 16
2024-05-03 04:56:47,427:INFO:   <<< cache_dir: 
2024-05-03 04:56:47,427:INFO:   <<< coef_lr: 0.001
2024-05-03 04:56:47,427:INFO:   <<< cross_model: cross-base
2024-05-03 04:56:47,427:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:56:47,427:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:56:47,427:INFO:   <<< datatype: msrvtt
2024-05-03 04:56:47,427:INFO:   <<< do_eval: True
2024-05-03 04:56:47,427:INFO:   <<< do_lower_case: False
2024-05-03 04:56:47,427:INFO:   <<< do_pretrain: False
2024-05-03 04:56:47,427:INFO:   <<< do_train: False
2024-05-03 04:56:47,428:INFO:   <<< epochs: 2
2024-05-03 04:56:47,428:INFO:   <<< eval_frame_order: 0
2024-05-03 04:56:47,428:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:56:47,428:INFO:   <<< feature_framerate: 1
2024-05-03 04:56:47,428:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:56:47,428:INFO:   <<< fp16: False
2024-05-03 04:56:47,428:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:56:47,428:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:56:47,428:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:56:47,428:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:56:47,428:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:56:47,428:INFO:   <<< linear_patch: 2d
2024-05-03 04:56:47,428:INFO:   <<< local_rank: 0
2024-05-03 04:56:47,428:INFO:   <<< loose_type: True
2024-05-03 04:56:47,428:INFO:   <<< lr: 0.0001
2024-05-03 04:56:47,428:INFO:   <<< lr_decay: 0.9
2024-05-03 04:56:47,429:INFO:   <<< margin: 0.1
2024-05-03 04:56:47,429:INFO:   <<< max_frames: 90
2024-05-03 04:56:47,429:INFO:   <<< max_words: 32
2024-05-03 04:56:47,429:INFO:   <<< n_display: 100
2024-05-03 04:56:47,429:INFO:   <<< n_gpu: 1
2024-05-03 04:56:47,429:INFO:   <<< n_pair: 1
2024-05-03 04:56:47,429:INFO:   <<< negative_weighting: 1
2024-05-03 04:56:47,429:INFO:   <<< num_thread_reader: 0
2024-05-03 04:56:47,429:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:56:47,429:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:56:47,429:INFO:   <<< rank: 0
2024-05-03 04:56:47,429:INFO:   <<< resume_model: None
2024-05-03 04:56:47,429:INFO:   <<< sampled_use_mil: False
2024-05-03 04:56:47,429:INFO:   <<< seed: 42
2024-05-03 04:56:47,429:INFO:   <<< sim_header: meanP
2024-05-03 04:56:47,429:INFO:   <<< slice_framepos: 2
2024-05-03 04:56:47,429:INFO:   <<< task_type: retrieval
2024-05-03 04:56:47,430:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:56:47,430:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:56:47,430:INFO:   <<< train_frame_order: 0
2024-05-03 04:56:47,430:INFO:   <<< use_mil: False
2024-05-03 04:56:47,430:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:56:47,430:INFO:   <<< video_dim: 1024
2024-05-03 04:56:47,430:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:56:47,430:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:56:47,430:INFO:   <<< world_size: 1
2024-05-03 04:56:47,430:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:56:47,562:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:56:48,040:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:56:48,040:WARNING: Test retrieval by loose type.
2024-05-03 04:56:48,041:WARNING: 	 embed_dim: 512
2024-05-03 04:56:48,041:WARNING: 	 image_resolution: 224
2024-05-03 04:56:48,041:WARNING: 	 vision_layers: 12
2024-05-03 04:56:48,041:WARNING: 	 vision_width: 768
2024-05-03 04:56:48,041:WARNING: 	 vision_patch_size: 32
2024-05-03 04:56:48,041:WARNING: 	 context_length: 77
2024-05-03 04:56:48,041:WARNING: 	 vocab_size: 49408
2024-05-03 04:56:48,041:WARNING: 	 transformer_width: 512
2024-05-03 04:56:48,041:WARNING: 	 transformer_heads: 8
2024-05-03 04:56:48,042:WARNING: 	 transformer_layers: 12
2024-05-03 04:56:48,042:WARNING: 		 linear_patch: 2d
2024-05-03 04:56:48,042:WARNING: 	 cut_top_layer: 0
2024-05-03 04:56:49,031:WARNING: 	 sim_header: meanP
2024-05-03 04:57:42,571:INFO: Effective parameters:
2024-05-03 04:57:42,572:INFO:   <<< batch_size: 16
2024-05-03 04:57:42,572:INFO:   <<< batch_size_val: 16
2024-05-03 04:57:42,572:INFO:   <<< cache_dir: 
2024-05-03 04:57:42,572:INFO:   <<< coef_lr: 0.001
2024-05-03 04:57:42,572:INFO:   <<< cross_model: cross-base
2024-05-03 04:57:42,572:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 04:57:42,572:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 04:57:42,572:INFO:   <<< datatype: msrvtt
2024-05-03 04:57:42,572:INFO:   <<< do_eval: True
2024-05-03 04:57:42,572:INFO:   <<< do_lower_case: False
2024-05-03 04:57:42,572:INFO:   <<< do_pretrain: False
2024-05-03 04:57:42,572:INFO:   <<< do_train: False
2024-05-03 04:57:42,572:INFO:   <<< epochs: 2
2024-05-03 04:57:42,573:INFO:   <<< eval_frame_order: 0
2024-05-03 04:57:42,573:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 04:57:42,573:INFO:   <<< feature_framerate: 1
2024-05-03 04:57:42,573:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 04:57:42,573:INFO:   <<< fp16: False
2024-05-03 04:57:42,573:INFO:   <<< fp16_opt_level: O1
2024-05-03 04:57:42,573:INFO:   <<< freeze_layer_num: 0
2024-05-03 04:57:42,573:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 04:57:42,573:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 04:57:42,573:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 04:57:42,573:INFO:   <<< linear_patch: 2d
2024-05-03 04:57:42,573:INFO:   <<< local_rank: 0
2024-05-03 04:57:42,573:INFO:   <<< loose_type: True
2024-05-03 04:57:42,574:INFO:   <<< lr: 0.0001
2024-05-03 04:57:42,574:INFO:   <<< lr_decay: 0.9
2024-05-03 04:57:42,574:INFO:   <<< margin: 0.1
2024-05-03 04:57:42,574:INFO:   <<< max_frames: 12
2024-05-03 04:57:42,574:INFO:   <<< max_words: 32
2024-05-03 04:57:42,574:INFO:   <<< n_display: 100
2024-05-03 04:57:42,574:INFO:   <<< n_gpu: 1
2024-05-03 04:57:42,574:INFO:   <<< n_pair: 1
2024-05-03 04:57:42,574:INFO:   <<< negative_weighting: 1
2024-05-03 04:57:42,574:INFO:   <<< num_thread_reader: 0
2024-05-03 04:57:42,574:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 04:57:42,574:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 04:57:42,574:INFO:   <<< rank: 0
2024-05-03 04:57:42,574:INFO:   <<< resume_model: None
2024-05-03 04:57:42,575:INFO:   <<< sampled_use_mil: False
2024-05-03 04:57:42,575:INFO:   <<< seed: 42
2024-05-03 04:57:42,575:INFO:   <<< sim_header: meanP
2024-05-03 04:57:42,575:INFO:   <<< slice_framepos: 2
2024-05-03 04:57:42,575:INFO:   <<< task_type: retrieval
2024-05-03 04:57:42,575:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 04:57:42,575:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 04:57:42,575:INFO:   <<< train_frame_order: 0
2024-05-03 04:57:42,575:INFO:   <<< use_mil: False
2024-05-03 04:57:42,575:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 04:57:42,575:INFO:   <<< video_dim: 1024
2024-05-03 04:57:42,575:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 04:57:42,575:INFO:   <<< warmup_proportion: 0.1
2024-05-03 04:57:42,575:INFO:   <<< world_size: 1
2024-05-03 04:57:42,576:INFO: device: cuda:0 n_gpu: 1
2024-05-03 04:57:42,791:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 04:57:43,248:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 04:57:43,248:WARNING: Test retrieval by loose type.
2024-05-03 04:57:43,249:WARNING: 	 embed_dim: 512
2024-05-03 04:57:43,249:WARNING: 	 image_resolution: 224
2024-05-03 04:57:43,249:WARNING: 	 vision_layers: 12
2024-05-03 04:57:43,249:WARNING: 	 vision_width: 768
2024-05-03 04:57:43,249:WARNING: 	 vision_patch_size: 32
2024-05-03 04:57:43,249:WARNING: 	 context_length: 77
2024-05-03 04:57:43,249:WARNING: 	 vocab_size: 49408
2024-05-03 04:57:43,249:WARNING: 	 transformer_width: 512
2024-05-03 04:57:43,250:WARNING: 	 transformer_heads: 8
2024-05-03 04:57:43,250:WARNING: 	 transformer_layers: 12
2024-05-03 04:57:43,250:WARNING: 		 linear_patch: 2d
2024-05-03 04:57:43,250:WARNING: 	 cut_top_layer: 0
2024-05-03 04:57:44,220:WARNING: 	 sim_header: meanP
2024-05-03 04:57:50,295:INFO: ***** Running test *****
2024-05-03 04:57:50,296:INFO:   Num examples = 29
2024-05-03 04:57:50,296:INFO:   Batch size = 16
2024-05-03 04:57:50,296:INFO:   Num steps = 2
2024-05-03 04:57:50,296:INFO: ***** Running val *****
2024-05-03 04:57:50,296:INFO:   Num examples = 29
2024-05-03 05:01:11,366:INFO: Effective parameters:
2024-05-03 05:01:11,367:INFO:   <<< batch_size: 1
2024-05-03 05:01:11,367:INFO:   <<< batch_size_val: 16
2024-05-03 05:01:11,367:INFO:   <<< cache_dir: 
2024-05-03 05:01:11,367:INFO:   <<< coef_lr: 0.001
2024-05-03 05:01:11,367:INFO:   <<< cross_model: cross-base
2024-05-03 05:01:11,367:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 05:01:11,367:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 05:01:11,367:INFO:   <<< datatype: msrvtt
2024-05-03 05:01:11,367:INFO:   <<< do_eval: True
2024-05-03 05:01:11,367:INFO:   <<< do_lower_case: False
2024-05-03 05:01:11,367:INFO:   <<< do_pretrain: False
2024-05-03 05:01:11,367:INFO:   <<< do_train: False
2024-05-03 05:01:11,367:INFO:   <<< epochs: 2
2024-05-03 05:01:11,367:INFO:   <<< eval_frame_order: 0
2024-05-03 05:01:11,368:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 05:01:11,368:INFO:   <<< feature_framerate: 1
2024-05-03 05:01:11,368:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 05:01:11,368:INFO:   <<< fp16: False
2024-05-03 05:01:11,368:INFO:   <<< fp16_opt_level: O1
2024-05-03 05:01:11,368:INFO:   <<< freeze_layer_num: 0
2024-05-03 05:01:11,368:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 05:01:11,368:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 05:01:11,368:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 05:01:11,368:INFO:   <<< linear_patch: 2d
2024-05-03 05:01:11,368:INFO:   <<< local_rank: 0
2024-05-03 05:01:11,368:INFO:   <<< loose_type: True
2024-05-03 05:01:11,368:INFO:   <<< lr: 0.0001
2024-05-03 05:01:11,368:INFO:   <<< lr_decay: 0.9
2024-05-03 05:01:11,368:INFO:   <<< margin: 0.1
2024-05-03 05:01:11,368:INFO:   <<< max_frames: 90
2024-05-03 05:01:11,368:INFO:   <<< max_words: 32
2024-05-03 05:01:11,369:INFO:   <<< n_display: 100
2024-05-03 05:01:11,369:INFO:   <<< n_gpu: 1
2024-05-03 05:01:11,369:INFO:   <<< n_pair: 1
2024-05-03 05:01:11,369:INFO:   <<< negative_weighting: 1
2024-05-03 05:01:11,369:INFO:   <<< num_thread_reader: 0
2024-05-03 05:01:11,369:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 05:01:11,369:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 05:01:11,369:INFO:   <<< rank: 0
2024-05-03 05:01:11,369:INFO:   <<< resume_model: None
2024-05-03 05:01:11,369:INFO:   <<< sampled_use_mil: False
2024-05-03 05:01:11,369:INFO:   <<< seed: 42
2024-05-03 05:01:11,369:INFO:   <<< sim_header: meanP
2024-05-03 05:01:11,369:INFO:   <<< slice_framepos: 2
2024-05-03 05:01:11,369:INFO:   <<< task_type: retrieval
2024-05-03 05:01:11,369:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 05:01:11,369:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 05:01:11,369:INFO:   <<< train_frame_order: 0
2024-05-03 05:01:11,370:INFO:   <<< use_mil: False
2024-05-03 05:01:11,370:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 05:01:11,370:INFO:   <<< video_dim: 1024
2024-05-03 05:01:11,370:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 05:01:11,370:INFO:   <<< warmup_proportion: 0.1
2024-05-03 05:01:11,370:INFO:   <<< world_size: 1
2024-05-03 05:01:11,370:INFO: device: cuda:0 n_gpu: 1
2024-05-03 05:01:11,610:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 05:01:12,161:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 05:01:12,161:WARNING: Test retrieval by loose type.
2024-05-03 05:01:12,162:WARNING: 	 embed_dim: 512
2024-05-03 05:01:12,162:WARNING: 	 image_resolution: 224
2024-05-03 05:01:12,162:WARNING: 	 vision_layers: 12
2024-05-03 05:01:12,162:WARNING: 	 vision_width: 768
2024-05-03 05:01:12,162:WARNING: 	 vision_patch_size: 32
2024-05-03 05:01:12,162:WARNING: 	 context_length: 77
2024-05-03 05:01:12,162:WARNING: 	 vocab_size: 49408
2024-05-03 05:01:12,162:WARNING: 	 transformer_width: 512
2024-05-03 05:01:12,162:WARNING: 	 transformer_heads: 8
2024-05-03 05:01:12,163:WARNING: 	 transformer_layers: 12
2024-05-03 05:01:12,163:WARNING: 		 linear_patch: 2d
2024-05-03 05:01:12,163:WARNING: 	 cut_top_layer: 0
2024-05-03 05:01:13,195:WARNING: 	 sim_header: meanP
2024-05-03 05:01:30,863:INFO: Effective parameters:
2024-05-03 05:01:30,863:INFO:   <<< batch_size: 1
2024-05-03 05:01:30,864:INFO:   <<< batch_size_val: 16
2024-05-03 05:01:30,864:INFO:   <<< cache_dir: 
2024-05-03 05:01:30,864:INFO:   <<< coef_lr: 0.001
2024-05-03 05:01:30,864:INFO:   <<< cross_model: cross-base
2024-05-03 05:01:30,864:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 05:01:30,864:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 05:01:30,864:INFO:   <<< datatype: msrvtt
2024-05-03 05:01:30,864:INFO:   <<< do_eval: True
2024-05-03 05:01:30,864:INFO:   <<< do_lower_case: False
2024-05-03 05:01:30,864:INFO:   <<< do_pretrain: False
2024-05-03 05:01:30,864:INFO:   <<< do_train: False
2024-05-03 05:01:30,864:INFO:   <<< epochs: 2
2024-05-03 05:01:30,864:INFO:   <<< eval_frame_order: 0
2024-05-03 05:01:30,864:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 05:01:30,864:INFO:   <<< feature_framerate: 1
2024-05-03 05:01:30,864:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 05:01:30,864:INFO:   <<< fp16: False
2024-05-03 05:01:30,865:INFO:   <<< fp16_opt_level: O1
2024-05-03 05:01:30,865:INFO:   <<< freeze_layer_num: 0
2024-05-03 05:01:30,865:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 05:01:30,865:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 05:01:30,865:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 05:01:30,865:INFO:   <<< linear_patch: 2d
2024-05-03 05:01:30,865:INFO:   <<< local_rank: 0
2024-05-03 05:01:30,865:INFO:   <<< loose_type: True
2024-05-03 05:01:30,865:INFO:   <<< lr: 0.0001
2024-05-03 05:01:30,865:INFO:   <<< lr_decay: 0.9
2024-05-03 05:01:30,865:INFO:   <<< margin: 0.1
2024-05-03 05:01:30,865:INFO:   <<< max_frames: 90
2024-05-03 05:01:30,865:INFO:   <<< max_words: 32
2024-05-03 05:01:30,865:INFO:   <<< n_display: 100
2024-05-03 05:01:30,865:INFO:   <<< n_gpu: 1
2024-05-03 05:01:30,865:INFO:   <<< n_pair: 1
2024-05-03 05:01:30,865:INFO:   <<< negative_weighting: 1
2024-05-03 05:01:30,866:INFO:   <<< num_thread_reader: 0
2024-05-03 05:01:30,866:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 05:01:30,866:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 05:01:30,866:INFO:   <<< rank: 0
2024-05-03 05:01:30,866:INFO:   <<< resume_model: None
2024-05-03 05:01:30,866:INFO:   <<< sampled_use_mil: False
2024-05-03 05:01:30,866:INFO:   <<< seed: 42
2024-05-03 05:01:30,866:INFO:   <<< sim_header: meanP
2024-05-03 05:01:30,866:INFO:   <<< slice_framepos: 2
2024-05-03 05:01:30,866:INFO:   <<< task_type: retrieval
2024-05-03 05:01:30,866:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 05:01:30,866:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 05:01:30,866:INFO:   <<< train_frame_order: 0
2024-05-03 05:01:30,866:INFO:   <<< use_mil: False
2024-05-03 05:01:30,866:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 05:01:30,866:INFO:   <<< video_dim: 1024
2024-05-03 05:01:30,866:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 05:01:30,866:INFO:   <<< warmup_proportion: 0.1
2024-05-03 05:01:30,867:INFO:   <<< world_size: 1
2024-05-03 05:01:30,867:INFO: device: cuda:0 n_gpu: 1
2024-05-03 05:01:31,022:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 05:01:31,521:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 05:01:31,521:WARNING: Test retrieval by loose type.
2024-05-03 05:01:31,522:WARNING: 	 embed_dim: 512
2024-05-03 05:01:31,522:WARNING: 	 image_resolution: 224
2024-05-03 05:01:31,522:WARNING: 	 vision_layers: 12
2024-05-03 05:01:31,522:WARNING: 	 vision_width: 768
2024-05-03 05:01:31,522:WARNING: 	 vision_patch_size: 32
2024-05-03 05:01:31,522:WARNING: 	 context_length: 77
2024-05-03 05:01:31,522:WARNING: 	 vocab_size: 49408
2024-05-03 05:01:31,522:WARNING: 	 transformer_width: 512
2024-05-03 05:01:31,522:WARNING: 	 transformer_heads: 8
2024-05-03 05:01:31,522:WARNING: 	 transformer_layers: 12
2024-05-03 05:01:31,522:WARNING: 		 linear_patch: 2d
2024-05-03 05:01:31,522:WARNING: 	 cut_top_layer: 0
2024-05-03 05:01:32,501:WARNING: 	 sim_header: meanP
2024-05-03 05:08:52,799:INFO: Effective parameters:
2024-05-03 05:08:52,799:INFO:   <<< batch_size: 1
2024-05-03 05:08:52,799:INFO:   <<< batch_size_val: 16
2024-05-03 05:08:52,799:INFO:   <<< cache_dir: 
2024-05-03 05:08:52,799:INFO:   <<< coef_lr: 0.001
2024-05-03 05:08:52,799:INFO:   <<< cross_model: cross-base
2024-05-03 05:08:52,799:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 05:08:52,800:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 05:08:52,800:INFO:   <<< datatype: msrvtt
2024-05-03 05:08:52,800:INFO:   <<< do_eval: True
2024-05-03 05:08:52,800:INFO:   <<< do_lower_case: False
2024-05-03 05:08:52,800:INFO:   <<< do_pretrain: False
2024-05-03 05:08:52,800:INFO:   <<< do_train: False
2024-05-03 05:08:52,800:INFO:   <<< epochs: 2
2024-05-03 05:08:52,800:INFO:   <<< eval_frame_order: 0
2024-05-03 05:08:52,800:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 05:08:52,800:INFO:   <<< feature_framerate: 1
2024-05-03 05:08:52,800:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 05:08:52,800:INFO:   <<< fp16: False
2024-05-03 05:08:52,800:INFO:   <<< fp16_opt_level: O1
2024-05-03 05:08:52,800:INFO:   <<< freeze_layer_num: 0
2024-05-03 05:08:52,800:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 05:08:52,800:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 05:08:52,800:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 05:08:52,801:INFO:   <<< linear_patch: 2d
2024-05-03 05:08:52,801:INFO:   <<< local_rank: 0
2024-05-03 05:08:52,801:INFO:   <<< loose_type: True
2024-05-03 05:08:52,801:INFO:   <<< lr: 0.0001
2024-05-03 05:08:52,801:INFO:   <<< lr_decay: 0.9
2024-05-03 05:08:52,801:INFO:   <<< margin: 0.1
2024-05-03 05:08:52,801:INFO:   <<< max_frames: 90
2024-05-03 05:08:52,801:INFO:   <<< max_words: 32
2024-05-03 05:08:52,801:INFO:   <<< n_display: 100
2024-05-03 05:08:52,801:INFO:   <<< n_gpu: 1
2024-05-03 05:08:52,801:INFO:   <<< n_pair: 1
2024-05-03 05:08:52,801:INFO:   <<< negative_weighting: 1
2024-05-03 05:08:52,801:INFO:   <<< num_thread_reader: 0
2024-05-03 05:08:52,801:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 05:08:52,801:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 05:08:52,801:INFO:   <<< rank: 0
2024-05-03 05:08:52,801:INFO:   <<< resume_model: None
2024-05-03 05:08:52,802:INFO:   <<< sampled_use_mil: False
2024-05-03 05:08:52,802:INFO:   <<< seed: 42
2024-05-03 05:08:52,802:INFO:   <<< sim_header: meanP
2024-05-03 05:08:52,802:INFO:   <<< slice_framepos: 2
2024-05-03 05:08:52,802:INFO:   <<< task_type: retrieval
2024-05-03 05:08:52,802:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 05:08:52,802:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 05:08:52,802:INFO:   <<< train_frame_order: 0
2024-05-03 05:08:52,802:INFO:   <<< use_mil: False
2024-05-03 05:08:52,802:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 05:08:52,802:INFO:   <<< video_dim: 1024
2024-05-03 05:08:52,802:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 05:08:52,802:INFO:   <<< warmup_proportion: 0.1
2024-05-03 05:08:52,802:INFO:   <<< world_size: 1
2024-05-03 05:08:52,802:INFO: device: cuda:0 n_gpu: 1
2024-05-03 05:08:52,946:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 05:08:53,434:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 05:08:53,434:WARNING: Test retrieval by loose type.
2024-05-03 05:08:53,435:WARNING: 	 embed_dim: 512
2024-05-03 05:08:53,435:WARNING: 	 image_resolution: 224
2024-05-03 05:08:53,435:WARNING: 	 vision_layers: 12
2024-05-03 05:08:53,435:WARNING: 	 vision_width: 768
2024-05-03 05:08:53,435:WARNING: 	 vision_patch_size: 32
2024-05-03 05:08:53,435:WARNING: 	 context_length: 77
2024-05-03 05:08:53,435:WARNING: 	 vocab_size: 49408
2024-05-03 05:08:53,435:WARNING: 	 transformer_width: 512
2024-05-03 05:08:53,435:WARNING: 	 transformer_heads: 8
2024-05-03 05:08:53,435:WARNING: 	 transformer_layers: 12
2024-05-03 05:08:53,435:WARNING: 		 linear_patch: 2d
2024-05-03 05:08:53,436:WARNING: 	 cut_top_layer: 0
2024-05-03 05:08:54,427:WARNING: 	 sim_header: meanP
2024-05-03 05:09:11,816:INFO: Effective parameters:
2024-05-03 05:09:11,816:INFO:   <<< batch_size: 1
2024-05-03 05:09:11,816:INFO:   <<< batch_size_val: 16
2024-05-03 05:09:11,816:INFO:   <<< cache_dir: 
2024-05-03 05:09:11,816:INFO:   <<< coef_lr: 0.001
2024-05-03 05:09:11,817:INFO:   <<< cross_model: cross-base
2024-05-03 05:09:11,817:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 05:09:11,817:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 05:09:11,817:INFO:   <<< datatype: msrvtt
2024-05-03 05:09:11,817:INFO:   <<< do_eval: True
2024-05-03 05:09:11,817:INFO:   <<< do_lower_case: False
2024-05-03 05:09:11,817:INFO:   <<< do_pretrain: False
2024-05-03 05:09:11,817:INFO:   <<< do_train: False
2024-05-03 05:09:11,817:INFO:   <<< epochs: 2
2024-05-03 05:09:11,817:INFO:   <<< eval_frame_order: 0
2024-05-03 05:09:11,817:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 05:09:11,817:INFO:   <<< feature_framerate: 1
2024-05-03 05:09:11,817:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 05:09:11,817:INFO:   <<< fp16: False
2024-05-03 05:09:11,817:INFO:   <<< fp16_opt_level: O1
2024-05-03 05:09:11,817:INFO:   <<< freeze_layer_num: 0
2024-05-03 05:09:11,817:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 05:09:11,818:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 05:09:11,818:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 05:09:11,818:INFO:   <<< linear_patch: 2d
2024-05-03 05:09:11,818:INFO:   <<< local_rank: 0
2024-05-03 05:09:11,818:INFO:   <<< loose_type: True
2024-05-03 05:09:11,818:INFO:   <<< lr: 0.0001
2024-05-03 05:09:11,818:INFO:   <<< lr_decay: 0.9
2024-05-03 05:09:11,818:INFO:   <<< margin: 0.1
2024-05-03 05:09:11,818:INFO:   <<< max_frames: 90
2024-05-03 05:09:11,818:INFO:   <<< max_words: 32
2024-05-03 05:09:11,818:INFO:   <<< n_display: 100
2024-05-03 05:09:11,818:INFO:   <<< n_gpu: 1
2024-05-03 05:09:11,818:INFO:   <<< n_pair: 1
2024-05-03 05:09:11,818:INFO:   <<< negative_weighting: 1
2024-05-03 05:09:11,818:INFO:   <<< num_thread_reader: 0
2024-05-03 05:09:11,818:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 05:09:11,818:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 05:09:11,819:INFO:   <<< rank: 0
2024-05-03 05:09:11,819:INFO:   <<< resume_model: None
2024-05-03 05:09:11,819:INFO:   <<< sampled_use_mil: False
2024-05-03 05:09:11,819:INFO:   <<< seed: 42
2024-05-03 05:09:11,819:INFO:   <<< sim_header: meanP
2024-05-03 05:09:11,819:INFO:   <<< slice_framepos: 2
2024-05-03 05:09:11,819:INFO:   <<< task_type: retrieval
2024-05-03 05:09:11,819:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 05:09:11,819:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 05:09:11,819:INFO:   <<< train_frame_order: 0
2024-05-03 05:09:11,819:INFO:   <<< use_mil: False
2024-05-03 05:09:11,819:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 05:09:11,819:INFO:   <<< video_dim: 1024
2024-05-03 05:09:11,819:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 05:09:11,819:INFO:   <<< warmup_proportion: 0.1
2024-05-03 05:09:11,819:INFO:   <<< world_size: 1
2024-05-03 05:09:11,820:INFO: device: cuda:0 n_gpu: 1
2024-05-03 05:09:11,960:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 05:09:12,449:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 05:09:12,449:WARNING: Test retrieval by loose type.
2024-05-03 05:09:12,450:WARNING: 	 embed_dim: 512
2024-05-03 05:09:12,450:WARNING: 	 image_resolution: 224
2024-05-03 05:09:12,450:WARNING: 	 vision_layers: 12
2024-05-03 05:09:12,450:WARNING: 	 vision_width: 768
2024-05-03 05:09:12,450:WARNING: 	 vision_patch_size: 32
2024-05-03 05:09:12,450:WARNING: 	 context_length: 77
2024-05-03 05:09:12,450:WARNING: 	 vocab_size: 49408
2024-05-03 05:09:12,450:WARNING: 	 transformer_width: 512
2024-05-03 05:09:12,450:WARNING: 	 transformer_heads: 8
2024-05-03 05:09:12,450:WARNING: 	 transformer_layers: 12
2024-05-03 05:09:12,450:WARNING: 		 linear_patch: 2d
2024-05-03 05:09:12,450:WARNING: 	 cut_top_layer: 0
2024-05-03 05:09:13,451:WARNING: 	 sim_header: meanP
2024-05-03 05:10:01,668:INFO: Effective parameters:
2024-05-03 05:10:01,669:INFO:   <<< batch_size: 1
2024-05-03 05:10:01,669:INFO:   <<< batch_size_val: 16
2024-05-03 05:10:01,669:INFO:   <<< cache_dir: 
2024-05-03 05:10:01,669:INFO:   <<< coef_lr: 0.001
2024-05-03 05:10:01,669:INFO:   <<< cross_model: cross-base
2024-05-03 05:10:01,669:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 05:10:01,669:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 05:10:01,669:INFO:   <<< datatype: msrvtt
2024-05-03 05:10:01,669:INFO:   <<< do_eval: True
2024-05-03 05:10:01,669:INFO:   <<< do_lower_case: False
2024-05-03 05:10:01,669:INFO:   <<< do_pretrain: False
2024-05-03 05:10:01,669:INFO:   <<< do_train: False
2024-05-03 05:10:01,669:INFO:   <<< epochs: 2
2024-05-03 05:10:01,669:INFO:   <<< eval_frame_order: 0
2024-05-03 05:10:01,669:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 05:10:01,669:INFO:   <<< feature_framerate: 1
2024-05-03 05:10:01,670:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 05:10:01,670:INFO:   <<< fp16: False
2024-05-03 05:10:01,670:INFO:   <<< fp16_opt_level: O1
2024-05-03 05:10:01,670:INFO:   <<< freeze_layer_num: 0
2024-05-03 05:10:01,670:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 05:10:01,670:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 05:10:01,670:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 05:10:01,670:INFO:   <<< linear_patch: 2d
2024-05-03 05:10:01,670:INFO:   <<< local_rank: 0
2024-05-03 05:10:01,670:INFO:   <<< loose_type: True
2024-05-03 05:10:01,670:INFO:   <<< lr: 0.0001
2024-05-03 05:10:01,670:INFO:   <<< lr_decay: 0.9
2024-05-03 05:10:01,670:INFO:   <<< margin: 0.1
2024-05-03 05:10:01,670:INFO:   <<< max_frames: 90
2024-05-03 05:10:01,670:INFO:   <<< max_words: 32
2024-05-03 05:10:01,670:INFO:   <<< n_display: 100
2024-05-03 05:10:01,670:INFO:   <<< n_gpu: 1
2024-05-03 05:10:01,671:INFO:   <<< n_pair: 1
2024-05-03 05:10:01,671:INFO:   <<< negative_weighting: 1
2024-05-03 05:10:01,671:INFO:   <<< num_thread_reader: 0
2024-05-03 05:10:01,671:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 05:10:01,671:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 05:10:01,671:INFO:   <<< rank: 0
2024-05-03 05:10:01,671:INFO:   <<< resume_model: None
2024-05-03 05:10:01,671:INFO:   <<< sampled_use_mil: False
2024-05-03 05:10:01,671:INFO:   <<< seed: 42
2024-05-03 05:10:01,671:INFO:   <<< sim_header: meanP
2024-05-03 05:10:01,671:INFO:   <<< slice_framepos: 2
2024-05-03 05:10:01,671:INFO:   <<< task_type: retrieval
2024-05-03 05:10:01,671:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 05:10:01,671:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 05:10:01,671:INFO:   <<< train_frame_order: 0
2024-05-03 05:10:01,671:INFO:   <<< use_mil: False
2024-05-03 05:10:01,671:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 05:10:01,672:INFO:   <<< video_dim: 1024
2024-05-03 05:10:01,672:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 05:10:01,672:INFO:   <<< warmup_proportion: 0.1
2024-05-03 05:10:01,672:INFO:   <<< world_size: 1
2024-05-03 05:10:01,672:INFO: device: cuda:0 n_gpu: 1
2024-05-03 05:10:01,813:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 05:10:02,302:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 05:10:02,302:WARNING: Test retrieval by loose type.
2024-05-03 05:10:02,303:WARNING: 	 embed_dim: 512
2024-05-03 05:10:02,303:WARNING: 	 image_resolution: 224
2024-05-03 05:10:02,303:WARNING: 	 vision_layers: 12
2024-05-03 05:10:02,303:WARNING: 	 vision_width: 768
2024-05-03 05:10:02,303:WARNING: 	 vision_patch_size: 32
2024-05-03 05:10:02,303:WARNING: 	 context_length: 77
2024-05-03 05:10:02,303:WARNING: 	 vocab_size: 49408
2024-05-03 05:10:02,303:WARNING: 	 transformer_width: 512
2024-05-03 05:10:02,303:WARNING: 	 transformer_heads: 8
2024-05-03 05:10:02,304:WARNING: 	 transformer_layers: 12
2024-05-03 05:10:02,304:WARNING: 		 linear_patch: 2d
2024-05-03 05:10:02,304:WARNING: 	 cut_top_layer: 0
2024-05-03 05:10:03,307:WARNING: 	 sim_header: meanP
2024-05-03 05:29:37,861:INFO: Effective parameters:
2024-05-03 05:29:37,861:INFO:   <<< batch_size: 1
2024-05-03 05:29:37,861:INFO:   <<< batch_size_val: 16
2024-05-03 05:29:37,861:INFO:   <<< cache_dir: 
2024-05-03 05:29:37,861:INFO:   <<< coef_lr: 0.001
2024-05-03 05:29:37,861:INFO:   <<< cross_model: cross-base
2024-05-03 05:29:37,861:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 05:29:37,861:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 05:29:37,861:INFO:   <<< datatype: msrvtt
2024-05-03 05:29:37,861:INFO:   <<< do_eval: True
2024-05-03 05:29:37,861:INFO:   <<< do_lower_case: False
2024-05-03 05:29:37,862:INFO:   <<< do_pretrain: False
2024-05-03 05:29:37,862:INFO:   <<< do_train: False
2024-05-03 05:29:37,862:INFO:   <<< epochs: 2
2024-05-03 05:29:37,862:INFO:   <<< eval_frame_order: 0
2024-05-03 05:29:37,862:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 05:29:37,862:INFO:   <<< feature_framerate: 1
2024-05-03 05:29:37,862:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 05:29:37,862:INFO:   <<< fp16: False
2024-05-03 05:29:37,862:INFO:   <<< fp16_opt_level: O1
2024-05-03 05:29:37,862:INFO:   <<< freeze_layer_num: 0
2024-05-03 05:29:37,862:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 05:29:37,862:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 05:29:37,862:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 05:29:37,862:INFO:   <<< linear_patch: 2d
2024-05-03 05:29:37,862:INFO:   <<< local_rank: 0
2024-05-03 05:29:37,862:INFO:   <<< loose_type: True
2024-05-03 05:29:37,862:INFO:   <<< lr: 0.0001
2024-05-03 05:29:37,863:INFO:   <<< lr_decay: 0.9
2024-05-03 05:29:37,863:INFO:   <<< margin: 0.1
2024-05-03 05:29:37,863:INFO:   <<< max_frames: 90
2024-05-03 05:29:37,863:INFO:   <<< max_words: 32
2024-05-03 05:29:37,863:INFO:   <<< n_display: 100
2024-05-03 05:29:37,863:INFO:   <<< n_gpu: 1
2024-05-03 05:29:37,863:INFO:   <<< n_pair: 1
2024-05-03 05:29:37,863:INFO:   <<< negative_weighting: 1
2024-05-03 05:29:37,863:INFO:   <<< num_thread_reader: 0
2024-05-03 05:29:37,863:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 05:29:37,863:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 05:29:37,863:INFO:   <<< rank: 0
2024-05-03 05:29:37,863:INFO:   <<< resume_model: None
2024-05-03 05:29:37,863:INFO:   <<< sampled_use_mil: False
2024-05-03 05:29:37,863:INFO:   <<< seed: 42
2024-05-03 05:29:37,863:INFO:   <<< sim_header: meanP
2024-05-03 05:29:37,863:INFO:   <<< slice_framepos: 2
2024-05-03 05:29:37,864:INFO:   <<< task_type: retrieval
2024-05-03 05:29:37,864:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 05:29:37,864:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 05:29:37,864:INFO:   <<< train_frame_order: 0
2024-05-03 05:29:37,864:INFO:   <<< use_mil: False
2024-05-03 05:29:37,864:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 05:29:37,864:INFO:   <<< video_dim: 1024
2024-05-03 05:29:37,864:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 05:29:37,864:INFO:   <<< warmup_proportion: 0.1
2024-05-03 05:29:37,864:INFO:   <<< world_size: 1
2024-05-03 05:29:37,864:INFO: device: cuda:0 n_gpu: 1
2024-05-03 05:29:38,002:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 05:29:38,487:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 05:29:38,487:WARNING: Test retrieval by loose type.
2024-05-03 05:29:38,488:WARNING: 	 embed_dim: 512
2024-05-03 05:29:38,488:WARNING: 	 image_resolution: 224
2024-05-03 05:29:38,488:WARNING: 	 vision_layers: 12
2024-05-03 05:29:38,488:WARNING: 	 vision_width: 768
2024-05-03 05:29:38,488:WARNING: 	 vision_patch_size: 32
2024-05-03 05:29:38,488:WARNING: 	 context_length: 77
2024-05-03 05:29:38,488:WARNING: 	 vocab_size: 49408
2024-05-03 05:29:38,488:WARNING: 	 transformer_width: 512
2024-05-03 05:29:38,488:WARNING: 	 transformer_heads: 8
2024-05-03 05:29:38,488:WARNING: 	 transformer_layers: 12
2024-05-03 05:29:38,488:WARNING: 		 linear_patch: 2d
2024-05-03 05:29:38,488:WARNING: 	 cut_top_layer: 0
2024-05-03 05:29:39,479:WARNING: 	 sim_header: meanP
2024-05-03 05:32:44,907:INFO: Effective parameters:
2024-05-03 05:32:44,907:INFO:   <<< batch_size: 1
2024-05-03 05:32:44,907:INFO:   <<< batch_size_val: 16
2024-05-03 05:32:44,907:INFO:   <<< cache_dir: 
2024-05-03 05:32:44,907:INFO:   <<< coef_lr: 0.001
2024-05-03 05:32:44,907:INFO:   <<< cross_model: cross-base
2024-05-03 05:32:44,907:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 05:32:44,907:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 05:32:44,907:INFO:   <<< datatype: msrvtt
2024-05-03 05:32:44,907:INFO:   <<< do_eval: True
2024-05-03 05:32:44,907:INFO:   <<< do_lower_case: False
2024-05-03 05:32:44,907:INFO:   <<< do_pretrain: False
2024-05-03 05:32:44,908:INFO:   <<< do_train: False
2024-05-03 05:32:44,908:INFO:   <<< epochs: 2
2024-05-03 05:32:44,908:INFO:   <<< eval_frame_order: 0
2024-05-03 05:32:44,908:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 05:32:44,908:INFO:   <<< feature_framerate: 1
2024-05-03 05:32:44,908:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 05:32:44,908:INFO:   <<< fp16: False
2024-05-03 05:32:44,908:INFO:   <<< fp16_opt_level: O1
2024-05-03 05:32:44,908:INFO:   <<< freeze_layer_num: 0
2024-05-03 05:32:44,908:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 05:32:44,908:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 05:32:44,908:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 05:32:44,908:INFO:   <<< linear_patch: 2d
2024-05-03 05:32:44,908:INFO:   <<< local_rank: 0
2024-05-03 05:32:44,908:INFO:   <<< loose_type: True
2024-05-03 05:32:44,908:INFO:   <<< lr: 0.0001
2024-05-03 05:32:44,908:INFO:   <<< lr_decay: 0.9
2024-05-03 05:32:44,909:INFO:   <<< margin: 0.1
2024-05-03 05:32:44,909:INFO:   <<< max_frames: 90
2024-05-03 05:32:44,909:INFO:   <<< max_words: 32
2024-05-03 05:32:44,909:INFO:   <<< n_display: 100
2024-05-03 05:32:44,909:INFO:   <<< n_gpu: 1
2024-05-03 05:32:44,909:INFO:   <<< n_pair: 1
2024-05-03 05:32:44,909:INFO:   <<< negative_weighting: 1
2024-05-03 05:32:44,909:INFO:   <<< num_thread_reader: 0
2024-05-03 05:32:44,909:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 05:32:44,909:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 05:32:44,909:INFO:   <<< rank: 0
2024-05-03 05:32:44,909:INFO:   <<< resume_model: None
2024-05-03 05:32:44,909:INFO:   <<< sampled_use_mil: False
2024-05-03 05:32:44,909:INFO:   <<< seed: 42
2024-05-03 05:32:44,909:INFO:   <<< sim_header: meanP
2024-05-03 05:32:44,909:INFO:   <<< slice_framepos: 2
2024-05-03 05:32:44,909:INFO:   <<< task_type: retrieval
2024-05-03 05:32:44,910:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 05:32:44,910:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 05:32:44,910:INFO:   <<< train_frame_order: 0
2024-05-03 05:32:44,910:INFO:   <<< use_mil: False
2024-05-03 05:32:44,910:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 05:32:44,910:INFO:   <<< video_dim: 1024
2024-05-03 05:32:44,910:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 05:32:44,910:INFO:   <<< warmup_proportion: 0.1
2024-05-03 05:32:44,910:INFO:   <<< world_size: 1
2024-05-03 05:32:44,910:INFO: device: cuda:0 n_gpu: 1
2024-05-03 05:32:45,049:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 05:32:45,528:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 05:32:45,528:WARNING: Test retrieval by loose type.
2024-05-03 05:32:45,529:WARNING: 	 embed_dim: 512
2024-05-03 05:32:45,529:WARNING: 	 image_resolution: 224
2024-05-03 05:32:45,529:WARNING: 	 vision_layers: 12
2024-05-03 05:32:45,529:WARNING: 	 vision_width: 768
2024-05-03 05:32:45,529:WARNING: 	 vision_patch_size: 32
2024-05-03 05:32:45,529:WARNING: 	 context_length: 77
2024-05-03 05:32:45,530:WARNING: 	 vocab_size: 49408
2024-05-03 05:32:45,530:WARNING: 	 transformer_width: 512
2024-05-03 05:32:45,530:WARNING: 	 transformer_heads: 8
2024-05-03 05:32:45,530:WARNING: 	 transformer_layers: 12
2024-05-03 05:32:45,530:WARNING: 		 linear_patch: 2d
2024-05-03 05:32:45,530:WARNING: 	 cut_top_layer: 0
2024-05-03 05:32:46,510:WARNING: 	 sim_header: meanP
2024-05-03 05:38:02,981:INFO: Effective parameters:
2024-05-03 05:38:02,982:INFO:   <<< batch_size: 1
2024-05-03 05:38:02,982:INFO:   <<< batch_size_val: 16
2024-05-03 05:38:02,982:INFO:   <<< cache_dir: 
2024-05-03 05:38:02,982:INFO:   <<< coef_lr: 0.001
2024-05-03 05:38:02,982:INFO:   <<< cross_model: cross-base
2024-05-03 05:38:02,982:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 05:38:02,982:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 05:38:02,982:INFO:   <<< datatype: msrvtt
2024-05-03 05:38:02,982:INFO:   <<< do_eval: True
2024-05-03 05:38:02,982:INFO:   <<< do_lower_case: False
2024-05-03 05:38:02,982:INFO:   <<< do_pretrain: False
2024-05-03 05:38:02,982:INFO:   <<< do_train: False
2024-05-03 05:38:02,982:INFO:   <<< epochs: 2
2024-05-03 05:38:02,983:INFO:   <<< eval_frame_order: 0
2024-05-03 05:38:02,983:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 05:38:02,983:INFO:   <<< feature_framerate: 1
2024-05-03 05:38:02,983:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 05:38:02,983:INFO:   <<< fp16: False
2024-05-03 05:38:02,983:INFO:   <<< fp16_opt_level: O1
2024-05-03 05:38:02,983:INFO:   <<< freeze_layer_num: 0
2024-05-03 05:38:02,983:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 05:38:02,983:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 05:38:02,983:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 05:38:02,983:INFO:   <<< linear_patch: 2d
2024-05-03 05:38:02,983:INFO:   <<< local_rank: 0
2024-05-03 05:38:02,983:INFO:   <<< loose_type: True
2024-05-03 05:38:02,983:INFO:   <<< lr: 0.0001
2024-05-03 05:38:02,983:INFO:   <<< lr_decay: 0.9
2024-05-03 05:38:02,983:INFO:   <<< margin: 0.1
2024-05-03 05:38:02,983:INFO:   <<< max_frames: 90
2024-05-03 05:38:02,984:INFO:   <<< max_words: 32
2024-05-03 05:38:02,984:INFO:   <<< n_display: 100
2024-05-03 05:38:02,984:INFO:   <<< n_gpu: 1
2024-05-03 05:38:02,984:INFO:   <<< n_pair: 1
2024-05-03 05:38:02,984:INFO:   <<< negative_weighting: 1
2024-05-03 05:38:02,984:INFO:   <<< num_thread_reader: 0
2024-05-03 05:38:02,984:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 05:38:02,984:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 05:38:02,984:INFO:   <<< rank: 0
2024-05-03 05:38:02,984:INFO:   <<< resume_model: None
2024-05-03 05:38:02,984:INFO:   <<< sampled_use_mil: False
2024-05-03 05:38:02,984:INFO:   <<< seed: 42
2024-05-03 05:38:02,984:INFO:   <<< sim_header: meanP
2024-05-03 05:38:02,984:INFO:   <<< slice_framepos: 2
2024-05-03 05:38:02,984:INFO:   <<< task_type: retrieval
2024-05-03 05:38:02,984:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 05:38:02,984:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 05:38:02,985:INFO:   <<< train_frame_order: 0
2024-05-03 05:38:02,985:INFO:   <<< use_mil: False
2024-05-03 05:38:02,985:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 05:38:02,985:INFO:   <<< video_dim: 1024
2024-05-03 05:38:02,985:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 05:38:02,985:INFO:   <<< warmup_proportion: 0.1
2024-05-03 05:38:02,985:INFO:   <<< world_size: 1
2024-05-03 05:38:02,985:INFO: device: cuda:0 n_gpu: 1
2024-05-03 05:38:03,127:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 05:38:03,639:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 05:38:03,639:WARNING: Test retrieval by loose type.
2024-05-03 05:38:03,640:WARNING: 	 embed_dim: 512
2024-05-03 05:38:03,640:WARNING: 	 image_resolution: 224
2024-05-03 05:38:03,640:WARNING: 	 vision_layers: 12
2024-05-03 05:38:03,640:WARNING: 	 vision_width: 768
2024-05-03 05:38:03,640:WARNING: 	 vision_patch_size: 32
2024-05-03 05:38:03,640:WARNING: 	 context_length: 77
2024-05-03 05:38:03,640:WARNING: 	 vocab_size: 49408
2024-05-03 05:38:03,640:WARNING: 	 transformer_width: 512
2024-05-03 05:38:03,640:WARNING: 	 transformer_heads: 8
2024-05-03 05:38:03,640:WARNING: 	 transformer_layers: 12
2024-05-03 05:38:03,640:WARNING: 		 linear_patch: 2d
2024-05-03 05:38:03,640:WARNING: 	 cut_top_layer: 0
2024-05-03 05:38:04,641:WARNING: 	 sim_header: meanP
2024-05-03 06:06:23,890:INFO: Effective parameters:
2024-05-03 06:06:23,890:INFO:   <<< batch_size: 16
2024-05-03 06:06:23,890:INFO:   <<< batch_size_val: 16
2024-05-03 06:06:23,890:INFO:   <<< cache_dir: 
2024-05-03 06:06:23,890:INFO:   <<< coef_lr: 0.001
2024-05-03 06:06:23,890:INFO:   <<< cross_model: cross-base
2024-05-03 06:06:23,891:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 06:06:23,891:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 06:06:23,891:INFO:   <<< datatype: msrvtt
2024-05-03 06:06:23,891:INFO:   <<< do_eval: True
2024-05-03 06:06:23,891:INFO:   <<< do_lower_case: False
2024-05-03 06:06:23,891:INFO:   <<< do_pretrain: False
2024-05-03 06:06:23,891:INFO:   <<< do_train: False
2024-05-03 06:06:23,891:INFO:   <<< epochs: 2
2024-05-03 06:06:23,891:INFO:   <<< eval_frame_order: 0
2024-05-03 06:06:23,891:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 06:06:23,891:INFO:   <<< feature_framerate: 1
2024-05-03 06:06:23,891:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 06:06:23,891:INFO:   <<< fp16: False
2024-05-03 06:06:23,891:INFO:   <<< fp16_opt_level: O1
2024-05-03 06:06:23,891:INFO:   <<< freeze_layer_num: 0
2024-05-03 06:06:23,891:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 06:06:23,891:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 06:06:23,892:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 06:06:23,892:INFO:   <<< linear_patch: 2d
2024-05-03 06:06:23,892:INFO:   <<< local_rank: 0
2024-05-03 06:06:23,892:INFO:   <<< loose_type: True
2024-05-03 06:06:23,892:INFO:   <<< lr: 0.0001
2024-05-03 06:06:23,892:INFO:   <<< lr_decay: 0.9
2024-05-03 06:06:23,892:INFO:   <<< margin: 0.1
2024-05-03 06:06:23,892:INFO:   <<< max_frames: 12
2024-05-03 06:06:23,892:INFO:   <<< max_words: 32
2024-05-03 06:06:23,892:INFO:   <<< n_display: 100
2024-05-03 06:06:23,892:INFO:   <<< n_gpu: 1
2024-05-03 06:06:23,892:INFO:   <<< n_pair: 1
2024-05-03 06:06:23,892:INFO:   <<< negative_weighting: 1
2024-05-03 06:06:23,892:INFO:   <<< num_thread_reader: 0
2024-05-03 06:06:23,892:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 06:06:23,892:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 06:06:23,893:INFO:   <<< rank: 0
2024-05-03 06:06:23,893:INFO:   <<< resume_model: None
2024-05-03 06:06:23,893:INFO:   <<< sampled_use_mil: False
2024-05-03 06:06:23,893:INFO:   <<< seed: 42
2024-05-03 06:06:23,893:INFO:   <<< sim_header: meanP
2024-05-03 06:06:23,893:INFO:   <<< slice_framepos: 2
2024-05-03 06:06:23,893:INFO:   <<< task_type: retrieval
2024-05-03 06:06:23,893:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 06:06:23,893:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 06:06:23,893:INFO:   <<< train_frame_order: 0
2024-05-03 06:06:23,893:INFO:   <<< use_mil: False
2024-05-03 06:06:23,893:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 06:06:23,893:INFO:   <<< video_dim: 1024
2024-05-03 06:06:23,893:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 06:06:23,893:INFO:   <<< warmup_proportion: 0.1
2024-05-03 06:06:23,893:INFO:   <<< world_size: 1
2024-05-03 06:06:23,894:INFO: device: cuda:0 n_gpu: 1
2024-05-03 06:06:24,122:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 06:06:24,592:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 06:06:24,592:WARNING: Test retrieval by loose type.
2024-05-03 06:06:24,593:WARNING: 	 embed_dim: 512
2024-05-03 06:06:24,593:WARNING: 	 image_resolution: 224
2024-05-03 06:06:24,593:WARNING: 	 vision_layers: 12
2024-05-03 06:06:24,593:WARNING: 	 vision_width: 768
2024-05-03 06:06:24,593:WARNING: 	 vision_patch_size: 32
2024-05-03 06:06:24,593:WARNING: 	 context_length: 77
2024-05-03 06:06:24,593:WARNING: 	 vocab_size: 49408
2024-05-03 06:06:24,593:WARNING: 	 transformer_width: 512
2024-05-03 06:06:24,593:WARNING: 	 transformer_heads: 8
2024-05-03 06:06:24,593:WARNING: 	 transformer_layers: 12
2024-05-03 06:06:24,593:WARNING: 		 linear_patch: 2d
2024-05-03 06:06:24,593:WARNING: 	 cut_top_layer: 0
2024-05-03 06:06:25,580:WARNING: 	 sim_header: meanP
2024-05-03 06:06:31,653:INFO: ***** Running test *****
2024-05-03 06:06:31,653:INFO:   Num examples = 29
2024-05-03 06:06:31,653:INFO:   Batch size = 16
2024-05-03 06:06:31,653:INFO:   Num steps = 2
2024-05-03 06:06:31,653:INFO: ***** Running val *****
2024-05-03 06:06:31,653:INFO:   Num examples = 29
2024-05-03 06:08:01,383:INFO: Effective parameters:
2024-05-03 06:08:01,383:INFO:   <<< batch_size: 16
2024-05-03 06:08:01,383:INFO:   <<< batch_size_val: 16
2024-05-03 06:08:01,383:INFO:   <<< cache_dir: 
2024-05-03 06:08:01,384:INFO:   <<< coef_lr: 0.001
2024-05-03 06:08:01,384:INFO:   <<< cross_model: cross-base
2024-05-03 06:08:01,384:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 06:08:01,384:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 06:08:01,384:INFO:   <<< datatype: msrvtt
2024-05-03 06:08:01,384:INFO:   <<< do_eval: True
2024-05-03 06:08:01,384:INFO:   <<< do_lower_case: False
2024-05-03 06:08:01,384:INFO:   <<< do_pretrain: False
2024-05-03 06:08:01,384:INFO:   <<< do_train: False
2024-05-03 06:08:01,384:INFO:   <<< epochs: 2
2024-05-03 06:08:01,384:INFO:   <<< eval_frame_order: 0
2024-05-03 06:08:01,384:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 06:08:01,384:INFO:   <<< feature_framerate: 1
2024-05-03 06:08:01,384:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 06:08:01,384:INFO:   <<< fp16: False
2024-05-03 06:08:01,384:INFO:   <<< fp16_opt_level: O1
2024-05-03 06:08:01,385:INFO:   <<< freeze_layer_num: 0
2024-05-03 06:08:01,385:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 06:08:01,385:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 06:08:01,385:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 06:08:01,385:INFO:   <<< linear_patch: 2d
2024-05-03 06:08:01,385:INFO:   <<< local_rank: 0
2024-05-03 06:08:01,385:INFO:   <<< loose_type: True
2024-05-03 06:08:01,385:INFO:   <<< lr: 0.0001
2024-05-03 06:08:01,385:INFO:   <<< lr_decay: 0.9
2024-05-03 06:08:01,385:INFO:   <<< margin: 0.1
2024-05-03 06:08:01,385:INFO:   <<< max_frames: 12
2024-05-03 06:08:01,385:INFO:   <<< max_words: 32
2024-05-03 06:08:01,385:INFO:   <<< n_display: 100
2024-05-03 06:08:01,385:INFO:   <<< n_gpu: 1
2024-05-03 06:08:01,385:INFO:   <<< n_pair: 1
2024-05-03 06:08:01,385:INFO:   <<< negative_weighting: 1
2024-05-03 06:08:01,386:INFO:   <<< num_thread_reader: 0
2024-05-03 06:08:01,386:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 06:08:01,386:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 06:08:01,386:INFO:   <<< rank: 0
2024-05-03 06:08:01,386:INFO:   <<< resume_model: None
2024-05-03 06:08:01,386:INFO:   <<< sampled_use_mil: False
2024-05-03 06:08:01,386:INFO:   <<< seed: 42
2024-05-03 06:08:01,386:INFO:   <<< sim_header: meanP
2024-05-03 06:08:01,386:INFO:   <<< slice_framepos: 2
2024-05-03 06:08:01,386:INFO:   <<< task_type: retrieval
2024-05-03 06:08:01,386:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 06:08:01,386:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 06:08:01,386:INFO:   <<< train_frame_order: 0
2024-05-03 06:08:01,386:INFO:   <<< use_mil: False
2024-05-03 06:08:01,386:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 06:08:01,387:INFO:   <<< video_dim: 1024
2024-05-03 06:08:01,387:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 06:08:01,387:INFO:   <<< warmup_proportion: 0.1
2024-05-03 06:08:01,387:INFO:   <<< world_size: 1
2024-05-03 06:08:01,387:INFO: device: cuda:0 n_gpu: 1
2024-05-03 06:08:01,618:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 06:08:02,088:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 06:08:02,088:WARNING: Test retrieval by loose type.
2024-05-03 06:08:02,089:WARNING: 	 embed_dim: 512
2024-05-03 06:08:02,089:WARNING: 	 image_resolution: 224
2024-05-03 06:08:02,089:WARNING: 	 vision_layers: 12
2024-05-03 06:08:02,089:WARNING: 	 vision_width: 768
2024-05-03 06:08:02,089:WARNING: 	 vision_patch_size: 32
2024-05-03 06:08:02,089:WARNING: 	 context_length: 77
2024-05-03 06:08:02,089:WARNING: 	 vocab_size: 49408
2024-05-03 06:08:02,089:WARNING: 	 transformer_width: 512
2024-05-03 06:08:02,089:WARNING: 	 transformer_heads: 8
2024-05-03 06:08:02,089:WARNING: 	 transformer_layers: 12
2024-05-03 06:08:02,089:WARNING: 		 linear_patch: 2d
2024-05-03 06:08:02,089:WARNING: 	 cut_top_layer: 0
2024-05-03 06:08:03,058:WARNING: 	 sim_header: meanP
2024-05-03 06:08:09,150:INFO: ***** Running test *****
2024-05-03 06:08:09,150:INFO:   Num examples = 29
2024-05-03 06:08:09,150:INFO:   Batch size = 16
2024-05-03 06:08:09,150:INFO:   Num steps = 2
2024-05-03 06:08:09,150:INFO: ***** Running val *****
2024-05-03 06:08:09,150:INFO:   Num examples = 29
2024-05-03 06:16:06,627:INFO: Effective parameters:
2024-05-03 06:16:06,627:INFO:   <<< batch_size: 16
2024-05-03 06:16:06,627:INFO:   <<< batch_size_val: 16
2024-05-03 06:16:06,627:INFO:   <<< cache_dir: 
2024-05-03 06:16:06,627:INFO:   <<< coef_lr: 0.001
2024-05-03 06:16:06,627:INFO:   <<< cross_model: cross-base
2024-05-03 06:16:06,627:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 06:16:06,627:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 06:16:06,628:INFO:   <<< datatype: msrvtt
2024-05-03 06:16:06,628:INFO:   <<< do_eval: True
2024-05-03 06:16:06,628:INFO:   <<< do_lower_case: False
2024-05-03 06:16:06,628:INFO:   <<< do_pretrain: False
2024-05-03 06:16:06,628:INFO:   <<< do_train: False
2024-05-03 06:16:06,628:INFO:   <<< epochs: 2
2024-05-03 06:16:06,628:INFO:   <<< eval_frame_order: 0
2024-05-03 06:16:06,628:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 06:16:06,628:INFO:   <<< feature_framerate: 1
2024-05-03 06:16:06,628:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 06:16:06,628:INFO:   <<< fp16: False
2024-05-03 06:16:06,628:INFO:   <<< fp16_opt_level: O1
2024-05-03 06:16:06,628:INFO:   <<< freeze_layer_num: 0
2024-05-03 06:16:06,628:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 06:16:06,628:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 06:16:06,628:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 06:16:06,628:INFO:   <<< linear_patch: 2d
2024-05-03 06:16:06,629:INFO:   <<< local_rank: 0
2024-05-03 06:16:06,629:INFO:   <<< loose_type: True
2024-05-03 06:16:06,629:INFO:   <<< lr: 0.0001
2024-05-03 06:16:06,629:INFO:   <<< lr_decay: 0.9
2024-05-03 06:16:06,629:INFO:   <<< margin: 0.1
2024-05-03 06:16:06,629:INFO:   <<< max_frames: 12
2024-05-03 06:16:06,629:INFO:   <<< max_words: 32
2024-05-03 06:16:06,629:INFO:   <<< n_display: 100
2024-05-03 06:16:06,629:INFO:   <<< n_gpu: 1
2024-05-03 06:16:06,629:INFO:   <<< n_pair: 1
2024-05-03 06:16:06,629:INFO:   <<< negative_weighting: 1
2024-05-03 06:16:06,629:INFO:   <<< num_thread_reader: 0
2024-05-03 06:16:06,629:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 06:16:06,629:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 06:16:06,629:INFO:   <<< rank: 0
2024-05-03 06:16:06,629:INFO:   <<< resume_model: None
2024-05-03 06:16:06,629:INFO:   <<< sampled_use_mil: False
2024-05-03 06:16:06,629:INFO:   <<< seed: 42
2024-05-03 06:16:06,630:INFO:   <<< sim_header: meanP
2024-05-03 06:16:06,630:INFO:   <<< slice_framepos: 2
2024-05-03 06:16:06,630:INFO:   <<< task_type: retrieval
2024-05-03 06:16:06,630:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 06:16:06,630:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 06:16:06,630:INFO:   <<< train_frame_order: 0
2024-05-03 06:16:06,630:INFO:   <<< use_mil: False
2024-05-03 06:16:06,630:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 06:16:06,630:INFO:   <<< video_dim: 1024
2024-05-03 06:16:06,630:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 06:16:06,630:INFO:   <<< warmup_proportion: 0.1
2024-05-03 06:16:06,630:INFO:   <<< world_size: 1
2024-05-03 06:16:06,630:INFO: device: cuda:0 n_gpu: 1
2024-05-03 06:16:06,856:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 06:16:07,321:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 06:16:07,321:WARNING: Test retrieval by loose type.
2024-05-03 06:16:07,322:WARNING: 	 embed_dim: 512
2024-05-03 06:16:07,322:WARNING: 	 image_resolution: 224
2024-05-03 06:16:07,322:WARNING: 	 vision_layers: 12
2024-05-03 06:16:07,322:WARNING: 	 vision_width: 768
2024-05-03 06:16:07,322:WARNING: 	 vision_patch_size: 32
2024-05-03 06:16:07,322:WARNING: 	 context_length: 77
2024-05-03 06:16:07,322:WARNING: 	 vocab_size: 49408
2024-05-03 06:16:07,322:WARNING: 	 transformer_width: 512
2024-05-03 06:16:07,322:WARNING: 	 transformer_heads: 8
2024-05-03 06:16:07,322:WARNING: 	 transformer_layers: 12
2024-05-03 06:16:07,322:WARNING: 		 linear_patch: 2d
2024-05-03 06:16:07,322:WARNING: 	 cut_top_layer: 0
2024-05-03 06:16:08,295:WARNING: 	 sim_header: meanP
2024-05-03 06:16:14,341:INFO: ***** Running test *****
2024-05-03 06:16:14,341:INFO:   Num examples = 29
2024-05-03 06:16:14,341:INFO:   Batch size = 16
2024-05-03 06:16:14,341:INFO:   Num steps = 2
2024-05-03 06:16:14,341:INFO: ***** Running val *****
2024-05-03 06:16:14,341:INFO:   Num examples = 29
2024-05-03 07:06:33,156:INFO: Effective parameters:
2024-05-03 07:06:33,156:INFO:   <<< batch_size: 16
2024-05-03 07:06:33,157:INFO:   <<< batch_size_val: 16
2024-05-03 07:06:33,157:INFO:   <<< cache_dir: 
2024-05-03 07:06:33,157:INFO:   <<< coef_lr: 0.001
2024-05-03 07:06:33,157:INFO:   <<< cross_model: cross-base
2024-05-03 07:06:33,157:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 07:06:33,157:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 07:06:33,157:INFO:   <<< datatype: msrvtt
2024-05-03 07:06:33,157:INFO:   <<< do_eval: True
2024-05-03 07:06:33,157:INFO:   <<< do_lower_case: False
2024-05-03 07:06:33,157:INFO:   <<< do_pretrain: False
2024-05-03 07:06:33,157:INFO:   <<< do_train: False
2024-05-03 07:06:33,157:INFO:   <<< epochs: 2
2024-05-03 07:06:33,157:INFO:   <<< eval_frame_order: 0
2024-05-03 07:06:33,157:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 07:06:33,157:INFO:   <<< feature_framerate: 1
2024-05-03 07:06:33,157:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 07:06:33,158:INFO:   <<< fp16: False
2024-05-03 07:06:33,158:INFO:   <<< fp16_opt_level: O1
2024-05-03 07:06:33,158:INFO:   <<< freeze_layer_num: 0
2024-05-03 07:06:33,158:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 07:06:33,158:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 07:06:33,158:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 07:06:33,158:INFO:   <<< linear_patch: 2d
2024-05-03 07:06:33,158:INFO:   <<< local_rank: 0
2024-05-03 07:06:33,158:INFO:   <<< loose_type: True
2024-05-03 07:06:33,158:INFO:   <<< lr: 0.0001
2024-05-03 07:06:33,158:INFO:   <<< lr_decay: 0.9
2024-05-03 07:06:33,158:INFO:   <<< margin: 0.1
2024-05-03 07:06:33,158:INFO:   <<< max_frames: 12
2024-05-03 07:06:33,158:INFO:   <<< max_words: 32
2024-05-03 07:06:33,158:INFO:   <<< n_display: 100
2024-05-03 07:06:33,158:INFO:   <<< n_gpu: 1
2024-05-03 07:06:33,159:INFO:   <<< n_pair: 1
2024-05-03 07:06:33,159:INFO:   <<< negative_weighting: 1
2024-05-03 07:06:33,159:INFO:   <<< num_thread_reader: 0
2024-05-03 07:06:33,159:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 07:06:33,159:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 07:06:33,159:INFO:   <<< rank: 0
2024-05-03 07:06:33,159:INFO:   <<< resume_model: None
2024-05-03 07:06:33,159:INFO:   <<< sampled_use_mil: False
2024-05-03 07:06:33,159:INFO:   <<< seed: 42
2024-05-03 07:06:33,159:INFO:   <<< sim_header: meanP
2024-05-03 07:06:33,159:INFO:   <<< slice_framepos: 2
2024-05-03 07:06:33,159:INFO:   <<< task_type: retrieval
2024-05-03 07:06:33,159:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 07:06:33,159:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 07:06:33,159:INFO:   <<< train_frame_order: 0
2024-05-03 07:06:33,159:INFO:   <<< use_mil: False
2024-05-03 07:06:33,159:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 07:06:33,160:INFO:   <<< video_dim: 1024
2024-05-03 07:06:33,160:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 07:06:33,160:INFO:   <<< warmup_proportion: 0.1
2024-05-03 07:06:33,160:INFO:   <<< world_size: 1
2024-05-03 07:06:33,160:INFO: device: cuda:0 n_gpu: 1
2024-05-03 07:06:33,385:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 07:06:33,859:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 07:06:33,859:WARNING: Test retrieval by loose type.
2024-05-03 07:06:33,859:WARNING: 	 embed_dim: 512
2024-05-03 07:06:33,860:WARNING: 	 image_resolution: 224
2024-05-03 07:06:33,860:WARNING: 	 vision_layers: 12
2024-05-03 07:06:33,860:WARNING: 	 vision_width: 768
2024-05-03 07:06:33,860:WARNING: 	 vision_patch_size: 32
2024-05-03 07:06:33,860:WARNING: 	 context_length: 77
2024-05-03 07:06:33,860:WARNING: 	 vocab_size: 49408
2024-05-03 07:06:33,860:WARNING: 	 transformer_width: 512
2024-05-03 07:06:33,860:WARNING: 	 transformer_heads: 8
2024-05-03 07:06:33,860:WARNING: 	 transformer_layers: 12
2024-05-03 07:06:33,860:WARNING: 		 linear_patch: 2d
2024-05-03 07:06:33,860:WARNING: 	 cut_top_layer: 0
2024-05-03 07:06:34,830:WARNING: 	 sim_header: meanP
2024-05-03 07:06:40,856:INFO: ***** Running test *****
2024-05-03 07:06:40,857:INFO:   Num examples = 29
2024-05-03 07:06:40,857:INFO:   Batch size = 16
2024-05-03 07:06:40,857:INFO:   Num steps = 2
2024-05-03 07:06:40,857:INFO: ***** Running val *****
2024-05-03 07:06:40,857:INFO:   Num examples = 29
2024-05-03 07:13:35,004:INFO: Effective parameters:
2024-05-03 07:13:35,004:INFO:   <<< batch_size: 1
2024-05-03 07:13:35,004:INFO:   <<< batch_size_val: 16
2024-05-03 07:13:35,004:INFO:   <<< cache_dir: 
2024-05-03 07:13:35,004:INFO:   <<< coef_lr: 0.001
2024-05-03 07:13:35,004:INFO:   <<< cross_model: cross-base
2024-05-03 07:13:35,004:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 07:13:35,004:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 07:13:35,004:INFO:   <<< datatype: msrvtt
2024-05-03 07:13:35,005:INFO:   <<< do_eval: True
2024-05-03 07:13:35,005:INFO:   <<< do_lower_case: False
2024-05-03 07:13:35,005:INFO:   <<< do_pretrain: False
2024-05-03 07:13:35,005:INFO:   <<< do_train: False
2024-05-03 07:13:35,005:INFO:   <<< epochs: 2
2024-05-03 07:13:35,005:INFO:   <<< eval_frame_order: 0
2024-05-03 07:13:35,005:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 07:13:35,005:INFO:   <<< feature_framerate: 1
2024-05-03 07:13:35,005:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 07:13:35,005:INFO:   <<< fp16: False
2024-05-03 07:13:35,005:INFO:   <<< fp16_opt_level: O1
2024-05-03 07:13:35,005:INFO:   <<< freeze_layer_num: 0
2024-05-03 07:13:35,005:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 07:13:35,005:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 07:13:35,005:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 07:13:35,005:INFO:   <<< linear_patch: 2d
2024-05-03 07:13:35,005:INFO:   <<< local_rank: 0
2024-05-03 07:13:35,006:INFO:   <<< loose_type: True
2024-05-03 07:13:35,006:INFO:   <<< lr: 0.0001
2024-05-03 07:13:35,006:INFO:   <<< lr_decay: 0.9
2024-05-03 07:13:35,006:INFO:   <<< margin: 0.1
2024-05-03 07:13:35,006:INFO:   <<< max_frames: 90
2024-05-03 07:13:35,006:INFO:   <<< max_words: 32
2024-05-03 07:13:35,006:INFO:   <<< n_display: 100
2024-05-03 07:13:35,006:INFO:   <<< n_gpu: 1
2024-05-03 07:13:35,006:INFO:   <<< n_pair: 1
2024-05-03 07:13:35,006:INFO:   <<< negative_weighting: 1
2024-05-03 07:13:35,006:INFO:   <<< num_thread_reader: 0
2024-05-03 07:13:35,006:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 07:13:35,006:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 07:13:35,006:INFO:   <<< rank: 0
2024-05-03 07:13:35,006:INFO:   <<< resume_model: None
2024-05-03 07:13:35,006:INFO:   <<< sampled_use_mil: False
2024-05-03 07:13:35,007:INFO:   <<< seed: 42
2024-05-03 07:13:35,007:INFO:   <<< sim_header: meanP
2024-05-03 07:13:35,007:INFO:   <<< slice_framepos: 2
2024-05-03 07:13:35,007:INFO:   <<< task_type: retrieval
2024-05-03 07:13:35,007:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 07:13:35,007:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 07:13:35,007:INFO:   <<< train_frame_order: 0
2024-05-03 07:13:35,007:INFO:   <<< use_mil: False
2024-05-03 07:13:35,007:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 07:13:35,007:INFO:   <<< video_dim: 1024
2024-05-03 07:13:35,007:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 07:13:35,007:INFO:   <<< warmup_proportion: 0.1
2024-05-03 07:13:35,007:INFO:   <<< world_size: 1
2024-05-03 07:13:35,007:INFO: device: cuda:0 n_gpu: 1
2024-05-03 07:13:35,151:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 07:13:35,633:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 07:13:35,633:WARNING: Test retrieval by loose type.
2024-05-03 07:13:35,634:WARNING: 	 embed_dim: 512
2024-05-03 07:13:35,634:WARNING: 	 image_resolution: 224
2024-05-03 07:13:35,634:WARNING: 	 vision_layers: 12
2024-05-03 07:13:35,634:WARNING: 	 vision_width: 768
2024-05-03 07:13:35,634:WARNING: 	 vision_patch_size: 32
2024-05-03 07:13:35,634:WARNING: 	 context_length: 77
2024-05-03 07:13:35,634:WARNING: 	 vocab_size: 49408
2024-05-03 07:13:35,634:WARNING: 	 transformer_width: 512
2024-05-03 07:13:35,635:WARNING: 	 transformer_heads: 8
2024-05-03 07:13:35,635:WARNING: 	 transformer_layers: 12
2024-05-03 07:13:35,635:WARNING: 		 linear_patch: 2d
2024-05-03 07:13:35,635:WARNING: 	 cut_top_layer: 0
2024-05-03 07:13:36,613:WARNING: 	 sim_header: meanP
2024-05-03 07:14:03,242:INFO: Effective parameters:
2024-05-03 07:14:03,242:INFO:   <<< batch_size: 1
2024-05-03 07:14:03,242:INFO:   <<< batch_size_val: 16
2024-05-03 07:14:03,243:INFO:   <<< cache_dir: 
2024-05-03 07:14:03,243:INFO:   <<< coef_lr: 0.001
2024-05-03 07:14:03,243:INFO:   <<< cross_model: cross-base
2024-05-03 07:14:03,243:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 07:14:03,243:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 07:14:03,243:INFO:   <<< datatype: msrvtt
2024-05-03 07:14:03,243:INFO:   <<< do_eval: True
2024-05-03 07:14:03,243:INFO:   <<< do_lower_case: False
2024-05-03 07:14:03,243:INFO:   <<< do_pretrain: False
2024-05-03 07:14:03,243:INFO:   <<< do_train: False
2024-05-03 07:14:03,243:INFO:   <<< epochs: 2
2024-05-03 07:14:03,243:INFO:   <<< eval_frame_order: 0
2024-05-03 07:14:03,243:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 07:14:03,243:INFO:   <<< feature_framerate: 1
2024-05-03 07:14:03,243:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 07:14:03,244:INFO:   <<< fp16: False
2024-05-03 07:14:03,244:INFO:   <<< fp16_opt_level: O1
2024-05-03 07:14:03,244:INFO:   <<< freeze_layer_num: 0
2024-05-03 07:14:03,244:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 07:14:03,244:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 07:14:03,244:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 07:14:03,244:INFO:   <<< linear_patch: 2d
2024-05-03 07:14:03,244:INFO:   <<< local_rank: 0
2024-05-03 07:14:03,244:INFO:   <<< loose_type: True
2024-05-03 07:14:03,244:INFO:   <<< lr: 0.0001
2024-05-03 07:14:03,244:INFO:   <<< lr_decay: 0.9
2024-05-03 07:14:03,244:INFO:   <<< margin: 0.1
2024-05-03 07:14:03,244:INFO:   <<< max_frames: 90
2024-05-03 07:14:03,245:INFO:   <<< max_words: 32
2024-05-03 07:14:03,245:INFO:   <<< n_display: 100
2024-05-03 07:14:03,245:INFO:   <<< n_gpu: 1
2024-05-03 07:14:03,245:INFO:   <<< n_pair: 1
2024-05-03 07:14:03,245:INFO:   <<< negative_weighting: 1
2024-05-03 07:14:03,245:INFO:   <<< num_thread_reader: 0
2024-05-03 07:14:03,245:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 07:14:03,245:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 07:14:03,245:INFO:   <<< rank: 0
2024-05-03 07:14:03,245:INFO:   <<< resume_model: None
2024-05-03 07:14:03,245:INFO:   <<< sampled_use_mil: False
2024-05-03 07:14:03,245:INFO:   <<< seed: 42
2024-05-03 07:14:03,245:INFO:   <<< sim_header: meanP
2024-05-03 07:14:03,245:INFO:   <<< slice_framepos: 2
2024-05-03 07:14:03,245:INFO:   <<< task_type: retrieval
2024-05-03 07:14:03,246:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 07:14:03,246:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 07:14:03,246:INFO:   <<< train_frame_order: 0
2024-05-03 07:14:03,246:INFO:   <<< use_mil: False
2024-05-03 07:14:03,246:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 07:14:03,246:INFO:   <<< video_dim: 1024
2024-05-03 07:14:03,246:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 07:14:03,246:INFO:   <<< warmup_proportion: 0.1
2024-05-03 07:14:03,246:INFO:   <<< world_size: 1
2024-05-03 07:14:03,246:INFO: device: cuda:0 n_gpu: 1
2024-05-03 07:14:03,390:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 07:14:03,875:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 07:14:03,875:WARNING: Test retrieval by loose type.
2024-05-03 07:14:03,876:WARNING: 	 embed_dim: 512
2024-05-03 07:14:03,876:WARNING: 	 image_resolution: 224
2024-05-03 07:14:03,876:WARNING: 	 vision_layers: 12
2024-05-03 07:14:03,876:WARNING: 	 vision_width: 768
2024-05-03 07:14:03,876:WARNING: 	 vision_patch_size: 32
2024-05-03 07:14:03,876:WARNING: 	 context_length: 77
2024-05-03 07:14:03,877:WARNING: 	 vocab_size: 49408
2024-05-03 07:14:03,877:WARNING: 	 transformer_width: 512
2024-05-03 07:14:03,877:WARNING: 	 transformer_heads: 8
2024-05-03 07:14:03,877:WARNING: 	 transformer_layers: 12
2024-05-03 07:14:03,877:WARNING: 		 linear_patch: 2d
2024-05-03 07:14:03,877:WARNING: 	 cut_top_layer: 0
2024-05-03 07:14:04,873:WARNING: 	 sim_header: meanP
2024-05-03 07:17:40,328:INFO: Effective parameters:
2024-05-03 07:17:40,329:INFO:   <<< batch_size: 1
2024-05-03 07:17:40,329:INFO:   <<< batch_size_val: 16
2024-05-03 07:17:40,329:INFO:   <<< cache_dir: 
2024-05-03 07:17:40,329:INFO:   <<< coef_lr: 0.001
2024-05-03 07:17:40,329:INFO:   <<< cross_model: cross-base
2024-05-03 07:17:40,329:INFO:   <<< cross_num_hidden_layers: 4
2024-05-03 07:17:40,329:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-03 07:17:40,329:INFO:   <<< datatype: msrvtt
2024-05-03 07:17:40,329:INFO:   <<< do_eval: True
2024-05-03 07:17:40,330:INFO:   <<< do_lower_case: False
2024-05-03 07:17:40,330:INFO:   <<< do_pretrain: False
2024-05-03 07:17:40,330:INFO:   <<< do_train: False
2024-05-03 07:17:40,330:INFO:   <<< epochs: 2
2024-05-03 07:17:40,330:INFO:   <<< eval_frame_order: 0
2024-05-03 07:17:40,330:INFO:   <<< expand_msrvtt_sentences: True
2024-05-03 07:17:40,330:INFO:   <<< feature_framerate: 1
2024-05-03 07:17:40,330:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-03 07:17:40,330:INFO:   <<< fp16: False
2024-05-03 07:17:40,330:INFO:   <<< fp16_opt_level: O1
2024-05-03 07:17:40,330:INFO:   <<< freeze_layer_num: 0
2024-05-03 07:17:40,330:INFO:   <<< gradient_accumulation_steps: 1
2024-05-03 07:17:40,330:INFO:   <<< hard_negative_rate: 0.5
2024-05-03 07:17:40,331:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-03 07:17:40,331:INFO:   <<< linear_patch: 2d
2024-05-03 07:17:40,331:INFO:   <<< local_rank: 0
2024-05-03 07:17:40,331:INFO:   <<< loose_type: True
2024-05-03 07:17:40,331:INFO:   <<< lr: 0.0001
2024-05-03 07:17:40,331:INFO:   <<< lr_decay: 0.9
2024-05-03 07:17:40,331:INFO:   <<< margin: 0.1
2024-05-03 07:17:40,331:INFO:   <<< max_frames: 90
2024-05-03 07:17:40,331:INFO:   <<< max_words: 32
2024-05-03 07:17:40,331:INFO:   <<< n_display: 100
2024-05-03 07:17:40,331:INFO:   <<< n_gpu: 1
2024-05-03 07:17:40,331:INFO:   <<< n_pair: 1
2024-05-03 07:17:40,332:INFO:   <<< negative_weighting: 1
2024-05-03 07:17:40,332:INFO:   <<< num_thread_reader: 0
2024-05-03 07:17:40,332:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-03 07:17:40,332:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-03 07:17:40,332:INFO:   <<< rank: 0
2024-05-03 07:17:40,332:INFO:   <<< resume_model: None
2024-05-03 07:17:40,332:INFO:   <<< sampled_use_mil: False
2024-05-03 07:17:40,332:INFO:   <<< seed: 42
2024-05-03 07:17:40,332:INFO:   <<< sim_header: meanP
2024-05-03 07:17:40,332:INFO:   <<< slice_framepos: 2
2024-05-03 07:17:40,332:INFO:   <<< task_type: retrieval
2024-05-03 07:17:40,332:INFO:   <<< text_num_hidden_layers: 12
2024-05-03 07:17:40,332:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-03 07:17:40,333:INFO:   <<< train_frame_order: 0
2024-05-03 07:17:40,333:INFO:   <<< use_mil: False
2024-05-03 07:17:40,333:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-03 07:17:40,333:INFO:   <<< video_dim: 1024
2024-05-03 07:17:40,333:INFO:   <<< visual_num_hidden_layers: 12
2024-05-03 07:17:40,333:INFO:   <<< warmup_proportion: 0.1
2024-05-03 07:17:40,333:INFO:   <<< world_size: 1
2024-05-03 07:17:40,333:INFO: device: cuda:0 n_gpu: 1
2024-05-03 07:17:40,472:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-03 07:17:40,952:WARNING: Stage-One:True, Stage-Two:False
2024-05-03 07:17:40,952:WARNING: Test retrieval by loose type.
2024-05-03 07:17:40,953:WARNING: 	 embed_dim: 512
2024-05-03 07:17:40,953:WARNING: 	 image_resolution: 224
2024-05-03 07:17:40,953:WARNING: 	 vision_layers: 12
2024-05-03 07:17:40,953:WARNING: 	 vision_width: 768
2024-05-03 07:17:40,953:WARNING: 	 vision_patch_size: 32
2024-05-03 07:17:40,953:WARNING: 	 context_length: 77
2024-05-03 07:17:40,953:WARNING: 	 vocab_size: 49408
2024-05-03 07:17:40,953:WARNING: 	 transformer_width: 512
2024-05-03 07:17:40,954:WARNING: 	 transformer_heads: 8
2024-05-03 07:17:40,954:WARNING: 	 transformer_layers: 12
2024-05-03 07:17:40,954:WARNING: 		 linear_patch: 2d
2024-05-03 07:17:40,954:WARNING: 	 cut_top_layer: 0
2024-05-03 07:17:41,928:WARNING: 	 sim_header: meanP
2024-05-04 02:31:22,894:INFO: Effective parameters:
2024-05-04 02:31:22,894:INFO:   <<< batch_size: 16
2024-05-04 02:31:22,894:INFO:   <<< batch_size_val: 16
2024-05-04 02:31:22,894:INFO:   <<< cache_dir: 
2024-05-04 02:31:22,895:INFO:   <<< coef_lr: 0.001
2024-05-04 02:31:22,895:INFO:   <<< cross_model: cross-base
2024-05-04 02:31:22,895:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 02:31:22,895:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 02:31:22,895:INFO:   <<< datatype: msrvtt
2024-05-04 02:31:22,895:INFO:   <<< do_eval: True
2024-05-04 02:31:22,895:INFO:   <<< do_lower_case: False
2024-05-04 02:31:22,895:INFO:   <<< do_pretrain: False
2024-05-04 02:31:22,895:INFO:   <<< do_train: False
2024-05-04 02:31:22,895:INFO:   <<< epochs: 2
2024-05-04 02:31:22,895:INFO:   <<< eval_frame_order: 0
2024-05-04 02:31:22,895:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 02:31:22,895:INFO:   <<< feature_framerate: 1
2024-05-04 02:31:22,895:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 02:31:22,895:INFO:   <<< fp16: False
2024-05-04 02:31:22,895:INFO:   <<< fp16_opt_level: O1
2024-05-04 02:31:22,895:INFO:   <<< freeze_layer_num: 0
2024-05-04 02:31:22,895:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 02:31:22,896:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 02:31:22,896:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 02:31:22,896:INFO:   <<< linear_patch: 2d
2024-05-04 02:31:22,896:INFO:   <<< local_rank: 0
2024-05-04 02:31:22,896:INFO:   <<< loose_type: True
2024-05-04 02:31:22,896:INFO:   <<< lr: 0.0001
2024-05-04 02:31:22,896:INFO:   <<< lr_decay: 0.9
2024-05-04 02:31:22,896:INFO:   <<< margin: 0.1
2024-05-04 02:31:22,896:INFO:   <<< max_frames: 12
2024-05-04 02:31:22,896:INFO:   <<< max_words: 32
2024-05-04 02:31:22,896:INFO:   <<< n_display: 100
2024-05-04 02:31:22,896:INFO:   <<< n_gpu: 1
2024-05-04 02:31:22,896:INFO:   <<< n_pair: 1
2024-05-04 02:31:22,896:INFO:   <<< negative_weighting: 1
2024-05-04 02:31:22,896:INFO:   <<< num_thread_reader: 0
2024-05-04 02:31:22,896:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 02:31:22,896:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 02:31:22,897:INFO:   <<< rank: 0
2024-05-04 02:31:22,897:INFO:   <<< resume_model: None
2024-05-04 02:31:22,897:INFO:   <<< sampled_use_mil: False
2024-05-04 02:31:22,897:INFO:   <<< seed: 42
2024-05-04 02:31:22,897:INFO:   <<< sim_header: meanP
2024-05-04 02:31:22,897:INFO:   <<< slice_framepos: 2
2024-05-04 02:31:22,897:INFO:   <<< task_type: retrieval
2024-05-04 02:31:22,897:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 02:31:22,897:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 02:31:22,897:INFO:   <<< train_frame_order: 0
2024-05-04 02:31:22,897:INFO:   <<< use_mil: False
2024-05-04 02:31:22,897:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 02:31:22,897:INFO:   <<< video_dim: 1024
2024-05-04 02:31:22,897:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 02:31:22,897:INFO:   <<< warmup_proportion: 0.1
2024-05-04 02:31:22,897:INFO:   <<< world_size: 1
2024-05-04 02:31:22,898:INFO: device: cuda:0 n_gpu: 1
2024-05-04 02:31:22,976:INFO: ***** Running test *****
2024-05-04 02:31:22,976:INFO:   Num examples = 22
2024-05-04 02:31:22,976:INFO:   Batch size = 16
2024-05-04 02:31:22,976:INFO:   Num steps = 2
2024-05-04 02:31:22,976:INFO: ***** Running val *****
2024-05-04 02:31:22,976:INFO:   Num examples = 22
2024-05-04 02:33:15,108:INFO: Effective parameters:
2024-05-04 02:33:15,108:INFO:   <<< batch_size: 16
2024-05-04 02:33:15,108:INFO:   <<< batch_size_val: 16
2024-05-04 02:33:15,108:INFO:   <<< cache_dir: 
2024-05-04 02:33:15,108:INFO:   <<< coef_lr: 0.001
2024-05-04 02:33:15,108:INFO:   <<< cross_model: cross-base
2024-05-04 02:33:15,108:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 02:33:15,108:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 02:33:15,108:INFO:   <<< datatype: msrvtt
2024-05-04 02:33:15,109:INFO:   <<< do_eval: True
2024-05-04 02:33:15,109:INFO:   <<< do_lower_case: False
2024-05-04 02:33:15,109:INFO:   <<< do_pretrain: False
2024-05-04 02:33:15,109:INFO:   <<< do_train: False
2024-05-04 02:33:15,109:INFO:   <<< epochs: 2
2024-05-04 02:33:15,109:INFO:   <<< eval_frame_order: 0
2024-05-04 02:33:15,109:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 02:33:15,109:INFO:   <<< feature_framerate: 1
2024-05-04 02:33:15,109:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 02:33:15,109:INFO:   <<< fp16: False
2024-05-04 02:33:15,109:INFO:   <<< fp16_opt_level: O1
2024-05-04 02:33:15,109:INFO:   <<< freeze_layer_num: 0
2024-05-04 02:33:15,109:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 02:33:15,109:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 02:33:15,109:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 02:33:15,109:INFO:   <<< linear_patch: 2d
2024-05-04 02:33:15,110:INFO:   <<< local_rank: 0
2024-05-04 02:33:15,110:INFO:   <<< loose_type: True
2024-05-04 02:33:15,110:INFO:   <<< lr: 0.0001
2024-05-04 02:33:15,110:INFO:   <<< lr_decay: 0.9
2024-05-04 02:33:15,110:INFO:   <<< margin: 0.1
2024-05-04 02:33:15,110:INFO:   <<< max_frames: 12
2024-05-04 02:33:15,110:INFO:   <<< max_words: 32
2024-05-04 02:33:15,110:INFO:   <<< n_display: 100
2024-05-04 02:33:15,110:INFO:   <<< n_gpu: 1
2024-05-04 02:33:15,110:INFO:   <<< n_pair: 1
2024-05-04 02:33:15,110:INFO:   <<< negative_weighting: 1
2024-05-04 02:33:15,110:INFO:   <<< num_thread_reader: 0
2024-05-04 02:33:15,110:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 02:33:15,110:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 02:33:15,110:INFO:   <<< rank: 0
2024-05-04 02:33:15,110:INFO:   <<< resume_model: None
2024-05-04 02:33:15,110:INFO:   <<< sampled_use_mil: False
2024-05-04 02:33:15,111:INFO:   <<< seed: 42
2024-05-04 02:33:15,111:INFO:   <<< sim_header: meanP
2024-05-04 02:33:15,111:INFO:   <<< slice_framepos: 2
2024-05-04 02:33:15,111:INFO:   <<< task_type: retrieval
2024-05-04 02:33:15,111:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 02:33:15,111:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 02:33:15,111:INFO:   <<< train_frame_order: 0
2024-05-04 02:33:15,111:INFO:   <<< use_mil: False
2024-05-04 02:33:15,111:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 02:33:15,111:INFO:   <<< video_dim: 1024
2024-05-04 02:33:15,111:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 02:33:15,111:INFO:   <<< warmup_proportion: 0.1
2024-05-04 02:33:15,111:INFO:   <<< world_size: 1
2024-05-04 02:33:15,111:INFO: device: cuda:0 n_gpu: 1
2024-05-04 02:33:16,492:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 02:33:17,706:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 02:33:17,708:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 02:33:17,708:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 02:33:17,708:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 02:33:17,709:WARNING: Test retrieval by loose type.
2024-05-04 02:33:17,710:WARNING: 	 embed_dim: 512
2024-05-04 02:33:17,710:WARNING: 	 image_resolution: 224
2024-05-04 02:33:17,710:WARNING: 	 vision_layers: 12
2024-05-04 02:33:17,710:WARNING: 	 vision_width: 768
2024-05-04 02:33:17,710:WARNING: 	 vision_patch_size: 32
2024-05-04 02:33:17,711:WARNING: 	 context_length: 77
2024-05-04 02:33:17,711:WARNING: 	 vocab_size: 49408
2024-05-04 02:33:17,711:WARNING: 	 transformer_width: 512
2024-05-04 02:33:17,711:WARNING: 	 transformer_heads: 8
2024-05-04 02:33:17,711:WARNING: 	 transformer_layers: 12
2024-05-04 02:33:17,711:WARNING: 		 linear_patch: 2d
2024-05-04 02:33:17,711:WARNING: 	 cut_top_layer: 0
2024-05-04 02:33:18,569:WARNING: 	 sim_header: meanP
2024-05-04 02:33:22,218:INFO: --------------------
2024-05-04 02:33:22,218:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 02:33:26,545:INFO: ***** Running test *****
2024-05-04 02:33:26,545:INFO:   Num examples = 22
2024-05-04 02:33:26,545:INFO:   Batch size = 16
2024-05-04 02:33:26,545:INFO:   Num steps = 2
2024-05-04 02:33:26,546:INFO: ***** Running val *****
2024-05-04 02:33:26,546:INFO:   Num examples = 22
2024-05-04 02:33:29,182:INFO: sim matrix size: 22, 22
2024-05-04 02:33:29,184:INFO: 	 Length-T: 22, Length-V:22
2024-05-04 02:33:29,184:INFO: Text-to-Video:
2024-05-04 02:33:29,184:INFO: 	>>>  R@1: 81.8 - R@5: 95.5 - R@10: 100.0 - Median R: 1.0 - Mean R: 1.5
2024-05-04 02:33:29,184:INFO: Video-to-Text:
2024-05-04 02:33:29,184:INFO: 	>>>  V2T$R@1: 86.4 - V2T$R@5: 95.5 - V2T$R@10: 100.0 - V2T$Median R: 1.0 - V2T$Mean R: 1.5
2024-05-04 02:34:18,635:INFO: Effective parameters:
2024-05-04 02:34:18,636:INFO:   <<< batch_size: 16
2024-05-04 02:34:18,636:INFO:   <<< batch_size_val: 16
2024-05-04 02:34:18,636:INFO:   <<< cache_dir: 
2024-05-04 02:34:18,636:INFO:   <<< coef_lr: 0.001
2024-05-04 02:34:18,636:INFO:   <<< cross_model: cross-base
2024-05-04 02:34:18,636:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 02:34:18,636:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 02:34:18,636:INFO:   <<< datatype: msrvtt
2024-05-04 02:34:18,636:INFO:   <<< do_eval: True
2024-05-04 02:34:18,636:INFO:   <<< do_lower_case: False
2024-05-04 02:34:18,636:INFO:   <<< do_pretrain: False
2024-05-04 02:34:18,637:INFO:   <<< do_train: False
2024-05-04 02:34:18,637:INFO:   <<< epochs: 2
2024-05-04 02:34:18,637:INFO:   <<< eval_frame_order: 0
2024-05-04 02:34:18,637:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 02:34:18,637:INFO:   <<< feature_framerate: 1
2024-05-04 02:34:18,637:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 02:34:18,637:INFO:   <<< fp16: False
2024-05-04 02:34:18,637:INFO:   <<< fp16_opt_level: O1
2024-05-04 02:34:18,637:INFO:   <<< freeze_layer_num: 0
2024-05-04 02:34:18,637:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 02:34:18,637:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 02:34:18,637:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 02:34:18,637:INFO:   <<< linear_patch: 2d
2024-05-04 02:34:18,638:INFO:   <<< local_rank: 0
2024-05-04 02:34:18,638:INFO:   <<< loose_type: True
2024-05-04 02:34:18,638:INFO:   <<< lr: 0.0001
2024-05-04 02:34:18,638:INFO:   <<< lr_decay: 0.9
2024-05-04 02:34:18,638:INFO:   <<< margin: 0.1
2024-05-04 02:34:18,638:INFO:   <<< max_frames: 12
2024-05-04 02:34:18,638:INFO:   <<< max_words: 32
2024-05-04 02:34:18,638:INFO:   <<< n_display: 100
2024-05-04 02:34:18,638:INFO:   <<< n_gpu: 1
2024-05-04 02:34:18,638:INFO:   <<< n_pair: 1
2024-05-04 02:34:18,638:INFO:   <<< negative_weighting: 1
2024-05-04 02:34:18,638:INFO:   <<< num_thread_reader: 0
2024-05-04 02:34:18,638:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 02:34:18,638:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 02:34:18,638:INFO:   <<< rank: 0
2024-05-04 02:34:18,639:INFO:   <<< resume_model: None
2024-05-04 02:34:18,639:INFO:   <<< sampled_use_mil: False
2024-05-04 02:34:18,639:INFO:   <<< seed: 42
2024-05-04 02:34:18,639:INFO:   <<< sim_header: meanP
2024-05-04 02:34:18,639:INFO:   <<< slice_framepos: 2
2024-05-04 02:34:18,639:INFO:   <<< task_type: retrieval
2024-05-04 02:34:18,639:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 02:34:18,639:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 02:34:18,639:INFO:   <<< train_frame_order: 0
2024-05-04 02:34:18,639:INFO:   <<< use_mil: False
2024-05-04 02:34:18,639:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 02:34:18,639:INFO:   <<< video_dim: 1024
2024-05-04 02:34:18,639:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 02:34:18,639:INFO:   <<< warmup_proportion: 0.1
2024-05-04 02:34:18,640:INFO:   <<< world_size: 1
2024-05-04 02:34:18,640:INFO: device: cuda:0 n_gpu: 1
2024-05-04 02:34:18,858:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 02:34:19,318:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 02:34:19,318:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 02:34:19,319:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 02:34:19,319:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 02:34:19,319:WARNING: Test retrieval by loose type.
2024-05-04 02:34:19,320:WARNING: 	 embed_dim: 512
2024-05-04 02:34:19,320:WARNING: 	 image_resolution: 224
2024-05-04 02:34:19,320:WARNING: 	 vision_layers: 12
2024-05-04 02:34:19,320:WARNING: 	 vision_width: 768
2024-05-04 02:34:19,320:WARNING: 	 vision_patch_size: 32
2024-05-04 02:34:19,320:WARNING: 	 context_length: 77
2024-05-04 02:34:19,320:WARNING: 	 vocab_size: 49408
2024-05-04 02:34:19,320:WARNING: 	 transformer_width: 512
2024-05-04 02:34:19,320:WARNING: 	 transformer_heads: 8
2024-05-04 02:34:19,320:WARNING: 	 transformer_layers: 12
2024-05-04 02:34:19,320:WARNING: 		 linear_patch: 2d
2024-05-04 02:34:19,320:WARNING: 	 cut_top_layer: 0
2024-05-04 02:34:20,147:WARNING: 	 sim_header: meanP
2024-05-04 02:34:23,751:INFO: --------------------
2024-05-04 02:34:23,751:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 02:34:25,793:INFO: ***** Running test *****
2024-05-04 02:34:25,793:INFO:   Num examples = 22
2024-05-04 02:34:25,793:INFO:   Batch size = 16
2024-05-04 02:34:25,793:INFO:   Num steps = 2
2024-05-04 02:34:25,793:INFO: ***** Running val *****
2024-05-04 02:34:25,793:INFO:   Num examples = 22
2024-05-04 02:34:51,492:INFO: Effective parameters:
2024-05-04 02:34:51,492:INFO:   <<< batch_size: 16
2024-05-04 02:34:51,492:INFO:   <<< batch_size_val: 16
2024-05-04 02:34:51,492:INFO:   <<< cache_dir: 
2024-05-04 02:34:51,493:INFO:   <<< coef_lr: 0.001
2024-05-04 02:34:51,493:INFO:   <<< cross_model: cross-base
2024-05-04 02:34:51,493:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 02:34:51,493:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 02:34:51,493:INFO:   <<< datatype: msrvtt
2024-05-04 02:34:51,493:INFO:   <<< do_eval: True
2024-05-04 02:34:51,493:INFO:   <<< do_lower_case: False
2024-05-04 02:34:51,493:INFO:   <<< do_pretrain: False
2024-05-04 02:34:51,493:INFO:   <<< do_train: False
2024-05-04 02:34:51,493:INFO:   <<< epochs: 2
2024-05-04 02:34:51,493:INFO:   <<< eval_frame_order: 0
2024-05-04 02:34:51,493:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 02:34:51,493:INFO:   <<< feature_framerate: 1
2024-05-04 02:34:51,493:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 02:34:51,493:INFO:   <<< fp16: False
2024-05-04 02:34:51,493:INFO:   <<< fp16_opt_level: O1
2024-05-04 02:34:51,494:INFO:   <<< freeze_layer_num: 0
2024-05-04 02:34:51,494:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 02:34:51,494:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 02:34:51,494:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 02:34:51,494:INFO:   <<< linear_patch: 2d
2024-05-04 02:34:51,494:INFO:   <<< local_rank: 0
2024-05-04 02:34:51,494:INFO:   <<< loose_type: True
2024-05-04 02:34:51,494:INFO:   <<< lr: 0.0001
2024-05-04 02:34:51,494:INFO:   <<< lr_decay: 0.9
2024-05-04 02:34:51,494:INFO:   <<< margin: 0.1
2024-05-04 02:34:51,494:INFO:   <<< max_frames: 12
2024-05-04 02:34:51,494:INFO:   <<< max_words: 32
2024-05-04 02:34:51,494:INFO:   <<< n_display: 100
2024-05-04 02:34:51,494:INFO:   <<< n_gpu: 1
2024-05-04 02:34:51,494:INFO:   <<< n_pair: 1
2024-05-04 02:34:51,494:INFO:   <<< negative_weighting: 1
2024-05-04 02:34:51,494:INFO:   <<< num_thread_reader: 0
2024-05-04 02:34:51,495:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 02:34:51,495:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 02:34:51,495:INFO:   <<< rank: 0
2024-05-04 02:34:51,495:INFO:   <<< resume_model: None
2024-05-04 02:34:51,495:INFO:   <<< sampled_use_mil: False
2024-05-04 02:34:51,495:INFO:   <<< seed: 42
2024-05-04 02:34:51,495:INFO:   <<< sim_header: meanP
2024-05-04 02:34:51,495:INFO:   <<< slice_framepos: 2
2024-05-04 02:34:51,495:INFO:   <<< task_type: retrieval
2024-05-04 02:34:51,495:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 02:34:51,495:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 02:34:51,495:INFO:   <<< train_frame_order: 0
2024-05-04 02:34:51,495:INFO:   <<< use_mil: False
2024-05-04 02:34:51,495:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 02:34:51,495:INFO:   <<< video_dim: 1024
2024-05-04 02:34:51,495:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 02:34:51,495:INFO:   <<< warmup_proportion: 0.1
2024-05-04 02:34:51,496:INFO:   <<< world_size: 1
2024-05-04 02:34:51,496:INFO: device: cuda:0 n_gpu: 1
2024-05-04 02:34:51,704:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 02:34:52,177:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 02:34:52,179:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 02:34:52,179:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 02:34:52,179:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 02:34:52,179:WARNING: Test retrieval by loose type.
2024-05-04 02:34:52,181:WARNING: 	 embed_dim: 512
2024-05-04 02:34:52,181:WARNING: 	 image_resolution: 224
2024-05-04 02:34:52,181:WARNING: 	 vision_layers: 12
2024-05-04 02:34:52,181:WARNING: 	 vision_width: 768
2024-05-04 02:34:52,181:WARNING: 	 vision_patch_size: 32
2024-05-04 02:34:52,181:WARNING: 	 context_length: 77
2024-05-04 02:34:52,181:WARNING: 	 vocab_size: 49408
2024-05-04 02:34:52,181:WARNING: 	 transformer_width: 512
2024-05-04 02:34:52,182:WARNING: 	 transformer_heads: 8
2024-05-04 02:34:52,182:WARNING: 	 transformer_layers: 12
2024-05-04 02:34:52,182:WARNING: 		 linear_patch: 2d
2024-05-04 02:34:52,182:WARNING: 	 cut_top_layer: 0
2024-05-04 02:34:53,030:WARNING: 	 sim_header: meanP
2024-05-04 02:34:56,641:INFO: --------------------
2024-05-04 02:34:56,642:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 02:34:58,661:INFO: ***** Running test *****
2024-05-04 02:34:58,661:INFO:   Num examples = 22
2024-05-04 02:34:58,661:INFO:   Batch size = 16
2024-05-04 02:34:58,661:INFO:   Num steps = 2
2024-05-04 02:34:58,661:INFO: ***** Running val *****
2024-05-04 02:34:58,661:INFO:   Num examples = 22
2024-05-04 04:38:04,202:INFO: Effective parameters:
2024-05-04 04:38:04,202:INFO:   <<< batch_size: 16
2024-05-04 04:38:04,202:INFO:   <<< batch_size_val: 16
2024-05-04 04:38:04,202:INFO:   <<< cache_dir: 
2024-05-04 04:38:04,202:INFO:   <<< coef_lr: 0.001
2024-05-04 04:38:04,202:INFO:   <<< cross_model: cross-base
2024-05-04 04:38:04,202:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 04:38:04,202:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 04:38:04,202:INFO:   <<< datatype: msrvtt
2024-05-04 04:38:04,202:INFO:   <<< do_eval: True
2024-05-04 04:38:04,203:INFO:   <<< do_lower_case: False
2024-05-04 04:38:04,203:INFO:   <<< do_pretrain: False
2024-05-04 04:38:04,203:INFO:   <<< do_train: False
2024-05-04 04:38:04,203:INFO:   <<< epochs: 2
2024-05-04 04:38:04,203:INFO:   <<< eval_frame_order: 0
2024-05-04 04:38:04,203:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 04:38:04,203:INFO:   <<< feature_framerate: 1
2024-05-04 04:38:04,203:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 04:38:04,203:INFO:   <<< fp16: False
2024-05-04 04:38:04,203:INFO:   <<< fp16_opt_level: O1
2024-05-04 04:38:04,203:INFO:   <<< freeze_layer_num: 0
2024-05-04 04:38:04,203:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 04:38:04,203:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 04:38:04,203:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 04:38:04,203:INFO:   <<< linear_patch: 2d
2024-05-04 04:38:04,203:INFO:   <<< local_rank: 0
2024-05-04 04:38:04,203:INFO:   <<< loose_type: True
2024-05-04 04:38:04,203:INFO:   <<< lr: 0.0001
2024-05-04 04:38:04,204:INFO:   <<< lr_decay: 0.9
2024-05-04 04:38:04,204:INFO:   <<< margin: 0.1
2024-05-04 04:38:04,204:INFO:   <<< max_frames: 12
2024-05-04 04:38:04,204:INFO:   <<< max_words: 32
2024-05-04 04:38:04,204:INFO:   <<< n_display: 100
2024-05-04 04:38:04,204:INFO:   <<< n_gpu: 1
2024-05-04 04:38:04,204:INFO:   <<< n_pair: 1
2024-05-04 04:38:04,204:INFO:   <<< negative_weighting: 1
2024-05-04 04:38:04,204:INFO:   <<< num_thread_reader: 0
2024-05-04 04:38:04,204:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 04:38:04,204:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 04:38:04,204:INFO:   <<< rank: 0
2024-05-04 04:38:04,204:INFO:   <<< resume_model: None
2024-05-04 04:38:04,204:INFO:   <<< sampled_use_mil: False
2024-05-04 04:38:04,204:INFO:   <<< seed: 42
2024-05-04 04:38:04,204:INFO:   <<< sim_header: meanP
2024-05-04 04:38:04,204:INFO:   <<< slice_framepos: 2
2024-05-04 04:38:04,205:INFO:   <<< task_type: retrieval
2024-05-04 04:38:04,205:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 04:38:04,205:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 04:38:04,205:INFO:   <<< train_frame_order: 0
2024-05-04 04:38:04,205:INFO:   <<< use_mil: False
2024-05-04 04:38:04,205:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 04:38:04,205:INFO:   <<< video_dim: 1024
2024-05-04 04:38:04,205:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 04:38:04,205:INFO:   <<< warmup_proportion: 0.1
2024-05-04 04:38:04,205:INFO:   <<< world_size: 1
2024-05-04 04:38:04,205:INFO: device: cuda:0 n_gpu: 1
2024-05-04 04:38:04,421:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 04:38:04,905:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 04:38:04,906:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 04:38:04,906:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 04:38:04,906:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 04:38:04,906:WARNING: Test retrieval by loose type.
2024-05-04 04:38:04,907:WARNING: 	 embed_dim: 512
2024-05-04 04:38:04,907:WARNING: 	 image_resolution: 224
2024-05-04 04:38:04,907:WARNING: 	 vision_layers: 12
2024-05-04 04:38:04,908:WARNING: 	 vision_width: 768
2024-05-04 04:38:04,908:WARNING: 	 vision_patch_size: 32
2024-05-04 04:38:04,908:WARNING: 	 context_length: 77
2024-05-04 04:38:04,908:WARNING: 	 vocab_size: 49408
2024-05-04 04:38:04,908:WARNING: 	 transformer_width: 512
2024-05-04 04:38:04,908:WARNING: 	 transformer_heads: 8
2024-05-04 04:38:04,908:WARNING: 	 transformer_layers: 12
2024-05-04 04:38:04,908:WARNING: 		 linear_patch: 2d
2024-05-04 04:38:04,908:WARNING: 	 cut_top_layer: 0
2024-05-04 04:38:05,756:WARNING: 	 sim_header: meanP
2024-05-04 04:38:09,464:INFO: --------------------
2024-05-04 04:38:09,464:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 04:38:17,773:INFO: Effective parameters:
2024-05-04 04:38:17,773:INFO:   <<< batch_size: 1
2024-05-04 04:38:17,773:INFO:   <<< batch_size_val: 16
2024-05-04 04:38:17,773:INFO:   <<< cache_dir: 
2024-05-04 04:38:17,773:INFO:   <<< coef_lr: 0.001
2024-05-04 04:38:17,773:INFO:   <<< cross_model: cross-base
2024-05-04 04:38:17,773:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 04:38:17,773:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 04:38:17,773:INFO:   <<< datatype: msrvtt
2024-05-04 04:38:17,773:INFO:   <<< do_eval: True
2024-05-04 04:38:17,773:INFO:   <<< do_lower_case: False
2024-05-04 04:38:17,773:INFO:   <<< do_pretrain: False
2024-05-04 04:38:17,774:INFO:   <<< do_train: False
2024-05-04 04:38:17,774:INFO:   <<< epochs: 2
2024-05-04 04:38:17,774:INFO:   <<< eval_frame_order: 0
2024-05-04 04:38:17,774:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 04:38:17,774:INFO:   <<< feature_framerate: 1
2024-05-04 04:38:17,774:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 04:38:17,774:INFO:   <<< fp16: False
2024-05-04 04:38:17,774:INFO:   <<< fp16_opt_level: O1
2024-05-04 04:38:17,774:INFO:   <<< freeze_layer_num: 0
2024-05-04 04:38:17,774:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 04:38:17,774:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 04:38:17,774:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 04:38:17,774:INFO:   <<< linear_patch: 2d
2024-05-04 04:38:17,774:INFO:   <<< local_rank: 0
2024-05-04 04:38:17,774:INFO:   <<< loose_type: True
2024-05-04 04:38:17,774:INFO:   <<< lr: 0.0001
2024-05-04 04:38:17,775:INFO:   <<< lr_decay: 0.9
2024-05-04 04:38:17,775:INFO:   <<< margin: 0.1
2024-05-04 04:38:17,775:INFO:   <<< max_frames: 90
2024-05-04 04:38:17,775:INFO:   <<< max_words: 32
2024-05-04 04:38:17,775:INFO:   <<< n_display: 100
2024-05-04 04:38:17,775:INFO:   <<< n_gpu: 1
2024-05-04 04:38:17,775:INFO:   <<< n_pair: 1
2024-05-04 04:38:17,775:INFO:   <<< negative_weighting: 1
2024-05-04 04:38:17,775:INFO:   <<< num_thread_reader: 0
2024-05-04 04:38:17,775:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 04:38:17,775:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 04:38:17,775:INFO:   <<< rank: 0
2024-05-04 04:38:17,775:INFO:   <<< resume_model: None
2024-05-04 04:38:17,775:INFO:   <<< sampled_use_mil: False
2024-05-04 04:38:17,775:INFO:   <<< seed: 42
2024-05-04 04:38:17,775:INFO:   <<< sim_header: meanP
2024-05-04 04:38:17,775:INFO:   <<< slice_framepos: 2
2024-05-04 04:38:17,775:INFO:   <<< task_type: retrieval
2024-05-04 04:38:17,776:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 04:38:17,776:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 04:38:17,776:INFO:   <<< train_frame_order: 0
2024-05-04 04:38:17,776:INFO:   <<< use_mil: False
2024-05-04 04:38:17,776:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 04:38:17,776:INFO:   <<< video_dim: 1024
2024-05-04 04:38:17,776:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 04:38:17,776:INFO:   <<< warmup_proportion: 0.1
2024-05-04 04:38:17,776:INFO:   <<< world_size: 1
2024-05-04 04:38:17,776:INFO: device: cuda:0 n_gpu: 1
2024-05-04 04:38:17,923:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 04:38:18,409:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 04:38:18,410:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 04:38:18,410:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 04:38:18,410:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 04:38:18,410:WARNING: Test retrieval by loose type.
2024-05-04 04:38:18,411:WARNING: 	 embed_dim: 512
2024-05-04 04:38:18,411:WARNING: 	 image_resolution: 224
2024-05-04 04:38:18,411:WARNING: 	 vision_layers: 12
2024-05-04 04:38:18,411:WARNING: 	 vision_width: 768
2024-05-04 04:38:18,411:WARNING: 	 vision_patch_size: 32
2024-05-04 04:38:18,412:WARNING: 	 context_length: 77
2024-05-04 04:38:18,412:WARNING: 	 vocab_size: 49408
2024-05-04 04:38:18,412:WARNING: 	 transformer_width: 512
2024-05-04 04:38:18,412:WARNING: 	 transformer_heads: 8
2024-05-04 04:38:18,412:WARNING: 	 transformer_layers: 12
2024-05-04 04:38:18,412:WARNING: 		 linear_patch: 2d
2024-05-04 04:38:18,412:WARNING: 	 cut_top_layer: 0
2024-05-04 04:38:19,275:WARNING: 	 sim_header: meanP
2024-05-04 04:38:22,995:INFO: --------------------
2024-05-04 04:38:22,995:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 04:39:35,307:INFO: Effective parameters:
2024-05-04 04:39:35,307:INFO:   <<< batch_size: 1
2024-05-04 04:39:35,307:INFO:   <<< batch_size_val: 16
2024-05-04 04:39:35,307:INFO:   <<< cache_dir: 
2024-05-04 04:39:35,308:INFO:   <<< coef_lr: 0.001
2024-05-04 04:39:35,308:INFO:   <<< cross_model: cross-base
2024-05-04 04:39:35,308:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 04:39:35,308:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 04:39:35,308:INFO:   <<< datatype: msrvtt
2024-05-04 04:39:35,308:INFO:   <<< do_eval: True
2024-05-04 04:39:35,308:INFO:   <<< do_lower_case: False
2024-05-04 04:39:35,308:INFO:   <<< do_pretrain: False
2024-05-04 04:39:35,308:INFO:   <<< do_train: False
2024-05-04 04:39:35,308:INFO:   <<< epochs: 2
2024-05-04 04:39:35,308:INFO:   <<< eval_frame_order: 0
2024-05-04 04:39:35,308:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 04:39:35,308:INFO:   <<< feature_framerate: 1
2024-05-04 04:39:35,308:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 04:39:35,308:INFO:   <<< fp16: False
2024-05-04 04:39:35,308:INFO:   <<< fp16_opt_level: O1
2024-05-04 04:39:35,308:INFO:   <<< freeze_layer_num: 0
2024-05-04 04:39:35,309:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 04:39:35,309:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 04:39:35,309:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 04:39:35,309:INFO:   <<< linear_patch: 2d
2024-05-04 04:39:35,309:INFO:   <<< local_rank: 0
2024-05-04 04:39:35,309:INFO:   <<< loose_type: True
2024-05-04 04:39:35,309:INFO:   <<< lr: 0.0001
2024-05-04 04:39:35,309:INFO:   <<< lr_decay: 0.9
2024-05-04 04:39:35,309:INFO:   <<< margin: 0.1
2024-05-04 04:39:35,309:INFO:   <<< max_frames: 90
2024-05-04 04:39:35,309:INFO:   <<< max_words: 32
2024-05-04 04:39:35,309:INFO:   <<< n_display: 100
2024-05-04 04:39:35,309:INFO:   <<< n_gpu: 1
2024-05-04 04:39:35,309:INFO:   <<< n_pair: 1
2024-05-04 04:39:35,309:INFO:   <<< negative_weighting: 1
2024-05-04 04:39:35,309:INFO:   <<< num_thread_reader: 0
2024-05-04 04:39:35,309:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 04:39:35,310:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 04:39:35,310:INFO:   <<< rank: 0
2024-05-04 04:39:35,310:INFO:   <<< resume_model: None
2024-05-04 04:39:35,310:INFO:   <<< sampled_use_mil: False
2024-05-04 04:39:35,310:INFO:   <<< seed: 42
2024-05-04 04:39:35,310:INFO:   <<< sim_header: meanP
2024-05-04 04:39:35,310:INFO:   <<< slice_framepos: 2
2024-05-04 04:39:35,310:INFO:   <<< task_type: retrieval
2024-05-04 04:39:35,310:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 04:39:35,310:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 04:39:35,310:INFO:   <<< train_frame_order: 0
2024-05-04 04:39:35,310:INFO:   <<< use_mil: False
2024-05-04 04:39:35,310:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 04:39:35,310:INFO:   <<< video_dim: 1024
2024-05-04 04:39:35,310:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 04:39:35,310:INFO:   <<< warmup_proportion: 0.1
2024-05-04 04:39:35,310:INFO:   <<< world_size: 1
2024-05-04 04:39:35,311:INFO: device: cuda:0 n_gpu: 1
2024-05-04 04:39:35,459:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 04:39:35,932:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 04:39:35,933:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 04:39:35,933:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 04:39:35,933:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 04:39:35,933:WARNING: Test retrieval by loose type.
2024-05-04 04:39:35,934:WARNING: 	 embed_dim: 512
2024-05-04 04:39:35,934:WARNING: 	 image_resolution: 224
2024-05-04 04:39:35,934:WARNING: 	 vision_layers: 12
2024-05-04 04:39:35,934:WARNING: 	 vision_width: 768
2024-05-04 04:39:35,934:WARNING: 	 vision_patch_size: 32
2024-05-04 04:39:35,935:WARNING: 	 context_length: 77
2024-05-04 04:39:35,935:WARNING: 	 vocab_size: 49408
2024-05-04 04:39:35,935:WARNING: 	 transformer_width: 512
2024-05-04 04:39:35,935:WARNING: 	 transformer_heads: 8
2024-05-04 04:39:35,935:WARNING: 	 transformer_layers: 12
2024-05-04 04:39:35,935:WARNING: 		 linear_patch: 2d
2024-05-04 04:39:35,935:WARNING: 	 cut_top_layer: 0
2024-05-04 04:39:36,805:WARNING: 	 sim_header: meanP
2024-05-04 04:39:40,537:INFO: --------------------
2024-05-04 04:39:40,537:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 04:48:57,799:INFO: Effective parameters:
2024-05-04 04:48:57,799:INFO:   <<< batch_size: 1
2024-05-04 04:48:57,799:INFO:   <<< batch_size_val: 16
2024-05-04 04:48:57,800:INFO:   <<< cache_dir: 
2024-05-04 04:48:57,800:INFO:   <<< coef_lr: 0.001
2024-05-04 04:48:57,800:INFO:   <<< cross_model: cross-base
2024-05-04 04:48:57,800:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 04:48:57,800:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 04:48:57,800:INFO:   <<< datatype: msrvtt
2024-05-04 04:48:57,800:INFO:   <<< do_eval: True
2024-05-04 04:48:57,800:INFO:   <<< do_lower_case: False
2024-05-04 04:48:57,800:INFO:   <<< do_pretrain: False
2024-05-04 04:48:57,800:INFO:   <<< do_train: False
2024-05-04 04:48:57,800:INFO:   <<< epochs: 2
2024-05-04 04:48:57,800:INFO:   <<< eval_frame_order: 0
2024-05-04 04:48:57,800:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 04:48:57,800:INFO:   <<< feature_framerate: 1
2024-05-04 04:48:57,800:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 04:48:57,800:INFO:   <<< fp16: False
2024-05-04 04:48:57,800:INFO:   <<< fp16_opt_level: O1
2024-05-04 04:48:57,801:INFO:   <<< freeze_layer_num: 0
2024-05-04 04:48:57,801:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 04:48:57,801:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 04:48:57,801:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 04:48:57,801:INFO:   <<< linear_patch: 2d
2024-05-04 04:48:57,801:INFO:   <<< local_rank: 0
2024-05-04 04:48:57,801:INFO:   <<< loose_type: True
2024-05-04 04:48:57,801:INFO:   <<< lr: 0.0001
2024-05-04 04:48:57,801:INFO:   <<< lr_decay: 0.9
2024-05-04 04:48:57,801:INFO:   <<< margin: 0.1
2024-05-04 04:48:57,801:INFO:   <<< max_frames: 90
2024-05-04 04:48:57,801:INFO:   <<< max_words: 32
2024-05-04 04:48:57,801:INFO:   <<< n_display: 100
2024-05-04 04:48:57,801:INFO:   <<< n_gpu: 1
2024-05-04 04:48:57,801:INFO:   <<< n_pair: 1
2024-05-04 04:48:57,801:INFO:   <<< negative_weighting: 1
2024-05-04 04:48:57,801:INFO:   <<< num_thread_reader: 0
2024-05-04 04:48:57,801:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 04:48:57,802:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 04:48:57,802:INFO:   <<< rank: 0
2024-05-04 04:48:57,802:INFO:   <<< resume_model: None
2024-05-04 04:48:57,802:INFO:   <<< sampled_use_mil: False
2024-05-04 04:48:57,802:INFO:   <<< seed: 42
2024-05-04 04:48:57,802:INFO:   <<< sim_header: meanP
2024-05-04 04:48:57,802:INFO:   <<< slice_framepos: 2
2024-05-04 04:48:57,802:INFO:   <<< task_type: retrieval
2024-05-04 04:48:57,802:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 04:48:57,802:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 04:48:57,802:INFO:   <<< train_frame_order: 0
2024-05-04 04:48:57,802:INFO:   <<< use_mil: False
2024-05-04 04:48:57,802:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 04:48:57,802:INFO:   <<< video_dim: 1024
2024-05-04 04:48:57,802:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 04:48:57,802:INFO:   <<< warmup_proportion: 0.1
2024-05-04 04:48:57,802:INFO:   <<< world_size: 1
2024-05-04 04:48:57,803:INFO: device: cuda:0 n_gpu: 1
2024-05-04 04:48:57,955:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 04:48:58,446:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 04:48:58,447:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 04:48:58,447:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 04:48:58,447:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 04:48:58,448:WARNING: Test retrieval by loose type.
2024-05-04 04:48:58,449:WARNING: 	 embed_dim: 512
2024-05-04 04:48:58,449:WARNING: 	 image_resolution: 224
2024-05-04 04:48:58,449:WARNING: 	 vision_layers: 12
2024-05-04 04:48:58,449:WARNING: 	 vision_width: 768
2024-05-04 04:48:58,449:WARNING: 	 vision_patch_size: 32
2024-05-04 04:48:58,450:WARNING: 	 context_length: 77
2024-05-04 04:48:58,450:WARNING: 	 vocab_size: 49408
2024-05-04 04:48:58,450:WARNING: 	 transformer_width: 512
2024-05-04 04:48:58,450:WARNING: 	 transformer_heads: 8
2024-05-04 04:48:58,450:WARNING: 	 transformer_layers: 12
2024-05-04 04:48:58,450:WARNING: 		 linear_patch: 2d
2024-05-04 04:48:58,450:WARNING: 	 cut_top_layer: 0
2024-05-04 04:48:59,317:WARNING: 	 sim_header: meanP
2024-05-04 04:49:03,024:INFO: --------------------
2024-05-04 04:49:03,024:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 04:50:58,236:INFO: Effective parameters:
2024-05-04 04:50:58,237:INFO:   <<< batch_size: 1
2024-05-04 04:50:58,237:INFO:   <<< batch_size_val: 16
2024-05-04 04:50:58,237:INFO:   <<< cache_dir: 
2024-05-04 04:50:58,237:INFO:   <<< coef_lr: 0.001
2024-05-04 04:50:58,237:INFO:   <<< cross_model: cross-base
2024-05-04 04:50:58,237:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 04:50:58,237:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 04:50:58,237:INFO:   <<< datatype: msrvtt
2024-05-04 04:50:58,237:INFO:   <<< do_eval: True
2024-05-04 04:50:58,237:INFO:   <<< do_lower_case: False
2024-05-04 04:50:58,237:INFO:   <<< do_pretrain: False
2024-05-04 04:50:58,237:INFO:   <<< do_train: False
2024-05-04 04:50:58,237:INFO:   <<< epochs: 2
2024-05-04 04:50:58,237:INFO:   <<< eval_frame_order: 0
2024-05-04 04:50:58,237:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 04:50:58,237:INFO:   <<< feature_framerate: 1
2024-05-04 04:50:58,237:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 04:50:58,238:INFO:   <<< fp16: False
2024-05-04 04:50:58,238:INFO:   <<< fp16_opt_level: O1
2024-05-04 04:50:58,238:INFO:   <<< freeze_layer_num: 0
2024-05-04 04:50:58,238:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 04:50:58,238:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 04:50:58,238:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 04:50:58,238:INFO:   <<< linear_patch: 2d
2024-05-04 04:50:58,238:INFO:   <<< local_rank: 0
2024-05-04 04:50:58,238:INFO:   <<< loose_type: True
2024-05-04 04:50:58,238:INFO:   <<< lr: 0.0001
2024-05-04 04:50:58,238:INFO:   <<< lr_decay: 0.9
2024-05-04 04:50:58,238:INFO:   <<< margin: 0.1
2024-05-04 04:50:58,238:INFO:   <<< max_frames: 90
2024-05-04 04:50:58,238:INFO:   <<< max_words: 32
2024-05-04 04:50:58,238:INFO:   <<< n_display: 100
2024-05-04 04:50:58,238:INFO:   <<< n_gpu: 1
2024-05-04 04:50:58,238:INFO:   <<< n_pair: 1
2024-05-04 04:50:58,239:INFO:   <<< negative_weighting: 1
2024-05-04 04:50:58,239:INFO:   <<< num_thread_reader: 0
2024-05-04 04:50:58,239:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 04:50:58,239:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 04:50:58,239:INFO:   <<< rank: 0
2024-05-04 04:50:58,239:INFO:   <<< resume_model: None
2024-05-04 04:50:58,239:INFO:   <<< sampled_use_mil: False
2024-05-04 04:50:58,239:INFO:   <<< seed: 42
2024-05-04 04:50:58,239:INFO:   <<< sim_header: meanP
2024-05-04 04:50:58,239:INFO:   <<< slice_framepos: 2
2024-05-04 04:50:58,239:INFO:   <<< task_type: retrieval
2024-05-04 04:50:58,239:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 04:50:58,239:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 04:50:58,239:INFO:   <<< train_frame_order: 0
2024-05-04 04:50:58,239:INFO:   <<< use_mil: False
2024-05-04 04:50:58,239:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 04:50:58,239:INFO:   <<< video_dim: 1024
2024-05-04 04:50:58,240:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 04:50:58,240:INFO:   <<< warmup_proportion: 0.1
2024-05-04 04:50:58,240:INFO:   <<< world_size: 1
2024-05-04 04:50:58,240:INFO: device: cuda:0 n_gpu: 1
2024-05-04 04:50:58,390:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 04:50:58,877:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 04:50:58,878:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 04:50:58,879:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 04:50:58,879:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 04:50:58,879:WARNING: Test retrieval by loose type.
2024-05-04 04:50:58,880:WARNING: 	 embed_dim: 512
2024-05-04 04:50:58,880:WARNING: 	 image_resolution: 224
2024-05-04 04:50:58,880:WARNING: 	 vision_layers: 12
2024-05-04 04:50:58,880:WARNING: 	 vision_width: 768
2024-05-04 04:50:58,880:WARNING: 	 vision_patch_size: 32
2024-05-04 04:50:58,880:WARNING: 	 context_length: 77
2024-05-04 04:50:58,880:WARNING: 	 vocab_size: 49408
2024-05-04 04:50:58,880:WARNING: 	 transformer_width: 512
2024-05-04 04:50:58,881:WARNING: 	 transformer_heads: 8
2024-05-04 04:50:58,881:WARNING: 	 transformer_layers: 12
2024-05-04 04:50:58,881:WARNING: 		 linear_patch: 2d
2024-05-04 04:50:58,881:WARNING: 	 cut_top_layer: 0
2024-05-04 04:50:59,742:WARNING: 	 sim_header: meanP
2024-05-04 04:51:03,467:INFO: --------------------
2024-05-04 04:51:03,467:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 04:51:36,304:INFO: Effective parameters:
2024-05-04 04:51:36,305:INFO:   <<< batch_size: 1
2024-05-04 04:51:36,305:INFO:   <<< batch_size_val: 16
2024-05-04 04:51:36,305:INFO:   <<< cache_dir: 
2024-05-04 04:51:36,305:INFO:   <<< coef_lr: 0.001
2024-05-04 04:51:36,305:INFO:   <<< cross_model: cross-base
2024-05-04 04:51:36,305:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 04:51:36,305:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 04:51:36,305:INFO:   <<< datatype: msrvtt
2024-05-04 04:51:36,305:INFO:   <<< do_eval: True
2024-05-04 04:51:36,305:INFO:   <<< do_lower_case: False
2024-05-04 04:51:36,305:INFO:   <<< do_pretrain: False
2024-05-04 04:51:36,305:INFO:   <<< do_train: False
2024-05-04 04:51:36,305:INFO:   <<< epochs: 2
2024-05-04 04:51:36,305:INFO:   <<< eval_frame_order: 0
2024-05-04 04:51:36,306:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 04:51:36,306:INFO:   <<< feature_framerate: 1
2024-05-04 04:51:36,306:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 04:51:36,306:INFO:   <<< fp16: False
2024-05-04 04:51:36,306:INFO:   <<< fp16_opt_level: O1
2024-05-04 04:51:36,306:INFO:   <<< freeze_layer_num: 0
2024-05-04 04:51:36,306:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 04:51:36,306:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 04:51:36,306:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 04:51:36,306:INFO:   <<< linear_patch: 2d
2024-05-04 04:51:36,306:INFO:   <<< local_rank: 0
2024-05-04 04:51:36,306:INFO:   <<< loose_type: True
2024-05-04 04:51:36,306:INFO:   <<< lr: 0.0001
2024-05-04 04:51:36,306:INFO:   <<< lr_decay: 0.9
2024-05-04 04:51:36,306:INFO:   <<< margin: 0.1
2024-05-04 04:51:36,306:INFO:   <<< max_frames: 90
2024-05-04 04:51:36,306:INFO:   <<< max_words: 32
2024-05-04 04:51:36,307:INFO:   <<< n_display: 100
2024-05-04 04:51:36,307:INFO:   <<< n_gpu: 1
2024-05-04 04:51:36,307:INFO:   <<< n_pair: 1
2024-05-04 04:51:36,307:INFO:   <<< negative_weighting: 1
2024-05-04 04:51:36,307:INFO:   <<< num_thread_reader: 0
2024-05-04 04:51:36,307:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 04:51:36,307:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 04:51:36,307:INFO:   <<< rank: 0
2024-05-04 04:51:36,307:INFO:   <<< resume_model: None
2024-05-04 04:51:36,307:INFO:   <<< sampled_use_mil: False
2024-05-04 04:51:36,307:INFO:   <<< seed: 42
2024-05-04 04:51:36,307:INFO:   <<< sim_header: meanP
2024-05-04 04:51:36,307:INFO:   <<< slice_framepos: 2
2024-05-04 04:51:36,307:INFO:   <<< task_type: retrieval
2024-05-04 04:51:36,307:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 04:51:36,307:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 04:51:36,307:INFO:   <<< train_frame_order: 0
2024-05-04 04:51:36,308:INFO:   <<< use_mil: False
2024-05-04 04:51:36,308:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 04:51:36,308:INFO:   <<< video_dim: 1024
2024-05-04 04:51:36,308:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 04:51:36,308:INFO:   <<< warmup_proportion: 0.1
2024-05-04 04:51:36,308:INFO:   <<< world_size: 1
2024-05-04 04:51:36,308:INFO: device: cuda:0 n_gpu: 1
2024-05-04 04:51:36,459:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 04:51:36,950:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 04:51:36,951:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 04:51:36,951:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 04:51:36,951:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 04:51:36,952:WARNING: Test retrieval by loose type.
2024-05-04 04:51:36,953:WARNING: 	 embed_dim: 512
2024-05-04 04:51:36,953:WARNING: 	 image_resolution: 224
2024-05-04 04:51:36,953:WARNING: 	 vision_layers: 12
2024-05-04 04:51:36,953:WARNING: 	 vision_width: 768
2024-05-04 04:51:36,953:WARNING: 	 vision_patch_size: 32
2024-05-04 04:51:36,954:WARNING: 	 context_length: 77
2024-05-04 04:51:36,954:WARNING: 	 vocab_size: 49408
2024-05-04 04:51:36,954:WARNING: 	 transformer_width: 512
2024-05-04 04:51:36,954:WARNING: 	 transformer_heads: 8
2024-05-04 04:51:36,954:WARNING: 	 transformer_layers: 12
2024-05-04 04:51:36,954:WARNING: 		 linear_patch: 2d
2024-05-04 04:51:36,954:WARNING: 	 cut_top_layer: 0
2024-05-04 04:51:37,822:WARNING: 	 sim_header: meanP
2024-05-04 04:51:49,168:INFO: Effective parameters:
2024-05-04 04:51:49,168:INFO:   <<< batch_size: 1
2024-05-04 04:51:49,168:INFO:   <<< batch_size_val: 16
2024-05-04 04:51:49,168:INFO:   <<< cache_dir: 
2024-05-04 04:51:49,168:INFO:   <<< coef_lr: 0.001
2024-05-04 04:51:49,169:INFO:   <<< cross_model: cross-base
2024-05-04 04:51:49,169:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 04:51:49,169:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 04:51:49,169:INFO:   <<< datatype: msrvtt
2024-05-04 04:51:49,169:INFO:   <<< do_eval: True
2024-05-04 04:51:49,169:INFO:   <<< do_lower_case: False
2024-05-04 04:51:49,169:INFO:   <<< do_pretrain: False
2024-05-04 04:51:49,169:INFO:   <<< do_train: False
2024-05-04 04:51:49,169:INFO:   <<< epochs: 2
2024-05-04 04:51:49,169:INFO:   <<< eval_frame_order: 0
2024-05-04 04:51:49,169:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 04:51:49,169:INFO:   <<< feature_framerate: 1
2024-05-04 04:51:49,169:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 04:51:49,169:INFO:   <<< fp16: False
2024-05-04 04:51:49,169:INFO:   <<< fp16_opt_level: O1
2024-05-04 04:51:49,169:INFO:   <<< freeze_layer_num: 0
2024-05-04 04:51:49,169:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 04:51:49,170:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 04:51:49,170:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 04:51:49,170:INFO:   <<< linear_patch: 2d
2024-05-04 04:51:49,170:INFO:   <<< local_rank: 0
2024-05-04 04:51:49,170:INFO:   <<< loose_type: True
2024-05-04 04:51:49,170:INFO:   <<< lr: 0.0001
2024-05-04 04:51:49,170:INFO:   <<< lr_decay: 0.9
2024-05-04 04:51:49,170:INFO:   <<< margin: 0.1
2024-05-04 04:51:49,170:INFO:   <<< max_frames: 90
2024-05-04 04:51:49,170:INFO:   <<< max_words: 32
2024-05-04 04:51:49,170:INFO:   <<< n_display: 100
2024-05-04 04:51:49,170:INFO:   <<< n_gpu: 1
2024-05-04 04:51:49,170:INFO:   <<< n_pair: 1
2024-05-04 04:51:49,170:INFO:   <<< negative_weighting: 1
2024-05-04 04:51:49,170:INFO:   <<< num_thread_reader: 0
2024-05-04 04:51:49,170:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 04:51:49,170:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 04:51:49,171:INFO:   <<< rank: 0
2024-05-04 04:51:49,171:INFO:   <<< resume_model: None
2024-05-04 04:51:49,171:INFO:   <<< sampled_use_mil: False
2024-05-04 04:51:49,171:INFO:   <<< seed: 42
2024-05-04 04:51:49,171:INFO:   <<< sim_header: meanP
2024-05-04 04:51:49,171:INFO:   <<< slice_framepos: 2
2024-05-04 04:51:49,171:INFO:   <<< task_type: retrieval
2024-05-04 04:51:49,171:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 04:51:49,171:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 04:51:49,171:INFO:   <<< train_frame_order: 0
2024-05-04 04:51:49,171:INFO:   <<< use_mil: False
2024-05-04 04:51:49,171:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 04:51:49,171:INFO:   <<< video_dim: 1024
2024-05-04 04:51:49,171:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 04:51:49,171:INFO:   <<< warmup_proportion: 0.1
2024-05-04 04:51:49,171:INFO:   <<< world_size: 1
2024-05-04 04:51:49,171:INFO: device: cuda:0 n_gpu: 1
2024-05-04 04:51:49,311:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 04:51:49,784:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 04:51:49,784:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 04:51:49,785:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 04:51:49,785:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 04:51:49,785:WARNING: Test retrieval by loose type.
2024-05-04 04:51:49,786:WARNING: 	 embed_dim: 512
2024-05-04 04:51:49,786:WARNING: 	 image_resolution: 224
2024-05-04 04:51:49,786:WARNING: 	 vision_layers: 12
2024-05-04 04:51:49,786:WARNING: 	 vision_width: 768
2024-05-04 04:51:49,786:WARNING: 	 vision_patch_size: 32
2024-05-04 04:51:49,786:WARNING: 	 context_length: 77
2024-05-04 04:51:49,786:WARNING: 	 vocab_size: 49408
2024-05-04 04:51:49,786:WARNING: 	 transformer_width: 512
2024-05-04 04:51:49,786:WARNING: 	 transformer_heads: 8
2024-05-04 04:51:49,786:WARNING: 	 transformer_layers: 12
2024-05-04 04:51:49,786:WARNING: 		 linear_patch: 2d
2024-05-04 04:51:49,786:WARNING: 	 cut_top_layer: 0
2024-05-04 04:51:50,649:WARNING: 	 sim_header: meanP
2024-05-04 04:51:54,334:INFO: --------------------
2024-05-04 04:51:54,334:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 04:55:28,764:INFO: Effective parameters:
2024-05-04 04:55:28,764:INFO:   <<< batch_size: 1
2024-05-04 04:55:28,764:INFO:   <<< batch_size_val: 16
2024-05-04 04:55:28,765:INFO:   <<< cache_dir: 
2024-05-04 04:55:28,765:INFO:   <<< coef_lr: 0.001
2024-05-04 04:55:28,765:INFO:   <<< cross_model: cross-base
2024-05-04 04:55:28,765:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 04:55:28,765:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 04:55:28,765:INFO:   <<< datatype: msrvtt
2024-05-04 04:55:28,765:INFO:   <<< do_eval: True
2024-05-04 04:55:28,765:INFO:   <<< do_lower_case: False
2024-05-04 04:55:28,765:INFO:   <<< do_pretrain: False
2024-05-04 04:55:28,765:INFO:   <<< do_train: False
2024-05-04 04:55:28,765:INFO:   <<< epochs: 2
2024-05-04 04:55:28,765:INFO:   <<< eval_frame_order: 0
2024-05-04 04:55:28,765:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 04:55:28,765:INFO:   <<< feature_framerate: 1
2024-05-04 04:55:28,766:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 04:55:28,766:INFO:   <<< fp16: False
2024-05-04 04:55:28,766:INFO:   <<< fp16_opt_level: O1
2024-05-04 04:55:28,766:INFO:   <<< freeze_layer_num: 0
2024-05-04 04:55:28,766:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 04:55:28,766:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 04:55:28,766:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 04:55:28,766:INFO:   <<< linear_patch: 2d
2024-05-04 04:55:28,766:INFO:   <<< local_rank: 0
2024-05-04 04:55:28,766:INFO:   <<< loose_type: True
2024-05-04 04:55:28,766:INFO:   <<< lr: 0.0001
2024-05-04 04:55:28,766:INFO:   <<< lr_decay: 0.9
2024-05-04 04:55:28,766:INFO:   <<< margin: 0.1
2024-05-04 04:55:28,766:INFO:   <<< max_frames: 90
2024-05-04 04:55:28,766:INFO:   <<< max_words: 32
2024-05-04 04:55:28,767:INFO:   <<< n_display: 100
2024-05-04 04:55:28,767:INFO:   <<< n_gpu: 1
2024-05-04 04:55:28,767:INFO:   <<< n_pair: 1
2024-05-04 04:55:28,767:INFO:   <<< negative_weighting: 1
2024-05-04 04:55:28,767:INFO:   <<< num_thread_reader: 0
2024-05-04 04:55:28,767:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 04:55:28,767:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 04:55:28,767:INFO:   <<< rank: 0
2024-05-04 04:55:28,767:INFO:   <<< resume_model: None
2024-05-04 04:55:28,767:INFO:   <<< sampled_use_mil: False
2024-05-04 04:55:28,767:INFO:   <<< seed: 42
2024-05-04 04:55:28,767:INFO:   <<< sim_header: meanP
2024-05-04 04:55:28,767:INFO:   <<< slice_framepos: 2
2024-05-04 04:55:28,767:INFO:   <<< task_type: retrieval
2024-05-04 04:55:28,767:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 04:55:28,767:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 04:55:28,768:INFO:   <<< train_frame_order: 0
2024-05-04 04:55:28,768:INFO:   <<< use_mil: False
2024-05-04 04:55:28,768:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 04:55:28,768:INFO:   <<< video_dim: 1024
2024-05-04 04:55:28,768:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 04:55:28,768:INFO:   <<< warmup_proportion: 0.1
2024-05-04 04:55:28,768:INFO:   <<< world_size: 1
2024-05-04 04:55:28,768:INFO: device: cuda:0 n_gpu: 1
2024-05-04 04:55:28,919:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 04:55:29,405:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 04:55:29,406:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 04:55:29,406:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 04:55:29,406:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 04:55:29,407:WARNING: Test retrieval by loose type.
2024-05-04 04:55:29,407:WARNING: 	 embed_dim: 512
2024-05-04 04:55:29,407:WARNING: 	 image_resolution: 224
2024-05-04 04:55:29,408:WARNING: 	 vision_layers: 12
2024-05-04 04:55:29,408:WARNING: 	 vision_width: 768
2024-05-04 04:55:29,408:WARNING: 	 vision_patch_size: 32
2024-05-04 04:55:29,408:WARNING: 	 context_length: 77
2024-05-04 04:55:29,408:WARNING: 	 vocab_size: 49408
2024-05-04 04:55:29,408:WARNING: 	 transformer_width: 512
2024-05-04 04:55:29,408:WARNING: 	 transformer_heads: 8
2024-05-04 04:55:29,408:WARNING: 	 transformer_layers: 12
2024-05-04 04:55:29,408:WARNING: 		 linear_patch: 2d
2024-05-04 04:55:29,408:WARNING: 	 cut_top_layer: 0
2024-05-04 04:55:30,289:WARNING: 	 sim_header: meanP
2024-05-04 04:55:34,012:INFO: --------------------
2024-05-04 04:55:34,012:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 04:56:28,260:INFO: Effective parameters:
2024-05-04 04:56:28,260:INFO:   <<< batch_size: 1
2024-05-04 04:56:28,260:INFO:   <<< batch_size_val: 16
2024-05-04 04:56:28,260:INFO:   <<< cache_dir: 
2024-05-04 04:56:28,261:INFO:   <<< coef_lr: 0.001
2024-05-04 04:56:28,261:INFO:   <<< cross_model: cross-base
2024-05-04 04:56:28,261:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 04:56:28,261:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 04:56:28,261:INFO:   <<< datatype: msrvtt
2024-05-04 04:56:28,261:INFO:   <<< do_eval: True
2024-05-04 04:56:28,261:INFO:   <<< do_lower_case: False
2024-05-04 04:56:28,261:INFO:   <<< do_pretrain: False
2024-05-04 04:56:28,261:INFO:   <<< do_train: False
2024-05-04 04:56:28,261:INFO:   <<< epochs: 2
2024-05-04 04:56:28,261:INFO:   <<< eval_frame_order: 0
2024-05-04 04:56:28,261:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 04:56:28,261:INFO:   <<< feature_framerate: 1
2024-05-04 04:56:28,261:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 04:56:28,261:INFO:   <<< fp16: False
2024-05-04 04:56:28,261:INFO:   <<< fp16_opt_level: O1
2024-05-04 04:56:28,262:INFO:   <<< freeze_layer_num: 0
2024-05-04 04:56:28,262:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 04:56:28,262:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 04:56:28,262:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 04:56:28,262:INFO:   <<< linear_patch: 2d
2024-05-04 04:56:28,262:INFO:   <<< local_rank: 0
2024-05-04 04:56:28,262:INFO:   <<< loose_type: True
2024-05-04 04:56:28,262:INFO:   <<< lr: 0.0001
2024-05-04 04:56:28,262:INFO:   <<< lr_decay: 0.9
2024-05-04 04:56:28,262:INFO:   <<< margin: 0.1
2024-05-04 04:56:28,262:INFO:   <<< max_frames: 90
2024-05-04 04:56:28,262:INFO:   <<< max_words: 32
2024-05-04 04:56:28,262:INFO:   <<< n_display: 100
2024-05-04 04:56:28,262:INFO:   <<< n_gpu: 1
2024-05-04 04:56:28,262:INFO:   <<< n_pair: 1
2024-05-04 04:56:28,262:INFO:   <<< negative_weighting: 1
2024-05-04 04:56:28,262:INFO:   <<< num_thread_reader: 0
2024-05-04 04:56:28,262:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 04:56:28,263:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 04:56:28,263:INFO:   <<< rank: 0
2024-05-04 04:56:28,263:INFO:   <<< resume_model: None
2024-05-04 04:56:28,263:INFO:   <<< sampled_use_mil: False
2024-05-04 04:56:28,263:INFO:   <<< seed: 42
2024-05-04 04:56:28,263:INFO:   <<< sim_header: meanP
2024-05-04 04:56:28,263:INFO:   <<< slice_framepos: 2
2024-05-04 04:56:28,263:INFO:   <<< task_type: retrieval
2024-05-04 04:56:28,263:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 04:56:28,263:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 04:56:28,263:INFO:   <<< train_frame_order: 0
2024-05-04 04:56:28,263:INFO:   <<< use_mil: False
2024-05-04 04:56:28,263:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 04:56:28,263:INFO:   <<< video_dim: 1024
2024-05-04 04:56:28,263:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 04:56:28,263:INFO:   <<< warmup_proportion: 0.1
2024-05-04 04:56:28,263:INFO:   <<< world_size: 1
2024-05-04 04:56:28,264:INFO: device: cuda:0 n_gpu: 1
2024-05-04 04:56:28,414:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 04:56:28,901:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 04:56:28,902:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 04:56:28,902:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 04:56:28,903:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 04:56:28,903:WARNING: Test retrieval by loose type.
2024-05-04 04:56:28,904:WARNING: 	 embed_dim: 512
2024-05-04 04:56:28,904:WARNING: 	 image_resolution: 224
2024-05-04 04:56:28,904:WARNING: 	 vision_layers: 12
2024-05-04 04:56:28,904:WARNING: 	 vision_width: 768
2024-05-04 04:56:28,904:WARNING: 	 vision_patch_size: 32
2024-05-04 04:56:28,904:WARNING: 	 context_length: 77
2024-05-04 04:56:28,904:WARNING: 	 vocab_size: 49408
2024-05-04 04:56:28,904:WARNING: 	 transformer_width: 512
2024-05-04 04:56:28,904:WARNING: 	 transformer_heads: 8
2024-05-04 04:56:28,904:WARNING: 	 transformer_layers: 12
2024-05-04 04:56:28,904:WARNING: 		 linear_patch: 2d
2024-05-04 04:56:28,904:WARNING: 	 cut_top_layer: 0
2024-05-04 04:56:29,760:WARNING: 	 sim_header: meanP
2024-05-04 04:56:33,468:INFO: --------------------
2024-05-04 04:56:33,468:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 05:05:14,452:INFO: Effective parameters:
2024-05-04 05:05:14,453:INFO:   <<< batch_size: 1
2024-05-04 05:05:14,453:INFO:   <<< batch_size_val: 16
2024-05-04 05:05:14,453:INFO:   <<< cache_dir: 
2024-05-04 05:05:14,453:INFO:   <<< coef_lr: 0.001
2024-05-04 05:05:14,453:INFO:   <<< cross_model: cross-base
2024-05-04 05:05:14,453:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 05:05:14,453:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 05:05:14,453:INFO:   <<< datatype: msrvtt
2024-05-04 05:05:14,453:INFO:   <<< do_eval: True
2024-05-04 05:05:14,453:INFO:   <<< do_lower_case: False
2024-05-04 05:05:14,453:INFO:   <<< do_pretrain: False
2024-05-04 05:05:14,453:INFO:   <<< do_train: False
2024-05-04 05:05:14,453:INFO:   <<< epochs: 2
2024-05-04 05:05:14,453:INFO:   <<< eval_frame_order: 0
2024-05-04 05:05:14,454:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 05:05:14,454:INFO:   <<< feature_framerate: 1
2024-05-04 05:05:14,454:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 05:05:14,454:INFO:   <<< fp16: False
2024-05-04 05:05:14,454:INFO:   <<< fp16_opt_level: O1
2024-05-04 05:05:14,454:INFO:   <<< freeze_layer_num: 0
2024-05-04 05:05:14,454:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 05:05:14,454:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 05:05:14,454:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 05:05:14,454:INFO:   <<< linear_patch: 2d
2024-05-04 05:05:14,454:INFO:   <<< local_rank: 0
2024-05-04 05:05:14,454:INFO:   <<< loose_type: True
2024-05-04 05:05:14,454:INFO:   <<< lr: 0.0001
2024-05-04 05:05:14,454:INFO:   <<< lr_decay: 0.9
2024-05-04 05:05:14,454:INFO:   <<< margin: 0.1
2024-05-04 05:05:14,454:INFO:   <<< max_frames: 90
2024-05-04 05:05:14,455:INFO:   <<< max_words: 32
2024-05-04 05:05:14,455:INFO:   <<< n_display: 100
2024-05-04 05:05:14,455:INFO:   <<< n_gpu: 1
2024-05-04 05:05:14,455:INFO:   <<< n_pair: 1
2024-05-04 05:05:14,455:INFO:   <<< negative_weighting: 1
2024-05-04 05:05:14,455:INFO:   <<< num_thread_reader: 0
2024-05-04 05:05:14,455:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 05:05:14,455:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 05:05:14,455:INFO:   <<< rank: 0
2024-05-04 05:05:14,455:INFO:   <<< resume_model: None
2024-05-04 05:05:14,455:INFO:   <<< sampled_use_mil: False
2024-05-04 05:05:14,455:INFO:   <<< seed: 42
2024-05-04 05:05:14,455:INFO:   <<< sim_header: meanP
2024-05-04 05:05:14,455:INFO:   <<< slice_framepos: 2
2024-05-04 05:05:14,455:INFO:   <<< task_type: retrieval
2024-05-04 05:05:14,455:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 05:05:14,455:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 05:05:14,456:INFO:   <<< train_frame_order: 0
2024-05-04 05:05:14,456:INFO:   <<< use_mil: False
2024-05-04 05:05:14,456:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 05:05:14,456:INFO:   <<< video_dim: 1024
2024-05-04 05:05:14,456:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 05:05:14,456:INFO:   <<< warmup_proportion: 0.1
2024-05-04 05:05:14,456:INFO:   <<< world_size: 1
2024-05-04 05:05:14,456:INFO: device: cuda:0 n_gpu: 1
2024-05-04 05:05:14,602:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 05:05:15,105:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 05:05:15,106:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 05:05:15,106:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 05:05:15,107:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 05:05:15,107:WARNING: Test retrieval by loose type.
2024-05-04 05:05:15,108:WARNING: 	 embed_dim: 512
2024-05-04 05:05:15,108:WARNING: 	 image_resolution: 224
2024-05-04 05:05:15,108:WARNING: 	 vision_layers: 12
2024-05-04 05:05:15,108:WARNING: 	 vision_width: 768
2024-05-04 05:05:15,108:WARNING: 	 vision_patch_size: 32
2024-05-04 05:05:15,108:WARNING: 	 context_length: 77
2024-05-04 05:05:15,109:WARNING: 	 vocab_size: 49408
2024-05-04 05:05:15,109:WARNING: 	 transformer_width: 512
2024-05-04 05:05:15,109:WARNING: 	 transformer_heads: 8
2024-05-04 05:05:15,109:WARNING: 	 transformer_layers: 12
2024-05-04 05:05:15,109:WARNING: 		 linear_patch: 2d
2024-05-04 05:05:15,109:WARNING: 	 cut_top_layer: 0
2024-05-04 05:05:15,975:WARNING: 	 sim_header: meanP
2024-05-04 05:05:19,714:INFO: --------------------
2024-05-04 05:05:19,714:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 05:08:31,434:INFO: Effective parameters:
2024-05-04 05:08:31,435:INFO:   <<< batch_size: 1
2024-05-04 05:08:31,435:INFO:   <<< batch_size_val: 16
2024-05-04 05:08:31,435:INFO:   <<< cache_dir: 
2024-05-04 05:08:31,435:INFO:   <<< coef_lr: 0.001
2024-05-04 05:08:31,435:INFO:   <<< cross_model: cross-base
2024-05-04 05:08:31,435:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 05:08:31,435:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 05:08:31,435:INFO:   <<< datatype: msrvtt
2024-05-04 05:08:31,435:INFO:   <<< do_eval: True
2024-05-04 05:08:31,435:INFO:   <<< do_lower_case: False
2024-05-04 05:08:31,435:INFO:   <<< do_pretrain: False
2024-05-04 05:08:31,435:INFO:   <<< do_train: False
2024-05-04 05:08:31,435:INFO:   <<< epochs: 2
2024-05-04 05:08:31,435:INFO:   <<< eval_frame_order: 0
2024-05-04 05:08:31,436:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 05:08:31,436:INFO:   <<< feature_framerate: 1
2024-05-04 05:08:31,436:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 05:08:31,436:INFO:   <<< fp16: False
2024-05-04 05:08:31,436:INFO:   <<< fp16_opt_level: O1
2024-05-04 05:08:31,436:INFO:   <<< freeze_layer_num: 0
2024-05-04 05:08:31,436:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 05:08:31,436:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 05:08:31,436:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 05:08:31,436:INFO:   <<< linear_patch: 2d
2024-05-04 05:08:31,436:INFO:   <<< local_rank: 0
2024-05-04 05:08:31,436:INFO:   <<< loose_type: True
2024-05-04 05:08:31,436:INFO:   <<< lr: 0.0001
2024-05-04 05:08:31,436:INFO:   <<< lr_decay: 0.9
2024-05-04 05:08:31,436:INFO:   <<< margin: 0.1
2024-05-04 05:08:31,436:INFO:   <<< max_frames: 90
2024-05-04 05:08:31,436:INFO:   <<< max_words: 32
2024-05-04 05:08:31,437:INFO:   <<< n_display: 100
2024-05-04 05:08:31,437:INFO:   <<< n_gpu: 1
2024-05-04 05:08:31,437:INFO:   <<< n_pair: 1
2024-05-04 05:08:31,437:INFO:   <<< negative_weighting: 1
2024-05-04 05:08:31,437:INFO:   <<< num_thread_reader: 0
2024-05-04 05:08:31,437:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 05:08:31,437:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 05:08:31,437:INFO:   <<< rank: 0
2024-05-04 05:08:31,437:INFO:   <<< resume_model: None
2024-05-04 05:08:31,437:INFO:   <<< sampled_use_mil: False
2024-05-04 05:08:31,437:INFO:   <<< seed: 42
2024-05-04 05:08:31,437:INFO:   <<< sim_header: meanP
2024-05-04 05:08:31,437:INFO:   <<< slice_framepos: 2
2024-05-04 05:08:31,437:INFO:   <<< task_type: retrieval
2024-05-04 05:08:31,437:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 05:08:31,437:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 05:08:31,437:INFO:   <<< train_frame_order: 0
2024-05-04 05:08:31,438:INFO:   <<< use_mil: False
2024-05-04 05:08:31,438:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 05:08:31,438:INFO:   <<< video_dim: 1024
2024-05-04 05:08:31,438:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 05:08:31,438:INFO:   <<< warmup_proportion: 0.1
2024-05-04 05:08:31,438:INFO:   <<< world_size: 1
2024-05-04 05:08:31,438:INFO: device: cuda:0 n_gpu: 1
2024-05-04 05:08:31,579:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 05:08:32,077:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 05:08:32,079:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 05:08:32,079:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 05:08:32,080:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 05:08:32,080:WARNING: Test retrieval by loose type.
2024-05-04 05:08:32,081:WARNING: 	 embed_dim: 512
2024-05-04 05:08:32,081:WARNING: 	 image_resolution: 224
2024-05-04 05:08:32,081:WARNING: 	 vision_layers: 12
2024-05-04 05:08:32,081:WARNING: 	 vision_width: 768
2024-05-04 05:08:32,082:WARNING: 	 vision_patch_size: 32
2024-05-04 05:08:32,082:WARNING: 	 context_length: 77
2024-05-04 05:08:32,082:WARNING: 	 vocab_size: 49408
2024-05-04 05:08:32,082:WARNING: 	 transformer_width: 512
2024-05-04 05:08:32,082:WARNING: 	 transformer_heads: 8
2024-05-04 05:08:32,082:WARNING: 	 transformer_layers: 12
2024-05-04 05:08:32,082:WARNING: 		 linear_patch: 2d
2024-05-04 05:08:32,082:WARNING: 	 cut_top_layer: 0
2024-05-04 05:08:32,943:WARNING: 	 sim_header: meanP
2024-05-04 05:08:36,661:INFO: --------------------
2024-05-04 05:08:36,661:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 05:13:39,773:INFO: Effective parameters:
2024-05-04 05:13:39,773:INFO:   <<< batch_size: 1
2024-05-04 05:13:39,773:INFO:   <<< batch_size_val: 16
2024-05-04 05:13:39,773:INFO:   <<< cache_dir: 
2024-05-04 05:13:39,773:INFO:   <<< coef_lr: 0.001
2024-05-04 05:13:39,773:INFO:   <<< cross_model: cross-base
2024-05-04 05:13:39,773:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 05:13:39,773:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 05:13:39,773:INFO:   <<< datatype: msrvtt
2024-05-04 05:13:39,773:INFO:   <<< do_eval: True
2024-05-04 05:13:39,773:INFO:   <<< do_lower_case: False
2024-05-04 05:13:39,773:INFO:   <<< do_pretrain: False
2024-05-04 05:13:39,773:INFO:   <<< do_train: False
2024-05-04 05:13:39,773:INFO:   <<< epochs: 2
2024-05-04 05:13:39,773:INFO:   <<< eval_frame_order: 0
2024-05-04 05:13:39,773:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 05:13:39,773:INFO:   <<< feature_framerate: 1
2024-05-04 05:13:39,773:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 05:13:39,773:INFO:   <<< fp16: False
2024-05-04 05:13:39,773:INFO:   <<< fp16_opt_level: O1
2024-05-04 05:13:39,773:INFO:   <<< freeze_layer_num: 0
2024-05-04 05:13:39,773:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 05:13:39,773:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 05:13:39,773:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 05:13:39,773:INFO:   <<< linear_patch: 2d
2024-05-04 05:13:39,773:INFO:   <<< local_rank: 0
2024-05-04 05:13:39,773:INFO:   <<< loose_type: True
2024-05-04 05:13:39,773:INFO:   <<< lr: 0.0001
2024-05-04 05:13:39,773:INFO:   <<< lr_decay: 0.9
2024-05-04 05:13:39,773:INFO:   <<< margin: 0.1
2024-05-04 05:13:39,773:INFO:   <<< max_frames: 90
2024-05-04 05:13:39,773:INFO:   <<< max_words: 32
2024-05-04 05:13:39,773:INFO:   <<< n_display: 100
2024-05-04 05:13:39,773:INFO:   <<< n_gpu: 1
2024-05-04 05:13:39,773:INFO:   <<< n_pair: 1
2024-05-04 05:13:39,773:INFO:   <<< negative_weighting: 1
2024-05-04 05:13:39,773:INFO:   <<< num_thread_reader: 0
2024-05-04 05:13:39,773:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 05:13:39,773:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 05:13:39,773:INFO:   <<< rank: 0
2024-05-04 05:13:39,773:INFO:   <<< resume_model: None
2024-05-04 05:13:39,773:INFO:   <<< sampled_use_mil: False
2024-05-04 05:13:39,774:INFO:   <<< seed: 42
2024-05-04 05:13:39,774:INFO:   <<< sim_header: meanP
2024-05-04 05:13:39,774:INFO:   <<< slice_framepos: 2
2024-05-04 05:13:39,774:INFO:   <<< task_type: retrieval
2024-05-04 05:13:39,774:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 05:13:39,774:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 05:13:39,774:INFO:   <<< train_frame_order: 0
2024-05-04 05:13:39,774:INFO:   <<< use_mil: False
2024-05-04 05:13:39,774:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 05:13:39,774:INFO:   <<< video_dim: 1024
2024-05-04 05:13:39,774:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 05:13:39,774:INFO:   <<< warmup_proportion: 0.1
2024-05-04 05:13:39,774:INFO:   <<< world_size: 1
2024-05-04 05:13:39,774:INFO: device: cuda:0 n_gpu: 1
2024-05-04 05:13:39,920:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 05:13:40,381:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 05:13:40,381:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 05:13:40,381:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 05:13:40,381:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 05:13:40,382:WARNING: Test retrieval by loose type.
2024-05-04 05:13:40,382:WARNING: 	 embed_dim: 512
2024-05-04 05:13:40,382:WARNING: 	 image_resolution: 224
2024-05-04 05:13:40,382:WARNING: 	 vision_layers: 12
2024-05-04 05:13:40,382:WARNING: 	 vision_width: 768
2024-05-04 05:13:40,382:WARNING: 	 vision_patch_size: 32
2024-05-04 05:13:40,382:WARNING: 	 context_length: 77
2024-05-04 05:13:40,382:WARNING: 	 vocab_size: 49408
2024-05-04 05:13:40,382:WARNING: 	 transformer_width: 512
2024-05-04 05:13:40,382:WARNING: 	 transformer_heads: 8
2024-05-04 05:13:40,382:WARNING: 	 transformer_layers: 12
2024-05-04 05:13:40,382:WARNING: 		 linear_patch: 2d
2024-05-04 05:13:40,382:WARNING: 	 cut_top_layer: 0
2024-05-04 05:13:41,220:WARNING: 	 sim_header: meanP
2024-05-04 05:13:44,928:INFO: --------------------
2024-05-04 05:13:44,928:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 05:14:37,393:INFO: Effective parameters:
2024-05-04 05:14:37,393:INFO:   <<< batch_size: 1
2024-05-04 05:14:37,393:INFO:   <<< batch_size_val: 16
2024-05-04 05:14:37,393:INFO:   <<< cache_dir: 
2024-05-04 05:14:37,393:INFO:   <<< coef_lr: 0.001
2024-05-04 05:14:37,393:INFO:   <<< cross_model: cross-base
2024-05-04 05:14:37,393:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 05:14:37,393:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 05:14:37,393:INFO:   <<< datatype: msrvtt
2024-05-04 05:14:37,393:INFO:   <<< do_eval: True
2024-05-04 05:14:37,393:INFO:   <<< do_lower_case: False
2024-05-04 05:14:37,394:INFO:   <<< do_pretrain: False
2024-05-04 05:14:37,394:INFO:   <<< do_train: False
2024-05-04 05:14:37,394:INFO:   <<< epochs: 2
2024-05-04 05:14:37,394:INFO:   <<< eval_frame_order: 0
2024-05-04 05:14:37,394:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 05:14:37,394:INFO:   <<< feature_framerate: 1
2024-05-04 05:14:37,394:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 05:14:37,394:INFO:   <<< fp16: False
2024-05-04 05:14:37,394:INFO:   <<< fp16_opt_level: O1
2024-05-04 05:14:37,394:INFO:   <<< freeze_layer_num: 0
2024-05-04 05:14:37,394:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 05:14:37,394:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 05:14:37,394:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 05:14:37,394:INFO:   <<< linear_patch: 2d
2024-05-04 05:14:37,394:INFO:   <<< local_rank: 0
2024-05-04 05:14:37,394:INFO:   <<< loose_type: True
2024-05-04 05:14:37,394:INFO:   <<< lr: 0.0001
2024-05-04 05:14:37,394:INFO:   <<< lr_decay: 0.9
2024-05-04 05:14:37,394:INFO:   <<< margin: 0.1
2024-05-04 05:14:37,394:INFO:   <<< max_frames: 90
2024-05-04 05:14:37,394:INFO:   <<< max_words: 32
2024-05-04 05:14:37,394:INFO:   <<< n_display: 100
2024-05-04 05:14:37,394:INFO:   <<< n_gpu: 1
2024-05-04 05:14:37,394:INFO:   <<< n_pair: 1
2024-05-04 05:14:37,394:INFO:   <<< negative_weighting: 1
2024-05-04 05:14:37,394:INFO:   <<< num_thread_reader: 0
2024-05-04 05:14:37,394:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 05:14:37,394:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 05:14:37,394:INFO:   <<< rank: 0
2024-05-04 05:14:37,394:INFO:   <<< resume_model: None
2024-05-04 05:14:37,394:INFO:   <<< sampled_use_mil: False
2024-05-04 05:14:37,394:INFO:   <<< seed: 42
2024-05-04 05:14:37,394:INFO:   <<< sim_header: meanP
2024-05-04 05:14:37,395:INFO:   <<< slice_framepos: 2
2024-05-04 05:14:37,395:INFO:   <<< task_type: retrieval
2024-05-04 05:14:37,395:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 05:14:37,395:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 05:14:37,395:INFO:   <<< train_frame_order: 0
2024-05-04 05:14:37,395:INFO:   <<< use_mil: False
2024-05-04 05:14:37,395:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 05:14:37,395:INFO:   <<< video_dim: 1024
2024-05-04 05:14:37,395:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 05:14:37,395:INFO:   <<< warmup_proportion: 0.1
2024-05-04 05:14:37,395:INFO:   <<< world_size: 1
2024-05-04 05:14:37,395:INFO: device: cuda:0 n_gpu: 1
2024-05-04 05:14:37,541:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 05:14:38,005:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 05:14:38,006:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 05:14:38,006:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 05:14:38,006:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 05:14:38,006:WARNING: Test retrieval by loose type.
2024-05-04 05:14:38,006:WARNING: 	 embed_dim: 512
2024-05-04 05:14:38,006:WARNING: 	 image_resolution: 224
2024-05-04 05:14:38,006:WARNING: 	 vision_layers: 12
2024-05-04 05:14:38,006:WARNING: 	 vision_width: 768
2024-05-04 05:14:38,006:WARNING: 	 vision_patch_size: 32
2024-05-04 05:14:38,006:WARNING: 	 context_length: 77
2024-05-04 05:14:38,006:WARNING: 	 vocab_size: 49408
2024-05-04 05:14:38,006:WARNING: 	 transformer_width: 512
2024-05-04 05:14:38,006:WARNING: 	 transformer_heads: 8
2024-05-04 05:14:38,006:WARNING: 	 transformer_layers: 12
2024-05-04 05:14:38,006:WARNING: 		 linear_patch: 2d
2024-05-04 05:14:38,006:WARNING: 	 cut_top_layer: 0
2024-05-04 05:14:38,852:WARNING: 	 sim_header: meanP
2024-05-04 05:14:42,557:INFO: --------------------
2024-05-04 05:14:42,558:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 05:18:31,022:INFO: Effective parameters:
2024-05-04 05:18:31,022:INFO:   <<< batch_size: 1
2024-05-04 05:18:31,022:INFO:   <<< batch_size_val: 16
2024-05-04 05:18:31,022:INFO:   <<< cache_dir: 
2024-05-04 05:18:31,022:INFO:   <<< coef_lr: 0.001
2024-05-04 05:18:31,022:INFO:   <<< cross_model: cross-base
2024-05-04 05:18:31,022:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 05:18:31,022:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 05:18:31,022:INFO:   <<< datatype: msrvtt
2024-05-04 05:18:31,022:INFO:   <<< do_eval: True
2024-05-04 05:18:31,022:INFO:   <<< do_lower_case: False
2024-05-04 05:18:31,022:INFO:   <<< do_pretrain: False
2024-05-04 05:18:31,022:INFO:   <<< do_train: False
2024-05-04 05:18:31,022:INFO:   <<< epochs: 2
2024-05-04 05:18:31,022:INFO:   <<< eval_frame_order: 0
2024-05-04 05:18:31,022:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 05:18:31,022:INFO:   <<< feature_framerate: 1
2024-05-04 05:18:31,022:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 05:18:31,022:INFO:   <<< fp16: False
2024-05-04 05:18:31,022:INFO:   <<< fp16_opt_level: O1
2024-05-04 05:18:31,022:INFO:   <<< freeze_layer_num: 0
2024-05-04 05:18:31,022:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 05:18:31,022:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 05:18:31,022:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 05:18:31,022:INFO:   <<< linear_patch: 2d
2024-05-04 05:18:31,022:INFO:   <<< local_rank: 0
2024-05-04 05:18:31,022:INFO:   <<< loose_type: True
2024-05-04 05:18:31,022:INFO:   <<< lr: 0.0001
2024-05-04 05:18:31,022:INFO:   <<< lr_decay: 0.9
2024-05-04 05:18:31,022:INFO:   <<< margin: 0.1
2024-05-04 05:18:31,022:INFO:   <<< max_frames: 90
2024-05-04 05:18:31,022:INFO:   <<< max_words: 32
2024-05-04 05:18:31,022:INFO:   <<< n_display: 100
2024-05-04 05:18:31,022:INFO:   <<< n_gpu: 1
2024-05-04 05:18:31,022:INFO:   <<< n_pair: 1
2024-05-04 05:18:31,022:INFO:   <<< negative_weighting: 1
2024-05-04 05:18:31,022:INFO:   <<< num_thread_reader: 0
2024-05-04 05:18:31,022:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 05:18:31,023:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 05:18:31,023:INFO:   <<< rank: 0
2024-05-04 05:18:31,023:INFO:   <<< resume_model: None
2024-05-04 05:18:31,023:INFO:   <<< sampled_use_mil: False
2024-05-04 05:18:31,023:INFO:   <<< seed: 42
2024-05-04 05:18:31,023:INFO:   <<< sim_header: meanP
2024-05-04 05:18:31,023:INFO:   <<< slice_framepos: 2
2024-05-04 05:18:31,023:INFO:   <<< task_type: retrieval
2024-05-04 05:18:31,023:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 05:18:31,023:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 05:18:31,023:INFO:   <<< train_frame_order: 0
2024-05-04 05:18:31,023:INFO:   <<< use_mil: False
2024-05-04 05:18:31,023:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 05:18:31,023:INFO:   <<< video_dim: 1024
2024-05-04 05:18:31,023:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 05:18:31,023:INFO:   <<< warmup_proportion: 0.1
2024-05-04 05:18:31,023:INFO:   <<< world_size: 1
2024-05-04 05:18:31,023:INFO: device: cuda:0 n_gpu: 1
2024-05-04 05:18:31,171:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 05:18:31,641:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 05:18:31,642:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 05:18:31,642:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 05:18:31,642:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 05:18:31,642:WARNING: Test retrieval by loose type.
2024-05-04 05:18:31,642:WARNING: 	 embed_dim: 512
2024-05-04 05:18:31,642:WARNING: 	 image_resolution: 224
2024-05-04 05:18:31,642:WARNING: 	 vision_layers: 12
2024-05-04 05:18:31,642:WARNING: 	 vision_width: 768
2024-05-04 05:18:31,642:WARNING: 	 vision_patch_size: 32
2024-05-04 05:18:31,642:WARNING: 	 context_length: 77
2024-05-04 05:18:31,642:WARNING: 	 vocab_size: 49408
2024-05-04 05:18:31,642:WARNING: 	 transformer_width: 512
2024-05-04 05:18:31,642:WARNING: 	 transformer_heads: 8
2024-05-04 05:18:31,642:WARNING: 	 transformer_layers: 12
2024-05-04 05:18:31,643:WARNING: 		 linear_patch: 2d
2024-05-04 05:18:31,643:WARNING: 	 cut_top_layer: 0
2024-05-04 05:18:32,491:WARNING: 	 sim_header: meanP
2024-05-04 05:18:36,184:INFO: --------------------
2024-05-04 05:18:36,184:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 05:19:31,004:INFO: Effective parameters:
2024-05-04 05:19:31,004:INFO:   <<< batch_size: 1
2024-05-04 05:19:31,004:INFO:   <<< batch_size_val: 16
2024-05-04 05:19:31,004:INFO:   <<< cache_dir: 
2024-05-04 05:19:31,004:INFO:   <<< coef_lr: 0.001
2024-05-04 05:19:31,004:INFO:   <<< cross_model: cross-base
2024-05-04 05:19:31,004:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 05:19:31,004:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 05:19:31,004:INFO:   <<< datatype: msrvtt
2024-05-04 05:19:31,004:INFO:   <<< do_eval: True
2024-05-04 05:19:31,004:INFO:   <<< do_lower_case: False
2024-05-04 05:19:31,004:INFO:   <<< do_pretrain: False
2024-05-04 05:19:31,004:INFO:   <<< do_train: False
2024-05-04 05:19:31,004:INFO:   <<< epochs: 2
2024-05-04 05:19:31,004:INFO:   <<< eval_frame_order: 0
2024-05-04 05:19:31,004:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 05:19:31,004:INFO:   <<< feature_framerate: 1
2024-05-04 05:19:31,004:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 05:19:31,005:INFO:   <<< fp16: False
2024-05-04 05:19:31,005:INFO:   <<< fp16_opt_level: O1
2024-05-04 05:19:31,005:INFO:   <<< freeze_layer_num: 0
2024-05-04 05:19:31,005:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 05:19:31,005:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 05:19:31,005:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 05:19:31,005:INFO:   <<< linear_patch: 2d
2024-05-04 05:19:31,005:INFO:   <<< local_rank: 0
2024-05-04 05:19:31,005:INFO:   <<< loose_type: True
2024-05-04 05:19:31,005:INFO:   <<< lr: 0.0001
2024-05-04 05:19:31,005:INFO:   <<< lr_decay: 0.9
2024-05-04 05:19:31,005:INFO:   <<< margin: 0.1
2024-05-04 05:19:31,005:INFO:   <<< max_frames: 90
2024-05-04 05:19:31,005:INFO:   <<< max_words: 32
2024-05-04 05:19:31,005:INFO:   <<< n_display: 100
2024-05-04 05:19:31,005:INFO:   <<< n_gpu: 1
2024-05-04 05:19:31,005:INFO:   <<< n_pair: 1
2024-05-04 05:19:31,005:INFO:   <<< negative_weighting: 1
2024-05-04 05:19:31,005:INFO:   <<< num_thread_reader: 0
2024-05-04 05:19:31,005:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 05:19:31,005:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 05:19:31,005:INFO:   <<< rank: 0
2024-05-04 05:19:31,005:INFO:   <<< resume_model: None
2024-05-04 05:19:31,005:INFO:   <<< sampled_use_mil: False
2024-05-04 05:19:31,005:INFO:   <<< seed: 42
2024-05-04 05:19:31,005:INFO:   <<< sim_header: meanP
2024-05-04 05:19:31,005:INFO:   <<< slice_framepos: 2
2024-05-04 05:19:31,005:INFO:   <<< task_type: retrieval
2024-05-04 05:19:31,005:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 05:19:31,005:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 05:19:31,005:INFO:   <<< train_frame_order: 0
2024-05-04 05:19:31,005:INFO:   <<< use_mil: False
2024-05-04 05:19:31,005:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 05:19:31,005:INFO:   <<< video_dim: 1024
2024-05-04 05:19:31,005:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 05:19:31,005:INFO:   <<< warmup_proportion: 0.1
2024-05-04 05:19:31,005:INFO:   <<< world_size: 1
2024-05-04 05:19:31,005:INFO: device: cuda:0 n_gpu: 1
2024-05-04 05:19:31,148:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 05:19:31,605:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 05:19:31,605:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 05:19:31,605:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 05:19:31,606:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 05:19:31,606:WARNING: Test retrieval by loose type.
2024-05-04 05:19:31,606:WARNING: 	 embed_dim: 512
2024-05-04 05:19:31,606:WARNING: 	 image_resolution: 224
2024-05-04 05:19:31,606:WARNING: 	 vision_layers: 12
2024-05-04 05:19:31,606:WARNING: 	 vision_width: 768
2024-05-04 05:19:31,606:WARNING: 	 vision_patch_size: 32
2024-05-04 05:19:31,606:WARNING: 	 context_length: 77
2024-05-04 05:19:31,606:WARNING: 	 vocab_size: 49408
2024-05-04 05:19:31,606:WARNING: 	 transformer_width: 512
2024-05-04 05:19:31,606:WARNING: 	 transformer_heads: 8
2024-05-04 05:19:31,606:WARNING: 	 transformer_layers: 12
2024-05-04 05:19:31,606:WARNING: 		 linear_patch: 2d
2024-05-04 05:19:31,606:WARNING: 	 cut_top_layer: 0
2024-05-04 05:19:32,461:WARNING: 	 sim_header: meanP
2024-05-04 05:19:36,163:INFO: --------------------
2024-05-04 05:19:36,164:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 05:24:51,700:INFO: Effective parameters:
2024-05-04 05:24:51,700:INFO:   <<< batch_size: 1
2024-05-04 05:24:51,700:INFO:   <<< batch_size_val: 16
2024-05-04 05:24:51,700:INFO:   <<< cache_dir: 
2024-05-04 05:24:51,700:INFO:   <<< coef_lr: 0.001
2024-05-04 05:24:51,700:INFO:   <<< cross_model: cross-base
2024-05-04 05:24:51,700:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 05:24:51,700:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 05:24:51,700:INFO:   <<< datatype: msrvtt
2024-05-04 05:24:51,700:INFO:   <<< do_eval: True
2024-05-04 05:24:51,700:INFO:   <<< do_lower_case: False
2024-05-04 05:24:51,700:INFO:   <<< do_pretrain: False
2024-05-04 05:24:51,700:INFO:   <<< do_train: False
2024-05-04 05:24:51,700:INFO:   <<< epochs: 2
2024-05-04 05:24:51,700:INFO:   <<< eval_frame_order: 0
2024-05-04 05:24:51,700:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 05:24:51,700:INFO:   <<< feature_framerate: 1
2024-05-04 05:24:51,700:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 05:24:51,700:INFO:   <<< fp16: False
2024-05-04 05:24:51,700:INFO:   <<< fp16_opt_level: O1
2024-05-04 05:24:51,701:INFO:   <<< freeze_layer_num: 0
2024-05-04 05:24:51,701:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 05:24:51,701:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 05:24:51,701:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 05:24:51,701:INFO:   <<< linear_patch: 2d
2024-05-04 05:24:51,701:INFO:   <<< local_rank: 0
2024-05-04 05:24:51,701:INFO:   <<< loose_type: True
2024-05-04 05:24:51,701:INFO:   <<< lr: 0.0001
2024-05-04 05:24:51,701:INFO:   <<< lr_decay: 0.9
2024-05-04 05:24:51,701:INFO:   <<< margin: 0.1
2024-05-04 05:24:51,701:INFO:   <<< max_frames: 90
2024-05-04 05:24:51,701:INFO:   <<< max_words: 32
2024-05-04 05:24:51,701:INFO:   <<< n_display: 100
2024-05-04 05:24:51,701:INFO:   <<< n_gpu: 1
2024-05-04 05:24:51,701:INFO:   <<< n_pair: 1
2024-05-04 05:24:51,701:INFO:   <<< negative_weighting: 1
2024-05-04 05:24:51,701:INFO:   <<< num_thread_reader: 0
2024-05-04 05:24:51,701:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 05:24:51,701:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 05:24:51,701:INFO:   <<< rank: 0
2024-05-04 05:24:51,701:INFO:   <<< resume_model: None
2024-05-04 05:24:51,701:INFO:   <<< sampled_use_mil: False
2024-05-04 05:24:51,701:INFO:   <<< seed: 42
2024-05-04 05:24:51,701:INFO:   <<< sim_header: meanP
2024-05-04 05:24:51,701:INFO:   <<< slice_framepos: 2
2024-05-04 05:24:51,701:INFO:   <<< task_type: retrieval
2024-05-04 05:24:51,701:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 05:24:51,701:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 05:24:51,701:INFO:   <<< train_frame_order: 0
2024-05-04 05:24:51,701:INFO:   <<< use_mil: False
2024-05-04 05:24:51,701:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 05:24:51,701:INFO:   <<< video_dim: 1024
2024-05-04 05:24:51,701:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 05:24:51,701:INFO:   <<< warmup_proportion: 0.1
2024-05-04 05:24:51,701:INFO:   <<< world_size: 1
2024-05-04 05:24:51,701:INFO: device: cuda:0 n_gpu: 1
2024-05-04 05:24:51,840:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 05:24:52,289:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 05:24:52,290:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 05:24:52,290:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 05:24:52,290:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 05:24:52,290:WARNING: Test retrieval by loose type.
2024-05-04 05:24:52,290:WARNING: 	 embed_dim: 512
2024-05-04 05:24:52,290:WARNING: 	 image_resolution: 224
2024-05-04 05:24:52,290:WARNING: 	 vision_layers: 12
2024-05-04 05:24:52,290:WARNING: 	 vision_width: 768
2024-05-04 05:24:52,290:WARNING: 	 vision_patch_size: 32
2024-05-04 05:24:52,290:WARNING: 	 context_length: 77
2024-05-04 05:24:52,290:WARNING: 	 vocab_size: 49408
2024-05-04 05:24:52,290:WARNING: 	 transformer_width: 512
2024-05-04 05:24:52,290:WARNING: 	 transformer_heads: 8
2024-05-04 05:24:52,290:WARNING: 	 transformer_layers: 12
2024-05-04 05:24:52,290:WARNING: 		 linear_patch: 2d
2024-05-04 05:24:52,290:WARNING: 	 cut_top_layer: 0
2024-05-04 05:24:53,136:WARNING: 	 sim_header: meanP
2024-05-04 05:24:56,794:INFO: --------------------
2024-05-04 05:24:56,796:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 05:31:41,989:INFO: Effective parameters:
2024-05-04 05:31:41,989:INFO:   <<< batch_size: 1
2024-05-04 05:31:41,989:INFO:   <<< batch_size_val: 16
2024-05-04 05:31:41,989:INFO:   <<< cache_dir: 
2024-05-04 05:31:41,989:INFO:   <<< coef_lr: 0.001
2024-05-04 05:31:41,989:INFO:   <<< cross_model: cross-base
2024-05-04 05:31:41,989:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 05:31:41,989:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 05:31:41,989:INFO:   <<< datatype: msrvtt
2024-05-04 05:31:41,989:INFO:   <<< do_eval: True
2024-05-04 05:31:41,989:INFO:   <<< do_lower_case: False
2024-05-04 05:31:41,989:INFO:   <<< do_pretrain: False
2024-05-04 05:31:41,989:INFO:   <<< do_train: False
2024-05-04 05:31:41,989:INFO:   <<< epochs: 2
2024-05-04 05:31:41,989:INFO:   <<< eval_frame_order: 0
2024-05-04 05:31:41,989:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 05:31:41,989:INFO:   <<< feature_framerate: 1
2024-05-04 05:31:41,989:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 05:31:41,989:INFO:   <<< fp16: False
2024-05-04 05:31:41,989:INFO:   <<< fp16_opt_level: O1
2024-05-04 05:31:41,989:INFO:   <<< freeze_layer_num: 0
2024-05-04 05:31:41,989:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 05:31:41,989:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 05:31:41,989:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 05:31:41,989:INFO:   <<< linear_patch: 2d
2024-05-04 05:31:41,989:INFO:   <<< local_rank: 0
2024-05-04 05:31:41,989:INFO:   <<< loose_type: True
2024-05-04 05:31:41,989:INFO:   <<< lr: 0.0001
2024-05-04 05:31:41,989:INFO:   <<< lr_decay: 0.9
2024-05-04 05:31:41,989:INFO:   <<< margin: 0.1
2024-05-04 05:31:41,989:INFO:   <<< max_frames: 90
2024-05-04 05:31:41,989:INFO:   <<< max_words: 32
2024-05-04 05:31:41,989:INFO:   <<< n_display: 100
2024-05-04 05:31:41,989:INFO:   <<< n_gpu: 1
2024-05-04 05:31:41,989:INFO:   <<< n_pair: 1
2024-05-04 05:31:41,990:INFO:   <<< negative_weighting: 1
2024-05-04 05:31:41,990:INFO:   <<< num_thread_reader: 0
2024-05-04 05:31:41,990:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 05:31:41,990:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 05:31:41,990:INFO:   <<< rank: 0
2024-05-04 05:31:41,990:INFO:   <<< resume_model: None
2024-05-04 05:31:41,990:INFO:   <<< sampled_use_mil: False
2024-05-04 05:31:41,990:INFO:   <<< seed: 42
2024-05-04 05:31:41,990:INFO:   <<< sim_header: meanP
2024-05-04 05:31:41,990:INFO:   <<< slice_framepos: 2
2024-05-04 05:31:41,990:INFO:   <<< task_type: retrieval
2024-05-04 05:31:41,990:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 05:31:41,990:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 05:31:41,990:INFO:   <<< train_frame_order: 0
2024-05-04 05:31:41,990:INFO:   <<< use_mil: False
2024-05-04 05:31:41,990:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 05:31:41,990:INFO:   <<< video_dim: 1024
2024-05-04 05:31:41,990:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 05:31:41,990:INFO:   <<< warmup_proportion: 0.1
2024-05-04 05:31:41,990:INFO:   <<< world_size: 1
2024-05-04 05:31:41,990:INFO: device: cuda:0 n_gpu: 1
2024-05-04 05:31:42,131:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 05:31:42,571:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 05:31:42,571:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 05:31:42,571:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 05:31:42,571:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 05:31:42,571:WARNING: Test retrieval by loose type.
2024-05-04 05:31:42,571:WARNING: 	 embed_dim: 512
2024-05-04 05:31:42,571:WARNING: 	 image_resolution: 224
2024-05-04 05:31:42,571:WARNING: 	 vision_layers: 12
2024-05-04 05:31:42,571:WARNING: 	 vision_width: 768
2024-05-04 05:31:42,571:WARNING: 	 vision_patch_size: 32
2024-05-04 05:31:42,571:WARNING: 	 context_length: 77
2024-05-04 05:31:42,571:WARNING: 	 vocab_size: 49408
2024-05-04 05:31:42,571:WARNING: 	 transformer_width: 512
2024-05-04 05:31:42,571:WARNING: 	 transformer_heads: 8
2024-05-04 05:31:42,571:WARNING: 	 transformer_layers: 12
2024-05-04 05:31:42,571:WARNING: 		 linear_patch: 2d
2024-05-04 05:31:42,571:WARNING: 	 cut_top_layer: 0
2024-05-04 05:31:43,440:WARNING: 	 sim_header: meanP
2024-05-04 05:31:47,170:INFO: --------------------
2024-05-04 05:31:47,171:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-04 05:34:55,753:INFO: Effective parameters:
2024-05-04 05:34:55,753:INFO:   <<< batch_size: 1
2024-05-04 05:34:55,753:INFO:   <<< batch_size_val: 16
2024-05-04 05:34:55,753:INFO:   <<< cache_dir: 
2024-05-04 05:34:55,753:INFO:   <<< coef_lr: 0.001
2024-05-04 05:34:55,753:INFO:   <<< cross_model: cross-base
2024-05-04 05:34:55,753:INFO:   <<< cross_num_hidden_layers: 4
2024-05-04 05:34:55,753:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-04 05:34:55,753:INFO:   <<< datatype: msrvtt
2024-05-04 05:34:55,753:INFO:   <<< do_eval: True
2024-05-04 05:34:55,753:INFO:   <<< do_lower_case: False
2024-05-04 05:34:55,753:INFO:   <<< do_pretrain: False
2024-05-04 05:34:55,753:INFO:   <<< do_train: False
2024-05-04 05:34:55,753:INFO:   <<< epochs: 2
2024-05-04 05:34:55,753:INFO:   <<< eval_frame_order: 0
2024-05-04 05:34:55,753:INFO:   <<< expand_msrvtt_sentences: True
2024-05-04 05:34:55,753:INFO:   <<< feature_framerate: 1
2024-05-04 05:34:55,753:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-04 05:34:55,753:INFO:   <<< fp16: False
2024-05-04 05:34:55,753:INFO:   <<< fp16_opt_level: O1
2024-05-04 05:34:55,753:INFO:   <<< freeze_layer_num: 0
2024-05-04 05:34:55,753:INFO:   <<< gradient_accumulation_steps: 1
2024-05-04 05:34:55,753:INFO:   <<< hard_negative_rate: 0.5
2024-05-04 05:34:55,753:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-04 05:34:55,753:INFO:   <<< linear_patch: 2d
2024-05-04 05:34:55,753:INFO:   <<< local_rank: 0
2024-05-04 05:34:55,753:INFO:   <<< loose_type: True
2024-05-04 05:34:55,753:INFO:   <<< lr: 0.0001
2024-05-04 05:34:55,753:INFO:   <<< lr_decay: 0.9
2024-05-04 05:34:55,753:INFO:   <<< margin: 0.1
2024-05-04 05:34:55,753:INFO:   <<< max_frames: 90
2024-05-04 05:34:55,753:INFO:   <<< max_words: 32
2024-05-04 05:34:55,753:INFO:   <<< n_display: 100
2024-05-04 05:34:55,753:INFO:   <<< n_gpu: 1
2024-05-04 05:34:55,753:INFO:   <<< n_pair: 1
2024-05-04 05:34:55,753:INFO:   <<< negative_weighting: 1
2024-05-04 05:34:55,753:INFO:   <<< num_thread_reader: 0
2024-05-04 05:34:55,753:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-04 05:34:55,753:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-04 05:34:55,753:INFO:   <<< rank: 0
2024-05-04 05:34:55,753:INFO:   <<< resume_model: None
2024-05-04 05:34:55,753:INFO:   <<< sampled_use_mil: False
2024-05-04 05:34:55,753:INFO:   <<< seed: 42
2024-05-04 05:34:55,753:INFO:   <<< sim_header: meanP
2024-05-04 05:34:55,753:INFO:   <<< slice_framepos: 2
2024-05-04 05:34:55,753:INFO:   <<< task_type: retrieval
2024-05-04 05:34:55,754:INFO:   <<< text_num_hidden_layers: 12
2024-05-04 05:34:55,754:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-04 05:34:55,754:INFO:   <<< train_frame_order: 0
2024-05-04 05:34:55,754:INFO:   <<< use_mil: False
2024-05-04 05:34:55,754:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-04 05:34:55,754:INFO:   <<< video_dim: 1024
2024-05-04 05:34:55,754:INFO:   <<< visual_num_hidden_layers: 12
2024-05-04 05:34:55,754:INFO:   <<< warmup_proportion: 0.1
2024-05-04 05:34:55,754:INFO:   <<< world_size: 1
2024-05-04 05:34:55,754:INFO: device: cuda:0 n_gpu: 1
2024-05-04 05:34:55,889:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-04 05:34:56,340:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-04 05:34:56,341:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-04 05:34:56,341:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-04 05:34:56,341:WARNING: Stage-One:True, Stage-Two:False
2024-05-04 05:34:56,341:WARNING: Test retrieval by loose type.
2024-05-04 05:34:56,341:WARNING: 	 embed_dim: 512
2024-05-04 05:34:56,341:WARNING: 	 image_resolution: 224
2024-05-04 05:34:56,341:WARNING: 	 vision_layers: 12
2024-05-04 05:34:56,341:WARNING: 	 vision_width: 768
2024-05-04 05:34:56,341:WARNING: 	 vision_patch_size: 32
2024-05-04 05:34:56,341:WARNING: 	 context_length: 77
2024-05-04 05:34:56,341:WARNING: 	 vocab_size: 49408
2024-05-04 05:34:56,341:WARNING: 	 transformer_width: 512
2024-05-04 05:34:56,341:WARNING: 	 transformer_heads: 8
2024-05-04 05:34:56,341:WARNING: 	 transformer_layers: 12
2024-05-04 05:34:56,341:WARNING: 		 linear_patch: 2d
2024-05-04 05:34:56,341:WARNING: 	 cut_top_layer: 0
2024-05-04 05:34:57,182:WARNING: 	 sim_header: meanP
2024-05-04 05:35:00,868:INFO: --------------------
2024-05-04 05:35:00,868:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 03:33:26,179:INFO: Effective parameters:
2024-05-06 03:33:26,179:INFO:   <<< batch_size: 1
2024-05-06 03:33:26,179:INFO:   <<< batch_size_val: 16
2024-05-06 03:33:26,179:INFO:   <<< cache_dir: 
2024-05-06 03:33:26,179:INFO:   <<< coef_lr: 0.001
2024-05-06 03:33:26,179:INFO:   <<< cross_model: cross-base
2024-05-06 03:33:26,179:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 03:33:26,179:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 03:33:26,179:INFO:   <<< datatype: msrvtt
2024-05-06 03:33:26,179:INFO:   <<< do_eval: True
2024-05-06 03:33:26,179:INFO:   <<< do_lower_case: False
2024-05-06 03:33:26,179:INFO:   <<< do_pretrain: False
2024-05-06 03:33:26,179:INFO:   <<< do_train: False
2024-05-06 03:33:26,179:INFO:   <<< epochs: 2
2024-05-06 03:33:26,179:INFO:   <<< eval_frame_order: 0
2024-05-06 03:33:26,179:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 03:33:26,179:INFO:   <<< feature_framerate: 1
2024-05-06 03:33:26,179:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 03:33:26,179:INFO:   <<< fp16: False
2024-05-06 03:33:26,179:INFO:   <<< fp16_opt_level: O1
2024-05-06 03:33:26,179:INFO:   <<< freeze_layer_num: 0
2024-05-06 03:33:26,180:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 03:33:26,180:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 03:33:26,180:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 03:33:26,180:INFO:   <<< linear_patch: 2d
2024-05-06 03:33:26,180:INFO:   <<< local_rank: 0
2024-05-06 03:33:26,180:INFO:   <<< loose_type: True
2024-05-06 03:33:26,180:INFO:   <<< lr: 0.0001
2024-05-06 03:33:26,180:INFO:   <<< lr_decay: 0.9
2024-05-06 03:33:26,180:INFO:   <<< margin: 0.1
2024-05-06 03:33:26,180:INFO:   <<< max_frames: 90
2024-05-06 03:33:26,180:INFO:   <<< max_words: 32
2024-05-06 03:33:26,180:INFO:   <<< n_display: 100
2024-05-06 03:33:26,180:INFO:   <<< n_gpu: 1
2024-05-06 03:33:26,180:INFO:   <<< n_pair: 1
2024-05-06 03:33:26,180:INFO:   <<< negative_weighting: 1
2024-05-06 03:33:26,180:INFO:   <<< num_thread_reader: 0
2024-05-06 03:33:26,180:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 03:33:26,180:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 03:33:26,180:INFO:   <<< rank: 0
2024-05-06 03:33:26,180:INFO:   <<< resume_model: None
2024-05-06 03:33:26,180:INFO:   <<< sampled_use_mil: False
2024-05-06 03:33:26,180:INFO:   <<< seed: 42
2024-05-06 03:33:26,180:INFO:   <<< sim_header: meanP
2024-05-06 03:33:26,180:INFO:   <<< slice_framepos: 2
2024-05-06 03:33:26,180:INFO:   <<< task_type: retrieval
2024-05-06 03:33:26,180:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 03:33:26,180:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 03:33:26,180:INFO:   <<< train_frame_order: 0
2024-05-06 03:33:26,180:INFO:   <<< use_mil: False
2024-05-06 03:33:26,180:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 03:33:26,180:INFO:   <<< video_dim: 1024
2024-05-06 03:33:26,180:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 03:33:26,180:INFO:   <<< warmup_proportion: 0.1
2024-05-06 03:33:26,180:INFO:   <<< world_size: 1
2024-05-06 03:33:26,180:INFO: device: cuda:0 n_gpu: 1
2024-05-06 03:33:27,486:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 03:33:28,699:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 03:33:28,699:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 03:33:28,699:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 03:33:28,700:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 03:33:28,700:WARNING: Test retrieval by loose type.
2024-05-06 03:33:28,700:WARNING: 	 embed_dim: 512
2024-05-06 03:33:28,700:WARNING: 	 image_resolution: 224
2024-05-06 03:33:28,700:WARNING: 	 vision_layers: 12
2024-05-06 03:33:28,700:WARNING: 	 vision_width: 768
2024-05-06 03:33:28,700:WARNING: 	 vision_patch_size: 32
2024-05-06 03:33:28,700:WARNING: 	 context_length: 77
2024-05-06 03:33:28,700:WARNING: 	 vocab_size: 49408
2024-05-06 03:33:28,700:WARNING: 	 transformer_width: 512
2024-05-06 03:33:28,700:WARNING: 	 transformer_heads: 8
2024-05-06 03:33:28,700:WARNING: 	 transformer_layers: 12
2024-05-06 03:33:28,700:WARNING: 		 linear_patch: 2d
2024-05-06 03:33:28,700:WARNING: 	 cut_top_layer: 0
2024-05-06 03:33:29,583:WARNING: 	 sim_header: meanP
2024-05-06 03:33:33,293:INFO: --------------------
2024-05-06 03:33:33,293:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 03:39:18,088:INFO: Effective parameters:
2024-05-06 03:39:18,088:INFO:   <<< batch_size: 1
2024-05-06 03:39:18,088:INFO:   <<< batch_size_val: 16
2024-05-06 03:39:18,088:INFO:   <<< cache_dir: 
2024-05-06 03:39:18,088:INFO:   <<< coef_lr: 0.001
2024-05-06 03:39:18,088:INFO:   <<< cross_model: cross-base
2024-05-06 03:39:18,088:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 03:39:18,088:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 03:39:18,088:INFO:   <<< datatype: msrvtt
2024-05-06 03:39:18,088:INFO:   <<< do_eval: True
2024-05-06 03:39:18,088:INFO:   <<< do_lower_case: False
2024-05-06 03:39:18,088:INFO:   <<< do_pretrain: False
2024-05-06 03:39:18,088:INFO:   <<< do_train: False
2024-05-06 03:39:18,088:INFO:   <<< epochs: 2
2024-05-06 03:39:18,088:INFO:   <<< eval_frame_order: 0
2024-05-06 03:39:18,088:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 03:39:18,088:INFO:   <<< feature_framerate: 1
2024-05-06 03:39:18,088:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 03:39:18,088:INFO:   <<< fp16: False
2024-05-06 03:39:18,088:INFO:   <<< fp16_opt_level: O1
2024-05-06 03:39:18,088:INFO:   <<< freeze_layer_num: 0
2024-05-06 03:39:18,088:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 03:39:18,088:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 03:39:18,088:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 03:39:18,088:INFO:   <<< linear_patch: 2d
2024-05-06 03:39:18,088:INFO:   <<< local_rank: 0
2024-05-06 03:39:18,088:INFO:   <<< loose_type: True
2024-05-06 03:39:18,088:INFO:   <<< lr: 0.0001
2024-05-06 03:39:18,088:INFO:   <<< lr_decay: 0.9
2024-05-06 03:39:18,088:INFO:   <<< margin: 0.1
2024-05-06 03:39:18,088:INFO:   <<< max_frames: 90
2024-05-06 03:39:18,088:INFO:   <<< max_words: 32
2024-05-06 03:39:18,088:INFO:   <<< n_display: 100
2024-05-06 03:39:18,088:INFO:   <<< n_gpu: 1
2024-05-06 03:39:18,089:INFO:   <<< n_pair: 1
2024-05-06 03:39:18,089:INFO:   <<< negative_weighting: 1
2024-05-06 03:39:18,089:INFO:   <<< num_thread_reader: 0
2024-05-06 03:39:18,089:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 03:39:18,089:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 03:39:18,089:INFO:   <<< rank: 0
2024-05-06 03:39:18,089:INFO:   <<< resume_model: None
2024-05-06 03:39:18,089:INFO:   <<< sampled_use_mil: False
2024-05-06 03:39:18,089:INFO:   <<< seed: 42
2024-05-06 03:39:18,089:INFO:   <<< sim_header: meanP
2024-05-06 03:39:18,089:INFO:   <<< slice_framepos: 2
2024-05-06 03:39:18,089:INFO:   <<< task_type: retrieval
2024-05-06 03:39:18,089:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 03:39:18,089:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 03:39:18,089:INFO:   <<< train_frame_order: 0
2024-05-06 03:39:18,089:INFO:   <<< use_mil: False
2024-05-06 03:39:18,089:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 03:39:18,089:INFO:   <<< video_dim: 1024
2024-05-06 03:39:18,089:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 03:39:18,089:INFO:   <<< warmup_proportion: 0.1
2024-05-06 03:39:18,089:INFO:   <<< world_size: 1
2024-05-06 03:39:18,089:INFO: device: cuda:0 n_gpu: 1
2024-05-06 03:39:18,247:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 03:39:18,737:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 03:39:18,738:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 03:39:18,738:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 03:39:18,738:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 03:39:18,738:WARNING: Test retrieval by loose type.
2024-05-06 03:39:18,738:WARNING: 	 embed_dim: 512
2024-05-06 03:39:18,738:WARNING: 	 image_resolution: 224
2024-05-06 03:39:18,738:WARNING: 	 vision_layers: 12
2024-05-06 03:39:18,738:WARNING: 	 vision_width: 768
2024-05-06 03:39:18,738:WARNING: 	 vision_patch_size: 32
2024-05-06 03:39:18,738:WARNING: 	 context_length: 77
2024-05-06 03:39:18,738:WARNING: 	 vocab_size: 49408
2024-05-06 03:39:18,738:WARNING: 	 transformer_width: 512
2024-05-06 03:39:18,738:WARNING: 	 transformer_heads: 8
2024-05-06 03:39:18,738:WARNING: 	 transformer_layers: 12
2024-05-06 03:39:18,738:WARNING: 		 linear_patch: 2d
2024-05-06 03:39:18,738:WARNING: 	 cut_top_layer: 0
2024-05-06 03:39:19,623:WARNING: 	 sim_header: meanP
2024-05-06 03:39:23,420:INFO: --------------------
2024-05-06 03:39:23,421:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 03:42:07,528:INFO: Effective parameters:
2024-05-06 03:42:07,528:INFO:   <<< batch_size: 1
2024-05-06 03:42:07,528:INFO:   <<< batch_size_val: 16
2024-05-06 03:42:07,528:INFO:   <<< cache_dir: 
2024-05-06 03:42:07,528:INFO:   <<< coef_lr: 0.001
2024-05-06 03:42:07,528:INFO:   <<< cross_model: cross-base
2024-05-06 03:42:07,528:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 03:42:07,528:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 03:42:07,528:INFO:   <<< datatype: msrvtt
2024-05-06 03:42:07,528:INFO:   <<< do_eval: True
2024-05-06 03:42:07,528:INFO:   <<< do_lower_case: False
2024-05-06 03:42:07,528:INFO:   <<< do_pretrain: False
2024-05-06 03:42:07,528:INFO:   <<< do_train: False
2024-05-06 03:42:07,528:INFO:   <<< epochs: 2
2024-05-06 03:42:07,528:INFO:   <<< eval_frame_order: 0
2024-05-06 03:42:07,528:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 03:42:07,528:INFO:   <<< feature_framerate: 1
2024-05-06 03:42:07,528:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 03:42:07,528:INFO:   <<< fp16: False
2024-05-06 03:42:07,528:INFO:   <<< fp16_opt_level: O1
2024-05-06 03:42:07,529:INFO:   <<< freeze_layer_num: 0
2024-05-06 03:42:07,529:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 03:42:07,529:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 03:42:07,529:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 03:42:07,529:INFO:   <<< linear_patch: 2d
2024-05-06 03:42:07,529:INFO:   <<< local_rank: 0
2024-05-06 03:42:07,529:INFO:   <<< loose_type: True
2024-05-06 03:42:07,529:INFO:   <<< lr: 0.0001
2024-05-06 03:42:07,529:INFO:   <<< lr_decay: 0.9
2024-05-06 03:42:07,529:INFO:   <<< margin: 0.1
2024-05-06 03:42:07,529:INFO:   <<< max_frames: 90
2024-05-06 03:42:07,529:INFO:   <<< max_words: 32
2024-05-06 03:42:07,529:INFO:   <<< n_display: 100
2024-05-06 03:42:07,529:INFO:   <<< n_gpu: 1
2024-05-06 03:42:07,529:INFO:   <<< n_pair: 1
2024-05-06 03:42:07,529:INFO:   <<< negative_weighting: 1
2024-05-06 03:42:07,529:INFO:   <<< num_thread_reader: 0
2024-05-06 03:42:07,529:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 03:42:07,529:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 03:42:07,529:INFO:   <<< rank: 0
2024-05-06 03:42:07,529:INFO:   <<< resume_model: None
2024-05-06 03:42:07,529:INFO:   <<< sampled_use_mil: False
2024-05-06 03:42:07,529:INFO:   <<< seed: 42
2024-05-06 03:42:07,529:INFO:   <<< sim_header: meanP
2024-05-06 03:42:07,529:INFO:   <<< slice_framepos: 2
2024-05-06 03:42:07,529:INFO:   <<< task_type: retrieval
2024-05-06 03:42:07,529:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 03:42:07,529:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 03:42:07,529:INFO:   <<< train_frame_order: 0
2024-05-06 03:42:07,529:INFO:   <<< use_mil: False
2024-05-06 03:42:07,529:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 03:42:07,529:INFO:   <<< video_dim: 1024
2024-05-06 03:42:07,529:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 03:42:07,529:INFO:   <<< warmup_proportion: 0.1
2024-05-06 03:42:07,529:INFO:   <<< world_size: 1
2024-05-06 03:42:07,529:INFO: device: cuda:0 n_gpu: 1
2024-05-06 03:42:07,666:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 03:42:08,120:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 03:42:08,120:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 03:42:08,120:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 03:42:08,120:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 03:42:08,121:WARNING: Test retrieval by loose type.
2024-05-06 03:42:08,121:WARNING: 	 embed_dim: 512
2024-05-06 03:42:08,121:WARNING: 	 image_resolution: 224
2024-05-06 03:42:08,121:WARNING: 	 vision_layers: 12
2024-05-06 03:42:08,121:WARNING: 	 vision_width: 768
2024-05-06 03:42:08,121:WARNING: 	 vision_patch_size: 32
2024-05-06 03:42:08,121:WARNING: 	 context_length: 77
2024-05-06 03:42:08,121:WARNING: 	 vocab_size: 49408
2024-05-06 03:42:08,121:WARNING: 	 transformer_width: 512
2024-05-06 03:42:08,121:WARNING: 	 transformer_heads: 8
2024-05-06 03:42:08,121:WARNING: 	 transformer_layers: 12
2024-05-06 03:42:08,121:WARNING: 		 linear_patch: 2d
2024-05-06 03:42:08,121:WARNING: 	 cut_top_layer: 0
2024-05-06 03:42:08,995:WARNING: 	 sim_header: meanP
2024-05-06 03:42:12,869:INFO: --------------------
2024-05-06 03:42:12,869:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 03:52:40,989:INFO: Effective parameters:
2024-05-06 03:52:40,989:INFO:   <<< batch_size: 1
2024-05-06 03:52:40,990:INFO:   <<< batch_size_val: 16
2024-05-06 03:52:40,990:INFO:   <<< cache_dir: 
2024-05-06 03:52:40,990:INFO:   <<< coef_lr: 0.001
2024-05-06 03:52:40,990:INFO:   <<< cross_model: cross-base
2024-05-06 03:52:40,990:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 03:52:40,990:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 03:52:40,990:INFO:   <<< datatype: msrvtt
2024-05-06 03:52:40,990:INFO:   <<< do_eval: True
2024-05-06 03:52:40,990:INFO:   <<< do_lower_case: False
2024-05-06 03:52:40,990:INFO:   <<< do_pretrain: False
2024-05-06 03:52:40,990:INFO:   <<< do_train: False
2024-05-06 03:52:40,990:INFO:   <<< epochs: 2
2024-05-06 03:52:40,990:INFO:   <<< eval_frame_order: 0
2024-05-06 03:52:40,990:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 03:52:40,990:INFO:   <<< feature_framerate: 1
2024-05-06 03:52:40,990:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 03:52:40,990:INFO:   <<< fp16: False
2024-05-06 03:52:40,990:INFO:   <<< fp16_opt_level: O1
2024-05-06 03:52:40,990:INFO:   <<< freeze_layer_num: 0
2024-05-06 03:52:40,990:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 03:52:40,990:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 03:52:40,990:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 03:52:40,990:INFO:   <<< linear_patch: 2d
2024-05-06 03:52:40,990:INFO:   <<< local_rank: 0
2024-05-06 03:52:40,990:INFO:   <<< loose_type: True
2024-05-06 03:52:40,990:INFO:   <<< lr: 0.0001
2024-05-06 03:52:40,990:INFO:   <<< lr_decay: 0.9
2024-05-06 03:52:40,990:INFO:   <<< margin: 0.1
2024-05-06 03:52:40,990:INFO:   <<< max_frames: 90
2024-05-06 03:52:40,990:INFO:   <<< max_words: 32
2024-05-06 03:52:40,990:INFO:   <<< n_display: 100
2024-05-06 03:52:40,990:INFO:   <<< n_gpu: 1
2024-05-06 03:52:40,990:INFO:   <<< n_pair: 1
2024-05-06 03:52:40,990:INFO:   <<< negative_weighting: 1
2024-05-06 03:52:40,990:INFO:   <<< num_thread_reader: 0
2024-05-06 03:52:40,990:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 03:52:40,990:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 03:52:40,990:INFO:   <<< rank: 0
2024-05-06 03:52:40,990:INFO:   <<< resume_model: None
2024-05-06 03:52:40,990:INFO:   <<< sampled_use_mil: False
2024-05-06 03:52:40,990:INFO:   <<< seed: 42
2024-05-06 03:52:40,990:INFO:   <<< sim_header: meanP
2024-05-06 03:52:40,990:INFO:   <<< slice_framepos: 2
2024-05-06 03:52:40,990:INFO:   <<< task_type: retrieval
2024-05-06 03:52:40,990:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 03:52:40,990:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 03:52:40,991:INFO:   <<< train_frame_order: 0
2024-05-06 03:52:40,991:INFO:   <<< use_mil: False
2024-05-06 03:52:40,991:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 03:52:40,991:INFO:   <<< video_dim: 1024
2024-05-06 03:52:40,991:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 03:52:40,991:INFO:   <<< warmup_proportion: 0.1
2024-05-06 03:52:40,991:INFO:   <<< world_size: 1
2024-05-06 03:52:40,991:INFO: device: cuda:0 n_gpu: 1
2024-05-06 03:52:41,127:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 03:52:41,601:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 03:52:41,602:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 03:52:41,602:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 03:52:41,602:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 03:52:41,602:WARNING: Test retrieval by loose type.
2024-05-06 03:52:41,602:WARNING: 	 embed_dim: 512
2024-05-06 03:52:41,602:WARNING: 	 image_resolution: 224
2024-05-06 03:52:41,602:WARNING: 	 vision_layers: 12
2024-05-06 03:52:41,602:WARNING: 	 vision_width: 768
2024-05-06 03:52:41,602:WARNING: 	 vision_patch_size: 32
2024-05-06 03:52:41,602:WARNING: 	 context_length: 77
2024-05-06 03:52:41,602:WARNING: 	 vocab_size: 49408
2024-05-06 03:52:41,602:WARNING: 	 transformer_width: 512
2024-05-06 03:52:41,602:WARNING: 	 transformer_heads: 8
2024-05-06 03:52:41,602:WARNING: 	 transformer_layers: 12
2024-05-06 03:52:41,602:WARNING: 		 linear_patch: 2d
2024-05-06 03:52:41,602:WARNING: 	 cut_top_layer: 0
2024-05-06 03:52:42,450:WARNING: 	 sim_header: meanP
2024-05-06 03:52:46,158:INFO: --------------------
2024-05-06 03:52:46,158:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 04:03:58,752:INFO: Effective parameters:
2024-05-06 04:03:58,752:INFO:   <<< batch_size: 1
2024-05-06 04:03:58,753:INFO:   <<< batch_size_val: 16
2024-05-06 04:03:58,753:INFO:   <<< cache_dir: 
2024-05-06 04:03:58,753:INFO:   <<< coef_lr: 0.001
2024-05-06 04:03:58,753:INFO:   <<< cross_model: cross-base
2024-05-06 04:03:58,753:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:03:58,753:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:03:58,753:INFO:   <<< datatype: msrvtt
2024-05-06 04:03:58,753:INFO:   <<< do_eval: True
2024-05-06 04:03:58,753:INFO:   <<< do_lower_case: False
2024-05-06 04:03:58,753:INFO:   <<< do_pretrain: False
2024-05-06 04:03:58,753:INFO:   <<< do_train: False
2024-05-06 04:03:58,753:INFO:   <<< epochs: 2
2024-05-06 04:03:58,753:INFO:   <<< eval_frame_order: 0
2024-05-06 04:03:58,753:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:03:58,753:INFO:   <<< feature_framerate: 1
2024-05-06 04:03:58,753:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:03:58,753:INFO:   <<< fp16: False
2024-05-06 04:03:58,753:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:03:58,753:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:03:58,753:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:03:58,753:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:03:58,753:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:03:58,753:INFO:   <<< linear_patch: 2d
2024-05-06 04:03:58,753:INFO:   <<< local_rank: 0
2024-05-06 04:03:58,753:INFO:   <<< loose_type: True
2024-05-06 04:03:58,753:INFO:   <<< lr: 0.0001
2024-05-06 04:03:58,753:INFO:   <<< lr_decay: 0.9
2024-05-06 04:03:58,753:INFO:   <<< margin: 0.1
2024-05-06 04:03:58,753:INFO:   <<< max_frames: 90
2024-05-06 04:03:58,753:INFO:   <<< max_words: 32
2024-05-06 04:03:58,753:INFO:   <<< n_display: 100
2024-05-06 04:03:58,753:INFO:   <<< n_gpu: 1
2024-05-06 04:03:58,753:INFO:   <<< n_pair: 1
2024-05-06 04:03:58,753:INFO:   <<< negative_weighting: 1
2024-05-06 04:03:58,753:INFO:   <<< num_thread_reader: 0
2024-05-06 04:03:58,753:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:03:58,753:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:03:58,753:INFO:   <<< rank: 0
2024-05-06 04:03:58,753:INFO:   <<< resume_model: None
2024-05-06 04:03:58,753:INFO:   <<< sampled_use_mil: False
2024-05-06 04:03:58,753:INFO:   <<< seed: 42
2024-05-06 04:03:58,753:INFO:   <<< sim_header: meanP
2024-05-06 04:03:58,753:INFO:   <<< slice_framepos: 2
2024-05-06 04:03:58,753:INFO:   <<< task_type: retrieval
2024-05-06 04:03:58,753:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:03:58,753:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:03:58,753:INFO:   <<< train_frame_order: 0
2024-05-06 04:03:58,753:INFO:   <<< use_mil: False
2024-05-06 04:03:58,753:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:03:58,753:INFO:   <<< video_dim: 1024
2024-05-06 04:03:58,753:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:03:58,753:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:03:58,753:INFO:   <<< world_size: 1
2024-05-06 04:03:58,754:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:03:58,890:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 04:03:59,354:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 04:03:59,354:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 04:03:59,354:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 04:03:59,354:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 04:03:59,354:WARNING: Test retrieval by loose type.
2024-05-06 04:03:59,354:WARNING: 	 embed_dim: 512
2024-05-06 04:03:59,354:WARNING: 	 image_resolution: 224
2024-05-06 04:03:59,354:WARNING: 	 vision_layers: 12
2024-05-06 04:03:59,354:WARNING: 	 vision_width: 768
2024-05-06 04:03:59,354:WARNING: 	 vision_patch_size: 32
2024-05-06 04:03:59,354:WARNING: 	 context_length: 77
2024-05-06 04:03:59,355:WARNING: 	 vocab_size: 49408
2024-05-06 04:03:59,355:WARNING: 	 transformer_width: 512
2024-05-06 04:03:59,355:WARNING: 	 transformer_heads: 8
2024-05-06 04:03:59,355:WARNING: 	 transformer_layers: 12
2024-05-06 04:03:59,355:WARNING: 		 linear_patch: 2d
2024-05-06 04:03:59,355:WARNING: 	 cut_top_layer: 0
2024-05-06 04:04:00,226:WARNING: 	 sim_header: meanP
2024-05-06 04:04:03,953:INFO: --------------------
2024-05-06 04:04:03,954:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 04:07:12,144:INFO: Effective parameters:
2024-05-06 04:07:12,145:INFO:   <<< batch_size: 1
2024-05-06 04:07:12,145:INFO:   <<< batch_size_val: 16
2024-05-06 04:07:12,145:INFO:   <<< cache_dir: 
2024-05-06 04:07:12,145:INFO:   <<< coef_lr: 0.001
2024-05-06 04:07:12,145:INFO:   <<< cross_model: cross-base
2024-05-06 04:07:12,145:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:07:12,145:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:07:12,145:INFO:   <<< datatype: msrvtt
2024-05-06 04:07:12,145:INFO:   <<< do_eval: True
2024-05-06 04:07:12,145:INFO:   <<< do_lower_case: False
2024-05-06 04:07:12,145:INFO:   <<< do_pretrain: False
2024-05-06 04:07:12,146:INFO:   <<< do_train: False
2024-05-06 04:07:12,146:INFO:   <<< epochs: 2
2024-05-06 04:07:12,146:INFO:   <<< eval_frame_order: 0
2024-05-06 04:07:12,146:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:07:12,146:INFO:   <<< feature_framerate: 1
2024-05-06 04:07:12,146:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:07:12,146:INFO:   <<< fp16: False
2024-05-06 04:07:12,146:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:07:12,146:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:07:12,146:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:07:12,146:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:07:12,146:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:07:12,146:INFO:   <<< linear_patch: 2d
2024-05-06 04:07:12,146:INFO:   <<< local_rank: 0
2024-05-06 04:07:12,146:INFO:   <<< loose_type: True
2024-05-06 04:07:12,146:INFO:   <<< lr: 0.0001
2024-05-06 04:07:12,146:INFO:   <<< lr_decay: 0.9
2024-05-06 04:07:12,147:INFO:   <<< margin: 0.1
2024-05-06 04:07:12,147:INFO:   <<< max_frames: 90
2024-05-06 04:07:12,147:INFO:   <<< max_words: 32
2024-05-06 04:07:12,147:INFO:   <<< n_display: 100
2024-05-06 04:07:12,147:INFO:   <<< n_gpu: 1
2024-05-06 04:07:12,147:INFO:   <<< n_pair: 1
2024-05-06 04:07:12,147:INFO:   <<< negative_weighting: 1
2024-05-06 04:07:12,147:INFO:   <<< num_thread_reader: 0
2024-05-06 04:07:12,147:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:07:12,147:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:07:12,147:INFO:   <<< rank: 0
2024-05-06 04:07:12,147:INFO:   <<< resume_model: None
2024-05-06 04:07:12,147:INFO:   <<< sampled_use_mil: False
2024-05-06 04:07:12,147:INFO:   <<< seed: 42
2024-05-06 04:07:12,147:INFO:   <<< sim_header: meanP
2024-05-06 04:07:12,147:INFO:   <<< slice_framepos: 2
2024-05-06 04:07:12,147:INFO:   <<< task_type: retrieval
2024-05-06 04:07:12,147:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:07:12,148:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:07:12,148:INFO:   <<< train_frame_order: 0
2024-05-06 04:07:12,148:INFO:   <<< use_mil: False
2024-05-06 04:07:12,148:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:07:12,148:INFO:   <<< video_dim: 1024
2024-05-06 04:07:12,148:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:07:12,148:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:07:12,148:INFO:   <<< world_size: 1
2024-05-06 04:07:12,148:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:07:12,301:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 04:07:12,781:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 04:07:12,783:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 04:07:12,783:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 04:07:12,783:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 04:07:12,783:WARNING: Test retrieval by loose type.
2024-05-06 04:07:12,785:WARNING: 	 embed_dim: 512
2024-05-06 04:07:12,785:WARNING: 	 image_resolution: 224
2024-05-06 04:07:12,785:WARNING: 	 vision_layers: 12
2024-05-06 04:07:12,785:WARNING: 	 vision_width: 768
2024-05-06 04:07:12,785:WARNING: 	 vision_patch_size: 32
2024-05-06 04:07:12,785:WARNING: 	 context_length: 77
2024-05-06 04:07:12,785:WARNING: 	 vocab_size: 49408
2024-05-06 04:07:12,786:WARNING: 	 transformer_width: 512
2024-05-06 04:07:12,786:WARNING: 	 transformer_heads: 8
2024-05-06 04:07:12,786:WARNING: 	 transformer_layers: 12
2024-05-06 04:07:12,786:WARNING: 		 linear_patch: 2d
2024-05-06 04:07:12,786:WARNING: 	 cut_top_layer: 0
2024-05-06 04:07:13,651:WARNING: 	 sim_header: meanP
2024-05-06 04:07:17,360:INFO: --------------------
2024-05-06 04:07:17,360:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 04:16:44,573:INFO: Effective parameters:
2024-05-06 04:16:44,573:INFO:   <<< batch_size: 1
2024-05-06 04:16:44,573:INFO:   <<< batch_size_val: 16
2024-05-06 04:16:44,573:INFO:   <<< cache_dir: 
2024-05-06 04:16:44,573:INFO:   <<< coef_lr: 0.001
2024-05-06 04:16:44,573:INFO:   <<< cross_model: cross-base
2024-05-06 04:16:44,573:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:16:44,573:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:16:44,573:INFO:   <<< datatype: msrvtt
2024-05-06 04:16:44,573:INFO:   <<< do_eval: True
2024-05-06 04:16:44,573:INFO:   <<< do_lower_case: False
2024-05-06 04:16:44,573:INFO:   <<< do_pretrain: False
2024-05-06 04:16:44,573:INFO:   <<< do_train: False
2024-05-06 04:16:44,573:INFO:   <<< epochs: 2
2024-05-06 04:16:44,573:INFO:   <<< eval_frame_order: 0
2024-05-06 04:16:44,573:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:16:44,573:INFO:   <<< feature_framerate: 1
2024-05-06 04:16:44,573:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:16:44,573:INFO:   <<< fp16: False
2024-05-06 04:16:44,573:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:16:44,573:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:16:44,573:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:16:44,573:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:16:44,573:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:16:44,573:INFO:   <<< linear_patch: 2d
2024-05-06 04:16:44,573:INFO:   <<< local_rank: 0
2024-05-06 04:16:44,573:INFO:   <<< loose_type: True
2024-05-06 04:16:44,573:INFO:   <<< lr: 0.0001
2024-05-06 04:16:44,573:INFO:   <<< lr_decay: 0.9
2024-05-06 04:16:44,573:INFO:   <<< margin: 0.1
2024-05-06 04:16:44,573:INFO:   <<< max_frames: 90
2024-05-06 04:16:44,573:INFO:   <<< max_words: 32
2024-05-06 04:16:44,573:INFO:   <<< n_display: 100
2024-05-06 04:16:44,574:INFO:   <<< n_gpu: 1
2024-05-06 04:16:44,574:INFO:   <<< n_pair: 1
2024-05-06 04:16:44,574:INFO:   <<< negative_weighting: 1
2024-05-06 04:16:44,574:INFO:   <<< num_thread_reader: 0
2024-05-06 04:16:44,574:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:16:44,574:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:16:44,574:INFO:   <<< rank: 0
2024-05-06 04:16:44,574:INFO:   <<< resume_model: None
2024-05-06 04:16:44,574:INFO:   <<< sampled_use_mil: False
2024-05-06 04:16:44,574:INFO:   <<< seed: 42
2024-05-06 04:16:44,574:INFO:   <<< sim_header: meanP
2024-05-06 04:16:44,574:INFO:   <<< slice_framepos: 2
2024-05-06 04:16:44,574:INFO:   <<< task_type: retrieval
2024-05-06 04:16:44,574:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:16:44,574:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:16:44,574:INFO:   <<< train_frame_order: 0
2024-05-06 04:16:44,574:INFO:   <<< use_mil: False
2024-05-06 04:16:44,574:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:16:44,574:INFO:   <<< video_dim: 1024
2024-05-06 04:16:44,574:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:16:44,574:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:16:44,574:INFO:   <<< world_size: 1
2024-05-06 04:16:44,574:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:16:44,715:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 04:16:45,177:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 04:16:45,178:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 04:16:45,178:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 04:16:45,178:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 04:16:45,178:WARNING: Test retrieval by loose type.
2024-05-06 04:16:45,178:WARNING: 	 embed_dim: 512
2024-05-06 04:16:45,178:WARNING: 	 image_resolution: 224
2024-05-06 04:16:45,178:WARNING: 	 vision_layers: 12
2024-05-06 04:16:45,178:WARNING: 	 vision_width: 768
2024-05-06 04:16:45,178:WARNING: 	 vision_patch_size: 32
2024-05-06 04:16:45,178:WARNING: 	 context_length: 77
2024-05-06 04:16:45,178:WARNING: 	 vocab_size: 49408
2024-05-06 04:16:45,178:WARNING: 	 transformer_width: 512
2024-05-06 04:16:45,178:WARNING: 	 transformer_heads: 8
2024-05-06 04:16:45,178:WARNING: 	 transformer_layers: 12
2024-05-06 04:16:45,178:WARNING: 		 linear_patch: 2d
2024-05-06 04:16:45,178:WARNING: 	 cut_top_layer: 0
2024-05-06 04:16:46,042:WARNING: 	 sim_header: meanP
2024-05-06 04:16:49,735:INFO: --------------------
2024-05-06 04:16:49,736:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 04:17:59,235:INFO: Effective parameters:
2024-05-06 04:17:59,235:INFO:   <<< batch_size: 1
2024-05-06 04:17:59,235:INFO:   <<< batch_size_val: 16
2024-05-06 04:17:59,235:INFO:   <<< cache_dir: 
2024-05-06 04:17:59,235:INFO:   <<< coef_lr: 0.001
2024-05-06 04:17:59,235:INFO:   <<< cross_model: cross-base
2024-05-06 04:17:59,235:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:17:59,235:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:17:59,235:INFO:   <<< datatype: msrvtt
2024-05-06 04:17:59,235:INFO:   <<< do_eval: True
2024-05-06 04:17:59,235:INFO:   <<< do_lower_case: False
2024-05-06 04:17:59,235:INFO:   <<< do_pretrain: False
2024-05-06 04:17:59,235:INFO:   <<< do_train: False
2024-05-06 04:17:59,235:INFO:   <<< epochs: 2
2024-05-06 04:17:59,235:INFO:   <<< eval_frame_order: 0
2024-05-06 04:17:59,235:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:17:59,235:INFO:   <<< feature_framerate: 1
2024-05-06 04:17:59,235:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:17:59,235:INFO:   <<< fp16: False
2024-05-06 04:17:59,235:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:17:59,235:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:17:59,235:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:17:59,235:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:17:59,235:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:17:59,235:INFO:   <<< linear_patch: 2d
2024-05-06 04:17:59,235:INFO:   <<< local_rank: 0
2024-05-06 04:17:59,235:INFO:   <<< loose_type: True
2024-05-06 04:17:59,235:INFO:   <<< lr: 0.0001
2024-05-06 04:17:59,236:INFO:   <<< lr_decay: 0.9
2024-05-06 04:17:59,236:INFO:   <<< margin: 0.1
2024-05-06 04:17:59,236:INFO:   <<< max_frames: 90
2024-05-06 04:17:59,236:INFO:   <<< max_words: 32
2024-05-06 04:17:59,236:INFO:   <<< n_display: 100
2024-05-06 04:17:59,236:INFO:   <<< n_gpu: 1
2024-05-06 04:17:59,236:INFO:   <<< n_pair: 1
2024-05-06 04:17:59,236:INFO:   <<< negative_weighting: 1
2024-05-06 04:17:59,236:INFO:   <<< num_thread_reader: 0
2024-05-06 04:17:59,236:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:17:59,236:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:17:59,236:INFO:   <<< rank: 0
2024-05-06 04:17:59,236:INFO:   <<< resume_model: None
2024-05-06 04:17:59,236:INFO:   <<< sampled_use_mil: False
2024-05-06 04:17:59,236:INFO:   <<< seed: 42
2024-05-06 04:17:59,236:INFO:   <<< sim_header: meanP
2024-05-06 04:17:59,236:INFO:   <<< slice_framepos: 2
2024-05-06 04:17:59,236:INFO:   <<< task_type: retrieval
2024-05-06 04:17:59,236:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:17:59,236:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:17:59,236:INFO:   <<< train_frame_order: 0
2024-05-06 04:17:59,236:INFO:   <<< use_mil: False
2024-05-06 04:17:59,236:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:17:59,236:INFO:   <<< video_dim: 1024
2024-05-06 04:17:59,236:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:17:59,236:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:17:59,236:INFO:   <<< world_size: 1
2024-05-06 04:17:59,236:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:17:59,375:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 04:17:59,845:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 04:17:59,846:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 04:17:59,846:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 04:17:59,846:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 04:17:59,846:WARNING: Test retrieval by loose type.
2024-05-06 04:17:59,846:WARNING: 	 embed_dim: 512
2024-05-06 04:17:59,846:WARNING: 	 image_resolution: 224
2024-05-06 04:17:59,846:WARNING: 	 vision_layers: 12
2024-05-06 04:17:59,846:WARNING: 	 vision_width: 768
2024-05-06 04:17:59,846:WARNING: 	 vision_patch_size: 32
2024-05-06 04:17:59,846:WARNING: 	 context_length: 77
2024-05-06 04:17:59,846:WARNING: 	 vocab_size: 49408
2024-05-06 04:17:59,846:WARNING: 	 transformer_width: 512
2024-05-06 04:17:59,846:WARNING: 	 transformer_heads: 8
2024-05-06 04:17:59,846:WARNING: 	 transformer_layers: 12
2024-05-06 04:17:59,846:WARNING: 		 linear_patch: 2d
2024-05-06 04:17:59,846:WARNING: 	 cut_top_layer: 0
2024-05-06 04:18:00,706:WARNING: 	 sim_header: meanP
2024-05-06 04:18:04,396:INFO: --------------------
2024-05-06 04:18:04,397:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 04:23:10,972:INFO: Effective parameters:
2024-05-06 04:23:10,972:INFO:   <<< batch_size: 1
2024-05-06 04:23:10,972:INFO:   <<< batch_size_val: 16
2024-05-06 04:23:10,972:INFO:   <<< cache_dir: 
2024-05-06 04:23:10,972:INFO:   <<< coef_lr: 0.001
2024-05-06 04:23:10,972:INFO:   <<< cross_model: cross-base
2024-05-06 04:23:10,972:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:23:10,972:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:23:10,972:INFO:   <<< datatype: msrvtt
2024-05-06 04:23:10,972:INFO:   <<< do_eval: True
2024-05-06 04:23:10,972:INFO:   <<< do_lower_case: False
2024-05-06 04:23:10,972:INFO:   <<< do_pretrain: False
2024-05-06 04:23:10,972:INFO:   <<< do_train: False
2024-05-06 04:23:10,972:INFO:   <<< epochs: 2
2024-05-06 04:23:10,972:INFO:   <<< eval_frame_order: 0
2024-05-06 04:23:10,972:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:23:10,972:INFO:   <<< feature_framerate: 1
2024-05-06 04:23:10,972:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:23:10,973:INFO:   <<< fp16: False
2024-05-06 04:23:10,973:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:23:10,973:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:23:10,973:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:23:10,973:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:23:10,973:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:23:10,973:INFO:   <<< linear_patch: 2d
2024-05-06 04:23:10,973:INFO:   <<< local_rank: 0
2024-05-06 04:23:10,973:INFO:   <<< loose_type: True
2024-05-06 04:23:10,973:INFO:   <<< lr: 0.0001
2024-05-06 04:23:10,973:INFO:   <<< lr_decay: 0.9
2024-05-06 04:23:10,973:INFO:   <<< margin: 0.1
2024-05-06 04:23:10,973:INFO:   <<< max_frames: 90
2024-05-06 04:23:10,973:INFO:   <<< max_words: 32
2024-05-06 04:23:10,973:INFO:   <<< n_display: 100
2024-05-06 04:23:10,973:INFO:   <<< n_gpu: 1
2024-05-06 04:23:10,973:INFO:   <<< n_pair: 1
2024-05-06 04:23:10,973:INFO:   <<< negative_weighting: 1
2024-05-06 04:23:10,973:INFO:   <<< num_thread_reader: 0
2024-05-06 04:23:10,973:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:23:10,973:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:23:10,973:INFO:   <<< rank: 0
2024-05-06 04:23:10,973:INFO:   <<< resume_model: None
2024-05-06 04:23:10,973:INFO:   <<< sampled_use_mil: False
2024-05-06 04:23:10,973:INFO:   <<< seed: 42
2024-05-06 04:23:10,973:INFO:   <<< sim_header: meanP
2024-05-06 04:23:10,973:INFO:   <<< slice_framepos: 2
2024-05-06 04:23:10,973:INFO:   <<< task_type: retrieval
2024-05-06 04:23:10,973:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:23:10,973:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:23:10,973:INFO:   <<< train_frame_order: 0
2024-05-06 04:23:10,973:INFO:   <<< use_mil: False
2024-05-06 04:23:10,973:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:23:10,973:INFO:   <<< video_dim: 1024
2024-05-06 04:23:10,973:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:23:10,973:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:23:10,973:INFO:   <<< world_size: 1
2024-05-06 04:23:10,973:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:23:11,108:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 04:23:11,566:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 04:23:11,566:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 04:23:11,566:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 04:23:11,566:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 04:23:11,566:WARNING: Test retrieval by loose type.
2024-05-06 04:23:11,566:WARNING: 	 embed_dim: 512
2024-05-06 04:23:11,566:WARNING: 	 image_resolution: 224
2024-05-06 04:23:11,566:WARNING: 	 vision_layers: 12
2024-05-06 04:23:11,567:WARNING: 	 vision_width: 768
2024-05-06 04:23:11,567:WARNING: 	 vision_patch_size: 32
2024-05-06 04:23:11,567:WARNING: 	 context_length: 77
2024-05-06 04:23:11,567:WARNING: 	 vocab_size: 49408
2024-05-06 04:23:11,567:WARNING: 	 transformer_width: 512
2024-05-06 04:23:11,567:WARNING: 	 transformer_heads: 8
2024-05-06 04:23:11,567:WARNING: 	 transformer_layers: 12
2024-05-06 04:23:11,567:WARNING: 		 linear_patch: 2d
2024-05-06 04:23:11,567:WARNING: 	 cut_top_layer: 0
2024-05-06 04:23:12,407:WARNING: 	 sim_header: meanP
2024-05-06 04:23:16,142:INFO: --------------------
2024-05-06 04:23:16,142:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 04:24:32,380:INFO: Effective parameters:
2024-05-06 04:24:32,380:INFO:   <<< batch_size: 1
2024-05-06 04:24:32,380:INFO:   <<< batch_size_val: 16
2024-05-06 04:24:32,380:INFO:   <<< cache_dir: 
2024-05-06 04:24:32,380:INFO:   <<< coef_lr: 0.001
2024-05-06 04:24:32,380:INFO:   <<< cross_model: cross-base
2024-05-06 04:24:32,380:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:24:32,380:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:24:32,380:INFO:   <<< datatype: msrvtt
2024-05-06 04:24:32,380:INFO:   <<< do_eval: True
2024-05-06 04:24:32,380:INFO:   <<< do_lower_case: False
2024-05-06 04:24:32,380:INFO:   <<< do_pretrain: False
2024-05-06 04:24:32,380:INFO:   <<< do_train: False
2024-05-06 04:24:32,380:INFO:   <<< epochs: 2
2024-05-06 04:24:32,381:INFO:   <<< eval_frame_order: 0
2024-05-06 04:24:32,381:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:24:32,381:INFO:   <<< feature_framerate: 1
2024-05-06 04:24:32,381:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:24:32,381:INFO:   <<< fp16: False
2024-05-06 04:24:32,381:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:24:32,381:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:24:32,381:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:24:32,381:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:24:32,381:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:24:32,381:INFO:   <<< linear_patch: 2d
2024-05-06 04:24:32,381:INFO:   <<< local_rank: 0
2024-05-06 04:24:32,381:INFO:   <<< loose_type: True
2024-05-06 04:24:32,381:INFO:   <<< lr: 0.0001
2024-05-06 04:24:32,381:INFO:   <<< lr_decay: 0.9
2024-05-06 04:24:32,381:INFO:   <<< margin: 0.1
2024-05-06 04:24:32,381:INFO:   <<< max_frames: 90
2024-05-06 04:24:32,381:INFO:   <<< max_words: 32
2024-05-06 04:24:32,381:INFO:   <<< n_display: 100
2024-05-06 04:24:32,381:INFO:   <<< n_gpu: 1
2024-05-06 04:24:32,381:INFO:   <<< n_pair: 1
2024-05-06 04:24:32,381:INFO:   <<< negative_weighting: 1
2024-05-06 04:24:32,381:INFO:   <<< num_thread_reader: 0
2024-05-06 04:24:32,381:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:24:32,381:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:24:32,381:INFO:   <<< rank: 0
2024-05-06 04:24:32,381:INFO:   <<< resume_model: None
2024-05-06 04:24:32,381:INFO:   <<< sampled_use_mil: False
2024-05-06 04:24:32,381:INFO:   <<< seed: 42
2024-05-06 04:24:32,381:INFO:   <<< sim_header: meanP
2024-05-06 04:24:32,381:INFO:   <<< slice_framepos: 2
2024-05-06 04:24:32,381:INFO:   <<< task_type: retrieval
2024-05-06 04:24:32,381:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:24:32,381:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:24:32,381:INFO:   <<< train_frame_order: 0
2024-05-06 04:24:32,381:INFO:   <<< use_mil: False
2024-05-06 04:24:32,381:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:24:32,381:INFO:   <<< video_dim: 1024
2024-05-06 04:24:32,381:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:24:32,381:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:24:32,381:INFO:   <<< world_size: 1
2024-05-06 04:24:32,381:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:24:32,527:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 04:24:32,981:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 04:24:32,982:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 04:24:32,982:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 04:24:32,982:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 04:24:32,982:WARNING: Test retrieval by loose type.
2024-05-06 04:24:32,982:WARNING: 	 embed_dim: 512
2024-05-06 04:24:32,982:WARNING: 	 image_resolution: 224
2024-05-06 04:24:32,982:WARNING: 	 vision_layers: 12
2024-05-06 04:24:32,982:WARNING: 	 vision_width: 768
2024-05-06 04:24:32,982:WARNING: 	 vision_patch_size: 32
2024-05-06 04:24:32,983:WARNING: 	 context_length: 77
2024-05-06 04:24:32,983:WARNING: 	 vocab_size: 49408
2024-05-06 04:24:32,983:WARNING: 	 transformer_width: 512
2024-05-06 04:24:32,983:WARNING: 	 transformer_heads: 8
2024-05-06 04:24:32,983:WARNING: 	 transformer_layers: 12
2024-05-06 04:24:32,983:WARNING: 		 linear_patch: 2d
2024-05-06 04:24:32,983:WARNING: 	 cut_top_layer: 0
2024-05-06 04:24:33,826:WARNING: 	 sim_header: meanP
2024-05-06 04:24:37,599:INFO: --------------------
2024-05-06 04:24:37,600:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 04:26:26,049:INFO: Effective parameters:
2024-05-06 04:26:26,049:INFO:   <<< batch_size: 1
2024-05-06 04:26:26,049:INFO:   <<< batch_size_val: 16
2024-05-06 04:26:26,049:INFO:   <<< cache_dir: 
2024-05-06 04:26:26,049:INFO:   <<< coef_lr: 0.001
2024-05-06 04:26:26,049:INFO:   <<< cross_model: cross-base
2024-05-06 04:26:26,049:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:26:26,049:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:26:26,049:INFO:   <<< datatype: msrvtt
2024-05-06 04:26:26,049:INFO:   <<< do_eval: True
2024-05-06 04:26:26,049:INFO:   <<< do_lower_case: False
2024-05-06 04:26:26,049:INFO:   <<< do_pretrain: False
2024-05-06 04:26:26,049:INFO:   <<< do_train: False
2024-05-06 04:26:26,049:INFO:   <<< epochs: 2
2024-05-06 04:26:26,049:INFO:   <<< eval_frame_order: 0
2024-05-06 04:26:26,049:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:26:26,049:INFO:   <<< feature_framerate: 1
2024-05-06 04:26:26,049:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:26:26,049:INFO:   <<< fp16: False
2024-05-06 04:26:26,049:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:26:26,049:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:26:26,049:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:26:26,049:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:26:26,049:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:26:26,049:INFO:   <<< linear_patch: 2d
2024-05-06 04:26:26,049:INFO:   <<< local_rank: 0
2024-05-06 04:26:26,049:INFO:   <<< loose_type: True
2024-05-06 04:26:26,049:INFO:   <<< lr: 0.0001
2024-05-06 04:26:26,049:INFO:   <<< lr_decay: 0.9
2024-05-06 04:26:26,049:INFO:   <<< margin: 0.1
2024-05-06 04:26:26,049:INFO:   <<< max_frames: 90
2024-05-06 04:26:26,049:INFO:   <<< max_words: 32
2024-05-06 04:26:26,049:INFO:   <<< n_display: 100
2024-05-06 04:26:26,050:INFO:   <<< n_gpu: 1
2024-05-06 04:26:26,050:INFO:   <<< n_pair: 1
2024-05-06 04:26:26,050:INFO:   <<< negative_weighting: 1
2024-05-06 04:26:26,050:INFO:   <<< num_thread_reader: 0
2024-05-06 04:26:26,050:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:26:26,050:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:26:26,050:INFO:   <<< rank: 0
2024-05-06 04:26:26,050:INFO:   <<< resume_model: None
2024-05-06 04:26:26,050:INFO:   <<< sampled_use_mil: False
2024-05-06 04:26:26,050:INFO:   <<< seed: 42
2024-05-06 04:26:26,050:INFO:   <<< sim_header: meanP
2024-05-06 04:26:26,050:INFO:   <<< slice_framepos: 2
2024-05-06 04:26:26,050:INFO:   <<< task_type: retrieval
2024-05-06 04:26:26,050:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:26:26,050:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:26:26,050:INFO:   <<< train_frame_order: 0
2024-05-06 04:26:26,050:INFO:   <<< use_mil: False
2024-05-06 04:26:26,050:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:26:26,050:INFO:   <<< video_dim: 1024
2024-05-06 04:26:26,050:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:26:26,050:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:26:26,050:INFO:   <<< world_size: 1
2024-05-06 04:26:26,050:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:26:26,187:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 04:26:26,640:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 04:26:26,640:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 04:26:26,640:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 04:26:26,640:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 04:26:26,640:WARNING: Test retrieval by loose type.
2024-05-06 04:26:26,640:WARNING: 	 embed_dim: 512
2024-05-06 04:26:26,640:WARNING: 	 image_resolution: 224
2024-05-06 04:26:26,640:WARNING: 	 vision_layers: 12
2024-05-06 04:26:26,640:WARNING: 	 vision_width: 768
2024-05-06 04:26:26,640:WARNING: 	 vision_patch_size: 32
2024-05-06 04:26:26,641:WARNING: 	 context_length: 77
2024-05-06 04:26:26,641:WARNING: 	 vocab_size: 49408
2024-05-06 04:26:26,641:WARNING: 	 transformer_width: 512
2024-05-06 04:26:26,641:WARNING: 	 transformer_heads: 8
2024-05-06 04:26:26,641:WARNING: 	 transformer_layers: 12
2024-05-06 04:26:26,641:WARNING: 		 linear_patch: 2d
2024-05-06 04:26:26,641:WARNING: 	 cut_top_layer: 0
2024-05-06 04:26:27,503:WARNING: 	 sim_header: meanP
2024-05-06 04:26:31,206:INFO: --------------------
2024-05-06 04:26:31,206:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 04:35:11,365:INFO: Effective parameters:
2024-05-06 04:35:11,365:INFO:   <<< batch_size: 1
2024-05-06 04:35:11,365:INFO:   <<< batch_size_val: 16
2024-05-06 04:35:11,365:INFO:   <<< cache_dir: 
2024-05-06 04:35:11,365:INFO:   <<< coef_lr: 0.001
2024-05-06 04:35:11,365:INFO:   <<< cross_model: cross-base
2024-05-06 04:35:11,365:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:35:11,365:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:35:11,365:INFO:   <<< datatype: msrvtt
2024-05-06 04:35:11,365:INFO:   <<< do_eval: True
2024-05-06 04:35:11,365:INFO:   <<< do_lower_case: False
2024-05-06 04:35:11,365:INFO:   <<< do_pretrain: False
2024-05-06 04:35:11,365:INFO:   <<< do_train: False
2024-05-06 04:35:11,365:INFO:   <<< epochs: 2
2024-05-06 04:35:11,365:INFO:   <<< eval_frame_order: 0
2024-05-06 04:35:11,365:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:35:11,365:INFO:   <<< feature_framerate: 1
2024-05-06 04:35:11,365:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:35:11,365:INFO:   <<< fp16: False
2024-05-06 04:35:11,365:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:35:11,366:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:35:11,366:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:35:11,366:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:35:11,366:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:35:11,366:INFO:   <<< linear_patch: 2d
2024-05-06 04:35:11,366:INFO:   <<< local_rank: 0
2024-05-06 04:35:11,366:INFO:   <<< loose_type: True
2024-05-06 04:35:11,366:INFO:   <<< lr: 0.0001
2024-05-06 04:35:11,366:INFO:   <<< lr_decay: 0.9
2024-05-06 04:35:11,366:INFO:   <<< margin: 0.1
2024-05-06 04:35:11,366:INFO:   <<< max_frames: 90
2024-05-06 04:35:11,366:INFO:   <<< max_words: 32
2024-05-06 04:35:11,366:INFO:   <<< n_display: 100
2024-05-06 04:35:11,366:INFO:   <<< n_gpu: 1
2024-05-06 04:35:11,366:INFO:   <<< n_pair: 1
2024-05-06 04:35:11,366:INFO:   <<< negative_weighting: 1
2024-05-06 04:35:11,366:INFO:   <<< num_thread_reader: 0
2024-05-06 04:35:11,366:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:35:11,366:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:35:11,366:INFO:   <<< rank: 0
2024-05-06 04:35:11,366:INFO:   <<< resume_model: None
2024-05-06 04:35:11,366:INFO:   <<< sampled_use_mil: False
2024-05-06 04:35:11,366:INFO:   <<< seed: 42
2024-05-06 04:35:11,366:INFO:   <<< sim_header: meanP
2024-05-06 04:35:11,366:INFO:   <<< slice_framepos: 2
2024-05-06 04:35:11,366:INFO:   <<< task_type: retrieval
2024-05-06 04:35:11,366:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:35:11,366:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:35:11,366:INFO:   <<< train_frame_order: 0
2024-05-06 04:35:11,366:INFO:   <<< use_mil: False
2024-05-06 04:35:11,366:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:35:11,366:INFO:   <<< video_dim: 1024
2024-05-06 04:35:11,366:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:35:11,366:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:35:11,366:INFO:   <<< world_size: 1
2024-05-06 04:35:11,366:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:35:56,948:INFO: Effective parameters:
2024-05-06 04:35:56,948:INFO:   <<< batch_size: 1
2024-05-06 04:35:56,948:INFO:   <<< batch_size_val: 16
2024-05-06 04:35:56,949:INFO:   <<< cache_dir: 
2024-05-06 04:35:56,949:INFO:   <<< coef_lr: 0.001
2024-05-06 04:35:56,949:INFO:   <<< cross_model: cross-base
2024-05-06 04:35:56,949:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:35:56,949:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:35:56,949:INFO:   <<< datatype: msrvtt
2024-05-06 04:35:56,949:INFO:   <<< do_eval: True
2024-05-06 04:35:56,949:INFO:   <<< do_lower_case: False
2024-05-06 04:35:56,949:INFO:   <<< do_pretrain: False
2024-05-06 04:35:56,949:INFO:   <<< do_train: False
2024-05-06 04:35:56,949:INFO:   <<< epochs: 2
2024-05-06 04:35:56,949:INFO:   <<< eval_frame_order: 0
2024-05-06 04:35:56,949:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:35:56,949:INFO:   <<< feature_framerate: 1
2024-05-06 04:35:56,949:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:35:56,949:INFO:   <<< fp16: False
2024-05-06 04:35:56,949:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:35:56,950:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:35:56,950:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:35:56,950:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:35:56,950:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:35:56,950:INFO:   <<< linear_patch: 2d
2024-05-06 04:35:56,950:INFO:   <<< local_rank: 0
2024-05-06 04:35:56,950:INFO:   <<< loose_type: True
2024-05-06 04:35:56,950:INFO:   <<< lr: 0.0001
2024-05-06 04:35:56,950:INFO:   <<< lr_decay: 0.9
2024-05-06 04:35:56,950:INFO:   <<< margin: 0.1
2024-05-06 04:35:56,950:INFO:   <<< max_frames: 90
2024-05-06 04:35:56,950:INFO:   <<< max_words: 32
2024-05-06 04:35:56,950:INFO:   <<< n_display: 100
2024-05-06 04:35:56,950:INFO:   <<< n_gpu: 1
2024-05-06 04:35:56,950:INFO:   <<< n_pair: 1
2024-05-06 04:35:56,950:INFO:   <<< negative_weighting: 1
2024-05-06 04:35:56,950:INFO:   <<< num_thread_reader: 0
2024-05-06 04:35:56,951:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:35:56,951:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:35:56,951:INFO:   <<< rank: 0
2024-05-06 04:35:56,951:INFO:   <<< resume_model: None
2024-05-06 04:35:56,951:INFO:   <<< sampled_use_mil: False
2024-05-06 04:35:56,951:INFO:   <<< seed: 42
2024-05-06 04:35:56,951:INFO:   <<< sim_header: meanP
2024-05-06 04:35:56,951:INFO:   <<< slice_framepos: 2
2024-05-06 04:35:56,951:INFO:   <<< task_type: retrieval
2024-05-06 04:35:56,951:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:35:56,951:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:35:56,951:INFO:   <<< train_frame_order: 0
2024-05-06 04:35:56,951:INFO:   <<< use_mil: False
2024-05-06 04:35:56,951:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:35:56,951:INFO:   <<< video_dim: 1024
2024-05-06 04:35:56,951:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:35:56,951:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:35:56,952:INFO:   <<< world_size: 1
2024-05-06 04:35:56,952:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:36:39,785:INFO: Effective parameters:
2024-05-06 04:36:39,786:INFO:   <<< batch_size: 1
2024-05-06 04:36:39,786:INFO:   <<< batch_size_val: 16
2024-05-06 04:36:39,786:INFO:   <<< cache_dir: 
2024-05-06 04:36:39,786:INFO:   <<< coef_lr: 0.001
2024-05-06 04:36:39,786:INFO:   <<< cross_model: cross-base
2024-05-06 04:36:39,786:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:36:39,786:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:36:39,786:INFO:   <<< datatype: msrvtt
2024-05-06 04:36:39,786:INFO:   <<< do_eval: True
2024-05-06 04:36:39,786:INFO:   <<< do_lower_case: False
2024-05-06 04:36:39,786:INFO:   <<< do_pretrain: False
2024-05-06 04:36:39,786:INFO:   <<< do_train: False
2024-05-06 04:36:39,786:INFO:   <<< epochs: 2
2024-05-06 04:36:39,786:INFO:   <<< eval_frame_order: 0
2024-05-06 04:36:39,786:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:36:39,786:INFO:   <<< feature_framerate: 1
2024-05-06 04:36:39,787:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:36:39,787:INFO:   <<< fp16: False
2024-05-06 04:36:39,787:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:36:39,787:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:36:39,787:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:36:39,787:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:36:39,787:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:36:39,787:INFO:   <<< linear_patch: 2d
2024-05-06 04:36:39,787:INFO:   <<< local_rank: 0
2024-05-06 04:36:39,787:INFO:   <<< loose_type: True
2024-05-06 04:36:39,787:INFO:   <<< lr: 0.0001
2024-05-06 04:36:39,787:INFO:   <<< lr_decay: 0.9
2024-05-06 04:36:39,787:INFO:   <<< margin: 0.1
2024-05-06 04:36:39,787:INFO:   <<< max_frames: 90
2024-05-06 04:36:39,787:INFO:   <<< max_words: 32
2024-05-06 04:36:39,787:INFO:   <<< n_display: 100
2024-05-06 04:36:39,787:INFO:   <<< n_gpu: 1
2024-05-06 04:36:39,788:INFO:   <<< n_pair: 1
2024-05-06 04:36:39,788:INFO:   <<< negative_weighting: 1
2024-05-06 04:36:39,788:INFO:   <<< num_thread_reader: 0
2024-05-06 04:36:39,788:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:36:39,788:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:36:39,788:INFO:   <<< rank: 0
2024-05-06 04:36:39,788:INFO:   <<< resume_model: None
2024-05-06 04:36:39,788:INFO:   <<< sampled_use_mil: False
2024-05-06 04:36:39,788:INFO:   <<< seed: 42
2024-05-06 04:36:39,788:INFO:   <<< sim_header: meanP
2024-05-06 04:36:39,788:INFO:   <<< slice_framepos: 2
2024-05-06 04:36:39,788:INFO:   <<< task_type: retrieval
2024-05-06 04:36:39,788:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:36:39,788:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:36:39,788:INFO:   <<< train_frame_order: 0
2024-05-06 04:36:39,788:INFO:   <<< use_mil: False
2024-05-06 04:36:39,788:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:36:39,789:INFO:   <<< video_dim: 1024
2024-05-06 04:36:39,789:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:36:39,789:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:36:39,789:INFO:   <<< world_size: 1
2024-05-06 04:36:39,789:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:40:29,208:INFO: Effective parameters:
2024-05-06 04:40:29,209:INFO:   <<< batch_size: 1
2024-05-06 04:40:29,209:INFO:   <<< batch_size_val: 16
2024-05-06 04:40:29,209:INFO:   <<< cache_dir: 
2024-05-06 04:40:29,209:INFO:   <<< coef_lr: 0.001
2024-05-06 04:40:29,209:INFO:   <<< cross_model: cross-base
2024-05-06 04:40:29,209:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:40:29,209:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:40:29,209:INFO:   <<< datatype: msrvtt
2024-05-06 04:40:29,209:INFO:   <<< do_eval: True
2024-05-06 04:40:29,209:INFO:   <<< do_lower_case: False
2024-05-06 04:40:29,209:INFO:   <<< do_pretrain: False
2024-05-06 04:40:29,209:INFO:   <<< do_train: False
2024-05-06 04:40:29,209:INFO:   <<< epochs: 2
2024-05-06 04:40:29,209:INFO:   <<< eval_frame_order: 0
2024-05-06 04:40:29,210:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:40:29,210:INFO:   <<< feature_framerate: 1
2024-05-06 04:40:29,210:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:40:29,210:INFO:   <<< fp16: False
2024-05-06 04:40:29,210:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:40:29,210:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:40:29,210:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:40:29,210:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:40:29,210:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:40:29,210:INFO:   <<< linear_patch: 2d
2024-05-06 04:40:29,210:INFO:   <<< local_rank: 0
2024-05-06 04:40:29,210:INFO:   <<< loose_type: True
2024-05-06 04:40:29,210:INFO:   <<< lr: 0.0001
2024-05-06 04:40:29,210:INFO:   <<< lr_decay: 0.9
2024-05-06 04:40:29,210:INFO:   <<< margin: 0.1
2024-05-06 04:40:29,210:INFO:   <<< max_frames: 90
2024-05-06 04:40:29,210:INFO:   <<< max_words: 32
2024-05-06 04:40:29,211:INFO:   <<< n_display: 100
2024-05-06 04:40:29,211:INFO:   <<< n_gpu: 1
2024-05-06 04:40:29,211:INFO:   <<< n_pair: 1
2024-05-06 04:40:29,211:INFO:   <<< negative_weighting: 1
2024-05-06 04:40:29,211:INFO:   <<< num_thread_reader: 0
2024-05-06 04:40:29,211:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:40:29,211:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:40:29,211:INFO:   <<< rank: 0
2024-05-06 04:40:29,211:INFO:   <<< resume_model: None
2024-05-06 04:40:29,211:INFO:   <<< sampled_use_mil: False
2024-05-06 04:40:29,211:INFO:   <<< seed: 42
2024-05-06 04:40:29,211:INFO:   <<< sim_header: meanP
2024-05-06 04:40:29,211:INFO:   <<< slice_framepos: 2
2024-05-06 04:40:29,211:INFO:   <<< task_type: retrieval
2024-05-06 04:40:29,211:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:40:29,211:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:40:29,211:INFO:   <<< train_frame_order: 0
2024-05-06 04:40:29,212:INFO:   <<< use_mil: False
2024-05-06 04:40:29,212:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:40:29,212:INFO:   <<< video_dim: 1024
2024-05-06 04:40:29,212:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:40:29,212:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:40:29,212:INFO:   <<< world_size: 1
2024-05-06 04:40:29,212:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:40:39,741:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/ViT-B-32.pt
2024-05-06 04:54:15,717:INFO: Effective parameters:
2024-05-06 04:54:15,717:INFO:   <<< batch_size: 16
2024-05-06 04:54:15,717:INFO:   <<< batch_size_val: 16
2024-05-06 04:54:15,717:INFO:   <<< cache_dir: 
2024-05-06 04:54:15,717:INFO:   <<< coef_lr: 0.001
2024-05-06 04:54:15,717:INFO:   <<< cross_model: cross-base
2024-05-06 04:54:15,717:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 04:54:15,717:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 04:54:15,717:INFO:   <<< datatype: msrvtt
2024-05-06 04:54:15,717:INFO:   <<< do_eval: True
2024-05-06 04:54:15,717:INFO:   <<< do_lower_case: False
2024-05-06 04:54:15,717:INFO:   <<< do_pretrain: False
2024-05-06 04:54:15,717:INFO:   <<< do_train: False
2024-05-06 04:54:15,717:INFO:   <<< epochs: 2
2024-05-06 04:54:15,717:INFO:   <<< eval_frame_order: 0
2024-05-06 04:54:15,717:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 04:54:15,718:INFO:   <<< feature_framerate: 1
2024-05-06 04:54:15,718:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 04:54:15,718:INFO:   <<< fp16: False
2024-05-06 04:54:15,718:INFO:   <<< fp16_opt_level: O1
2024-05-06 04:54:15,718:INFO:   <<< freeze_layer_num: 0
2024-05-06 04:54:15,718:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 04:54:15,718:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 04:54:15,718:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 04:54:15,718:INFO:   <<< linear_patch: 2d
2024-05-06 04:54:15,718:INFO:   <<< local_rank: 0
2024-05-06 04:54:15,718:INFO:   <<< loose_type: True
2024-05-06 04:54:15,718:INFO:   <<< lr: 0.0001
2024-05-06 04:54:15,718:INFO:   <<< lr_decay: 0.9
2024-05-06 04:54:15,718:INFO:   <<< margin: 0.1
2024-05-06 04:54:15,718:INFO:   <<< max_frames: 12
2024-05-06 04:54:15,718:INFO:   <<< max_words: 32
2024-05-06 04:54:15,718:INFO:   <<< n_display: 100
2024-05-06 04:54:15,718:INFO:   <<< n_gpu: 1
2024-05-06 04:54:15,718:INFO:   <<< n_pair: 1
2024-05-06 04:54:15,718:INFO:   <<< negative_weighting: 1
2024-05-06 04:54:15,718:INFO:   <<< num_thread_reader: 0
2024-05-06 04:54:15,718:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 04:54:15,719:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 04:54:15,719:INFO:   <<< rank: 0
2024-05-06 04:54:15,719:INFO:   <<< resume_model: None
2024-05-06 04:54:15,719:INFO:   <<< sampled_use_mil: False
2024-05-06 04:54:15,719:INFO:   <<< seed: 42
2024-05-06 04:54:15,719:INFO:   <<< sim_header: meanP
2024-05-06 04:54:15,719:INFO:   <<< slice_framepos: 2
2024-05-06 04:54:15,719:INFO:   <<< task_type: retrieval
2024-05-06 04:54:15,719:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 04:54:15,719:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 04:54:15,719:INFO:   <<< train_frame_order: 0
2024-05-06 04:54:15,719:INFO:   <<< use_mil: False
2024-05-06 04:54:15,719:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 04:54:15,719:INFO:   <<< video_dim: 1024
2024-05-06 04:54:15,719:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 04:54:15,719:INFO:   <<< warmup_proportion: 0.1
2024-05-06 04:54:15,719:INFO:   <<< world_size: 1
2024-05-06 04:54:15,719:INFO: device: cuda:0 n_gpu: 1
2024-05-06 04:54:15,912:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 04:54:16,381:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 04:54:16,382:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 04:54:16,382:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 04:54:16,382:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 04:54:16,382:WARNING: Test retrieval by loose type.
2024-05-06 04:54:16,382:WARNING: 	 embed_dim: 512
2024-05-06 04:54:16,382:WARNING: 	 image_resolution: 224
2024-05-06 04:54:16,382:WARNING: 	 vision_layers: 12
2024-05-06 04:54:16,382:WARNING: 	 vision_width: 768
2024-05-06 04:54:16,382:WARNING: 	 vision_patch_size: 32
2024-05-06 04:54:16,382:WARNING: 	 context_length: 77
2024-05-06 04:54:16,382:WARNING: 	 vocab_size: 49408
2024-05-06 04:54:16,382:WARNING: 	 transformer_width: 512
2024-05-06 04:54:16,382:WARNING: 	 transformer_heads: 8
2024-05-06 04:54:16,382:WARNING: 	 transformer_layers: 12
2024-05-06 04:54:16,382:WARNING: 		 linear_patch: 2d
2024-05-06 04:54:16,382:WARNING: 	 cut_top_layer: 0
2024-05-06 04:54:17,214:WARNING: 	 sim_header: meanP
2024-05-06 04:54:20,905:INFO: --------------------
2024-05-06 04:54:20,905:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 04:54:22,958:INFO: ***** Running test *****
2024-05-06 04:54:22,958:INFO:   Num examples = 1000
2024-05-06 04:54:22,958:INFO:   Batch size = 16
2024-05-06 04:54:22,958:INFO:   Num steps = 63
2024-05-06 04:54:22,958:INFO: ***** Running val *****
2024-05-06 04:54:22,958:INFO:   Num examples = 1000
2024-05-06 04:56:54,243:INFO: sim matrix size: 1000, 1000
2024-05-06 04:56:54,314:INFO: 	 Length-T: 1000, Length-V:1000
2024-05-06 04:56:54,314:INFO: Text-to-Video:
2024-05-06 04:56:54,314:INFO: 	>>>  R@1: 43.3 - R@5: 68.8 - R@10: 78.4 - Median R: 2.0 - Mean R: 16.3
2024-05-06 04:56:54,314:INFO: Video-to-Text:
2024-05-06 04:56:54,314:INFO: 	>>>  V2T$R@1: 40.1 - V2T$R@5: 68.6 - V2T$R@10: 79.3 - V2T$Median R: 2.0 - V2T$Mean R: 13.0
2024-05-06 05:03:52,883:INFO: Effective parameters:
2024-05-06 05:03:52,883:INFO:   <<< batch_size: 16
2024-05-06 05:03:52,883:INFO:   <<< batch_size_val: 16
2024-05-06 05:03:52,883:INFO:   <<< cache_dir: 
2024-05-06 05:03:52,883:INFO:   <<< coef_lr: 0.001
2024-05-06 05:03:52,883:INFO:   <<< cross_model: cross-base
2024-05-06 05:03:52,883:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:03:52,883:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:03:52,883:INFO:   <<< datatype: msrvtt
2024-05-06 05:03:52,884:INFO:   <<< do_eval: True
2024-05-06 05:03:52,884:INFO:   <<< do_lower_case: False
2024-05-06 05:03:52,884:INFO:   <<< do_pretrain: False
2024-05-06 05:03:52,884:INFO:   <<< do_train: False
2024-05-06 05:03:52,884:INFO:   <<< epochs: 2
2024-05-06 05:03:52,884:INFO:   <<< eval_frame_order: 0
2024-05-06 05:03:52,884:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:03:52,884:INFO:   <<< feature_framerate: 1
2024-05-06 05:03:52,884:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:03:52,884:INFO:   <<< fp16: False
2024-05-06 05:03:52,884:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:03:52,884:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:03:52,884:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:03:52,884:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:03:52,884:INFO:   <<< init_model: None
2024-05-06 05:03:52,884:INFO:   <<< linear_patch: 2d
2024-05-06 05:03:52,884:INFO:   <<< local_rank: 0
2024-05-06 05:03:52,884:INFO:   <<< loose_type: True
2024-05-06 05:03:52,884:INFO:   <<< lr: 0.0001
2024-05-06 05:03:52,884:INFO:   <<< lr_decay: 0.9
2024-05-06 05:03:52,884:INFO:   <<< margin: 0.1
2024-05-06 05:03:52,884:INFO:   <<< max_frames: 12
2024-05-06 05:03:52,884:INFO:   <<< max_words: 32
2024-05-06 05:03:52,884:INFO:   <<< n_display: 100
2024-05-06 05:03:52,884:INFO:   <<< n_gpu: 1
2024-05-06 05:03:52,884:INFO:   <<< n_pair: 1
2024-05-06 05:03:52,884:INFO:   <<< negative_weighting: 1
2024-05-06 05:03:52,885:INFO:   <<< num_thread_reader: 0
2024-05-06 05:03:52,885:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:03:52,885:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:03:52,885:INFO:   <<< rank: 0
2024-05-06 05:03:52,885:INFO:   <<< resume_model: None
2024-05-06 05:03:52,885:INFO:   <<< sampled_use_mil: False
2024-05-06 05:03:52,885:INFO:   <<< seed: 42
2024-05-06 05:03:52,885:INFO:   <<< sim_header: meanP
2024-05-06 05:03:52,885:INFO:   <<< slice_framepos: 2
2024-05-06 05:03:52,885:INFO:   <<< task_type: retrieval
2024-05-06 05:03:52,885:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:03:52,885:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:03:52,885:INFO:   <<< train_frame_order: 0
2024-05-06 05:03:52,885:INFO:   <<< use_mil: False
2024-05-06 05:03:52,885:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:03:52,885:INFO:   <<< video_dim: 1024
2024-05-06 05:03:52,885:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:03:52,885:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:03:52,885:INFO:   <<< world_size: 1
2024-05-06 05:03:52,885:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:03:53,084:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:03:53,531:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:03:53,531:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:03:53,531:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:03:53,531:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:03:53,531:WARNING: Test retrieval by loose type.
2024-05-06 05:03:53,531:WARNING: 	 embed_dim: 512
2024-05-06 05:03:53,531:WARNING: 	 image_resolution: 224
2024-05-06 05:03:53,531:WARNING: 	 vision_layers: 12
2024-05-06 05:03:53,531:WARNING: 	 vision_width: 768
2024-05-06 05:03:53,531:WARNING: 	 vision_patch_size: 32
2024-05-06 05:03:53,531:WARNING: 	 context_length: 77
2024-05-06 05:03:53,531:WARNING: 	 vocab_size: 49408
2024-05-06 05:03:53,531:WARNING: 	 transformer_width: 512
2024-05-06 05:03:53,531:WARNING: 	 transformer_heads: 8
2024-05-06 05:03:53,531:WARNING: 	 transformer_layers: 12
2024-05-06 05:03:53,531:WARNING: 		 linear_patch: 2d
2024-05-06 05:03:53,531:WARNING: 	 cut_top_layer: 0
2024-05-06 05:03:54,376:WARNING: 	 sim_header: meanP
2024-05-06 05:03:58,083:INFO: --------------------
2024-05-06 05:03:58,083:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:04:00,132:INFO: ***** Running test *****
2024-05-06 05:04:00,132:INFO:   Num examples = 1000
2024-05-06 05:04:00,132:INFO:   Batch size = 16
2024-05-06 05:04:00,132:INFO:   Num steps = 63
2024-05-06 05:04:00,132:INFO: ***** Running val *****
2024-05-06 05:04:00,132:INFO:   Num examples = 1000
2024-05-06 05:06:25,137:INFO: sim matrix size: 1000, 1000
2024-05-06 05:06:25,204:INFO: 	 Length-T: 1000, Length-V:1000
2024-05-06 05:06:25,204:INFO: Text-to-Video:
2024-05-06 05:06:25,204:INFO: 	>>>  R@1: 43.3 - R@5: 68.8 - R@10: 78.4 - Median R: 2.0 - Mean R: 16.3
2024-05-06 05:06:25,204:INFO: Video-to-Text:
2024-05-06 05:06:25,204:INFO: 	>>>  V2T$R@1: 40.1 - V2T$R@5: 68.6 - V2T$R@10: 79.3 - V2T$Median R: 2.0 - V2T$Mean R: 13.0
2024-05-06 05:06:47,080:INFO: Effective parameters:
2024-05-06 05:06:47,080:INFO:   <<< batch_size: 16
2024-05-06 05:06:47,080:INFO:   <<< batch_size_val: 16
2024-05-06 05:06:47,080:INFO:   <<< cache_dir: 
2024-05-06 05:06:47,080:INFO:   <<< coef_lr: 0.001
2024-05-06 05:06:47,080:INFO:   <<< cross_model: cross-base
2024-05-06 05:06:47,080:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:06:47,080:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:06:47,080:INFO:   <<< datatype: msrvtt
2024-05-06 05:06:47,080:INFO:   <<< do_eval: True
2024-05-06 05:06:47,080:INFO:   <<< do_lower_case: False
2024-05-06 05:06:47,080:INFO:   <<< do_pretrain: False
2024-05-06 05:06:47,080:INFO:   <<< do_train: False
2024-05-06 05:06:47,080:INFO:   <<< epochs: 2
2024-05-06 05:06:47,080:INFO:   <<< eval_frame_order: 0
2024-05-06 05:06:47,081:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:06:47,081:INFO:   <<< feature_framerate: 1
2024-05-06 05:06:47,081:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:06:47,081:INFO:   <<< fp16: False
2024-05-06 05:06:47,081:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:06:47,081:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:06:47,081:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:06:47,081:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:06:47,081:INFO:   <<< init_model: None
2024-05-06 05:06:47,081:INFO:   <<< linear_patch: 2d
2024-05-06 05:06:47,081:INFO:   <<< local_rank: 0
2024-05-06 05:06:47,081:INFO:   <<< loose_type: True
2024-05-06 05:06:47,081:INFO:   <<< lr: 0.0001
2024-05-06 05:06:47,081:INFO:   <<< lr_decay: 0.9
2024-05-06 05:06:47,081:INFO:   <<< margin: 0.1
2024-05-06 05:06:47,081:INFO:   <<< max_frames: 12
2024-05-06 05:06:47,081:INFO:   <<< max_words: 32
2024-05-06 05:06:47,081:INFO:   <<< n_display: 100
2024-05-06 05:06:47,081:INFO:   <<< n_gpu: 1
2024-05-06 05:06:47,081:INFO:   <<< n_pair: 1
2024-05-06 05:06:47,081:INFO:   <<< negative_weighting: 1
2024-05-06 05:06:47,081:INFO:   <<< num_thread_reader: 0
2024-05-06 05:06:47,081:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:06:47,081:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:06:47,081:INFO:   <<< rank: 0
2024-05-06 05:06:47,081:INFO:   <<< resume_model: None
2024-05-06 05:06:47,081:INFO:   <<< sampled_use_mil: False
2024-05-06 05:06:47,081:INFO:   <<< seed: 42
2024-05-06 05:06:47,081:INFO:   <<< sim_header: meanP
2024-05-06 05:06:47,081:INFO:   <<< slice_framepos: 2
2024-05-06 05:06:47,081:INFO:   <<< task_type: retrieval
2024-05-06 05:06:47,081:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:06:47,081:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:06:47,081:INFO:   <<< train_frame_order: 0
2024-05-06 05:06:47,081:INFO:   <<< use_mil: False
2024-05-06 05:06:47,081:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:06:47,081:INFO:   <<< video_dim: 1024
2024-05-06 05:06:47,081:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:06:47,081:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:06:47,081:INFO:   <<< world_size: 1
2024-05-06 05:06:47,081:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:12:34,950:INFO: Effective parameters:
2024-05-06 05:12:34,950:INFO:   <<< batch_size: 1
2024-05-06 05:12:34,950:INFO:   <<< batch_size_val: 16
2024-05-06 05:12:34,950:INFO:   <<< cache_dir: 
2024-05-06 05:12:34,950:INFO:   <<< coef_lr: 0.001
2024-05-06 05:12:34,950:INFO:   <<< cross_model: cross-base
2024-05-06 05:12:34,950:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:12:34,950:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:12:34,950:INFO:   <<< datatype: msrvtt
2024-05-06 05:12:34,950:INFO:   <<< do_eval: True
2024-05-06 05:12:34,950:INFO:   <<< do_lower_case: False
2024-05-06 05:12:34,950:INFO:   <<< do_pretrain: False
2024-05-06 05:12:34,950:INFO:   <<< do_train: False
2024-05-06 05:12:34,950:INFO:   <<< epochs: 2
2024-05-06 05:12:34,950:INFO:   <<< eval_frame_order: 0
2024-05-06 05:12:34,950:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:12:34,950:INFO:   <<< feature_framerate: 1
2024-05-06 05:12:34,950:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:12:34,950:INFO:   <<< fp16: False
2024-05-06 05:12:34,950:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:12:34,950:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:12:34,950:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:12:34,950:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:12:34,950:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:12:34,950:INFO:   <<< linear_patch: 2d
2024-05-06 05:12:34,950:INFO:   <<< local_rank: 0
2024-05-06 05:12:34,950:INFO:   <<< loose_type: True
2024-05-06 05:12:34,950:INFO:   <<< lr: 0.0001
2024-05-06 05:12:34,950:INFO:   <<< lr_decay: 0.9
2024-05-06 05:12:34,950:INFO:   <<< margin: 0.1
2024-05-06 05:12:34,951:INFO:   <<< max_frames: 90
2024-05-06 05:12:34,951:INFO:   <<< max_words: 32
2024-05-06 05:12:34,951:INFO:   <<< n_display: 100
2024-05-06 05:12:34,951:INFO:   <<< n_gpu: 1
2024-05-06 05:12:34,951:INFO:   <<< n_pair: 1
2024-05-06 05:12:34,951:INFO:   <<< negative_weighting: 1
2024-05-06 05:12:34,951:INFO:   <<< num_thread_reader: 0
2024-05-06 05:12:34,951:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:12:34,951:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:12:34,951:INFO:   <<< rank: 0
2024-05-06 05:12:34,951:INFO:   <<< resume_model: None
2024-05-06 05:12:34,951:INFO:   <<< sampled_use_mil: False
2024-05-06 05:12:34,951:INFO:   <<< seed: 42
2024-05-06 05:12:34,951:INFO:   <<< sim_header: meanP
2024-05-06 05:12:34,951:INFO:   <<< slice_framepos: 2
2024-05-06 05:12:34,951:INFO:   <<< task_type: retrieval
2024-05-06 05:12:34,951:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:12:34,951:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:12:34,951:INFO:   <<< train_frame_order: 0
2024-05-06 05:12:34,951:INFO:   <<< use_mil: False
2024-05-06 05:12:34,951:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:12:34,951:INFO:   <<< video_dim: 1024
2024-05-06 05:12:34,951:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:12:34,951:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:12:34,951:INFO:   <<< world_size: 1
2024-05-06 05:12:34,951:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:12:37,607:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/ViT-B-32.pt
2024-05-06 05:13:00,865:INFO: Effective parameters:
2024-05-06 05:13:00,865:INFO:   <<< batch_size: 1
2024-05-06 05:13:00,865:INFO:   <<< batch_size_val: 16
2024-05-06 05:13:00,865:INFO:   <<< cache_dir: 
2024-05-06 05:13:00,865:INFO:   <<< coef_lr: 0.001
2024-05-06 05:13:00,865:INFO:   <<< cross_model: cross-base
2024-05-06 05:13:00,865:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:13:00,865:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:13:00,865:INFO:   <<< datatype: msrvtt
2024-05-06 05:13:00,865:INFO:   <<< do_eval: True
2024-05-06 05:13:00,865:INFO:   <<< do_lower_case: False
2024-05-06 05:13:00,865:INFO:   <<< do_pretrain: False
2024-05-06 05:13:00,865:INFO:   <<< do_train: False
2024-05-06 05:13:00,865:INFO:   <<< epochs: 2
2024-05-06 05:13:00,865:INFO:   <<< eval_frame_order: 0
2024-05-06 05:13:00,865:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:13:00,865:INFO:   <<< feature_framerate: 1
2024-05-06 05:13:00,865:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:13:00,865:INFO:   <<< fp16: False
2024-05-06 05:13:00,865:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:13:00,865:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:13:00,865:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:13:00,865:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:13:00,865:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:13:00,865:INFO:   <<< linear_patch: 2d
2024-05-06 05:13:00,865:INFO:   <<< local_rank: 0
2024-05-06 05:13:00,865:INFO:   <<< loose_type: True
2024-05-06 05:13:00,865:INFO:   <<< lr: 0.0001
2024-05-06 05:13:00,865:INFO:   <<< lr_decay: 0.9
2024-05-06 05:13:00,865:INFO:   <<< margin: 0.1
2024-05-06 05:13:00,865:INFO:   <<< max_frames: 90
2024-05-06 05:13:00,865:INFO:   <<< max_words: 32
2024-05-06 05:13:00,865:INFO:   <<< n_display: 100
2024-05-06 05:13:00,865:INFO:   <<< n_gpu: 1
2024-05-06 05:13:00,865:INFO:   <<< n_pair: 1
2024-05-06 05:13:00,865:INFO:   <<< negative_weighting: 1
2024-05-06 05:13:00,865:INFO:   <<< num_thread_reader: 0
2024-05-06 05:13:00,865:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:13:00,865:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:13:00,865:INFO:   <<< rank: 0
2024-05-06 05:13:00,866:INFO:   <<< resume_model: None
2024-05-06 05:13:00,866:INFO:   <<< sampled_use_mil: False
2024-05-06 05:13:00,866:INFO:   <<< seed: 42
2024-05-06 05:13:00,866:INFO:   <<< sim_header: meanP
2024-05-06 05:13:00,866:INFO:   <<< slice_framepos: 2
2024-05-06 05:13:00,866:INFO:   <<< task_type: retrieval
2024-05-06 05:13:00,866:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:13:00,866:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:13:00,866:INFO:   <<< train_frame_order: 0
2024-05-06 05:13:00,866:INFO:   <<< use_mil: False
2024-05-06 05:13:00,866:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:13:00,866:INFO:   <<< video_dim: 1024
2024-05-06 05:13:00,866:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:13:00,866:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:13:00,866:INFO:   <<< world_size: 1
2024-05-06 05:13:00,866:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:13:01,027:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:13:01,474:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:13:01,474:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:13:01,474:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:13:01,474:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:13:01,474:WARNING: Test retrieval by loose type.
2024-05-06 05:13:01,474:WARNING: 	 embed_dim: 512
2024-05-06 05:13:01,474:WARNING: 	 image_resolution: 224
2024-05-06 05:13:01,474:WARNING: 	 vision_layers: 12
2024-05-06 05:13:01,474:WARNING: 	 vision_width: 768
2024-05-06 05:13:01,474:WARNING: 	 vision_patch_size: 32
2024-05-06 05:13:01,474:WARNING: 	 context_length: 77
2024-05-06 05:13:01,475:WARNING: 	 vocab_size: 49408
2024-05-06 05:13:01,475:WARNING: 	 transformer_width: 512
2024-05-06 05:13:01,475:WARNING: 	 transformer_heads: 8
2024-05-06 05:13:01,475:WARNING: 	 transformer_layers: 12
2024-05-06 05:13:01,475:WARNING: 		 linear_patch: 2d
2024-05-06 05:13:01,475:WARNING: 	 cut_top_layer: 0
2024-05-06 05:13:02,319:WARNING: 	 sim_header: meanP
2024-05-06 05:13:06,037:INFO: --------------------
2024-05-06 05:13:06,037:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:14:57,561:INFO: Effective parameters:
2024-05-06 05:14:57,561:INFO:   <<< batch_size: 1
2024-05-06 05:14:57,561:INFO:   <<< batch_size_val: 16
2024-05-06 05:14:57,561:INFO:   <<< cache_dir: 
2024-05-06 05:14:57,561:INFO:   <<< coef_lr: 0.001
2024-05-06 05:14:57,561:INFO:   <<< cross_model: cross-base
2024-05-06 05:14:57,561:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:14:57,561:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:14:57,561:INFO:   <<< datatype: msrvtt
2024-05-06 05:14:57,561:INFO:   <<< do_eval: True
2024-05-06 05:14:57,561:INFO:   <<< do_lower_case: False
2024-05-06 05:14:57,561:INFO:   <<< do_pretrain: False
2024-05-06 05:14:57,561:INFO:   <<< do_train: False
2024-05-06 05:14:57,561:INFO:   <<< epochs: 2
2024-05-06 05:14:57,561:INFO:   <<< eval_frame_order: 0
2024-05-06 05:14:57,561:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:14:57,561:INFO:   <<< feature_framerate: 1
2024-05-06 05:14:57,561:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:14:57,561:INFO:   <<< fp16: False
2024-05-06 05:14:57,561:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:14:57,561:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:14:57,561:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:14:57,561:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:14:57,561:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:14:57,561:INFO:   <<< linear_patch: 2d
2024-05-06 05:14:57,561:INFO:   <<< local_rank: 0
2024-05-06 05:14:57,561:INFO:   <<< loose_type: True
2024-05-06 05:14:57,561:INFO:   <<< lr: 0.0001
2024-05-06 05:14:57,561:INFO:   <<< lr_decay: 0.9
2024-05-06 05:14:57,561:INFO:   <<< margin: 0.1
2024-05-06 05:14:57,561:INFO:   <<< max_frames: 90
2024-05-06 05:14:57,561:INFO:   <<< max_words: 32
2024-05-06 05:14:57,561:INFO:   <<< n_display: 100
2024-05-06 05:14:57,561:INFO:   <<< n_gpu: 1
2024-05-06 05:14:57,561:INFO:   <<< n_pair: 1
2024-05-06 05:14:57,561:INFO:   <<< negative_weighting: 1
2024-05-06 05:14:57,561:INFO:   <<< num_thread_reader: 0
2024-05-06 05:14:57,561:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:14:57,561:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:14:57,562:INFO:   <<< rank: 0
2024-05-06 05:14:57,562:INFO:   <<< resume_model: None
2024-05-06 05:14:57,562:INFO:   <<< sampled_use_mil: False
2024-05-06 05:14:57,562:INFO:   <<< seed: 42
2024-05-06 05:14:57,562:INFO:   <<< sim_header: meanP
2024-05-06 05:14:57,562:INFO:   <<< slice_framepos: 2
2024-05-06 05:14:57,562:INFO:   <<< task_type: retrieval
2024-05-06 05:14:57,562:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:14:57,562:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:14:57,562:INFO:   <<< train_frame_order: 0
2024-05-06 05:14:57,562:INFO:   <<< use_mil: False
2024-05-06 05:14:57,562:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:14:57,562:INFO:   <<< video_dim: 1024
2024-05-06 05:14:57,562:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:14:57,562:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:14:57,562:INFO:   <<< world_size: 1
2024-05-06 05:14:57,562:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:14:57,696:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:14:58,165:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:14:58,166:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:14:58,166:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:14:58,166:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:14:58,166:WARNING: Test retrieval by loose type.
2024-05-06 05:14:58,166:WARNING: 	 embed_dim: 512
2024-05-06 05:14:58,166:WARNING: 	 image_resolution: 224
2024-05-06 05:14:58,166:WARNING: 	 vision_layers: 12
2024-05-06 05:14:58,166:WARNING: 	 vision_width: 768
2024-05-06 05:14:58,166:WARNING: 	 vision_patch_size: 32
2024-05-06 05:14:58,166:WARNING: 	 context_length: 77
2024-05-06 05:14:58,166:WARNING: 	 vocab_size: 49408
2024-05-06 05:14:58,166:WARNING: 	 transformer_width: 512
2024-05-06 05:14:58,166:WARNING: 	 transformer_heads: 8
2024-05-06 05:14:58,166:WARNING: 	 transformer_layers: 12
2024-05-06 05:14:58,166:WARNING: 		 linear_patch: 2d
2024-05-06 05:14:58,166:WARNING: 	 cut_top_layer: 0
2024-05-06 05:14:59,020:WARNING: 	 sim_header: meanP
2024-05-06 05:15:02,727:INFO: --------------------
2024-05-06 05:15:02,727:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:17:17,056:INFO: Effective parameters:
2024-05-06 05:17:17,057:INFO:   <<< batch_size: 1
2024-05-06 05:17:17,057:INFO:   <<< batch_size_val: 16
2024-05-06 05:17:17,057:INFO:   <<< cache_dir: 
2024-05-06 05:17:17,057:INFO:   <<< coef_lr: 0.001
2024-05-06 05:17:17,057:INFO:   <<< cross_model: cross-base
2024-05-06 05:17:17,057:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:17:17,057:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:17:17,057:INFO:   <<< datatype: msrvtt
2024-05-06 05:17:17,057:INFO:   <<< do_eval: True
2024-05-06 05:17:17,057:INFO:   <<< do_lower_case: False
2024-05-06 05:17:17,057:INFO:   <<< do_pretrain: False
2024-05-06 05:17:17,057:INFO:   <<< do_train: False
2024-05-06 05:17:17,057:INFO:   <<< epochs: 2
2024-05-06 05:17:17,057:INFO:   <<< eval_frame_order: 0
2024-05-06 05:17:17,057:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:17:17,057:INFO:   <<< feature_framerate: 1
2024-05-06 05:17:17,057:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:17:17,057:INFO:   <<< fp16: False
2024-05-06 05:17:17,057:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:17:17,057:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:17:17,057:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:17:17,057:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:17:17,057:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:17:17,057:INFO:   <<< linear_patch: 2d
2024-05-06 05:17:17,057:INFO:   <<< local_rank: 0
2024-05-06 05:17:17,057:INFO:   <<< loose_type: True
2024-05-06 05:17:17,057:INFO:   <<< lr: 0.0001
2024-05-06 05:17:17,057:INFO:   <<< lr_decay: 0.9
2024-05-06 05:17:17,057:INFO:   <<< margin: 0.1
2024-05-06 05:17:17,057:INFO:   <<< max_frames: 90
2024-05-06 05:17:17,057:INFO:   <<< max_words: 32
2024-05-06 05:17:17,057:INFO:   <<< n_display: 100
2024-05-06 05:17:17,057:INFO:   <<< n_gpu: 1
2024-05-06 05:17:17,057:INFO:   <<< n_pair: 1
2024-05-06 05:17:17,057:INFO:   <<< negative_weighting: 1
2024-05-06 05:17:17,057:INFO:   <<< num_thread_reader: 0
2024-05-06 05:17:17,057:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:17:17,057:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:17:17,057:INFO:   <<< rank: 0
2024-05-06 05:17:17,057:INFO:   <<< resume_model: None
2024-05-06 05:17:17,057:INFO:   <<< sampled_use_mil: False
2024-05-06 05:17:17,057:INFO:   <<< seed: 42
2024-05-06 05:17:17,058:INFO:   <<< sim_header: meanP
2024-05-06 05:17:17,058:INFO:   <<< slice_framepos: 2
2024-05-06 05:17:17,058:INFO:   <<< task_type: retrieval
2024-05-06 05:17:17,058:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:17:17,058:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:17:17,058:INFO:   <<< train_frame_order: 0
2024-05-06 05:17:17,058:INFO:   <<< use_mil: False
2024-05-06 05:17:17,058:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:17:17,058:INFO:   <<< video_dim: 1024
2024-05-06 05:17:17,058:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:17:17,058:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:17:17,058:INFO:   <<< world_size: 1
2024-05-06 05:17:17,058:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:17:17,219:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:17:17,668:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:17:17,668:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:17:17,668:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:17:17,668:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:17:17,668:WARNING: Test retrieval by loose type.
2024-05-06 05:17:17,668:WARNING: 	 embed_dim: 512
2024-05-06 05:17:17,668:WARNING: 	 image_resolution: 224
2024-05-06 05:17:17,668:WARNING: 	 vision_layers: 12
2024-05-06 05:17:17,668:WARNING: 	 vision_width: 768
2024-05-06 05:17:17,668:WARNING: 	 vision_patch_size: 32
2024-05-06 05:17:17,668:WARNING: 	 context_length: 77
2024-05-06 05:17:17,668:WARNING: 	 vocab_size: 49408
2024-05-06 05:17:17,668:WARNING: 	 transformer_width: 512
2024-05-06 05:17:17,668:WARNING: 	 transformer_heads: 8
2024-05-06 05:17:17,668:WARNING: 	 transformer_layers: 12
2024-05-06 05:17:17,668:WARNING: 		 linear_patch: 2d
2024-05-06 05:17:17,668:WARNING: 	 cut_top_layer: 0
2024-05-06 05:17:18,519:WARNING: 	 sim_header: meanP
2024-05-06 05:17:22,201:INFO: --------------------
2024-05-06 05:17:22,201:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:22:01,652:INFO: Effective parameters:
2024-05-06 05:22:01,652:INFO:   <<< batch_size: 1
2024-05-06 05:22:01,652:INFO:   <<< batch_size_val: 16
2024-05-06 05:22:01,652:INFO:   <<< cache_dir: 
2024-05-06 05:22:01,652:INFO:   <<< coef_lr: 0.001
2024-05-06 05:22:01,652:INFO:   <<< cross_model: cross-base
2024-05-06 05:22:01,652:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:22:01,652:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:22:01,652:INFO:   <<< datatype: msrvtt
2024-05-06 05:22:01,652:INFO:   <<< do_eval: True
2024-05-06 05:22:01,652:INFO:   <<< do_lower_case: False
2024-05-06 05:22:01,652:INFO:   <<< do_pretrain: False
2024-05-06 05:22:01,652:INFO:   <<< do_train: False
2024-05-06 05:22:01,652:INFO:   <<< epochs: 2
2024-05-06 05:22:01,652:INFO:   <<< eval_frame_order: 0
2024-05-06 05:22:01,652:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:22:01,652:INFO:   <<< feature_framerate: 1
2024-05-06 05:22:01,652:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:22:01,652:INFO:   <<< fp16: False
2024-05-06 05:22:01,652:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:22:01,652:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:22:01,652:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:22:01,652:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:22:01,652:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:22:01,652:INFO:   <<< linear_patch: 2d
2024-05-06 05:22:01,652:INFO:   <<< local_rank: 0
2024-05-06 05:22:01,653:INFO:   <<< loose_type: True
2024-05-06 05:22:01,653:INFO:   <<< lr: 0.0001
2024-05-06 05:22:01,653:INFO:   <<< lr_decay: 0.9
2024-05-06 05:22:01,653:INFO:   <<< margin: 0.1
2024-05-06 05:22:01,653:INFO:   <<< max_frames: 90
2024-05-06 05:22:01,653:INFO:   <<< max_words: 32
2024-05-06 05:22:01,653:INFO:   <<< n_display: 100
2024-05-06 05:22:01,653:INFO:   <<< n_gpu: 1
2024-05-06 05:22:01,653:INFO:   <<< n_pair: 1
2024-05-06 05:22:01,653:INFO:   <<< negative_weighting: 1
2024-05-06 05:22:01,653:INFO:   <<< num_thread_reader: 0
2024-05-06 05:22:01,653:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:22:01,653:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:22:01,653:INFO:   <<< rank: 0
2024-05-06 05:22:01,653:INFO:   <<< resume_model: None
2024-05-06 05:22:01,653:INFO:   <<< sampled_use_mil: False
2024-05-06 05:22:01,653:INFO:   <<< seed: 42
2024-05-06 05:22:01,653:INFO:   <<< sim_header: meanP
2024-05-06 05:22:01,653:INFO:   <<< slice_framepos: 2
2024-05-06 05:22:01,653:INFO:   <<< task_type: retrieval
2024-05-06 05:22:01,653:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:22:01,653:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:22:01,653:INFO:   <<< train_frame_order: 0
2024-05-06 05:22:01,653:INFO:   <<< use_mil: False
2024-05-06 05:22:01,653:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:22:01,653:INFO:   <<< video_dim: 1024
2024-05-06 05:22:01,653:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:22:01,653:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:22:01,653:INFO:   <<< world_size: 1
2024-05-06 05:22:01,653:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:22:01,790:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:22:02,270:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:22:02,270:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:22:02,270:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:22:02,270:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:22:02,270:WARNING: Test retrieval by loose type.
2024-05-06 05:22:02,270:WARNING: 	 embed_dim: 512
2024-05-06 05:22:02,270:WARNING: 	 image_resolution: 224
2024-05-06 05:22:02,270:WARNING: 	 vision_layers: 12
2024-05-06 05:22:02,270:WARNING: 	 vision_width: 768
2024-05-06 05:22:02,270:WARNING: 	 vision_patch_size: 32
2024-05-06 05:22:02,270:WARNING: 	 context_length: 77
2024-05-06 05:22:02,270:WARNING: 	 vocab_size: 49408
2024-05-06 05:22:02,270:WARNING: 	 transformer_width: 512
2024-05-06 05:22:02,270:WARNING: 	 transformer_heads: 8
2024-05-06 05:22:02,270:WARNING: 	 transformer_layers: 12
2024-05-06 05:22:02,270:WARNING: 		 linear_patch: 2d
2024-05-06 05:22:02,270:WARNING: 	 cut_top_layer: 0
2024-05-06 05:22:03,169:WARNING: 	 sim_header: meanP
2024-05-06 05:22:06,860:INFO: --------------------
2024-05-06 05:22:06,860:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:22:41,716:INFO: Effective parameters:
2024-05-06 05:22:41,717:INFO:   <<< batch_size: 1
2024-05-06 05:22:41,717:INFO:   <<< batch_size_val: 16
2024-05-06 05:22:41,717:INFO:   <<< cache_dir: 
2024-05-06 05:22:41,717:INFO:   <<< coef_lr: 0.001
2024-05-06 05:22:41,717:INFO:   <<< cross_model: cross-base
2024-05-06 05:22:41,717:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:22:41,717:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:22:41,717:INFO:   <<< datatype: msrvtt
2024-05-06 05:22:41,717:INFO:   <<< do_eval: True
2024-05-06 05:22:41,717:INFO:   <<< do_lower_case: False
2024-05-06 05:22:41,717:INFO:   <<< do_pretrain: False
2024-05-06 05:22:41,718:INFO:   <<< do_train: False
2024-05-06 05:22:41,718:INFO:   <<< epochs: 2
2024-05-06 05:22:41,718:INFO:   <<< eval_frame_order: 0
2024-05-06 05:22:41,718:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:22:41,718:INFO:   <<< feature_framerate: 1
2024-05-06 05:22:41,718:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:22:41,718:INFO:   <<< fp16: False
2024-05-06 05:22:41,718:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:22:41,718:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:22:41,718:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:22:41,718:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:22:41,718:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:22:41,718:INFO:   <<< linear_patch: 2d
2024-05-06 05:22:41,718:INFO:   <<< local_rank: 0
2024-05-06 05:22:41,718:INFO:   <<< loose_type: True
2024-05-06 05:22:41,718:INFO:   <<< lr: 0.0001
2024-05-06 05:22:41,719:INFO:   <<< lr_decay: 0.9
2024-05-06 05:22:41,719:INFO:   <<< margin: 0.1
2024-05-06 05:22:41,719:INFO:   <<< max_frames: 90
2024-05-06 05:22:41,719:INFO:   <<< max_words: 32
2024-05-06 05:22:41,719:INFO:   <<< n_display: 100
2024-05-06 05:22:41,719:INFO:   <<< n_gpu: 1
2024-05-06 05:22:41,719:INFO:   <<< n_pair: 1
2024-05-06 05:22:41,719:INFO:   <<< negative_weighting: 1
2024-05-06 05:22:41,719:INFO:   <<< num_thread_reader: 0
2024-05-06 05:22:41,719:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:22:41,719:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:22:41,719:INFO:   <<< rank: 0
2024-05-06 05:22:41,719:INFO:   <<< resume_model: None
2024-05-06 05:22:41,719:INFO:   <<< sampled_use_mil: False
2024-05-06 05:22:41,719:INFO:   <<< seed: 42
2024-05-06 05:22:41,719:INFO:   <<< sim_header: meanP
2024-05-06 05:22:41,719:INFO:   <<< slice_framepos: 2
2024-05-06 05:22:41,720:INFO:   <<< task_type: retrieval
2024-05-06 05:22:41,720:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:22:41,720:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:22:41,720:INFO:   <<< train_frame_order: 0
2024-05-06 05:22:41,720:INFO:   <<< use_mil: False
2024-05-06 05:22:41,720:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:22:41,720:INFO:   <<< video_dim: 1024
2024-05-06 05:22:41,720:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:22:41,720:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:22:41,720:INFO:   <<< world_size: 1
2024-05-06 05:22:41,720:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:22:45,457:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:22:45,958:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:22:45,959:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:22:45,959:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:22:45,960:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:22:45,960:WARNING: Test retrieval by loose type.
2024-05-06 05:22:45,962:WARNING: 	 embed_dim: 512
2024-05-06 05:22:45,962:WARNING: 	 image_resolution: 224
2024-05-06 05:22:45,962:WARNING: 	 vision_layers: 12
2024-05-06 05:22:45,962:WARNING: 	 vision_width: 768
2024-05-06 05:22:45,962:WARNING: 	 vision_patch_size: 32
2024-05-06 05:22:45,962:WARNING: 	 context_length: 77
2024-05-06 05:22:45,963:WARNING: 	 vocab_size: 49408
2024-05-06 05:22:45,963:WARNING: 	 transformer_width: 512
2024-05-06 05:22:45,963:WARNING: 	 transformer_heads: 8
2024-05-06 05:22:45,963:WARNING: 	 transformer_layers: 12
2024-05-06 05:22:45,963:WARNING: 		 linear_patch: 2d
2024-05-06 05:22:45,963:WARNING: 	 cut_top_layer: 0
2024-05-06 05:22:46,861:WARNING: 	 sim_header: meanP
2024-05-06 05:22:50,570:INFO: --------------------
2024-05-06 05:22:50,570:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:23:46,573:INFO: Effective parameters:
2024-05-06 05:23:46,573:INFO:   <<< batch_size: 1
2024-05-06 05:23:46,573:INFO:   <<< batch_size_val: 16
2024-05-06 05:23:46,573:INFO:   <<< cache_dir: 
2024-05-06 05:23:46,574:INFO:   <<< coef_lr: 0.001
2024-05-06 05:23:46,574:INFO:   <<< cross_model: cross-base
2024-05-06 05:23:46,574:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:23:46,574:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:23:46,574:INFO:   <<< datatype: msrvtt
2024-05-06 05:23:46,574:INFO:   <<< do_eval: True
2024-05-06 05:23:46,574:INFO:   <<< do_lower_case: False
2024-05-06 05:23:46,574:INFO:   <<< do_pretrain: False
2024-05-06 05:23:46,574:INFO:   <<< do_train: False
2024-05-06 05:23:46,574:INFO:   <<< epochs: 2
2024-05-06 05:23:46,574:INFO:   <<< eval_frame_order: 0
2024-05-06 05:23:46,574:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:23:46,574:INFO:   <<< feature_framerate: 1
2024-05-06 05:23:46,574:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:23:46,574:INFO:   <<< fp16: False
2024-05-06 05:23:46,575:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:23:46,575:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:23:46,575:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:23:46,575:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:23:46,575:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:23:46,575:INFO:   <<< linear_patch: 2d
2024-05-06 05:23:46,575:INFO:   <<< local_rank: 0
2024-05-06 05:23:46,575:INFO:   <<< loose_type: True
2024-05-06 05:23:46,575:INFO:   <<< lr: 0.0001
2024-05-06 05:23:46,575:INFO:   <<< lr_decay: 0.9
2024-05-06 05:23:46,575:INFO:   <<< margin: 0.1
2024-05-06 05:23:46,575:INFO:   <<< max_frames: 90
2024-05-06 05:23:46,575:INFO:   <<< max_words: 32
2024-05-06 05:23:46,575:INFO:   <<< n_display: 100
2024-05-06 05:23:46,575:INFO:   <<< n_gpu: 1
2024-05-06 05:23:46,575:INFO:   <<< n_pair: 1
2024-05-06 05:23:46,576:INFO:   <<< negative_weighting: 1
2024-05-06 05:23:46,576:INFO:   <<< num_thread_reader: 0
2024-05-06 05:23:46,576:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:23:46,576:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:23:46,576:INFO:   <<< rank: 0
2024-05-06 05:23:46,576:INFO:   <<< resume_model: None
2024-05-06 05:23:46,576:INFO:   <<< sampled_use_mil: False
2024-05-06 05:23:46,576:INFO:   <<< seed: 42
2024-05-06 05:23:46,576:INFO:   <<< sim_header: meanP
2024-05-06 05:23:46,576:INFO:   <<< slice_framepos: 2
2024-05-06 05:23:46,576:INFO:   <<< task_type: retrieval
2024-05-06 05:23:46,576:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:23:46,576:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:23:46,576:INFO:   <<< train_frame_order: 0
2024-05-06 05:23:46,576:INFO:   <<< use_mil: False
2024-05-06 05:23:46,576:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:23:46,577:INFO:   <<< video_dim: 1024
2024-05-06 05:23:46,577:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:23:46,577:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:23:46,577:INFO:   <<< world_size: 1
2024-05-06 05:23:46,577:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:23:46,727:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:23:47,192:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:23:47,193:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:23:47,193:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:23:47,193:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:23:47,193:WARNING: Test retrieval by loose type.
2024-05-06 05:23:47,194:WARNING: 	 embed_dim: 512
2024-05-06 05:23:47,194:WARNING: 	 image_resolution: 224
2024-05-06 05:23:47,194:WARNING: 	 vision_layers: 12
2024-05-06 05:23:47,194:WARNING: 	 vision_width: 768
2024-05-06 05:23:47,194:WARNING: 	 vision_patch_size: 32
2024-05-06 05:23:47,194:WARNING: 	 context_length: 77
2024-05-06 05:23:47,194:WARNING: 	 vocab_size: 49408
2024-05-06 05:23:47,195:WARNING: 	 transformer_width: 512
2024-05-06 05:23:47,195:WARNING: 	 transformer_heads: 8
2024-05-06 05:23:47,195:WARNING: 	 transformer_layers: 12
2024-05-06 05:23:47,195:WARNING: 		 linear_patch: 2d
2024-05-06 05:23:47,195:WARNING: 	 cut_top_layer: 0
2024-05-06 05:23:48,059:WARNING: 	 sim_header: meanP
2024-05-06 05:23:51,808:INFO: --------------------
2024-05-06 05:23:51,808:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:27:43,201:INFO: Effective parameters:
2024-05-06 05:27:43,202:INFO:   <<< batch_size: 1
2024-05-06 05:27:43,202:INFO:   <<< batch_size_val: 16
2024-05-06 05:27:43,202:INFO:   <<< cache_dir: 
2024-05-06 05:27:43,202:INFO:   <<< coef_lr: 0.001
2024-05-06 05:27:43,202:INFO:   <<< cross_model: cross-base
2024-05-06 05:27:43,202:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:27:43,202:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:27:43,202:INFO:   <<< datatype: msrvtt
2024-05-06 05:27:43,202:INFO:   <<< do_eval: True
2024-05-06 05:27:43,202:INFO:   <<< do_lower_case: False
2024-05-06 05:27:43,202:INFO:   <<< do_pretrain: False
2024-05-06 05:27:43,202:INFO:   <<< do_train: False
2024-05-06 05:27:43,202:INFO:   <<< epochs: 2
2024-05-06 05:27:43,202:INFO:   <<< eval_frame_order: 0
2024-05-06 05:27:43,202:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:27:43,202:INFO:   <<< feature_framerate: 1
2024-05-06 05:27:43,203:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:27:43,203:INFO:   <<< fp16: False
2024-05-06 05:27:43,203:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:27:43,203:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:27:43,203:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:27:43,203:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:27:43,203:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:27:43,203:INFO:   <<< linear_patch: 2d
2024-05-06 05:27:43,203:INFO:   <<< local_rank: 0
2024-05-06 05:27:43,203:INFO:   <<< loose_type: True
2024-05-06 05:27:43,203:INFO:   <<< lr: 0.0001
2024-05-06 05:27:43,203:INFO:   <<< lr_decay: 0.9
2024-05-06 05:27:43,203:INFO:   <<< margin: 0.1
2024-05-06 05:27:43,203:INFO:   <<< max_frames: 90
2024-05-06 05:27:43,203:INFO:   <<< max_words: 32
2024-05-06 05:27:43,203:INFO:   <<< n_display: 100
2024-05-06 05:27:43,203:INFO:   <<< n_gpu: 1
2024-05-06 05:27:43,204:INFO:   <<< n_pair: 1
2024-05-06 05:27:43,204:INFO:   <<< negative_weighting: 1
2024-05-06 05:27:43,204:INFO:   <<< num_thread_reader: 0
2024-05-06 05:27:43,204:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:27:43,204:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:27:43,204:INFO:   <<< rank: 0
2024-05-06 05:27:43,204:INFO:   <<< resume_model: None
2024-05-06 05:27:43,204:INFO:   <<< sampled_use_mil: False
2024-05-06 05:27:43,204:INFO:   <<< seed: 42
2024-05-06 05:27:43,204:INFO:   <<< sim_header: meanP
2024-05-06 05:27:43,204:INFO:   <<< slice_framepos: 2
2024-05-06 05:27:43,204:INFO:   <<< task_type: retrieval
2024-05-06 05:27:43,204:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:27:43,204:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:27:43,204:INFO:   <<< train_frame_order: 0
2024-05-06 05:27:43,204:INFO:   <<< use_mil: False
2024-05-06 05:27:43,204:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:27:43,205:INFO:   <<< video_dim: 1024
2024-05-06 05:27:43,205:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:27:43,205:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:27:43,205:INFO:   <<< world_size: 1
2024-05-06 05:27:43,205:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:27:43,347:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:27:43,818:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:27:43,819:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:27:43,819:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:27:43,819:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:27:43,819:WARNING: Test retrieval by loose type.
2024-05-06 05:27:43,820:WARNING: 	 embed_dim: 512
2024-05-06 05:27:43,820:WARNING: 	 image_resolution: 224
2024-05-06 05:27:43,820:WARNING: 	 vision_layers: 12
2024-05-06 05:27:43,820:WARNING: 	 vision_width: 768
2024-05-06 05:27:43,820:WARNING: 	 vision_patch_size: 32
2024-05-06 05:27:43,821:WARNING: 	 context_length: 77
2024-05-06 05:27:43,821:WARNING: 	 vocab_size: 49408
2024-05-06 05:27:43,821:WARNING: 	 transformer_width: 512
2024-05-06 05:27:43,821:WARNING: 	 transformer_heads: 8
2024-05-06 05:27:43,821:WARNING: 	 transformer_layers: 12
2024-05-06 05:27:43,821:WARNING: 		 linear_patch: 2d
2024-05-06 05:27:43,821:WARNING: 	 cut_top_layer: 0
2024-05-06 05:27:44,696:WARNING: 	 sim_header: meanP
2024-05-06 05:27:48,363:INFO: --------------------
2024-05-06 05:27:48,364:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:29:14,630:INFO: Effective parameters:
2024-05-06 05:29:14,631:INFO:   <<< batch_size: 1
2024-05-06 05:29:14,631:INFO:   <<< batch_size_val: 16
2024-05-06 05:29:14,631:INFO:   <<< cache_dir: 
2024-05-06 05:29:14,631:INFO:   <<< coef_lr: 0.001
2024-05-06 05:29:14,631:INFO:   <<< cross_model: cross-base
2024-05-06 05:29:14,631:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:29:14,631:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:29:14,631:INFO:   <<< datatype: msrvtt
2024-05-06 05:29:14,632:INFO:   <<< do_eval: True
2024-05-06 05:29:14,632:INFO:   <<< do_lower_case: False
2024-05-06 05:29:14,632:INFO:   <<< do_pretrain: False
2024-05-06 05:29:14,632:INFO:   <<< do_train: False
2024-05-06 05:29:14,632:INFO:   <<< epochs: 2
2024-05-06 05:29:14,632:INFO:   <<< eval_frame_order: 0
2024-05-06 05:29:14,632:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:29:14,632:INFO:   <<< feature_framerate: 1
2024-05-06 05:29:14,632:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:29:14,632:INFO:   <<< fp16: False
2024-05-06 05:29:14,632:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:29:14,633:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:29:14,633:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:29:14,633:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:29:14,633:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:29:14,633:INFO:   <<< linear_patch: 2d
2024-05-06 05:29:14,633:INFO:   <<< local_rank: 0
2024-05-06 05:29:14,633:INFO:   <<< loose_type: True
2024-05-06 05:29:14,633:INFO:   <<< lr: 0.0001
2024-05-06 05:29:14,633:INFO:   <<< lr_decay: 0.9
2024-05-06 05:29:14,633:INFO:   <<< margin: 0.1
2024-05-06 05:29:14,633:INFO:   <<< max_frames: 90
2024-05-06 05:29:14,633:INFO:   <<< max_words: 32
2024-05-06 05:29:14,634:INFO:   <<< n_display: 100
2024-05-06 05:29:14,634:INFO:   <<< n_gpu: 1
2024-05-06 05:29:14,634:INFO:   <<< n_pair: 1
2024-05-06 05:29:14,634:INFO:   <<< negative_weighting: 1
2024-05-06 05:29:14,634:INFO:   <<< num_thread_reader: 0
2024-05-06 05:29:14,634:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:29:14,634:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:29:14,634:INFO:   <<< rank: 0
2024-05-06 05:29:14,634:INFO:   <<< resume_model: None
2024-05-06 05:29:14,634:INFO:   <<< sampled_use_mil: False
2024-05-06 05:29:14,634:INFO:   <<< seed: 42
2024-05-06 05:29:14,635:INFO:   <<< sim_header: meanP
2024-05-06 05:29:14,635:INFO:   <<< slice_framepos: 2
2024-05-06 05:29:14,635:INFO:   <<< task_type: retrieval
2024-05-06 05:29:14,635:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:29:14,635:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:29:14,635:INFO:   <<< train_frame_order: 0
2024-05-06 05:29:14,635:INFO:   <<< use_mil: False
2024-05-06 05:29:14,635:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:29:14,635:INFO:   <<< video_dim: 1024
2024-05-06 05:29:14,635:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:29:14,635:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:29:14,635:INFO:   <<< world_size: 1
2024-05-06 05:29:14,636:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:29:14,776:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:29:15,262:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:29:15,263:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:29:15,263:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:29:15,263:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:29:15,264:WARNING: Test retrieval by loose type.
2024-05-06 05:29:15,265:WARNING: 	 embed_dim: 512
2024-05-06 05:29:15,265:WARNING: 	 image_resolution: 224
2024-05-06 05:29:15,265:WARNING: 	 vision_layers: 12
2024-05-06 05:29:15,265:WARNING: 	 vision_width: 768
2024-05-06 05:29:15,265:WARNING: 	 vision_patch_size: 32
2024-05-06 05:29:15,266:WARNING: 	 context_length: 77
2024-05-06 05:29:15,266:WARNING: 	 vocab_size: 49408
2024-05-06 05:29:15,266:WARNING: 	 transformer_width: 512
2024-05-06 05:29:15,266:WARNING: 	 transformer_heads: 8
2024-05-06 05:29:15,266:WARNING: 	 transformer_layers: 12
2024-05-06 05:29:15,266:WARNING: 		 linear_patch: 2d
2024-05-06 05:29:15,266:WARNING: 	 cut_top_layer: 0
2024-05-06 05:29:16,124:WARNING: 	 sim_header: meanP
2024-05-06 05:29:19,838:INFO: --------------------
2024-05-06 05:29:19,838:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:32:38,516:INFO: Effective parameters:
2024-05-06 05:32:38,517:INFO:   <<< batch_size: 1
2024-05-06 05:32:38,517:INFO:   <<< batch_size_val: 16
2024-05-06 05:32:38,517:INFO:   <<< cache_dir: 
2024-05-06 05:32:38,517:INFO:   <<< coef_lr: 0.001
2024-05-06 05:32:38,517:INFO:   <<< cross_model: cross-base
2024-05-06 05:32:38,517:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:32:38,517:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:32:38,517:INFO:   <<< datatype: msrvtt
2024-05-06 05:32:38,517:INFO:   <<< do_eval: True
2024-05-06 05:32:38,517:INFO:   <<< do_lower_case: False
2024-05-06 05:32:38,517:INFO:   <<< do_pretrain: False
2024-05-06 05:32:38,517:INFO:   <<< do_train: False
2024-05-06 05:32:38,517:INFO:   <<< epochs: 2
2024-05-06 05:32:38,517:INFO:   <<< eval_frame_order: 0
2024-05-06 05:32:38,517:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:32:38,517:INFO:   <<< feature_framerate: 1
2024-05-06 05:32:38,517:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:32:38,517:INFO:   <<< fp16: False
2024-05-06 05:32:38,517:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:32:38,517:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:32:38,517:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:32:38,517:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:32:38,517:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb_20230612-b9706e54.pth
2024-05-06 05:32:38,517:INFO:   <<< linear_patch: 2d
2024-05-06 05:32:38,517:INFO:   <<< local_rank: 0
2024-05-06 05:32:38,517:INFO:   <<< loose_type: True
2024-05-06 05:32:38,517:INFO:   <<< lr: 0.0001
2024-05-06 05:32:38,517:INFO:   <<< lr_decay: 0.9
2024-05-06 05:32:38,517:INFO:   <<< margin: 0.1
2024-05-06 05:32:38,517:INFO:   <<< max_frames: 90
2024-05-06 05:32:38,517:INFO:   <<< max_words: 32
2024-05-06 05:32:38,517:INFO:   <<< n_display: 100
2024-05-06 05:32:38,517:INFO:   <<< n_gpu: 1
2024-05-06 05:32:38,517:INFO:   <<< n_pair: 1
2024-05-06 05:32:38,517:INFO:   <<< negative_weighting: 1
2024-05-06 05:32:38,517:INFO:   <<< num_thread_reader: 0
2024-05-06 05:32:38,517:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:32:38,517:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:32:38,517:INFO:   <<< rank: 0
2024-05-06 05:32:38,517:INFO:   <<< resume_model: None
2024-05-06 05:32:38,517:INFO:   <<< sampled_use_mil: False
2024-05-06 05:32:38,517:INFO:   <<< seed: 42
2024-05-06 05:32:38,517:INFO:   <<< sim_header: meanP
2024-05-06 05:32:38,517:INFO:   <<< slice_framepos: 2
2024-05-06 05:32:38,517:INFO:   <<< task_type: retrieval
2024-05-06 05:32:38,517:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:32:38,517:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:32:38,517:INFO:   <<< train_frame_order: 0
2024-05-06 05:32:38,517:INFO:   <<< use_mil: False
2024-05-06 05:32:38,517:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:32:38,517:INFO:   <<< video_dim: 1024
2024-05-06 05:32:38,517:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:32:38,517:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:32:38,518:INFO:   <<< world_size: 1
2024-05-06 05:32:38,518:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:32:38,665:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 05:32:39,121:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:32:39,122:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:32:39,122:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:32:39,122:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:32:39,122:WARNING: Test retrieval by loose type.
2024-05-06 05:32:39,122:WARNING: 	 embed_dim: 512
2024-05-06 05:32:39,122:WARNING: 	 image_resolution: 224
2024-05-06 05:32:39,122:WARNING: 	 vision_layers: 12
2024-05-06 05:32:39,122:WARNING: 	 vision_width: 768
2024-05-06 05:32:39,122:WARNING: 	 vision_patch_size: 32
2024-05-06 05:32:39,122:WARNING: 	 context_length: 77
2024-05-06 05:32:39,122:WARNING: 	 vocab_size: 49408
2024-05-06 05:32:39,122:WARNING: 	 transformer_width: 512
2024-05-06 05:32:39,122:WARNING: 	 transformer_heads: 8
2024-05-06 05:32:39,122:WARNING: 	 transformer_layers: 12
2024-05-06 05:32:39,122:WARNING: 		 linear_patch: 2d
2024-05-06 05:32:39,123:WARNING: 	 cut_top_layer: 0
2024-05-06 05:32:39,974:WARNING: 	 sim_header: meanP
2024-05-06 05:32:43,678:INFO: --------------------
2024-05-06 05:32:43,678:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:38:37,113:INFO: Effective parameters:
2024-05-06 05:38:37,113:INFO:   <<< batch_size: 16
2024-05-06 05:38:37,113:INFO:   <<< batch_size_val: 16
2024-05-06 05:38:37,113:INFO:   <<< cache_dir: 
2024-05-06 05:38:37,113:INFO:   <<< coef_lr: 0.001
2024-05-06 05:38:37,113:INFO:   <<< cross_model: cross-base
2024-05-06 05:38:37,113:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:38:37,113:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:38:37,113:INFO:   <<< datatype: msrvtt
2024-05-06 05:38:37,114:INFO:   <<< do_eval: True
2024-05-06 05:38:37,114:INFO:   <<< do_lower_case: False
2024-05-06 05:38:37,114:INFO:   <<< do_pretrain: False
2024-05-06 05:38:37,114:INFO:   <<< do_train: False
2024-05-06 05:38:37,114:INFO:   <<< epochs: 2
2024-05-06 05:38:37,114:INFO:   <<< eval_frame_order: 0
2024-05-06 05:38:37,114:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:38:37,114:INFO:   <<< feature_framerate: 1
2024-05-06 05:38:37,114:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:38:37,114:INFO:   <<< fp16: False
2024-05-06 05:38:37,114:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:38:37,114:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:38:37,114:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:38:37,114:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:38:37,114:INFO:   <<< init_model: None
2024-05-06 05:38:37,114:INFO:   <<< linear_patch: 2d
2024-05-06 05:38:37,114:INFO:   <<< local_rank: 0
2024-05-06 05:38:37,114:INFO:   <<< loose_type: True
2024-05-06 05:38:37,114:INFO:   <<< lr: 0.0001
2024-05-06 05:38:37,114:INFO:   <<< lr_decay: 0.9
2024-05-06 05:38:37,114:INFO:   <<< margin: 0.1
2024-05-06 05:38:37,114:INFO:   <<< max_frames: 12
2024-05-06 05:38:37,114:INFO:   <<< max_words: 32
2024-05-06 05:38:37,114:INFO:   <<< n_display: 100
2024-05-06 05:38:37,114:INFO:   <<< n_gpu: 1
2024-05-06 05:38:37,114:INFO:   <<< n_pair: 1
2024-05-06 05:38:37,114:INFO:   <<< negative_weighting: 1
2024-05-06 05:38:37,114:INFO:   <<< num_thread_reader: 0
2024-05-06 05:38:37,114:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:38:37,114:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:38:37,114:INFO:   <<< rank: 0
2024-05-06 05:38:37,114:INFO:   <<< resume_model: None
2024-05-06 05:38:37,114:INFO:   <<< sampled_use_mil: False
2024-05-06 05:38:37,114:INFO:   <<< seed: 42
2024-05-06 05:38:37,114:INFO:   <<< sim_header: meanP
2024-05-06 05:38:37,114:INFO:   <<< slice_framepos: 2
2024-05-06 05:38:37,114:INFO:   <<< task_type: retrieval
2024-05-06 05:38:37,114:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:38:37,114:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:38:37,114:INFO:   <<< train_frame_order: 0
2024-05-06 05:38:37,114:INFO:   <<< use_mil: False
2024-05-06 05:38:37,114:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:38:37,114:INFO:   <<< video_dim: 1024
2024-05-06 05:38:37,114:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:38:37,114:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:38:37,114:INFO:   <<< world_size: 1
2024-05-06 05:38:37,115:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:38:37,696:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:38:37,697:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:38:37,697:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:38:37,697:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:38:37,697:WARNING: Test retrieval by loose type.
2024-05-06 05:38:37,697:WARNING: 	 embed_dim: 512
2024-05-06 05:38:37,697:WARNING: 	 image_resolution: 224
2024-05-06 05:38:37,697:WARNING: 	 vision_layers: 12
2024-05-06 05:38:37,697:WARNING: 	 vision_width: 768
2024-05-06 05:38:37,697:WARNING: 	 vision_patch_size: 32
2024-05-06 05:38:37,697:WARNING: 	 context_length: 77
2024-05-06 05:38:37,697:WARNING: 	 vocab_size: 49408
2024-05-06 05:38:37,697:WARNING: 	 transformer_width: 512
2024-05-06 05:38:37,697:WARNING: 	 transformer_heads: 8
2024-05-06 05:38:37,697:WARNING: 	 transformer_layers: 12
2024-05-06 05:38:37,697:WARNING: 		 linear_patch: 2d
2024-05-06 05:38:37,697:WARNING: 	 cut_top_layer: 0
2024-05-06 05:38:38,548:WARNING: 	 sim_header: meanP
2024-05-06 05:38:42,248:INFO: --------------------
2024-05-06 05:38:42,248:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:38:44,319:INFO: ***** Running test *****
2024-05-06 05:38:44,319:INFO:   Num examples = 1000
2024-05-06 05:38:44,319:INFO:   Batch size = 16
2024-05-06 05:38:44,319:INFO:   Num steps = 63
2024-05-06 05:38:44,319:INFO: ***** Running val *****
2024-05-06 05:38:44,319:INFO:   Num examples = 1000
2024-05-06 05:41:17,232:INFO: sim matrix size: 1000, 1000
2024-05-06 05:41:17,297:INFO: 	 Length-T: 1000, Length-V:1000
2024-05-06 05:41:17,297:INFO: Text-to-Video:
2024-05-06 05:41:17,297:INFO: 	>>>  R@1: 30.9 - R@5: 54.2 - R@10: 63.3 - Median R: 4.0 - Mean R: 38.8
2024-05-06 05:41:17,297:INFO: Video-to-Text:
2024-05-06 05:41:17,297:INFO: 	>>>  V2T$R@1: 26.4 - V2T$R@5: 52.0 - V2T$R@10: 62.3 - V2T$Median R: 5.0 - V2T$Mean R: 37.6
2024-05-06 05:43:51,216:INFO: Effective parameters:
2024-05-06 05:43:51,216:INFO:   <<< batch_size: 1
2024-05-06 05:43:51,216:INFO:   <<< batch_size_val: 16
2024-05-06 05:43:51,216:INFO:   <<< cache_dir: 
2024-05-06 05:43:51,216:INFO:   <<< coef_lr: 0.001
2024-05-06 05:43:51,216:INFO:   <<< cross_model: cross-base
2024-05-06 05:43:51,216:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:43:51,216:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:43:51,216:INFO:   <<< datatype: msrvtt
2024-05-06 05:43:51,216:INFO:   <<< do_eval: True
2024-05-06 05:43:51,216:INFO:   <<< do_lower_case: False
2024-05-06 05:43:51,216:INFO:   <<< do_pretrain: False
2024-05-06 05:43:51,216:INFO:   <<< do_train: False
2024-05-06 05:43:51,216:INFO:   <<< epochs: 2
2024-05-06 05:43:51,216:INFO:   <<< eval_frame_order: 0
2024-05-06 05:43:51,216:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:43:51,216:INFO:   <<< feature_framerate: 1
2024-05-06 05:43:51,216:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:43:51,216:INFO:   <<< fp16: False
2024-05-06 05:43:51,216:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:43:51,216:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:43:51,216:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:43:51,216:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:43:51,217:INFO:   <<< init_model: None
2024-05-06 05:43:51,217:INFO:   <<< linear_patch: 2d
2024-05-06 05:43:51,217:INFO:   <<< local_rank: 0
2024-05-06 05:43:51,217:INFO:   <<< loose_type: True
2024-05-06 05:43:51,217:INFO:   <<< lr: 0.0001
2024-05-06 05:43:51,217:INFO:   <<< lr_decay: 0.9
2024-05-06 05:43:51,217:INFO:   <<< margin: 0.1
2024-05-06 05:43:51,217:INFO:   <<< max_frames: 90
2024-05-06 05:43:51,217:INFO:   <<< max_words: 32
2024-05-06 05:43:51,217:INFO:   <<< n_display: 100
2024-05-06 05:43:51,217:INFO:   <<< n_gpu: 1
2024-05-06 05:43:51,217:INFO:   <<< n_pair: 1
2024-05-06 05:43:51,217:INFO:   <<< negative_weighting: 1
2024-05-06 05:43:51,217:INFO:   <<< num_thread_reader: 0
2024-05-06 05:43:51,217:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:43:51,217:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:43:51,217:INFO:   <<< rank: 0
2024-05-06 05:43:51,217:INFO:   <<< resume_model: None
2024-05-06 05:43:51,217:INFO:   <<< sampled_use_mil: False
2024-05-06 05:43:51,217:INFO:   <<< seed: 42
2024-05-06 05:43:51,217:INFO:   <<< sim_header: meanP
2024-05-06 05:43:51,217:INFO:   <<< slice_framepos: 2
2024-05-06 05:43:51,217:INFO:   <<< task_type: retrieval
2024-05-06 05:43:51,217:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:43:51,217:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:43:51,217:INFO:   <<< train_frame_order: 0
2024-05-06 05:43:51,217:INFO:   <<< use_mil: False
2024-05-06 05:43:51,217:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:43:51,217:INFO:   <<< video_dim: 1024
2024-05-06 05:43:51,217:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:43:51,217:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:43:51,217:INFO:   <<< world_size: 1
2024-05-06 05:43:51,217:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:43:51,724:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:43:51,725:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:43:51,725:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:43:51,725:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:43:51,725:WARNING: Test retrieval by loose type.
2024-05-06 05:43:51,725:WARNING: 	 embed_dim: 512
2024-05-06 05:43:51,725:WARNING: 	 image_resolution: 224
2024-05-06 05:43:51,725:WARNING: 	 vision_layers: 12
2024-05-06 05:43:51,725:WARNING: 	 vision_width: 768
2024-05-06 05:43:51,725:WARNING: 	 vision_patch_size: 32
2024-05-06 05:43:51,725:WARNING: 	 context_length: 77
2024-05-06 05:43:51,725:WARNING: 	 vocab_size: 49408
2024-05-06 05:43:51,725:WARNING: 	 transformer_width: 512
2024-05-06 05:43:51,725:WARNING: 	 transformer_heads: 8
2024-05-06 05:43:51,725:WARNING: 	 transformer_layers: 12
2024-05-06 05:43:51,725:WARNING: 		 linear_patch: 2d
2024-05-06 05:43:51,725:WARNING: 	 cut_top_layer: 0
2024-05-06 05:43:52,559:WARNING: 	 sim_header: meanP
2024-05-06 05:43:56,209:INFO: --------------------
2024-05-06 05:43:56,210:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:46:22,002:INFO: Effective parameters:
2024-05-06 05:46:22,002:INFO:   <<< batch_size: 1
2024-05-06 05:46:22,002:INFO:   <<< batch_size_val: 16
2024-05-06 05:46:22,002:INFO:   <<< cache_dir: 
2024-05-06 05:46:22,002:INFO:   <<< coef_lr: 0.001
2024-05-06 05:46:22,002:INFO:   <<< cross_model: cross-base
2024-05-06 05:46:22,002:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:46:22,002:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:46:22,002:INFO:   <<< datatype: msrvtt
2024-05-06 05:46:22,002:INFO:   <<< do_eval: True
2024-05-06 05:46:22,002:INFO:   <<< do_lower_case: False
2024-05-06 05:46:22,002:INFO:   <<< do_pretrain: False
2024-05-06 05:46:22,002:INFO:   <<< do_train: False
2024-05-06 05:46:22,002:INFO:   <<< epochs: 2
2024-05-06 05:46:22,002:INFO:   <<< eval_frame_order: 0
2024-05-06 05:46:22,002:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:46:22,002:INFO:   <<< feature_framerate: 1
2024-05-06 05:46:22,002:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:46:22,002:INFO:   <<< fp16: False
2024-05-06 05:46:22,002:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:46:22,002:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:46:22,002:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:46:22,002:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:46:22,003:INFO:   <<< init_model: None
2024-05-06 05:46:22,003:INFO:   <<< linear_patch: 2d
2024-05-06 05:46:22,003:INFO:   <<< local_rank: 0
2024-05-06 05:46:22,003:INFO:   <<< loose_type: True
2024-05-06 05:46:22,003:INFO:   <<< lr: 0.0001
2024-05-06 05:46:22,003:INFO:   <<< lr_decay: 0.9
2024-05-06 05:46:22,003:INFO:   <<< margin: 0.1
2024-05-06 05:46:22,003:INFO:   <<< max_frames: 90
2024-05-06 05:46:22,003:INFO:   <<< max_words: 32
2024-05-06 05:46:22,003:INFO:   <<< n_display: 100
2024-05-06 05:46:22,003:INFO:   <<< n_gpu: 1
2024-05-06 05:46:22,003:INFO:   <<< n_pair: 1
2024-05-06 05:46:22,003:INFO:   <<< negative_weighting: 1
2024-05-06 05:46:22,003:INFO:   <<< num_thread_reader: 0
2024-05-06 05:46:22,003:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:46:22,003:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:46:22,003:INFO:   <<< rank: 0
2024-05-06 05:46:22,003:INFO:   <<< resume_model: None
2024-05-06 05:46:22,003:INFO:   <<< sampled_use_mil: False
2024-05-06 05:46:22,003:INFO:   <<< seed: 42
2024-05-06 05:46:22,003:INFO:   <<< sim_header: meanP
2024-05-06 05:46:22,003:INFO:   <<< slice_framepos: 2
2024-05-06 05:46:22,003:INFO:   <<< task_type: retrieval
2024-05-06 05:46:22,003:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:46:22,003:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:46:22,003:INFO:   <<< train_frame_order: 0
2024-05-06 05:46:22,003:INFO:   <<< use_mil: False
2024-05-06 05:46:22,003:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:46:22,003:INFO:   <<< video_dim: 1024
2024-05-06 05:46:22,003:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:46:22,003:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:46:22,003:INFO:   <<< world_size: 1
2024-05-06 05:46:22,003:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:46:22,510:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:46:22,511:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:46:22,511:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:46:22,511:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:46:22,511:WARNING: Test retrieval by loose type.
2024-05-06 05:46:22,511:WARNING: 	 embed_dim: 512
2024-05-06 05:46:22,511:WARNING: 	 image_resolution: 224
2024-05-06 05:46:22,511:WARNING: 	 vision_layers: 12
2024-05-06 05:46:22,511:WARNING: 	 vision_width: 768
2024-05-06 05:46:22,511:WARNING: 	 vision_patch_size: 32
2024-05-06 05:46:22,511:WARNING: 	 context_length: 77
2024-05-06 05:46:22,511:WARNING: 	 vocab_size: 49408
2024-05-06 05:46:22,511:WARNING: 	 transformer_width: 512
2024-05-06 05:46:22,511:WARNING: 	 transformer_heads: 8
2024-05-06 05:46:22,511:WARNING: 	 transformer_layers: 12
2024-05-06 05:46:22,511:WARNING: 		 linear_patch: 2d
2024-05-06 05:46:22,511:WARNING: 	 cut_top_layer: 0
2024-05-06 05:46:23,364:WARNING: 	 sim_header: meanP
2024-05-06 05:46:27,050:INFO: --------------------
2024-05-06 05:46:27,050:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:48:21,138:INFO: Effective parameters:
2024-05-06 05:48:21,138:INFO:   <<< batch_size: 1
2024-05-06 05:48:21,138:INFO:   <<< batch_size_val: 16
2024-05-06 05:48:21,138:INFO:   <<< cache_dir: 
2024-05-06 05:48:21,138:INFO:   <<< coef_lr: 0.001
2024-05-06 05:48:21,138:INFO:   <<< cross_model: cross-base
2024-05-06 05:48:21,138:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:48:21,138:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:48:21,138:INFO:   <<< datatype: msrvtt
2024-05-06 05:48:21,138:INFO:   <<< do_eval: True
2024-05-06 05:48:21,138:INFO:   <<< do_lower_case: False
2024-05-06 05:48:21,138:INFO:   <<< do_pretrain: False
2024-05-06 05:48:21,138:INFO:   <<< do_train: False
2024-05-06 05:48:21,138:INFO:   <<< epochs: 2
2024-05-06 05:48:21,138:INFO:   <<< eval_frame_order: 0
2024-05-06 05:48:21,138:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:48:21,138:INFO:   <<< feature_framerate: 1
2024-05-06 05:48:21,138:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:48:21,138:INFO:   <<< fp16: False
2024-05-06 05:48:21,138:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:48:21,138:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:48:21,138:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:48:21,138:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:48:21,138:INFO:   <<< init_model: None
2024-05-06 05:48:21,138:INFO:   <<< linear_patch: 2d
2024-05-06 05:48:21,138:INFO:   <<< local_rank: 0
2024-05-06 05:48:21,138:INFO:   <<< loose_type: True
2024-05-06 05:48:21,138:INFO:   <<< lr: 0.0001
2024-05-06 05:48:21,138:INFO:   <<< lr_decay: 0.9
2024-05-06 05:48:21,138:INFO:   <<< margin: 0.1
2024-05-06 05:48:21,138:INFO:   <<< max_frames: 90
2024-05-06 05:48:21,139:INFO:   <<< max_words: 32
2024-05-06 05:48:21,139:INFO:   <<< n_display: 100
2024-05-06 05:48:21,139:INFO:   <<< n_gpu: 1
2024-05-06 05:48:21,139:INFO:   <<< n_pair: 1
2024-05-06 05:48:21,139:INFO:   <<< negative_weighting: 1
2024-05-06 05:48:21,139:INFO:   <<< num_thread_reader: 0
2024-05-06 05:48:21,139:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:48:21,139:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:48:21,139:INFO:   <<< rank: 0
2024-05-06 05:48:21,139:INFO:   <<< resume_model: None
2024-05-06 05:48:21,139:INFO:   <<< sampled_use_mil: False
2024-05-06 05:48:21,139:INFO:   <<< seed: 42
2024-05-06 05:48:21,139:INFO:   <<< sim_header: meanP
2024-05-06 05:48:21,139:INFO:   <<< slice_framepos: 2
2024-05-06 05:48:21,139:INFO:   <<< task_type: retrieval
2024-05-06 05:48:21,139:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:48:21,139:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:48:21,139:INFO:   <<< train_frame_order: 0
2024-05-06 05:48:21,139:INFO:   <<< use_mil: False
2024-05-06 05:48:21,139:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:48:21,139:INFO:   <<< video_dim: 1024
2024-05-06 05:48:21,139:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:48:21,139:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:48:21,139:INFO:   <<< world_size: 1
2024-05-06 05:48:21,139:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:48:21,656:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:48:21,657:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:48:21,657:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:48:21,657:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:48:21,657:WARNING: Test retrieval by loose type.
2024-05-06 05:48:21,657:WARNING: 	 embed_dim: 512
2024-05-06 05:48:21,657:WARNING: 	 image_resolution: 224
2024-05-06 05:48:21,657:WARNING: 	 vision_layers: 12
2024-05-06 05:48:21,657:WARNING: 	 vision_width: 768
2024-05-06 05:48:21,657:WARNING: 	 vision_patch_size: 32
2024-05-06 05:48:21,657:WARNING: 	 context_length: 77
2024-05-06 05:48:21,657:WARNING: 	 vocab_size: 49408
2024-05-06 05:48:21,657:WARNING: 	 transformer_width: 512
2024-05-06 05:48:21,657:WARNING: 	 transformer_heads: 8
2024-05-06 05:48:21,657:WARNING: 	 transformer_layers: 12
2024-05-06 05:48:21,657:WARNING: 		 linear_patch: 2d
2024-05-06 05:48:21,657:WARNING: 	 cut_top_layer: 0
2024-05-06 05:48:22,523:WARNING: 	 sim_header: meanP
2024-05-06 05:48:26,276:INFO: --------------------
2024-05-06 05:48:26,276:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:52:00,072:INFO: Effective parameters:
2024-05-06 05:52:00,072:INFO:   <<< batch_size: 1
2024-05-06 05:52:00,072:INFO:   <<< batch_size_val: 16
2024-05-06 05:52:00,072:INFO:   <<< cache_dir: 
2024-05-06 05:52:00,073:INFO:   <<< coef_lr: 0.001
2024-05-06 05:52:00,073:INFO:   <<< cross_model: cross-base
2024-05-06 05:52:00,073:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:52:00,073:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:52:00,073:INFO:   <<< datatype: msrvtt
2024-05-06 05:52:00,073:INFO:   <<< do_eval: True
2024-05-06 05:52:00,073:INFO:   <<< do_lower_case: False
2024-05-06 05:52:00,073:INFO:   <<< do_pretrain: False
2024-05-06 05:52:00,073:INFO:   <<< do_train: False
2024-05-06 05:52:00,073:INFO:   <<< epochs: 2
2024-05-06 05:52:00,073:INFO:   <<< eval_frame_order: 0
2024-05-06 05:52:00,073:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:52:00,073:INFO:   <<< feature_framerate: 1
2024-05-06 05:52:00,073:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:52:00,073:INFO:   <<< fp16: False
2024-05-06 05:52:00,074:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:52:00,074:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:52:00,074:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:52:00,074:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:52:00,074:INFO:   <<< init_model: None
2024-05-06 05:52:00,074:INFO:   <<< linear_patch: 2d
2024-05-06 05:52:00,074:INFO:   <<< local_rank: 0
2024-05-06 05:52:00,074:INFO:   <<< loose_type: True
2024-05-06 05:52:00,074:INFO:   <<< lr: 0.0001
2024-05-06 05:52:00,074:INFO:   <<< lr_decay: 0.9
2024-05-06 05:52:00,074:INFO:   <<< margin: 0.1
2024-05-06 05:52:00,074:INFO:   <<< max_frames: 90
2024-05-06 05:52:00,074:INFO:   <<< max_words: 32
2024-05-06 05:52:00,074:INFO:   <<< n_display: 100
2024-05-06 05:52:00,074:INFO:   <<< n_gpu: 1
2024-05-06 05:52:00,074:INFO:   <<< n_pair: 1
2024-05-06 05:52:00,074:INFO:   <<< negative_weighting: 1
2024-05-06 05:52:00,075:INFO:   <<< num_thread_reader: 0
2024-05-06 05:52:00,075:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:52:00,075:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:52:00,075:INFO:   <<< rank: 0
2024-05-06 05:52:00,075:INFO:   <<< resume_model: None
2024-05-06 05:52:00,075:INFO:   <<< sampled_use_mil: False
2024-05-06 05:52:00,075:INFO:   <<< seed: 42
2024-05-06 05:52:00,075:INFO:   <<< sim_header: meanP
2024-05-06 05:52:00,075:INFO:   <<< slice_framepos: 2
2024-05-06 05:52:00,075:INFO:   <<< task_type: retrieval
2024-05-06 05:52:00,075:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:52:00,075:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:52:00,075:INFO:   <<< train_frame_order: 0
2024-05-06 05:52:00,075:INFO:   <<< use_mil: False
2024-05-06 05:52:00,075:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:52:00,075:INFO:   <<< video_dim: 1024
2024-05-06 05:52:00,075:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:52:00,076:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:52:00,076:INFO:   <<< world_size: 1
2024-05-06 05:52:00,076:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:52:00,591:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:52:00,591:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:52:00,591:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:52:00,592:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:52:00,592:WARNING: Test retrieval by loose type.
2024-05-06 05:52:00,593:WARNING: 	 embed_dim: 512
2024-05-06 05:52:00,593:WARNING: 	 image_resolution: 224
2024-05-06 05:52:00,593:WARNING: 	 vision_layers: 12
2024-05-06 05:52:00,593:WARNING: 	 vision_width: 768
2024-05-06 05:52:00,593:WARNING: 	 vision_patch_size: 32
2024-05-06 05:52:00,593:WARNING: 	 context_length: 77
2024-05-06 05:52:00,593:WARNING: 	 vocab_size: 49408
2024-05-06 05:52:00,593:WARNING: 	 transformer_width: 512
2024-05-06 05:52:00,593:WARNING: 	 transformer_heads: 8
2024-05-06 05:52:00,593:WARNING: 	 transformer_layers: 12
2024-05-06 05:52:00,593:WARNING: 		 linear_patch: 2d
2024-05-06 05:52:00,593:WARNING: 	 cut_top_layer: 0
2024-05-06 05:52:01,458:WARNING: 	 sim_header: meanP
2024-05-06 05:52:05,069:INFO: --------------------
2024-05-06 05:52:05,069:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:52:45,951:INFO: Effective parameters:
2024-05-06 05:52:45,951:INFO:   <<< batch_size: 1
2024-05-06 05:52:45,951:INFO:   <<< batch_size_val: 16
2024-05-06 05:52:45,951:INFO:   <<< cache_dir: 
2024-05-06 05:52:45,951:INFO:   <<< coef_lr: 0.001
2024-05-06 05:52:45,951:INFO:   <<< cross_model: cross-base
2024-05-06 05:52:45,951:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:52:45,951:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:52:45,951:INFO:   <<< datatype: msrvtt
2024-05-06 05:52:45,951:INFO:   <<< do_eval: True
2024-05-06 05:52:45,951:INFO:   <<< do_lower_case: False
2024-05-06 05:52:45,951:INFO:   <<< do_pretrain: False
2024-05-06 05:52:45,951:INFO:   <<< do_train: False
2024-05-06 05:52:45,951:INFO:   <<< epochs: 2
2024-05-06 05:52:45,951:INFO:   <<< eval_frame_order: 0
2024-05-06 05:52:45,951:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:52:45,951:INFO:   <<< feature_framerate: 1
2024-05-06 05:52:45,951:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:52:45,951:INFO:   <<< fp16: False
2024-05-06 05:52:45,951:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:52:45,951:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:52:45,951:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:52:45,951:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:52:45,951:INFO:   <<< init_model: None
2024-05-06 05:52:45,951:INFO:   <<< linear_patch: 2d
2024-05-06 05:52:45,951:INFO:   <<< local_rank: 0
2024-05-06 05:52:45,951:INFO:   <<< loose_type: True
2024-05-06 05:52:45,951:INFO:   <<< lr: 0.0001
2024-05-06 05:52:45,951:INFO:   <<< lr_decay: 0.9
2024-05-06 05:52:45,951:INFO:   <<< margin: 0.1
2024-05-06 05:52:45,951:INFO:   <<< max_frames: 90
2024-05-06 05:52:45,951:INFO:   <<< max_words: 32
2024-05-06 05:52:45,951:INFO:   <<< n_display: 100
2024-05-06 05:52:45,951:INFO:   <<< n_gpu: 1
2024-05-06 05:52:45,951:INFO:   <<< n_pair: 1
2024-05-06 05:52:45,951:INFO:   <<< negative_weighting: 1
2024-05-06 05:52:45,951:INFO:   <<< num_thread_reader: 0
2024-05-06 05:52:45,952:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:52:45,952:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:52:45,952:INFO:   <<< rank: 0
2024-05-06 05:52:45,952:INFO:   <<< resume_model: None
2024-05-06 05:52:45,952:INFO:   <<< sampled_use_mil: False
2024-05-06 05:52:45,952:INFO:   <<< seed: 42
2024-05-06 05:52:45,952:INFO:   <<< sim_header: meanP
2024-05-06 05:52:45,952:INFO:   <<< slice_framepos: 2
2024-05-06 05:52:45,952:INFO:   <<< task_type: retrieval
2024-05-06 05:52:45,952:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:52:45,952:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:52:45,952:INFO:   <<< train_frame_order: 0
2024-05-06 05:52:45,952:INFO:   <<< use_mil: False
2024-05-06 05:52:45,952:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:52:45,952:INFO:   <<< video_dim: 1024
2024-05-06 05:52:45,952:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:52:45,952:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:52:45,952:INFO:   <<< world_size: 1
2024-05-06 05:52:45,952:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:52:46,474:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:52:46,474:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:52:46,474:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:52:46,474:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:52:46,474:WARNING: Test retrieval by loose type.
2024-05-06 05:52:46,474:WARNING: 	 embed_dim: 512
2024-05-06 05:52:46,474:WARNING: 	 image_resolution: 224
2024-05-06 05:52:46,474:WARNING: 	 vision_layers: 12
2024-05-06 05:52:46,474:WARNING: 	 vision_width: 768
2024-05-06 05:52:46,474:WARNING: 	 vision_patch_size: 32
2024-05-06 05:52:46,475:WARNING: 	 context_length: 77
2024-05-06 05:52:46,475:WARNING: 	 vocab_size: 49408
2024-05-06 05:52:46,475:WARNING: 	 transformer_width: 512
2024-05-06 05:52:46,475:WARNING: 	 transformer_heads: 8
2024-05-06 05:52:46,475:WARNING: 	 transformer_layers: 12
2024-05-06 05:52:46,475:WARNING: 		 linear_patch: 2d
2024-05-06 05:52:46,475:WARNING: 	 cut_top_layer: 0
2024-05-06 05:52:47,329:WARNING: 	 sim_header: meanP
2024-05-06 05:52:51,078:INFO: --------------------
2024-05-06 05:52:51,078:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:53:41,964:INFO: Effective parameters:
2024-05-06 05:53:41,964:INFO:   <<< batch_size: 1
2024-05-06 05:53:41,964:INFO:   <<< batch_size_val: 16
2024-05-06 05:53:41,964:INFO:   <<< cache_dir: 
2024-05-06 05:53:41,964:INFO:   <<< coef_lr: 0.001
2024-05-06 05:53:41,964:INFO:   <<< cross_model: cross-base
2024-05-06 05:53:41,964:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:53:41,964:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:53:41,964:INFO:   <<< datatype: msrvtt
2024-05-06 05:53:41,964:INFO:   <<< do_eval: True
2024-05-06 05:53:41,964:INFO:   <<< do_lower_case: False
2024-05-06 05:53:41,964:INFO:   <<< do_pretrain: False
2024-05-06 05:53:41,964:INFO:   <<< do_train: False
2024-05-06 05:53:41,964:INFO:   <<< epochs: 2
2024-05-06 05:53:41,964:INFO:   <<< eval_frame_order: 0
2024-05-06 05:53:41,964:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:53:41,964:INFO:   <<< feature_framerate: 1
2024-05-06 05:53:41,964:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:53:41,964:INFO:   <<< fp16: False
2024-05-06 05:53:41,964:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:53:41,964:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:53:41,964:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:53:41,964:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:53:41,964:INFO:   <<< init_model: None
2024-05-06 05:53:41,964:INFO:   <<< linear_patch: 2d
2024-05-06 05:53:41,964:INFO:   <<< local_rank: 0
2024-05-06 05:53:41,964:INFO:   <<< loose_type: True
2024-05-06 05:53:41,964:INFO:   <<< lr: 0.0001
2024-05-06 05:53:41,964:INFO:   <<< lr_decay: 0.9
2024-05-06 05:53:41,964:INFO:   <<< margin: 0.1
2024-05-06 05:53:41,964:INFO:   <<< max_frames: 90
2024-05-06 05:53:41,964:INFO:   <<< max_words: 32
2024-05-06 05:53:41,964:INFO:   <<< n_display: 100
2024-05-06 05:53:41,964:INFO:   <<< n_gpu: 1
2024-05-06 05:53:41,964:INFO:   <<< n_pair: 1
2024-05-06 05:53:41,964:INFO:   <<< negative_weighting: 1
2024-05-06 05:53:41,964:INFO:   <<< num_thread_reader: 0
2024-05-06 05:53:41,964:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:53:41,964:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:53:41,964:INFO:   <<< rank: 0
2024-05-06 05:53:41,964:INFO:   <<< resume_model: None
2024-05-06 05:53:41,964:INFO:   <<< sampled_use_mil: False
2024-05-06 05:53:41,964:INFO:   <<< seed: 42
2024-05-06 05:53:41,964:INFO:   <<< sim_header: meanP
2024-05-06 05:53:41,964:INFO:   <<< slice_framepos: 2
2024-05-06 05:53:41,964:INFO:   <<< task_type: retrieval
2024-05-06 05:53:41,964:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:53:41,964:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:53:41,964:INFO:   <<< train_frame_order: 0
2024-05-06 05:53:41,964:INFO:   <<< use_mil: False
2024-05-06 05:53:41,964:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:53:41,964:INFO:   <<< video_dim: 1024
2024-05-06 05:53:41,965:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:53:41,965:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:53:41,965:INFO:   <<< world_size: 1
2024-05-06 05:53:41,965:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:53:42,479:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:53:42,479:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:53:42,479:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:53:42,479:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:53:42,479:WARNING: Test retrieval by loose type.
2024-05-06 05:53:42,479:WARNING: 	 embed_dim: 512
2024-05-06 05:53:42,479:WARNING: 	 image_resolution: 224
2024-05-06 05:53:42,479:WARNING: 	 vision_layers: 12
2024-05-06 05:53:42,479:WARNING: 	 vision_width: 768
2024-05-06 05:53:42,479:WARNING: 	 vision_patch_size: 32
2024-05-06 05:53:42,479:WARNING: 	 context_length: 77
2024-05-06 05:53:42,479:WARNING: 	 vocab_size: 49408
2024-05-06 05:53:42,479:WARNING: 	 transformer_width: 512
2024-05-06 05:53:42,479:WARNING: 	 transformer_heads: 8
2024-05-06 05:53:42,479:WARNING: 	 transformer_layers: 12
2024-05-06 05:53:42,479:WARNING: 		 linear_patch: 2d
2024-05-06 05:53:42,479:WARNING: 	 cut_top_layer: 0
2024-05-06 05:53:43,353:WARNING: 	 sim_header: meanP
2024-05-06 05:53:47,069:INFO: --------------------
2024-05-06 05:53:47,069:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 05:55:11,266:INFO: Effective parameters:
2024-05-06 05:55:11,267:INFO:   <<< batch_size: 1
2024-05-06 05:55:11,267:INFO:   <<< batch_size_val: 16
2024-05-06 05:55:11,267:INFO:   <<< cache_dir: 
2024-05-06 05:55:11,267:INFO:   <<< coef_lr: 0.001
2024-05-06 05:55:11,267:INFO:   <<< cross_model: cross-base
2024-05-06 05:55:11,267:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 05:55:11,267:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 05:55:11,267:INFO:   <<< datatype: msrvtt
2024-05-06 05:55:11,267:INFO:   <<< do_eval: True
2024-05-06 05:55:11,267:INFO:   <<< do_lower_case: False
2024-05-06 05:55:11,267:INFO:   <<< do_pretrain: False
2024-05-06 05:55:11,267:INFO:   <<< do_train: False
2024-05-06 05:55:11,267:INFO:   <<< epochs: 2
2024-05-06 05:55:11,267:INFO:   <<< eval_frame_order: 0
2024-05-06 05:55:11,268:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 05:55:11,268:INFO:   <<< feature_framerate: 1
2024-05-06 05:55:11,268:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 05:55:11,268:INFO:   <<< fp16: False
2024-05-06 05:55:11,268:INFO:   <<< fp16_opt_level: O1
2024-05-06 05:55:11,268:INFO:   <<< freeze_layer_num: 0
2024-05-06 05:55:11,268:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 05:55:11,268:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 05:55:11,268:INFO:   <<< init_model: None
2024-05-06 05:55:11,268:INFO:   <<< linear_patch: 2d
2024-05-06 05:55:11,268:INFO:   <<< local_rank: 0
2024-05-06 05:55:11,268:INFO:   <<< loose_type: True
2024-05-06 05:55:11,268:INFO:   <<< lr: 0.0001
2024-05-06 05:55:11,268:INFO:   <<< lr_decay: 0.9
2024-05-06 05:55:11,268:INFO:   <<< margin: 0.1
2024-05-06 05:55:11,268:INFO:   <<< max_frames: 90
2024-05-06 05:55:11,268:INFO:   <<< max_words: 32
2024-05-06 05:55:11,268:INFO:   <<< n_display: 100
2024-05-06 05:55:11,269:INFO:   <<< n_gpu: 1
2024-05-06 05:55:11,269:INFO:   <<< n_pair: 1
2024-05-06 05:55:11,269:INFO:   <<< negative_weighting: 1
2024-05-06 05:55:11,269:INFO:   <<< num_thread_reader: 0
2024-05-06 05:55:11,269:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 05:55:11,269:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 05:55:11,269:INFO:   <<< rank: 0
2024-05-06 05:55:11,269:INFO:   <<< resume_model: None
2024-05-06 05:55:11,269:INFO:   <<< sampled_use_mil: False
2024-05-06 05:55:11,269:INFO:   <<< seed: 42
2024-05-06 05:55:11,269:INFO:   <<< sim_header: meanP
2024-05-06 05:55:11,269:INFO:   <<< slice_framepos: 2
2024-05-06 05:55:11,269:INFO:   <<< task_type: retrieval
2024-05-06 05:55:11,269:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 05:55:11,269:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 05:55:11,269:INFO:   <<< train_frame_order: 0
2024-05-06 05:55:11,269:INFO:   <<< use_mil: False
2024-05-06 05:55:11,270:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 05:55:11,270:INFO:   <<< video_dim: 1024
2024-05-06 05:55:11,270:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 05:55:11,270:INFO:   <<< warmup_proportion: 0.1
2024-05-06 05:55:11,270:INFO:   <<< world_size: 1
2024-05-06 05:55:11,270:INFO: device: cuda:0 n_gpu: 1
2024-05-06 05:57:39,631:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 05:57:39,632:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 05:57:39,633:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 05:57:57,427:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 05:58:03,266:WARNING: Test retrieval by loose type.
2024-05-06 05:59:19,173:WARNING: 	 embed_dim: 512
2024-05-06 05:59:20,760:WARNING: 	 image_resolution: 224
2024-05-06 05:59:21,145:WARNING: 	 vision_layers: 12
2024-05-06 05:59:21,459:WARNING: 	 vision_width: 768
2024-05-06 05:59:21,713:WARNING: 	 vision_patch_size: 32
2024-05-06 05:59:21,966:WARNING: 	 context_length: 77
2024-05-06 05:59:22,432:WARNING: 	 vocab_size: 49408
2024-05-06 05:59:22,766:WARNING: 	 transformer_width: 512
2024-05-06 05:59:23,101:WARNING: 	 transformer_heads: 8
2024-05-06 05:59:23,324:WARNING: 	 transformer_layers: 12
2024-05-06 05:59:25,504:WARNING: 		 linear_patch: 2d
2024-05-06 05:59:26,802:WARNING: 	 cut_top_layer: 0
2024-05-06 10:40:11,325:INFO: Effective parameters:
2024-05-06 10:40:11,326:INFO:   <<< batch_size: 1
2024-05-06 10:40:11,326:INFO:   <<< batch_size_val: 16
2024-05-06 10:40:11,326:INFO:   <<< cache_dir: 
2024-05-06 10:40:11,326:INFO:   <<< coef_lr: 0.001
2024-05-06 10:40:11,326:INFO:   <<< cross_model: cross-base
2024-05-06 10:40:11,326:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 10:40:11,326:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 10:40:11,327:INFO:   <<< datatype: msrvtt
2024-05-06 10:40:11,327:INFO:   <<< do_eval: True
2024-05-06 10:40:11,327:INFO:   <<< do_lower_case: False
2024-05-06 10:40:11,327:INFO:   <<< do_pretrain: False
2024-05-06 10:40:11,327:INFO:   <<< do_train: False
2024-05-06 10:40:11,327:INFO:   <<< epochs: 2
2024-05-06 10:40:11,327:INFO:   <<< eval_frame_order: 0
2024-05-06 10:40:11,327:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 10:40:11,327:INFO:   <<< feature_framerate: 1
2024-05-06 10:40:11,327:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 10:40:11,327:INFO:   <<< fp16: False
2024-05-06 10:40:11,327:INFO:   <<< fp16_opt_level: O1
2024-05-06 10:40:11,327:INFO:   <<< freeze_layer_num: 0
2024-05-06 10:40:11,327:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 10:40:11,327:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 10:40:11,327:INFO:   <<< init_model: None
2024-05-06 10:40:11,327:INFO:   <<< linear_patch: 2d
2024-05-06 10:40:11,327:INFO:   <<< local_rank: 0
2024-05-06 10:40:11,328:INFO:   <<< loose_type: True
2024-05-06 10:40:11,328:INFO:   <<< lr: 0.0001
2024-05-06 10:40:11,328:INFO:   <<< lr_decay: 0.9
2024-05-06 10:40:11,328:INFO:   <<< margin: 0.1
2024-05-06 10:40:11,328:INFO:   <<< max_frames: 90
2024-05-06 10:40:11,328:INFO:   <<< max_words: 32
2024-05-06 10:40:11,328:INFO:   <<< n_display: 100
2024-05-06 10:40:11,328:INFO:   <<< n_gpu: 1
2024-05-06 10:40:11,328:INFO:   <<< n_pair: 1
2024-05-06 10:40:11,328:INFO:   <<< negative_weighting: 1
2024-05-06 10:40:11,328:INFO:   <<< num_thread_reader: 0
2024-05-06 10:40:11,328:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 10:40:11,328:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 10:40:11,328:INFO:   <<< rank: 0
2024-05-06 10:40:11,328:INFO:   <<< resume_model: None
2024-05-06 10:40:11,328:INFO:   <<< sampled_use_mil: False
2024-05-06 10:40:11,328:INFO:   <<< seed: 42
2024-05-06 10:40:11,329:INFO:   <<< sim_header: meanP
2024-05-06 10:40:11,329:INFO:   <<< slice_framepos: 2
2024-05-06 10:40:11,329:INFO:   <<< task_type: retrieval
2024-05-06 10:40:11,329:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 10:40:11,329:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 10:40:11,329:INFO:   <<< train_frame_order: 0
2024-05-06 10:40:11,329:INFO:   <<< use_mil: False
2024-05-06 10:40:11,329:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 10:40:11,329:INFO:   <<< video_dim: 1024
2024-05-06 10:40:11,329:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 10:40:11,329:INFO:   <<< warmup_proportion: 0.1
2024-05-06 10:40:11,329:INFO:   <<< world_size: 1
2024-05-06 10:40:11,329:INFO: device: cuda:0 n_gpu: 1
2024-05-06 10:40:48,877:INFO: Effective parameters:
2024-05-06 10:40:48,878:INFO:   <<< batch_size: 1
2024-05-06 10:40:48,878:INFO:   <<< batch_size_val: 16
2024-05-06 10:40:48,878:INFO:   <<< cache_dir: 
2024-05-06 10:40:48,878:INFO:   <<< coef_lr: 0.001
2024-05-06 10:40:48,878:INFO:   <<< cross_model: cross-base
2024-05-06 10:40:48,878:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 10:40:48,878:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 10:40:48,878:INFO:   <<< datatype: msrvtt
2024-05-06 10:40:48,878:INFO:   <<< do_eval: True
2024-05-06 10:40:48,878:INFO:   <<< do_lower_case: False
2024-05-06 10:40:48,878:INFO:   <<< do_pretrain: False
2024-05-06 10:40:48,878:INFO:   <<< do_train: False
2024-05-06 10:40:48,879:INFO:   <<< epochs: 2
2024-05-06 10:40:48,879:INFO:   <<< eval_frame_order: 0
2024-05-06 10:40:48,879:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 10:40:48,879:INFO:   <<< feature_framerate: 1
2024-05-06 10:40:48,879:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 10:40:48,879:INFO:   <<< fp16: False
2024-05-06 10:40:48,879:INFO:   <<< fp16_opt_level: O1
2024-05-06 10:40:48,879:INFO:   <<< freeze_layer_num: 0
2024-05-06 10:40:48,879:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 10:40:48,879:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 10:40:48,879:INFO:   <<< init_model: None
2024-05-06 10:40:48,879:INFO:   <<< linear_patch: 2d
2024-05-06 10:40:48,879:INFO:   <<< local_rank: 0
2024-05-06 10:40:48,879:INFO:   <<< loose_type: True
2024-05-06 10:40:48,879:INFO:   <<< lr: 0.0001
2024-05-06 10:40:48,879:INFO:   <<< lr_decay: 0.9
2024-05-06 10:40:48,880:INFO:   <<< margin: 0.1
2024-05-06 10:40:48,880:INFO:   <<< max_frames: 90
2024-05-06 10:40:48,880:INFO:   <<< max_words: 32
2024-05-06 10:40:48,880:INFO:   <<< n_display: 100
2024-05-06 10:40:48,880:INFO:   <<< n_gpu: 1
2024-05-06 10:40:48,880:INFO:   <<< n_pair: 1
2024-05-06 10:40:48,880:INFO:   <<< negative_weighting: 1
2024-05-06 10:40:48,880:INFO:   <<< num_thread_reader: 0
2024-05-06 10:40:48,880:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 10:40:48,880:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 10:40:48,880:INFO:   <<< rank: 0
2024-05-06 10:40:48,880:INFO:   <<< resume_model: None
2024-05-06 10:40:48,880:INFO:   <<< sampled_use_mil: False
2024-05-06 10:40:48,880:INFO:   <<< seed: 42
2024-05-06 10:40:48,880:INFO:   <<< sim_header: meanP
2024-05-06 10:40:48,880:INFO:   <<< slice_framepos: 2
2024-05-06 10:40:48,880:INFO:   <<< task_type: retrieval
2024-05-06 10:40:48,881:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 10:40:48,881:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 10:40:48,881:INFO:   <<< train_frame_order: 0
2024-05-06 10:40:48,881:INFO:   <<< use_mil: False
2024-05-06 10:40:48,881:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 10:40:48,881:INFO:   <<< video_dim: 1024
2024-05-06 10:40:48,881:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 10:40:48,881:INFO:   <<< warmup_proportion: 0.1
2024-05-06 10:40:48,881:INFO:   <<< world_size: 1
2024-05-06 10:40:48,881:INFO: device: cuda:0 n_gpu: 1
2024-05-06 10:40:50,188:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 10:40:57,253:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 10:40:57,257:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 10:40:57,257:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 10:40:57,258:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 10:40:57,258:WARNING: Test retrieval by loose type.
2024-05-06 10:40:57,259:WARNING: 	 embed_dim: 512
2024-05-06 10:40:57,259:WARNING: 	 image_resolution: 224
2024-05-06 10:40:57,259:WARNING: 	 vision_layers: 12
2024-05-06 10:40:57,259:WARNING: 	 vision_width: 768
2024-05-06 10:40:57,259:WARNING: 	 vision_patch_size: 32
2024-05-06 10:40:57,259:WARNING: 	 context_length: 77
2024-05-06 10:40:57,259:WARNING: 	 vocab_size: 49408
2024-05-06 10:40:57,260:WARNING: 	 transformer_width: 512
2024-05-06 10:40:57,260:WARNING: 	 transformer_heads: 8
2024-05-06 10:40:57,260:WARNING: 	 transformer_layers: 12
2024-05-06 10:40:57,260:WARNING: 		 linear_patch: 2d
2024-05-06 10:40:57,260:WARNING: 	 cut_top_layer: 0
2024-05-06 10:40:58,152:WARNING: 	 sim_header: meanP
2024-05-06 10:41:01,846:INFO: --------------------
2024-05-06 10:41:01,846:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 10:56:21,327:INFO: Effective parameters:
2024-05-06 10:56:21,327:INFO:   <<< batch_size: 1
2024-05-06 10:56:21,327:INFO:   <<< batch_size_val: 16
2024-05-06 10:56:21,327:INFO:   <<< cache_dir: 
2024-05-06 10:56:21,328:INFO:   <<< coef_lr: 0.001
2024-05-06 10:56:21,328:INFO:   <<< cross_model: cross-base
2024-05-06 10:56:21,328:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 10:56:21,328:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 10:56:21,328:INFO:   <<< datatype: msrvtt
2024-05-06 10:56:21,328:INFO:   <<< do_eval: True
2024-05-06 10:56:21,328:INFO:   <<< do_lower_case: False
2024-05-06 10:56:21,328:INFO:   <<< do_pretrain: False
2024-05-06 10:56:21,328:INFO:   <<< do_train: False
2024-05-06 10:56:21,328:INFO:   <<< epochs: 2
2024-05-06 10:56:21,328:INFO:   <<< eval_frame_order: 0
2024-05-06 10:56:21,328:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 10:56:21,328:INFO:   <<< feature_framerate: 1
2024-05-06 10:56:21,328:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 10:56:21,328:INFO:   <<< fp16: False
2024-05-06 10:56:21,328:INFO:   <<< fp16_opt_level: O1
2024-05-06 10:56:21,329:INFO:   <<< freeze_layer_num: 0
2024-05-06 10:56:21,329:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 10:56:21,329:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 10:56:21,329:INFO:   <<< init_model: None
2024-05-06 10:56:21,329:INFO:   <<< linear_patch: 2d
2024-05-06 10:56:21,329:INFO:   <<< local_rank: 0
2024-05-06 10:56:21,329:INFO:   <<< loose_type: True
2024-05-06 10:56:21,329:INFO:   <<< lr: 0.0001
2024-05-06 10:56:21,329:INFO:   <<< lr_decay: 0.9
2024-05-06 10:56:21,329:INFO:   <<< margin: 0.1
2024-05-06 10:56:21,329:INFO:   <<< max_frames: 90
2024-05-06 10:56:21,329:INFO:   <<< max_words: 32
2024-05-06 10:56:21,329:INFO:   <<< n_display: 100
2024-05-06 10:56:21,329:INFO:   <<< n_gpu: 1
2024-05-06 10:56:21,329:INFO:   <<< n_pair: 1
2024-05-06 10:56:21,329:INFO:   <<< negative_weighting: 1
2024-05-06 10:56:21,329:INFO:   <<< num_thread_reader: 0
2024-05-06 10:56:21,330:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 10:56:21,330:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 10:56:21,330:INFO:   <<< rank: 0
2024-05-06 10:56:21,330:INFO:   <<< resume_model: None
2024-05-06 10:56:21,330:INFO:   <<< sampled_use_mil: False
2024-05-06 10:56:21,330:INFO:   <<< seed: 42
2024-05-06 10:56:21,330:INFO:   <<< sim_header: meanP
2024-05-06 10:56:21,330:INFO:   <<< slice_framepos: 2
2024-05-06 10:56:21,330:INFO:   <<< task_type: retrieval
2024-05-06 10:56:21,330:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 10:56:21,330:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 10:56:21,330:INFO:   <<< train_frame_order: 0
2024-05-06 10:56:21,330:INFO:   <<< use_mil: False
2024-05-06 10:56:21,330:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 10:56:21,330:INFO:   <<< video_dim: 1024
2024-05-06 10:56:21,330:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 10:56:21,331:INFO:   <<< warmup_proportion: 0.1
2024-05-06 10:56:21,331:INFO:   <<< world_size: 1
2024-05-06 10:56:21,331:INFO: device: cuda:0 n_gpu: 1
2024-05-06 10:56:21,490:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 10:56:21,977:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 10:56:21,978:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 10:56:21,978:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 10:56:21,979:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 10:56:21,979:WARNING: Test retrieval by loose type.
2024-05-06 10:56:21,980:WARNING: 	 embed_dim: 512
2024-05-06 10:56:21,980:WARNING: 	 image_resolution: 224
2024-05-06 10:56:21,980:WARNING: 	 vision_layers: 12
2024-05-06 10:56:21,981:WARNING: 	 vision_width: 768
2024-05-06 10:56:21,981:WARNING: 	 vision_patch_size: 32
2024-05-06 10:56:21,981:WARNING: 	 context_length: 77
2024-05-06 10:56:21,981:WARNING: 	 vocab_size: 49408
2024-05-06 10:56:21,981:WARNING: 	 transformer_width: 512
2024-05-06 10:56:21,981:WARNING: 	 transformer_heads: 8
2024-05-06 10:56:21,981:WARNING: 	 transformer_layers: 12
2024-05-06 10:56:21,981:WARNING: 		 linear_patch: 2d
2024-05-06 10:56:21,981:WARNING: 	 cut_top_layer: 0
2024-05-06 10:56:22,840:WARNING: 	 sim_header: meanP
2024-05-06 10:56:26,558:INFO: --------------------
2024-05-06 10:56:26,558:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:17:20,489:INFO: Effective parameters:
2024-05-06 11:17:20,490:INFO:   <<< batch_size: 1
2024-05-06 11:17:20,490:INFO:   <<< batch_size_val: 16
2024-05-06 11:17:20,490:INFO:   <<< cache_dir: 
2024-05-06 11:17:20,490:INFO:   <<< coef_lr: 0.001
2024-05-06 11:17:20,490:INFO:   <<< cross_model: cross-base
2024-05-06 11:17:20,490:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:17:20,490:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:17:20,490:INFO:   <<< datatype: msrvtt
2024-05-06 11:17:20,490:INFO:   <<< do_eval: True
2024-05-06 11:17:20,490:INFO:   <<< do_lower_case: False
2024-05-06 11:17:20,490:INFO:   <<< do_pretrain: False
2024-05-06 11:17:20,490:INFO:   <<< do_train: False
2024-05-06 11:17:20,490:INFO:   <<< epochs: 2
2024-05-06 11:17:20,491:INFO:   <<< eval_frame_order: 0
2024-05-06 11:17:20,491:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:17:20,491:INFO:   <<< feature_framerate: 1
2024-05-06 11:17:20,491:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:17:20,491:INFO:   <<< fp16: False
2024-05-06 11:17:20,491:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:17:20,491:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:17:20,491:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:17:20,491:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:17:20,491:INFO:   <<< init_model: None
2024-05-06 11:17:20,491:INFO:   <<< linear_patch: 2d
2024-05-06 11:17:20,491:INFO:   <<< local_rank: 0
2024-05-06 11:17:20,491:INFO:   <<< loose_type: True
2024-05-06 11:17:20,491:INFO:   <<< lr: 0.0001
2024-05-06 11:17:20,491:INFO:   <<< lr_decay: 0.9
2024-05-06 11:17:20,491:INFO:   <<< margin: 0.1
2024-05-06 11:17:20,491:INFO:   <<< max_frames: 90
2024-05-06 11:17:20,492:INFO:   <<< max_words: 32
2024-05-06 11:17:20,492:INFO:   <<< n_display: 100
2024-05-06 11:17:20,492:INFO:   <<< n_gpu: 1
2024-05-06 11:17:20,492:INFO:   <<< n_pair: 1
2024-05-06 11:17:20,492:INFO:   <<< negative_weighting: 1
2024-05-06 11:17:20,492:INFO:   <<< num_thread_reader: 0
2024-05-06 11:17:20,492:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:17:20,492:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:17:20,492:INFO:   <<< rank: 0
2024-05-06 11:17:20,492:INFO:   <<< resume_model: None
2024-05-06 11:17:20,492:INFO:   <<< sampled_use_mil: False
2024-05-06 11:17:20,492:INFO:   <<< seed: 42
2024-05-06 11:17:20,492:INFO:   <<< sim_header: meanP
2024-05-06 11:17:20,492:INFO:   <<< slice_framepos: 2
2024-05-06 11:17:20,492:INFO:   <<< task_type: retrieval
2024-05-06 11:17:20,492:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:17:20,493:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:17:20,493:INFO:   <<< train_frame_order: 0
2024-05-06 11:17:20,493:INFO:   <<< use_mil: False
2024-05-06 11:17:20,493:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:17:20,493:INFO:   <<< video_dim: 1024
2024-05-06 11:17:20,493:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:17:20,493:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:17:20,493:INFO:   <<< world_size: 1
2024-05-06 11:17:20,493:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:17:20,643:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:17:21,125:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:17:21,126:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:17:21,126:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:17:21,127:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:17:21,127:WARNING: Test retrieval by loose type.
2024-05-06 11:17:21,128:WARNING: 	 embed_dim: 512
2024-05-06 11:17:21,129:WARNING: 	 image_resolution: 224
2024-05-06 11:17:21,129:WARNING: 	 vision_layers: 12
2024-05-06 11:17:21,129:WARNING: 	 vision_width: 768
2024-05-06 11:17:21,129:WARNING: 	 vision_patch_size: 32
2024-05-06 11:17:21,129:WARNING: 	 context_length: 77
2024-05-06 11:17:21,129:WARNING: 	 vocab_size: 49408
2024-05-06 11:17:21,129:WARNING: 	 transformer_width: 512
2024-05-06 11:17:21,129:WARNING: 	 transformer_heads: 8
2024-05-06 11:17:21,129:WARNING: 	 transformer_layers: 12
2024-05-06 11:17:21,130:WARNING: 		 linear_patch: 2d
2024-05-06 11:17:21,130:WARNING: 	 cut_top_layer: 0
2024-05-06 11:17:21,996:WARNING: 	 sim_header: meanP
2024-05-06 11:17:25,743:INFO: --------------------
2024-05-06 11:17:25,743:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:19:48,979:INFO: Effective parameters:
2024-05-06 11:19:48,979:INFO:   <<< batch_size: 1
2024-05-06 11:19:48,980:INFO:   <<< batch_size_val: 16
2024-05-06 11:19:48,980:INFO:   <<< cache_dir: 
2024-05-06 11:19:48,980:INFO:   <<< coef_lr: 0.001
2024-05-06 11:19:48,980:INFO:   <<< cross_model: cross-base
2024-05-06 11:19:48,980:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:19:48,980:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:19:48,980:INFO:   <<< datatype: msrvtt
2024-05-06 11:19:48,980:INFO:   <<< do_eval: True
2024-05-06 11:19:48,980:INFO:   <<< do_lower_case: False
2024-05-06 11:19:48,980:INFO:   <<< do_pretrain: False
2024-05-06 11:19:48,980:INFO:   <<< do_train: False
2024-05-06 11:19:48,980:INFO:   <<< epochs: 2
2024-05-06 11:19:48,980:INFO:   <<< eval_frame_order: 0
2024-05-06 11:19:48,980:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:19:48,980:INFO:   <<< feature_framerate: 1
2024-05-06 11:19:48,980:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:19:48,981:INFO:   <<< fp16: False
2024-05-06 11:19:48,981:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:19:48,981:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:19:48,981:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:19:48,981:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:19:48,981:INFO:   <<< init_model: None
2024-05-06 11:19:48,981:INFO:   <<< linear_patch: 2d
2024-05-06 11:19:48,981:INFO:   <<< local_rank: 0
2024-05-06 11:19:48,981:INFO:   <<< loose_type: True
2024-05-06 11:19:48,981:INFO:   <<< lr: 0.0001
2024-05-06 11:19:48,981:INFO:   <<< lr_decay: 0.9
2024-05-06 11:19:48,981:INFO:   <<< margin: 0.1
2024-05-06 11:19:48,981:INFO:   <<< max_frames: 90
2024-05-06 11:19:48,981:INFO:   <<< max_words: 32
2024-05-06 11:19:48,981:INFO:   <<< n_display: 100
2024-05-06 11:19:48,981:INFO:   <<< n_gpu: 1
2024-05-06 11:19:48,981:INFO:   <<< n_pair: 1
2024-05-06 11:19:48,981:INFO:   <<< negative_weighting: 1
2024-05-06 11:19:48,982:INFO:   <<< num_thread_reader: 0
2024-05-06 11:19:48,982:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:19:48,982:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:19:48,982:INFO:   <<< rank: 0
2024-05-06 11:19:48,982:INFO:   <<< resume_model: None
2024-05-06 11:19:48,982:INFO:   <<< sampled_use_mil: False
2024-05-06 11:19:48,982:INFO:   <<< seed: 42
2024-05-06 11:19:48,982:INFO:   <<< sim_header: meanP
2024-05-06 11:19:48,982:INFO:   <<< slice_framepos: 2
2024-05-06 11:19:48,982:INFO:   <<< task_type: retrieval
2024-05-06 11:19:48,982:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:19:48,982:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:19:48,982:INFO:   <<< train_frame_order: 0
2024-05-06 11:19:48,982:INFO:   <<< use_mil: False
2024-05-06 11:19:48,982:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:19:48,982:INFO:   <<< video_dim: 1024
2024-05-06 11:19:48,982:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:19:48,983:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:19:48,983:INFO:   <<< world_size: 1
2024-05-06 11:19:48,983:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:19:49,133:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:19:49,625:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:19:49,626:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:19:49,626:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:19:49,626:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:19:49,626:WARNING: Test retrieval by loose type.
2024-05-06 11:19:49,628:WARNING: 	 embed_dim: 512
2024-05-06 11:19:49,628:WARNING: 	 image_resolution: 224
2024-05-06 11:19:49,628:WARNING: 	 vision_layers: 12
2024-05-06 11:19:49,628:WARNING: 	 vision_width: 768
2024-05-06 11:19:49,628:WARNING: 	 vision_patch_size: 32
2024-05-06 11:19:49,628:WARNING: 	 context_length: 77
2024-05-06 11:19:49,628:WARNING: 	 vocab_size: 49408
2024-05-06 11:19:49,629:WARNING: 	 transformer_width: 512
2024-05-06 11:19:49,629:WARNING: 	 transformer_heads: 8
2024-05-06 11:19:49,629:WARNING: 	 transformer_layers: 12
2024-05-06 11:19:49,629:WARNING: 		 linear_patch: 2d
2024-05-06 11:19:49,629:WARNING: 	 cut_top_layer: 0
2024-05-06 11:19:50,578:WARNING: 	 sim_header: meanP
2024-05-06 11:19:54,292:INFO: --------------------
2024-05-06 11:19:54,292:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:21:02,118:INFO: Effective parameters:
2024-05-06 11:21:02,119:INFO:   <<< batch_size: 1
2024-05-06 11:21:02,119:INFO:   <<< batch_size_val: 16
2024-05-06 11:21:02,119:INFO:   <<< cache_dir: 
2024-05-06 11:21:02,119:INFO:   <<< coef_lr: 0.001
2024-05-06 11:21:02,119:INFO:   <<< cross_model: cross-base
2024-05-06 11:21:02,119:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:21:02,119:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:21:02,119:INFO:   <<< datatype: msrvtt
2024-05-06 11:21:02,119:INFO:   <<< do_eval: True
2024-05-06 11:21:02,119:INFO:   <<< do_lower_case: False
2024-05-06 11:21:02,119:INFO:   <<< do_pretrain: False
2024-05-06 11:21:02,119:INFO:   <<< do_train: False
2024-05-06 11:21:02,119:INFO:   <<< epochs: 2
2024-05-06 11:21:02,119:INFO:   <<< eval_frame_order: 0
2024-05-06 11:21:02,119:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:21:02,119:INFO:   <<< feature_framerate: 1
2024-05-06 11:21:02,120:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:21:02,120:INFO:   <<< fp16: False
2024-05-06 11:21:02,120:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:21:02,120:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:21:02,120:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:21:02,120:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:21:02,120:INFO:   <<< init_model: None
2024-05-06 11:21:02,120:INFO:   <<< linear_patch: 2d
2024-05-06 11:21:02,120:INFO:   <<< local_rank: 0
2024-05-06 11:21:02,120:INFO:   <<< loose_type: True
2024-05-06 11:21:02,120:INFO:   <<< lr: 0.0001
2024-05-06 11:21:02,120:INFO:   <<< lr_decay: 0.9
2024-05-06 11:21:02,120:INFO:   <<< margin: 0.1
2024-05-06 11:21:02,120:INFO:   <<< max_frames: 90
2024-05-06 11:21:02,120:INFO:   <<< max_words: 32
2024-05-06 11:21:02,120:INFO:   <<< n_display: 100
2024-05-06 11:21:02,121:INFO:   <<< n_gpu: 1
2024-05-06 11:21:02,121:INFO:   <<< n_pair: 1
2024-05-06 11:21:02,121:INFO:   <<< negative_weighting: 1
2024-05-06 11:21:02,121:INFO:   <<< num_thread_reader: 0
2024-05-06 11:21:02,121:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:21:02,121:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:21:02,121:INFO:   <<< rank: 0
2024-05-06 11:21:02,121:INFO:   <<< resume_model: None
2024-05-06 11:21:02,121:INFO:   <<< sampled_use_mil: False
2024-05-06 11:21:02,121:INFO:   <<< seed: 42
2024-05-06 11:21:02,121:INFO:   <<< sim_header: meanP
2024-05-06 11:21:02,121:INFO:   <<< slice_framepos: 2
2024-05-06 11:21:02,121:INFO:   <<< task_type: retrieval
2024-05-06 11:21:02,121:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:21:02,121:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:21:02,121:INFO:   <<< train_frame_order: 0
2024-05-06 11:21:02,121:INFO:   <<< use_mil: False
2024-05-06 11:21:02,122:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:21:02,122:INFO:   <<< video_dim: 1024
2024-05-06 11:21:02,122:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:21:02,122:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:21:02,122:INFO:   <<< world_size: 1
2024-05-06 11:21:02,122:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:21:02,260:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:21:02,749:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:21:02,750:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:21:02,750:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:21:02,750:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:21:02,750:WARNING: Test retrieval by loose type.
2024-05-06 11:21:02,752:WARNING: 	 embed_dim: 512
2024-05-06 11:21:02,752:WARNING: 	 image_resolution: 224
2024-05-06 11:21:02,752:WARNING: 	 vision_layers: 12
2024-05-06 11:21:02,752:WARNING: 	 vision_width: 768
2024-05-06 11:21:02,752:WARNING: 	 vision_patch_size: 32
2024-05-06 11:21:02,752:WARNING: 	 context_length: 77
2024-05-06 11:21:02,752:WARNING: 	 vocab_size: 49408
2024-05-06 11:21:02,752:WARNING: 	 transformer_width: 512
2024-05-06 11:21:02,752:WARNING: 	 transformer_heads: 8
2024-05-06 11:21:02,753:WARNING: 	 transformer_layers: 12
2024-05-06 11:21:02,753:WARNING: 		 linear_patch: 2d
2024-05-06 11:21:02,753:WARNING: 	 cut_top_layer: 0
2024-05-06 11:21:03,617:WARNING: 	 sim_header: meanP
2024-05-06 11:21:07,355:INFO: --------------------
2024-05-06 11:21:07,355:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:23:54,687:INFO: Effective parameters:
2024-05-06 11:23:54,688:INFO:   <<< batch_size: 1
2024-05-06 11:23:54,688:INFO:   <<< batch_size_val: 16
2024-05-06 11:23:54,688:INFO:   <<< cache_dir: 
2024-05-06 11:23:54,688:INFO:   <<< coef_lr: 0.001
2024-05-06 11:23:54,688:INFO:   <<< cross_model: cross-base
2024-05-06 11:23:54,688:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:23:54,688:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:23:54,688:INFO:   <<< datatype: msrvtt
2024-05-06 11:23:54,688:INFO:   <<< do_eval: True
2024-05-06 11:23:54,688:INFO:   <<< do_lower_case: False
2024-05-06 11:23:54,688:INFO:   <<< do_pretrain: False
2024-05-06 11:23:54,688:INFO:   <<< do_train: False
2024-05-06 11:23:54,689:INFO:   <<< epochs: 2
2024-05-06 11:23:54,689:INFO:   <<< eval_frame_order: 0
2024-05-06 11:23:54,689:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:23:54,689:INFO:   <<< feature_framerate: 1
2024-05-06 11:23:54,689:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:23:54,689:INFO:   <<< fp16: False
2024-05-06 11:23:54,689:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:23:54,689:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:23:54,689:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:23:54,689:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:23:54,689:INFO:   <<< init_model: None
2024-05-06 11:23:54,689:INFO:   <<< linear_patch: 2d
2024-05-06 11:23:54,689:INFO:   <<< local_rank: 0
2024-05-06 11:23:54,689:INFO:   <<< loose_type: True
2024-05-06 11:23:54,690:INFO:   <<< lr: 0.0001
2024-05-06 11:23:54,690:INFO:   <<< lr_decay: 0.9
2024-05-06 11:23:54,690:INFO:   <<< margin: 0.1
2024-05-06 11:23:54,690:INFO:   <<< max_frames: 90
2024-05-06 11:23:54,690:INFO:   <<< max_words: 32
2024-05-06 11:23:54,690:INFO:   <<< n_display: 100
2024-05-06 11:23:54,690:INFO:   <<< n_gpu: 1
2024-05-06 11:23:54,690:INFO:   <<< n_pair: 1
2024-05-06 11:23:54,690:INFO:   <<< negative_weighting: 1
2024-05-06 11:23:54,690:INFO:   <<< num_thread_reader: 0
2024-05-06 11:23:54,690:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:23:54,690:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:23:54,690:INFO:   <<< rank: 0
2024-05-06 11:23:54,690:INFO:   <<< resume_model: None
2024-05-06 11:23:54,691:INFO:   <<< sampled_use_mil: False
2024-05-06 11:23:54,691:INFO:   <<< seed: 42
2024-05-06 11:23:54,691:INFO:   <<< sim_header: meanP
2024-05-06 11:23:54,691:INFO:   <<< slice_framepos: 2
2024-05-06 11:23:54,691:INFO:   <<< task_type: retrieval
2024-05-06 11:23:54,691:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:23:54,691:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:23:54,691:INFO:   <<< train_frame_order: 0
2024-05-06 11:23:54,691:INFO:   <<< use_mil: False
2024-05-06 11:23:54,691:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:23:54,691:INFO:   <<< video_dim: 1024
2024-05-06 11:23:54,691:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:23:54,691:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:23:54,691:INFO:   <<< world_size: 1
2024-05-06 11:23:54,692:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:23:54,836:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:23:55,317:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:23:55,318:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:23:55,318:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:23:55,318:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:23:55,318:WARNING: Test retrieval by loose type.
2024-05-06 11:23:55,319:WARNING: 	 embed_dim: 512
2024-05-06 11:23:55,320:WARNING: 	 image_resolution: 224
2024-05-06 11:23:55,320:WARNING: 	 vision_layers: 12
2024-05-06 11:23:55,320:WARNING: 	 vision_width: 768
2024-05-06 11:23:55,320:WARNING: 	 vision_patch_size: 32
2024-05-06 11:23:55,320:WARNING: 	 context_length: 77
2024-05-06 11:23:55,320:WARNING: 	 vocab_size: 49408
2024-05-06 11:23:55,320:WARNING: 	 transformer_width: 512
2024-05-06 11:23:55,320:WARNING: 	 transformer_heads: 8
2024-05-06 11:23:55,320:WARNING: 	 transformer_layers: 12
2024-05-06 11:23:55,320:WARNING: 		 linear_patch: 2d
2024-05-06 11:23:55,320:WARNING: 	 cut_top_layer: 0
2024-05-06 11:23:56,179:WARNING: 	 sim_header: meanP
2024-05-06 11:23:59,900:INFO: --------------------
2024-05-06 11:23:59,901:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:39:21,365:INFO: Effective parameters:
2024-05-06 11:39:21,365:INFO:   <<< batch_size: 1
2024-05-06 11:39:21,365:INFO:   <<< batch_size_val: 16
2024-05-06 11:39:21,366:INFO:   <<< cache_dir: 
2024-05-06 11:39:21,366:INFO:   <<< coef_lr: 0.001
2024-05-06 11:39:21,366:INFO:   <<< cross_model: cross-base
2024-05-06 11:39:21,366:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:39:21,366:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:39:21,366:INFO:   <<< datatype: msrvtt
2024-05-06 11:39:21,366:INFO:   <<< do_eval: True
2024-05-06 11:39:21,366:INFO:   <<< do_lower_case: False
2024-05-06 11:39:21,366:INFO:   <<< do_pretrain: False
2024-05-06 11:39:21,366:INFO:   <<< do_train: False
2024-05-06 11:39:21,366:INFO:   <<< epochs: 2
2024-05-06 11:39:21,366:INFO:   <<< eval_frame_order: 0
2024-05-06 11:39:21,366:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:39:21,366:INFO:   <<< feature_framerate: 1
2024-05-06 11:39:21,366:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:39:21,366:INFO:   <<< fp16: False
2024-05-06 11:39:21,366:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:39:21,367:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:39:21,367:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:39:21,367:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:39:21,367:INFO:   <<< init_model: None
2024-05-06 11:39:21,367:INFO:   <<< linear_patch: 2d
2024-05-06 11:39:21,367:INFO:   <<< local_rank: 0
2024-05-06 11:39:21,367:INFO:   <<< loose_type: True
2024-05-06 11:39:21,367:INFO:   <<< lr: 0.0001
2024-05-06 11:39:21,367:INFO:   <<< lr_decay: 0.9
2024-05-06 11:39:21,367:INFO:   <<< margin: 0.1
2024-05-06 11:39:21,367:INFO:   <<< max_frames: 90
2024-05-06 11:39:21,367:INFO:   <<< max_words: 32
2024-05-06 11:39:21,367:INFO:   <<< n_display: 100
2024-05-06 11:39:21,367:INFO:   <<< n_gpu: 1
2024-05-06 11:39:21,367:INFO:   <<< n_pair: 1
2024-05-06 11:39:21,367:INFO:   <<< negative_weighting: 1
2024-05-06 11:39:21,367:INFO:   <<< num_thread_reader: 0
2024-05-06 11:39:21,368:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:39:21,368:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:39:21,368:INFO:   <<< rank: 0
2024-05-06 11:39:21,368:INFO:   <<< resume_model: None
2024-05-06 11:39:21,368:INFO:   <<< sampled_use_mil: False
2024-05-06 11:39:21,368:INFO:   <<< seed: 42
2024-05-06 11:39:21,368:INFO:   <<< sim_header: meanP
2024-05-06 11:39:21,368:INFO:   <<< slice_framepos: 2
2024-05-06 11:39:21,368:INFO:   <<< task_type: retrieval
2024-05-06 11:39:21,368:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:39:21,368:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:39:21,368:INFO:   <<< train_frame_order: 0
2024-05-06 11:39:21,368:INFO:   <<< use_mil: False
2024-05-06 11:39:21,368:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:39:21,368:INFO:   <<< video_dim: 1024
2024-05-06 11:39:21,368:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:39:21,368:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:39:21,369:INFO:   <<< world_size: 1
2024-05-06 11:39:21,369:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:39:21,506:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:39:21,974:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:39:21,974:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:39:21,974:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:39:21,975:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:39:21,975:WARNING: Test retrieval by loose type.
2024-05-06 11:39:21,975:WARNING: 	 embed_dim: 512
2024-05-06 11:39:21,975:WARNING: 	 image_resolution: 224
2024-05-06 11:39:21,976:WARNING: 	 vision_layers: 12
2024-05-06 11:39:21,976:WARNING: 	 vision_width: 768
2024-05-06 11:39:21,976:WARNING: 	 vision_patch_size: 32
2024-05-06 11:39:21,976:WARNING: 	 context_length: 77
2024-05-06 11:39:21,976:WARNING: 	 vocab_size: 49408
2024-05-06 11:39:21,976:WARNING: 	 transformer_width: 512
2024-05-06 11:39:21,976:WARNING: 	 transformer_heads: 8
2024-05-06 11:39:21,976:WARNING: 	 transformer_layers: 12
2024-05-06 11:39:21,976:WARNING: 		 linear_patch: 2d
2024-05-06 11:39:21,976:WARNING: 	 cut_top_layer: 0
2024-05-06 11:39:22,856:WARNING: 	 sim_header: meanP
2024-05-06 11:40:20,798:INFO: Effective parameters:
2024-05-06 11:40:20,798:INFO:   <<< batch_size: 1
2024-05-06 11:40:20,798:INFO:   <<< batch_size_val: 16
2024-05-06 11:40:20,798:INFO:   <<< cache_dir: 
2024-05-06 11:40:20,798:INFO:   <<< coef_lr: 0.001
2024-05-06 11:40:20,798:INFO:   <<< cross_model: cross-base
2024-05-06 11:40:20,798:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:40:20,798:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:40:20,798:INFO:   <<< datatype: msrvtt
2024-05-06 11:40:20,798:INFO:   <<< do_eval: True
2024-05-06 11:40:20,798:INFO:   <<< do_lower_case: False
2024-05-06 11:40:20,799:INFO:   <<< do_pretrain: False
2024-05-06 11:40:20,799:INFO:   <<< do_train: False
2024-05-06 11:40:20,799:INFO:   <<< epochs: 2
2024-05-06 11:40:20,799:INFO:   <<< eval_frame_order: 0
2024-05-06 11:40:20,799:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:40:20,799:INFO:   <<< feature_framerate: 1
2024-05-06 11:40:20,799:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:40:20,799:INFO:   <<< fp16: False
2024-05-06 11:40:20,799:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:40:20,799:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:40:20,799:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:40:20,799:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:40:20,799:INFO:   <<< init_model: None
2024-05-06 11:40:20,799:INFO:   <<< linear_patch: 2d
2024-05-06 11:40:20,799:INFO:   <<< local_rank: 0
2024-05-06 11:40:20,799:INFO:   <<< loose_type: True
2024-05-06 11:40:20,799:INFO:   <<< lr: 0.0001
2024-05-06 11:40:20,800:INFO:   <<< lr_decay: 0.9
2024-05-06 11:40:20,800:INFO:   <<< margin: 0.1
2024-05-06 11:40:20,800:INFO:   <<< max_frames: 90
2024-05-06 11:40:20,800:INFO:   <<< max_words: 32
2024-05-06 11:40:20,800:INFO:   <<< n_display: 100
2024-05-06 11:40:20,800:INFO:   <<< n_gpu: 1
2024-05-06 11:40:20,800:INFO:   <<< n_pair: 1
2024-05-06 11:40:20,800:INFO:   <<< negative_weighting: 1
2024-05-06 11:40:20,800:INFO:   <<< num_thread_reader: 0
2024-05-06 11:40:20,800:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:40:20,800:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:40:20,800:INFO:   <<< rank: 0
2024-05-06 11:40:20,800:INFO:   <<< resume_model: None
2024-05-06 11:40:20,800:INFO:   <<< sampled_use_mil: False
2024-05-06 11:40:20,800:INFO:   <<< seed: 42
2024-05-06 11:40:20,800:INFO:   <<< sim_header: meanP
2024-05-06 11:40:20,800:INFO:   <<< slice_framepos: 2
2024-05-06 11:40:20,801:INFO:   <<< task_type: retrieval
2024-05-06 11:40:20,801:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:40:20,801:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:40:20,801:INFO:   <<< train_frame_order: 0
2024-05-06 11:40:20,801:INFO:   <<< use_mil: False
2024-05-06 11:40:20,801:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:40:20,801:INFO:   <<< video_dim: 1024
2024-05-06 11:40:20,801:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:40:20,801:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:40:20,801:INFO:   <<< world_size: 1
2024-05-06 11:40:20,801:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:40:20,947:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:40:21,429:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:40:21,430:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:40:21,430:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:40:21,431:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:40:21,431:WARNING: Test retrieval by loose type.
2024-05-06 11:40:21,432:WARNING: 	 embed_dim: 512
2024-05-06 11:40:21,432:WARNING: 	 image_resolution: 224
2024-05-06 11:40:21,432:WARNING: 	 vision_layers: 12
2024-05-06 11:40:21,433:WARNING: 	 vision_width: 768
2024-05-06 11:40:21,433:WARNING: 	 vision_patch_size: 32
2024-05-06 11:40:21,433:WARNING: 	 context_length: 77
2024-05-06 11:40:21,433:WARNING: 	 vocab_size: 49408
2024-05-06 11:40:21,433:WARNING: 	 transformer_width: 512
2024-05-06 11:40:21,433:WARNING: 	 transformer_heads: 8
2024-05-06 11:40:21,433:WARNING: 	 transformer_layers: 12
2024-05-06 11:40:21,433:WARNING: 		 linear_patch: 2d
2024-05-06 11:40:21,433:WARNING: 	 cut_top_layer: 0
2024-05-06 11:40:22,318:WARNING: 	 sim_header: meanP
2024-05-06 11:40:26,022:INFO: --------------------
2024-05-06 11:40:26,022:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:44:22,903:INFO: Effective parameters:
2024-05-06 11:44:22,904:INFO:   <<< batch_size: 1
2024-05-06 11:44:22,904:INFO:   <<< batch_size_val: 16
2024-05-06 11:44:22,904:INFO:   <<< cache_dir: 
2024-05-06 11:44:22,904:INFO:   <<< coef_lr: 0.001
2024-05-06 11:44:22,904:INFO:   <<< cross_model: cross-base
2024-05-06 11:44:22,904:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:44:22,904:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:44:22,904:INFO:   <<< datatype: msrvtt
2024-05-06 11:44:22,904:INFO:   <<< do_eval: True
2024-05-06 11:44:22,904:INFO:   <<< do_lower_case: False
2024-05-06 11:44:22,904:INFO:   <<< do_pretrain: False
2024-05-06 11:44:22,904:INFO:   <<< do_train: False
2024-05-06 11:44:22,904:INFO:   <<< epochs: 2
2024-05-06 11:44:22,904:INFO:   <<< eval_frame_order: 0
2024-05-06 11:44:22,904:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:44:22,904:INFO:   <<< feature_framerate: 1
2024-05-06 11:44:22,905:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:44:22,905:INFO:   <<< fp16: False
2024-05-06 11:44:22,905:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:44:22,905:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:44:22,905:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:44:22,905:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:44:22,905:INFO:   <<< init_model: None
2024-05-06 11:44:22,905:INFO:   <<< linear_patch: 2d
2024-05-06 11:44:22,905:INFO:   <<< local_rank: 0
2024-05-06 11:44:22,905:INFO:   <<< loose_type: True
2024-05-06 11:44:22,905:INFO:   <<< lr: 0.0001
2024-05-06 11:44:22,905:INFO:   <<< lr_decay: 0.9
2024-05-06 11:44:22,905:INFO:   <<< margin: 0.1
2024-05-06 11:44:22,905:INFO:   <<< max_frames: 90
2024-05-06 11:44:22,905:INFO:   <<< max_words: 32
2024-05-06 11:44:22,905:INFO:   <<< n_display: 100
2024-05-06 11:44:22,905:INFO:   <<< n_gpu: 1
2024-05-06 11:44:22,906:INFO:   <<< n_pair: 1
2024-05-06 11:44:22,906:INFO:   <<< negative_weighting: 1
2024-05-06 11:44:22,906:INFO:   <<< num_thread_reader: 0
2024-05-06 11:44:22,906:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:44:22,906:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:44:22,906:INFO:   <<< rank: 0
2024-05-06 11:44:22,906:INFO:   <<< resume_model: None
2024-05-06 11:44:22,906:INFO:   <<< sampled_use_mil: False
2024-05-06 11:44:22,906:INFO:   <<< seed: 42
2024-05-06 11:44:22,906:INFO:   <<< sim_header: meanP
2024-05-06 11:44:22,906:INFO:   <<< slice_framepos: 2
2024-05-06 11:44:22,906:INFO:   <<< task_type: retrieval
2024-05-06 11:44:22,906:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:44:22,906:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:44:22,906:INFO:   <<< train_frame_order: 0
2024-05-06 11:44:22,906:INFO:   <<< use_mil: False
2024-05-06 11:44:22,906:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:44:22,907:INFO:   <<< video_dim: 1024
2024-05-06 11:44:22,907:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:44:22,907:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:44:22,907:INFO:   <<< world_size: 1
2024-05-06 11:44:22,907:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:44:23,048:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:44:23,499:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:44:23,500:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:44:23,500:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:44:23,500:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:44:23,500:WARNING: Test retrieval by loose type.
2024-05-06 11:44:23,501:WARNING: 	 embed_dim: 512
2024-05-06 11:44:23,501:WARNING: 	 image_resolution: 224
2024-05-06 11:44:23,501:WARNING: 	 vision_layers: 12
2024-05-06 11:44:23,501:WARNING: 	 vision_width: 768
2024-05-06 11:44:23,501:WARNING: 	 vision_patch_size: 32
2024-05-06 11:44:23,501:WARNING: 	 context_length: 77
2024-05-06 11:44:23,501:WARNING: 	 vocab_size: 49408
2024-05-06 11:44:23,501:WARNING: 	 transformer_width: 512
2024-05-06 11:44:23,501:WARNING: 	 transformer_heads: 8
2024-05-06 11:44:23,501:WARNING: 	 transformer_layers: 12
2024-05-06 11:44:23,501:WARNING: 		 linear_patch: 2d
2024-05-06 11:44:23,501:WARNING: 	 cut_top_layer: 0
2024-05-06 11:44:24,363:WARNING: 	 sim_header: meanP
2024-05-06 11:44:28,062:INFO: --------------------
2024-05-06 11:44:28,062:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:48:53,659:INFO: Effective parameters:
2024-05-06 11:48:53,660:INFO:   <<< batch_size: 1
2024-05-06 11:48:53,660:INFO:   <<< batch_size_val: 16
2024-05-06 11:48:53,660:INFO:   <<< cache_dir: 
2024-05-06 11:48:53,660:INFO:   <<< coef_lr: 0.001
2024-05-06 11:48:53,660:INFO:   <<< cross_model: cross-base
2024-05-06 11:48:53,660:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:48:53,660:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:48:53,660:INFO:   <<< datatype: msrvtt
2024-05-06 11:48:53,660:INFO:   <<< do_eval: True
2024-05-06 11:48:53,661:INFO:   <<< do_lower_case: False
2024-05-06 11:48:53,661:INFO:   <<< do_pretrain: False
2024-05-06 11:48:53,661:INFO:   <<< do_train: False
2024-05-06 11:48:53,661:INFO:   <<< epochs: 2
2024-05-06 11:48:53,661:INFO:   <<< eval_frame_order: 0
2024-05-06 11:48:53,661:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:48:53,661:INFO:   <<< feature_framerate: 1
2024-05-06 11:48:53,661:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:48:53,661:INFO:   <<< fp16: False
2024-05-06 11:48:53,661:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:48:53,661:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:48:53,661:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:48:53,661:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:48:53,661:INFO:   <<< init_model: None
2024-05-06 11:48:53,662:INFO:   <<< linear_patch: 2d
2024-05-06 11:48:53,662:INFO:   <<< local_rank: 0
2024-05-06 11:48:53,662:INFO:   <<< loose_type: True
2024-05-06 11:48:53,662:INFO:   <<< lr: 0.0001
2024-05-06 11:48:53,662:INFO:   <<< lr_decay: 0.9
2024-05-06 11:48:53,662:INFO:   <<< margin: 0.1
2024-05-06 11:48:53,662:INFO:   <<< max_frames: 90
2024-05-06 11:48:53,662:INFO:   <<< max_words: 32
2024-05-06 11:48:53,662:INFO:   <<< n_display: 100
2024-05-06 11:48:53,662:INFO:   <<< n_gpu: 1
2024-05-06 11:48:53,662:INFO:   <<< n_pair: 1
2024-05-06 11:48:53,662:INFO:   <<< negative_weighting: 1
2024-05-06 11:48:53,662:INFO:   <<< num_thread_reader: 0
2024-05-06 11:48:53,662:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:48:53,662:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:48:53,663:INFO:   <<< rank: 0
2024-05-06 11:48:53,663:INFO:   <<< resume_model: None
2024-05-06 11:48:53,663:INFO:   <<< sampled_use_mil: False
2024-05-06 11:48:53,663:INFO:   <<< seed: 42
2024-05-06 11:48:53,663:INFO:   <<< sim_header: meanP
2024-05-06 11:48:53,663:INFO:   <<< slice_framepos: 2
2024-05-06 11:48:53,663:INFO:   <<< task_type: retrieval
2024-05-06 11:48:53,663:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:48:53,663:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:48:53,663:INFO:   <<< train_frame_order: 0
2024-05-06 11:48:53,663:INFO:   <<< use_mil: False
2024-05-06 11:48:53,663:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:48:53,663:INFO:   <<< video_dim: 1024
2024-05-06 11:48:53,663:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:48:53,664:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:48:53,664:INFO:   <<< world_size: 1
2024-05-06 11:48:53,664:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:48:53,809:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:48:54,293:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:48:54,294:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:48:54,294:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:48:54,294:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:48:54,294:WARNING: Test retrieval by loose type.
2024-05-06 11:48:54,295:WARNING: 	 embed_dim: 512
2024-05-06 11:48:54,295:WARNING: 	 image_resolution: 224
2024-05-06 11:48:54,296:WARNING: 	 vision_layers: 12
2024-05-06 11:48:54,296:WARNING: 	 vision_width: 768
2024-05-06 11:48:54,296:WARNING: 	 vision_patch_size: 32
2024-05-06 11:48:54,296:WARNING: 	 context_length: 77
2024-05-06 11:48:54,296:WARNING: 	 vocab_size: 49408
2024-05-06 11:48:54,296:WARNING: 	 transformer_width: 512
2024-05-06 11:48:54,296:WARNING: 	 transformer_heads: 8
2024-05-06 11:48:54,296:WARNING: 	 transformer_layers: 12
2024-05-06 11:48:54,296:WARNING: 		 linear_patch: 2d
2024-05-06 11:48:54,296:WARNING: 	 cut_top_layer: 0
2024-05-06 11:48:55,161:WARNING: 	 sim_header: meanP
2024-05-06 11:48:58,898:INFO: --------------------
2024-05-06 11:48:58,898:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:49:56,723:INFO: Effective parameters:
2024-05-06 11:49:56,724:INFO:   <<< batch_size: 1
2024-05-06 11:49:56,724:INFO:   <<< batch_size_val: 16
2024-05-06 11:49:56,724:INFO:   <<< cache_dir: 
2024-05-06 11:49:56,724:INFO:   <<< coef_lr: 0.001
2024-05-06 11:49:56,724:INFO:   <<< cross_model: cross-base
2024-05-06 11:49:56,724:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:49:56,724:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:49:56,724:INFO:   <<< datatype: msrvtt
2024-05-06 11:49:56,724:INFO:   <<< do_eval: True
2024-05-06 11:49:56,724:INFO:   <<< do_lower_case: False
2024-05-06 11:49:56,724:INFO:   <<< do_pretrain: False
2024-05-06 11:49:56,724:INFO:   <<< do_train: False
2024-05-06 11:49:56,725:INFO:   <<< epochs: 2
2024-05-06 11:49:56,725:INFO:   <<< eval_frame_order: 0
2024-05-06 11:49:56,725:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:49:56,725:INFO:   <<< feature_framerate: 1
2024-05-06 11:49:56,725:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:49:56,725:INFO:   <<< fp16: False
2024-05-06 11:49:56,725:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:49:56,725:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:49:56,725:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:49:56,725:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:49:56,725:INFO:   <<< init_model: None
2024-05-06 11:49:56,725:INFO:   <<< linear_patch: 2d
2024-05-06 11:49:56,725:INFO:   <<< local_rank: 0
2024-05-06 11:49:56,725:INFO:   <<< loose_type: True
2024-05-06 11:49:56,725:INFO:   <<< lr: 0.0001
2024-05-06 11:49:56,725:INFO:   <<< lr_decay: 0.9
2024-05-06 11:49:56,725:INFO:   <<< margin: 0.1
2024-05-06 11:49:56,725:INFO:   <<< max_frames: 90
2024-05-06 11:49:56,726:INFO:   <<< max_words: 32
2024-05-06 11:49:56,726:INFO:   <<< n_display: 100
2024-05-06 11:49:56,726:INFO:   <<< n_gpu: 1
2024-05-06 11:49:56,726:INFO:   <<< n_pair: 1
2024-05-06 11:49:56,726:INFO:   <<< negative_weighting: 1
2024-05-06 11:49:56,726:INFO:   <<< num_thread_reader: 0
2024-05-06 11:49:56,726:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:49:56,726:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:49:56,726:INFO:   <<< rank: 0
2024-05-06 11:49:56,726:INFO:   <<< resume_model: None
2024-05-06 11:49:56,726:INFO:   <<< sampled_use_mil: False
2024-05-06 11:49:56,726:INFO:   <<< seed: 42
2024-05-06 11:49:56,726:INFO:   <<< sim_header: meanP
2024-05-06 11:49:56,726:INFO:   <<< slice_framepos: 2
2024-05-06 11:49:56,726:INFO:   <<< task_type: retrieval
2024-05-06 11:49:56,726:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:49:56,726:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:49:56,727:INFO:   <<< train_frame_order: 0
2024-05-06 11:49:56,727:INFO:   <<< use_mil: False
2024-05-06 11:49:56,727:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:49:56,727:INFO:   <<< video_dim: 1024
2024-05-06 11:49:56,727:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:49:56,727:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:49:56,727:INFO:   <<< world_size: 1
2024-05-06 11:49:56,727:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:49:56,871:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:49:57,361:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:49:57,362:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:49:57,362:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:49:57,363:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:49:57,363:WARNING: Test retrieval by loose type.
2024-05-06 11:49:57,364:WARNING: 	 embed_dim: 512
2024-05-06 11:49:57,364:WARNING: 	 image_resolution: 224
2024-05-06 11:49:57,364:WARNING: 	 vision_layers: 12
2024-05-06 11:49:57,365:WARNING: 	 vision_width: 768
2024-05-06 11:49:57,365:WARNING: 	 vision_patch_size: 32
2024-05-06 11:49:57,365:WARNING: 	 context_length: 77
2024-05-06 11:49:57,365:WARNING: 	 vocab_size: 49408
2024-05-06 11:49:57,365:WARNING: 	 transformer_width: 512
2024-05-06 11:49:57,365:WARNING: 	 transformer_heads: 8
2024-05-06 11:49:57,365:WARNING: 	 transformer_layers: 12
2024-05-06 11:49:57,365:WARNING: 		 linear_patch: 2d
2024-05-06 11:49:57,365:WARNING: 	 cut_top_layer: 0
2024-05-06 11:49:58,226:WARNING: 	 sim_header: meanP
2024-05-06 11:50:01,936:INFO: --------------------
2024-05-06 11:50:01,936:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:52:38,326:INFO: Effective parameters:
2024-05-06 11:52:38,326:INFO:   <<< batch_size: 1
2024-05-06 11:52:38,326:INFO:   <<< batch_size_val: 16
2024-05-06 11:52:38,326:INFO:   <<< cache_dir: 
2024-05-06 11:52:38,326:INFO:   <<< coef_lr: 0.001
2024-05-06 11:52:38,327:INFO:   <<< cross_model: cross-base
2024-05-06 11:52:38,327:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:52:38,327:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:52:38,327:INFO:   <<< datatype: msrvtt
2024-05-06 11:52:38,327:INFO:   <<< do_eval: True
2024-05-06 11:52:38,327:INFO:   <<< do_lower_case: False
2024-05-06 11:52:38,327:INFO:   <<< do_pretrain: False
2024-05-06 11:52:38,327:INFO:   <<< do_train: False
2024-05-06 11:52:38,327:INFO:   <<< epochs: 2
2024-05-06 11:52:38,327:INFO:   <<< eval_frame_order: 0
2024-05-06 11:52:38,327:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:52:38,327:INFO:   <<< feature_framerate: 1
2024-05-06 11:52:38,327:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:52:38,327:INFO:   <<< fp16: False
2024-05-06 11:52:38,327:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:52:38,327:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:52:38,327:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:52:38,328:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:52:38,328:INFO:   <<< init_model: None
2024-05-06 11:52:38,328:INFO:   <<< linear_patch: 2d
2024-05-06 11:52:38,328:INFO:   <<< local_rank: 0
2024-05-06 11:52:38,328:INFO:   <<< loose_type: True
2024-05-06 11:52:38,328:INFO:   <<< lr: 0.0001
2024-05-06 11:52:38,328:INFO:   <<< lr_decay: 0.9
2024-05-06 11:52:38,328:INFO:   <<< margin: 0.1
2024-05-06 11:52:38,328:INFO:   <<< max_frames: 90
2024-05-06 11:52:38,328:INFO:   <<< max_words: 32
2024-05-06 11:52:38,328:INFO:   <<< n_display: 100
2024-05-06 11:52:38,328:INFO:   <<< n_gpu: 1
2024-05-06 11:52:38,328:INFO:   <<< n_pair: 1
2024-05-06 11:52:38,328:INFO:   <<< negative_weighting: 1
2024-05-06 11:52:38,328:INFO:   <<< num_thread_reader: 0
2024-05-06 11:52:38,328:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:52:38,329:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:52:38,329:INFO:   <<< rank: 0
2024-05-06 11:52:38,329:INFO:   <<< resume_model: None
2024-05-06 11:52:38,329:INFO:   <<< sampled_use_mil: False
2024-05-06 11:52:38,329:INFO:   <<< seed: 42
2024-05-06 11:52:38,329:INFO:   <<< sim_header: meanP
2024-05-06 11:52:38,329:INFO:   <<< slice_framepos: 2
2024-05-06 11:52:38,329:INFO:   <<< task_type: retrieval
2024-05-06 11:52:38,329:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:52:38,329:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:52:38,329:INFO:   <<< train_frame_order: 0
2024-05-06 11:52:38,329:INFO:   <<< use_mil: False
2024-05-06 11:52:38,329:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:52:38,329:INFO:   <<< video_dim: 1024
2024-05-06 11:52:38,329:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:52:38,329:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:52:38,329:INFO:   <<< world_size: 1
2024-05-06 11:52:38,330:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:52:38,465:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:52:38,945:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:52:38,946:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:52:38,946:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:52:38,946:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:52:38,947:WARNING: Test retrieval by loose type.
2024-05-06 11:52:38,948:WARNING: 	 embed_dim: 512
2024-05-06 11:52:38,948:WARNING: 	 image_resolution: 224
2024-05-06 11:52:38,948:WARNING: 	 vision_layers: 12
2024-05-06 11:52:38,948:WARNING: 	 vision_width: 768
2024-05-06 11:52:38,948:WARNING: 	 vision_patch_size: 32
2024-05-06 11:52:38,948:WARNING: 	 context_length: 77
2024-05-06 11:52:38,949:WARNING: 	 vocab_size: 49408
2024-05-06 11:52:38,949:WARNING: 	 transformer_width: 512
2024-05-06 11:52:38,949:WARNING: 	 transformer_heads: 8
2024-05-06 11:52:38,949:WARNING: 	 transformer_layers: 12
2024-05-06 11:52:38,949:WARNING: 		 linear_patch: 2d
2024-05-06 11:52:38,949:WARNING: 	 cut_top_layer: 0
2024-05-06 11:52:39,827:WARNING: 	 sim_header: meanP
2024-05-06 11:52:43,542:INFO: --------------------
2024-05-06 11:52:43,542:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:54:06,082:INFO: Effective parameters:
2024-05-06 11:54:06,083:INFO:   <<< batch_size: 1
2024-05-06 11:54:06,083:INFO:   <<< batch_size_val: 16
2024-05-06 11:54:06,083:INFO:   <<< cache_dir: 
2024-05-06 11:54:06,083:INFO:   <<< coef_lr: 0.001
2024-05-06 11:54:06,083:INFO:   <<< cross_model: cross-base
2024-05-06 11:54:06,083:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:54:06,083:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:54:06,084:INFO:   <<< datatype: msrvtt
2024-05-06 11:54:06,084:INFO:   <<< do_eval: True
2024-05-06 11:54:06,084:INFO:   <<< do_lower_case: False
2024-05-06 11:54:06,084:INFO:   <<< do_pretrain: False
2024-05-06 11:54:06,084:INFO:   <<< do_train: False
2024-05-06 11:54:06,084:INFO:   <<< epochs: 2
2024-05-06 11:54:06,084:INFO:   <<< eval_frame_order: 0
2024-05-06 11:54:06,084:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:54:06,085:INFO:   <<< feature_framerate: 1
2024-05-06 11:54:06,085:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:54:06,085:INFO:   <<< fp16: False
2024-05-06 11:54:06,085:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:54:06,085:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:54:06,085:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:54:06,085:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:54:06,085:INFO:   <<< init_model: None
2024-05-06 11:54:06,085:INFO:   <<< linear_patch: 2d
2024-05-06 11:54:06,085:INFO:   <<< local_rank: 0
2024-05-06 11:54:06,085:INFO:   <<< loose_type: True
2024-05-06 11:54:06,085:INFO:   <<< lr: 0.0001
2024-05-06 11:54:06,085:INFO:   <<< lr_decay: 0.9
2024-05-06 11:54:06,085:INFO:   <<< margin: 0.1
2024-05-06 11:54:06,086:INFO:   <<< max_frames: 90
2024-05-06 11:54:06,086:INFO:   <<< max_words: 32
2024-05-06 11:54:06,086:INFO:   <<< n_display: 100
2024-05-06 11:54:06,086:INFO:   <<< n_gpu: 1
2024-05-06 11:54:06,086:INFO:   <<< n_pair: 1
2024-05-06 11:54:06,086:INFO:   <<< negative_weighting: 1
2024-05-06 11:54:06,086:INFO:   <<< num_thread_reader: 0
2024-05-06 11:54:06,086:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:54:06,086:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:54:06,086:INFO:   <<< rank: 0
2024-05-06 11:54:06,086:INFO:   <<< resume_model: None
2024-05-06 11:54:06,086:INFO:   <<< sampled_use_mil: False
2024-05-06 11:54:06,086:INFO:   <<< seed: 42
2024-05-06 11:54:06,086:INFO:   <<< sim_header: meanP
2024-05-06 11:54:06,087:INFO:   <<< slice_framepos: 2
2024-05-06 11:54:06,087:INFO:   <<< task_type: retrieval
2024-05-06 11:54:06,087:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:54:06,087:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:54:06,087:INFO:   <<< train_frame_order: 0
2024-05-06 11:54:06,087:INFO:   <<< use_mil: False
2024-05-06 11:54:06,087:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:54:06,087:INFO:   <<< video_dim: 1024
2024-05-06 11:54:06,087:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:54:06,087:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:54:06,087:INFO:   <<< world_size: 1
2024-05-06 11:54:06,087:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:54:06,223:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:54:06,713:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:54:06,714:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:54:06,714:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:54:06,715:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:54:06,715:WARNING: Test retrieval by loose type.
2024-05-06 11:54:06,716:WARNING: 	 embed_dim: 512
2024-05-06 11:54:06,716:WARNING: 	 image_resolution: 224
2024-05-06 11:54:06,716:WARNING: 	 vision_layers: 12
2024-05-06 11:54:06,717:WARNING: 	 vision_width: 768
2024-05-06 11:54:06,717:WARNING: 	 vision_patch_size: 32
2024-05-06 11:54:06,717:WARNING: 	 context_length: 77
2024-05-06 11:54:06,717:WARNING: 	 vocab_size: 49408
2024-05-06 11:54:06,717:WARNING: 	 transformer_width: 512
2024-05-06 11:54:06,717:WARNING: 	 transformer_heads: 8
2024-05-06 11:54:06,717:WARNING: 	 transformer_layers: 12
2024-05-06 11:54:06,717:WARNING: 		 linear_patch: 2d
2024-05-06 11:54:06,717:WARNING: 	 cut_top_layer: 0
2024-05-06 11:54:07,593:WARNING: 	 sim_header: meanP
2024-05-06 11:54:11,343:INFO: --------------------
2024-05-06 11:54:11,343:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:55:05,373:INFO: Effective parameters:
2024-05-06 11:55:05,373:INFO:   <<< batch_size: 1
2024-05-06 11:55:05,373:INFO:   <<< batch_size_val: 16
2024-05-06 11:55:05,373:INFO:   <<< cache_dir: 
2024-05-06 11:55:05,373:INFO:   <<< coef_lr: 0.001
2024-05-06 11:55:05,373:INFO:   <<< cross_model: cross-base
2024-05-06 11:55:05,373:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:55:05,373:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:55:05,374:INFO:   <<< datatype: msrvtt
2024-05-06 11:55:05,374:INFO:   <<< do_eval: True
2024-05-06 11:55:05,374:INFO:   <<< do_lower_case: False
2024-05-06 11:55:05,374:INFO:   <<< do_pretrain: False
2024-05-06 11:55:05,374:INFO:   <<< do_train: False
2024-05-06 11:55:05,374:INFO:   <<< epochs: 2
2024-05-06 11:55:05,374:INFO:   <<< eval_frame_order: 0
2024-05-06 11:55:05,374:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:55:05,374:INFO:   <<< feature_framerate: 1
2024-05-06 11:55:05,374:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:55:05,374:INFO:   <<< fp16: False
2024-05-06 11:55:05,374:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:55:05,374:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:55:05,374:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:55:05,374:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:55:05,375:INFO:   <<< init_model: None
2024-05-06 11:55:05,375:INFO:   <<< linear_patch: 2d
2024-05-06 11:55:05,375:INFO:   <<< local_rank: 0
2024-05-06 11:55:05,375:INFO:   <<< loose_type: True
2024-05-06 11:55:05,375:INFO:   <<< lr: 0.0001
2024-05-06 11:55:05,375:INFO:   <<< lr_decay: 0.9
2024-05-06 11:55:05,375:INFO:   <<< margin: 0.1
2024-05-06 11:55:05,375:INFO:   <<< max_frames: 90
2024-05-06 11:55:05,375:INFO:   <<< max_words: 32
2024-05-06 11:55:05,375:INFO:   <<< n_display: 100
2024-05-06 11:55:05,375:INFO:   <<< n_gpu: 1
2024-05-06 11:55:05,375:INFO:   <<< n_pair: 1
2024-05-06 11:55:05,375:INFO:   <<< negative_weighting: 1
2024-05-06 11:55:05,375:INFO:   <<< num_thread_reader: 0
2024-05-06 11:55:05,375:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:55:05,376:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:55:05,376:INFO:   <<< rank: 0
2024-05-06 11:55:05,376:INFO:   <<< resume_model: None
2024-05-06 11:55:05,376:INFO:   <<< sampled_use_mil: False
2024-05-06 11:55:05,376:INFO:   <<< seed: 42
2024-05-06 11:55:05,376:INFO:   <<< sim_header: meanP
2024-05-06 11:55:05,376:INFO:   <<< slice_framepos: 2
2024-05-06 11:55:05,376:INFO:   <<< task_type: retrieval
2024-05-06 11:55:05,376:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:55:05,376:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:55:05,376:INFO:   <<< train_frame_order: 0
2024-05-06 11:55:05,376:INFO:   <<< use_mil: False
2024-05-06 11:55:05,376:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:55:05,376:INFO:   <<< video_dim: 1024
2024-05-06 11:55:05,376:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:55:05,377:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:55:05,377:INFO:   <<< world_size: 1
2024-05-06 11:55:05,377:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:55:05,523:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:55:06,001:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:55:06,002:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:55:06,002:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:55:06,002:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:55:06,002:WARNING: Test retrieval by loose type.
2024-05-06 11:55:06,003:WARNING: 	 embed_dim: 512
2024-05-06 11:55:06,003:WARNING: 	 image_resolution: 224
2024-05-06 11:55:06,003:WARNING: 	 vision_layers: 12
2024-05-06 11:55:06,003:WARNING: 	 vision_width: 768
2024-05-06 11:55:06,003:WARNING: 	 vision_patch_size: 32
2024-05-06 11:55:06,003:WARNING: 	 context_length: 77
2024-05-06 11:55:06,003:WARNING: 	 vocab_size: 49408
2024-05-06 11:55:06,003:WARNING: 	 transformer_width: 512
2024-05-06 11:55:06,003:WARNING: 	 transformer_heads: 8
2024-05-06 11:55:06,004:WARNING: 	 transformer_layers: 12
2024-05-06 11:55:06,004:WARNING: 		 linear_patch: 2d
2024-05-06 11:55:06,004:WARNING: 	 cut_top_layer: 0
2024-05-06 11:55:06,870:WARNING: 	 sim_header: meanP
2024-05-06 11:55:10,602:INFO: --------------------
2024-05-06 11:55:10,602:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:56:46,628:INFO: Effective parameters:
2024-05-06 11:56:46,628:INFO:   <<< batch_size: 1
2024-05-06 11:56:46,628:INFO:   <<< batch_size_val: 16
2024-05-06 11:56:46,628:INFO:   <<< cache_dir: 
2024-05-06 11:56:46,628:INFO:   <<< coef_lr: 0.001
2024-05-06 11:56:46,628:INFO:   <<< cross_model: cross-base
2024-05-06 11:56:46,628:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:56:46,629:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:56:46,629:INFO:   <<< datatype: msrvtt
2024-05-06 11:56:46,629:INFO:   <<< do_eval: True
2024-05-06 11:56:46,629:INFO:   <<< do_lower_case: False
2024-05-06 11:56:46,629:INFO:   <<< do_pretrain: False
2024-05-06 11:56:46,629:INFO:   <<< do_train: False
2024-05-06 11:56:46,629:INFO:   <<< epochs: 2
2024-05-06 11:56:46,629:INFO:   <<< eval_frame_order: 0
2024-05-06 11:56:46,629:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:56:46,629:INFO:   <<< feature_framerate: 1
2024-05-06 11:56:46,629:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:56:46,629:INFO:   <<< fp16: False
2024-05-06 11:56:46,629:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:56:46,629:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:56:46,629:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:56:46,629:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:56:46,629:INFO:   <<< init_model: None
2024-05-06 11:56:46,630:INFO:   <<< linear_patch: 2d
2024-05-06 11:56:46,630:INFO:   <<< local_rank: 0
2024-05-06 11:56:46,630:INFO:   <<< loose_type: True
2024-05-06 11:56:46,630:INFO:   <<< lr: 0.0001
2024-05-06 11:56:46,630:INFO:   <<< lr_decay: 0.9
2024-05-06 11:56:46,630:INFO:   <<< margin: 0.1
2024-05-06 11:56:46,630:INFO:   <<< max_frames: 90
2024-05-06 11:56:46,630:INFO:   <<< max_words: 32
2024-05-06 11:56:46,630:INFO:   <<< n_display: 100
2024-05-06 11:56:46,630:INFO:   <<< n_gpu: 1
2024-05-06 11:56:46,630:INFO:   <<< n_pair: 1
2024-05-06 11:56:46,630:INFO:   <<< negative_weighting: 1
2024-05-06 11:56:46,630:INFO:   <<< num_thread_reader: 0
2024-05-06 11:56:46,630:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:56:46,630:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:56:46,630:INFO:   <<< rank: 0
2024-05-06 11:56:46,630:INFO:   <<< resume_model: None
2024-05-06 11:56:46,631:INFO:   <<< sampled_use_mil: False
2024-05-06 11:56:46,631:INFO:   <<< seed: 42
2024-05-06 11:56:46,631:INFO:   <<< sim_header: meanP
2024-05-06 11:56:46,631:INFO:   <<< slice_framepos: 2
2024-05-06 11:56:46,631:INFO:   <<< task_type: retrieval
2024-05-06 11:56:46,631:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:56:46,631:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:56:46,631:INFO:   <<< train_frame_order: 0
2024-05-06 11:56:46,631:INFO:   <<< use_mil: False
2024-05-06 11:56:46,631:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:56:46,631:INFO:   <<< video_dim: 1024
2024-05-06 11:56:46,631:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:56:46,631:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:56:46,631:INFO:   <<< world_size: 1
2024-05-06 11:56:46,631:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:56:46,776:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:56:47,229:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:56:47,230:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:56:47,230:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:56:47,230:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:56:47,230:WARNING: Test retrieval by loose type.
2024-05-06 11:56:47,231:WARNING: 	 embed_dim: 512
2024-05-06 11:56:47,231:WARNING: 	 image_resolution: 224
2024-05-06 11:56:47,231:WARNING: 	 vision_layers: 12
2024-05-06 11:56:47,231:WARNING: 	 vision_width: 768
2024-05-06 11:56:47,231:WARNING: 	 vision_patch_size: 32
2024-05-06 11:56:47,231:WARNING: 	 context_length: 77
2024-05-06 11:56:47,231:WARNING: 	 vocab_size: 49408
2024-05-06 11:56:47,231:WARNING: 	 transformer_width: 512
2024-05-06 11:56:47,231:WARNING: 	 transformer_heads: 8
2024-05-06 11:56:47,231:WARNING: 	 transformer_layers: 12
2024-05-06 11:56:47,231:WARNING: 		 linear_patch: 2d
2024-05-06 11:56:47,231:WARNING: 	 cut_top_layer: 0
2024-05-06 11:56:48,104:WARNING: 	 sim_header: meanP
2024-05-06 11:56:51,858:INFO: --------------------
2024-05-06 11:56:51,858:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:57:40,726:INFO: Effective parameters:
2024-05-06 11:57:40,727:INFO:   <<< batch_size: 1
2024-05-06 11:57:40,727:INFO:   <<< batch_size_val: 16
2024-05-06 11:57:40,727:INFO:   <<< cache_dir: 
2024-05-06 11:57:40,727:INFO:   <<< coef_lr: 0.001
2024-05-06 11:57:40,727:INFO:   <<< cross_model: cross-base
2024-05-06 11:57:40,727:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:57:40,727:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:57:40,727:INFO:   <<< datatype: msrvtt
2024-05-06 11:57:40,727:INFO:   <<< do_eval: True
2024-05-06 11:57:40,727:INFO:   <<< do_lower_case: False
2024-05-06 11:57:40,727:INFO:   <<< do_pretrain: False
2024-05-06 11:57:40,728:INFO:   <<< do_train: False
2024-05-06 11:57:40,728:INFO:   <<< epochs: 2
2024-05-06 11:57:40,728:INFO:   <<< eval_frame_order: 0
2024-05-06 11:57:40,728:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:57:40,728:INFO:   <<< feature_framerate: 1
2024-05-06 11:57:40,728:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:57:40,728:INFO:   <<< fp16: False
2024-05-06 11:57:40,728:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:57:40,728:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:57:40,728:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:57:40,728:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:57:40,728:INFO:   <<< init_model: None
2024-05-06 11:57:40,728:INFO:   <<< linear_patch: 2d
2024-05-06 11:57:40,728:INFO:   <<< local_rank: 0
2024-05-06 11:57:40,729:INFO:   <<< loose_type: True
2024-05-06 11:57:40,729:INFO:   <<< lr: 0.0001
2024-05-06 11:57:40,729:INFO:   <<< lr_decay: 0.9
2024-05-06 11:57:40,729:INFO:   <<< margin: 0.1
2024-05-06 11:57:40,729:INFO:   <<< max_frames: 90
2024-05-06 11:57:40,729:INFO:   <<< max_words: 32
2024-05-06 11:57:40,729:INFO:   <<< n_display: 100
2024-05-06 11:57:40,729:INFO:   <<< n_gpu: 1
2024-05-06 11:57:40,729:INFO:   <<< n_pair: 1
2024-05-06 11:57:40,729:INFO:   <<< negative_weighting: 1
2024-05-06 11:57:40,729:INFO:   <<< num_thread_reader: 0
2024-05-06 11:57:40,729:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:57:40,729:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:57:40,729:INFO:   <<< rank: 0
2024-05-06 11:57:40,730:INFO:   <<< resume_model: None
2024-05-06 11:57:40,730:INFO:   <<< sampled_use_mil: False
2024-05-06 11:57:40,730:INFO:   <<< seed: 42
2024-05-06 11:57:40,730:INFO:   <<< sim_header: meanP
2024-05-06 11:57:40,730:INFO:   <<< slice_framepos: 2
2024-05-06 11:57:40,730:INFO:   <<< task_type: retrieval
2024-05-06 11:57:40,730:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:57:40,730:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:57:40,730:INFO:   <<< train_frame_order: 0
2024-05-06 11:57:40,730:INFO:   <<< use_mil: False
2024-05-06 11:57:40,730:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:57:40,730:INFO:   <<< video_dim: 1024
2024-05-06 11:57:40,730:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:57:40,730:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:57:40,731:INFO:   <<< world_size: 1
2024-05-06 11:57:40,731:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:57:40,877:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:57:41,338:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:57:41,339:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:57:41,339:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:57:41,339:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:57:41,339:WARNING: Test retrieval by loose type.
2024-05-06 11:57:41,340:WARNING: 	 embed_dim: 512
2024-05-06 11:57:41,340:WARNING: 	 image_resolution: 224
2024-05-06 11:57:41,340:WARNING: 	 vision_layers: 12
2024-05-06 11:57:41,340:WARNING: 	 vision_width: 768
2024-05-06 11:57:41,340:WARNING: 	 vision_patch_size: 32
2024-05-06 11:57:41,340:WARNING: 	 context_length: 77
2024-05-06 11:57:41,340:WARNING: 	 vocab_size: 49408
2024-05-06 11:57:41,340:WARNING: 	 transformer_width: 512
2024-05-06 11:57:41,341:WARNING: 	 transformer_heads: 8
2024-05-06 11:57:41,341:WARNING: 	 transformer_layers: 12
2024-05-06 11:57:41,341:WARNING: 		 linear_patch: 2d
2024-05-06 11:57:41,341:WARNING: 	 cut_top_layer: 0
2024-05-06 11:57:42,201:WARNING: 	 sim_header: meanP
2024-05-06 11:57:45,920:INFO: --------------------
2024-05-06 11:57:45,921:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 11:59:09,279:INFO: Effective parameters:
2024-05-06 11:59:09,279:INFO:   <<< batch_size: 1
2024-05-06 11:59:09,279:INFO:   <<< batch_size_val: 16
2024-05-06 11:59:09,279:INFO:   <<< cache_dir: 
2024-05-06 11:59:09,279:INFO:   <<< coef_lr: 0.001
2024-05-06 11:59:09,279:INFO:   <<< cross_model: cross-base
2024-05-06 11:59:09,279:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 11:59:09,280:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 11:59:09,280:INFO:   <<< datatype: msrvtt
2024-05-06 11:59:09,280:INFO:   <<< do_eval: True
2024-05-06 11:59:09,280:INFO:   <<< do_lower_case: False
2024-05-06 11:59:09,280:INFO:   <<< do_pretrain: False
2024-05-06 11:59:09,280:INFO:   <<< do_train: False
2024-05-06 11:59:09,280:INFO:   <<< epochs: 2
2024-05-06 11:59:09,280:INFO:   <<< eval_frame_order: 0
2024-05-06 11:59:09,280:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 11:59:09,280:INFO:   <<< feature_framerate: 1
2024-05-06 11:59:09,280:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 11:59:09,280:INFO:   <<< fp16: False
2024-05-06 11:59:09,280:INFO:   <<< fp16_opt_level: O1
2024-05-06 11:59:09,280:INFO:   <<< freeze_layer_num: 0
2024-05-06 11:59:09,280:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 11:59:09,281:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 11:59:09,281:INFO:   <<< init_model: None
2024-05-06 11:59:09,281:INFO:   <<< linear_patch: 2d
2024-05-06 11:59:09,281:INFO:   <<< local_rank: 0
2024-05-06 11:59:09,281:INFO:   <<< loose_type: True
2024-05-06 11:59:09,281:INFO:   <<< lr: 0.0001
2024-05-06 11:59:09,281:INFO:   <<< lr_decay: 0.9
2024-05-06 11:59:09,281:INFO:   <<< margin: 0.1
2024-05-06 11:59:09,281:INFO:   <<< max_frames: 90
2024-05-06 11:59:09,281:INFO:   <<< max_words: 32
2024-05-06 11:59:09,281:INFO:   <<< n_display: 100
2024-05-06 11:59:09,281:INFO:   <<< n_gpu: 1
2024-05-06 11:59:09,281:INFO:   <<< n_pair: 1
2024-05-06 11:59:09,281:INFO:   <<< negative_weighting: 1
2024-05-06 11:59:09,281:INFO:   <<< num_thread_reader: 0
2024-05-06 11:59:09,281:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 11:59:09,281:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 11:59:09,281:INFO:   <<< rank: 0
2024-05-06 11:59:09,282:INFO:   <<< resume_model: None
2024-05-06 11:59:09,282:INFO:   <<< sampled_use_mil: False
2024-05-06 11:59:09,282:INFO:   <<< seed: 42
2024-05-06 11:59:09,282:INFO:   <<< sim_header: meanP
2024-05-06 11:59:09,282:INFO:   <<< slice_framepos: 2
2024-05-06 11:59:09,282:INFO:   <<< task_type: retrieval
2024-05-06 11:59:09,282:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 11:59:09,282:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 11:59:09,282:INFO:   <<< train_frame_order: 0
2024-05-06 11:59:09,282:INFO:   <<< use_mil: False
2024-05-06 11:59:09,282:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 11:59:09,282:INFO:   <<< video_dim: 1024
2024-05-06 11:59:09,282:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 11:59:09,282:INFO:   <<< warmup_proportion: 0.1
2024-05-06 11:59:09,282:INFO:   <<< world_size: 1
2024-05-06 11:59:09,282:INFO: device: cuda:0 n_gpu: 1
2024-05-06 11:59:09,421:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 11:59:09,890:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 11:59:09,891:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 11:59:09,891:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 11:59:09,891:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 11:59:09,891:WARNING: Test retrieval by loose type.
2024-05-06 11:59:09,892:WARNING: 	 embed_dim: 512
2024-05-06 11:59:09,892:WARNING: 	 image_resolution: 224
2024-05-06 11:59:09,892:WARNING: 	 vision_layers: 12
2024-05-06 11:59:09,892:WARNING: 	 vision_width: 768
2024-05-06 11:59:09,892:WARNING: 	 vision_patch_size: 32
2024-05-06 11:59:09,892:WARNING: 	 context_length: 77
2024-05-06 11:59:09,893:WARNING: 	 vocab_size: 49408
2024-05-06 11:59:09,893:WARNING: 	 transformer_width: 512
2024-05-06 11:59:09,893:WARNING: 	 transformer_heads: 8
2024-05-06 11:59:09,893:WARNING: 	 transformer_layers: 12
2024-05-06 11:59:09,893:WARNING: 		 linear_patch: 2d
2024-05-06 11:59:09,893:WARNING: 	 cut_top_layer: 0
2024-05-06 11:59:10,761:WARNING: 	 sim_header: meanP
2024-05-06 11:59:14,456:INFO: --------------------
2024-05-06 11:59:14,457:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:00:44,561:INFO: Effective parameters:
2024-05-06 12:00:44,562:INFO:   <<< batch_size: 1
2024-05-06 12:00:44,562:INFO:   <<< batch_size_val: 16
2024-05-06 12:00:44,562:INFO:   <<< cache_dir: 
2024-05-06 12:00:44,562:INFO:   <<< coef_lr: 0.001
2024-05-06 12:00:44,562:INFO:   <<< cross_model: cross-base
2024-05-06 12:00:44,562:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:00:44,562:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:00:44,562:INFO:   <<< datatype: msrvtt
2024-05-06 12:00:44,562:INFO:   <<< do_eval: True
2024-05-06 12:00:44,562:INFO:   <<< do_lower_case: False
2024-05-06 12:00:44,562:INFO:   <<< do_pretrain: False
2024-05-06 12:00:44,562:INFO:   <<< do_train: False
2024-05-06 12:00:44,562:INFO:   <<< epochs: 2
2024-05-06 12:00:44,562:INFO:   <<< eval_frame_order: 0
2024-05-06 12:00:44,562:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:00:44,562:INFO:   <<< feature_framerate: 1
2024-05-06 12:00:44,563:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:00:44,563:INFO:   <<< fp16: False
2024-05-06 12:00:44,563:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:00:44,563:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:00:44,563:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:00:44,563:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:00:44,563:INFO:   <<< init_model: None
2024-05-06 12:00:44,563:INFO:   <<< linear_patch: 2d
2024-05-06 12:00:44,563:INFO:   <<< local_rank: 0
2024-05-06 12:00:44,563:INFO:   <<< loose_type: True
2024-05-06 12:00:44,563:INFO:   <<< lr: 0.0001
2024-05-06 12:00:44,563:INFO:   <<< lr_decay: 0.9
2024-05-06 12:00:44,563:INFO:   <<< margin: 0.1
2024-05-06 12:00:44,563:INFO:   <<< max_frames: 90
2024-05-06 12:00:44,563:INFO:   <<< max_words: 32
2024-05-06 12:00:44,563:INFO:   <<< n_display: 100
2024-05-06 12:00:44,563:INFO:   <<< n_gpu: 1
2024-05-06 12:00:44,564:INFO:   <<< n_pair: 1
2024-05-06 12:00:44,564:INFO:   <<< negative_weighting: 1
2024-05-06 12:00:44,564:INFO:   <<< num_thread_reader: 0
2024-05-06 12:00:44,564:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:00:44,564:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:00:44,564:INFO:   <<< rank: 0
2024-05-06 12:00:44,564:INFO:   <<< resume_model: None
2024-05-06 12:00:44,564:INFO:   <<< sampled_use_mil: False
2024-05-06 12:00:44,564:INFO:   <<< seed: 42
2024-05-06 12:00:44,564:INFO:   <<< sim_header: meanP
2024-05-06 12:00:44,564:INFO:   <<< slice_framepos: 2
2024-05-06 12:00:44,564:INFO:   <<< task_type: retrieval
2024-05-06 12:00:44,564:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:00:44,564:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:00:44,564:INFO:   <<< train_frame_order: 0
2024-05-06 12:00:44,564:INFO:   <<< use_mil: False
2024-05-06 12:00:44,564:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:00:44,565:INFO:   <<< video_dim: 1024
2024-05-06 12:00:44,565:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:00:44,565:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:00:44,565:INFO:   <<< world_size: 1
2024-05-06 12:00:44,565:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:00:44,705:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:00:45,193:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:00:45,194:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:00:45,194:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:00:45,195:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:00:45,195:WARNING: Test retrieval by loose type.
2024-05-06 12:00:45,196:WARNING: 	 embed_dim: 512
2024-05-06 12:00:45,196:WARNING: 	 image_resolution: 224
2024-05-06 12:00:45,196:WARNING: 	 vision_layers: 12
2024-05-06 12:00:45,196:WARNING: 	 vision_width: 768
2024-05-06 12:00:45,197:WARNING: 	 vision_patch_size: 32
2024-05-06 12:00:45,197:WARNING: 	 context_length: 77
2024-05-06 12:00:45,197:WARNING: 	 vocab_size: 49408
2024-05-06 12:00:45,197:WARNING: 	 transformer_width: 512
2024-05-06 12:00:45,197:WARNING: 	 transformer_heads: 8
2024-05-06 12:00:45,197:WARNING: 	 transformer_layers: 12
2024-05-06 12:00:45,197:WARNING: 		 linear_patch: 2d
2024-05-06 12:00:45,197:WARNING: 	 cut_top_layer: 0
2024-05-06 12:00:46,066:WARNING: 	 sim_header: meanP
2024-05-06 12:00:49,757:INFO: --------------------
2024-05-06 12:00:49,757:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:04:28,810:INFO: Effective parameters:
2024-05-06 12:04:28,810:INFO:   <<< batch_size: 1
2024-05-06 12:04:28,810:INFO:   <<< batch_size_val: 16
2024-05-06 12:04:28,810:INFO:   <<< cache_dir: 
2024-05-06 12:04:28,810:INFO:   <<< coef_lr: 0.001
2024-05-06 12:04:28,811:INFO:   <<< cross_model: cross-base
2024-05-06 12:04:28,811:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:04:28,811:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:04:28,811:INFO:   <<< datatype: msrvtt
2024-05-06 12:04:28,811:INFO:   <<< do_eval: True
2024-05-06 12:04:28,811:INFO:   <<< do_lower_case: False
2024-05-06 12:04:28,811:INFO:   <<< do_pretrain: False
2024-05-06 12:04:28,811:INFO:   <<< do_train: False
2024-05-06 12:04:28,811:INFO:   <<< epochs: 2
2024-05-06 12:04:28,811:INFO:   <<< eval_frame_order: 0
2024-05-06 12:04:28,811:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:04:28,811:INFO:   <<< feature_framerate: 1
2024-05-06 12:04:28,811:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:04:28,811:INFO:   <<< fp16: False
2024-05-06 12:04:28,811:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:04:28,811:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:04:28,811:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:04:28,812:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:04:28,812:INFO:   <<< init_model: None
2024-05-06 12:04:28,812:INFO:   <<< linear_patch: 2d
2024-05-06 12:04:28,812:INFO:   <<< local_rank: 0
2024-05-06 12:04:28,812:INFO:   <<< loose_type: True
2024-05-06 12:04:28,812:INFO:   <<< lr: 0.0001
2024-05-06 12:04:28,812:INFO:   <<< lr_decay: 0.9
2024-05-06 12:04:28,812:INFO:   <<< margin: 0.1
2024-05-06 12:04:28,812:INFO:   <<< max_frames: 90
2024-05-06 12:04:28,812:INFO:   <<< max_words: 32
2024-05-06 12:04:28,812:INFO:   <<< n_display: 100
2024-05-06 12:04:28,812:INFO:   <<< n_gpu: 1
2024-05-06 12:04:28,812:INFO:   <<< n_pair: 1
2024-05-06 12:04:28,812:INFO:   <<< negative_weighting: 1
2024-05-06 12:04:28,812:INFO:   <<< num_thread_reader: 0
2024-05-06 12:04:28,812:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:04:28,813:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:04:28,813:INFO:   <<< rank: 0
2024-05-06 12:04:28,813:INFO:   <<< resume_model: None
2024-05-06 12:04:28,813:INFO:   <<< sampled_use_mil: False
2024-05-06 12:04:28,813:INFO:   <<< seed: 42
2024-05-06 12:04:28,813:INFO:   <<< sim_header: meanP
2024-05-06 12:04:28,813:INFO:   <<< slice_framepos: 2
2024-05-06 12:04:28,813:INFO:   <<< task_type: retrieval
2024-05-06 12:04:28,813:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:04:28,813:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:04:28,813:INFO:   <<< train_frame_order: 0
2024-05-06 12:04:28,813:INFO:   <<< use_mil: False
2024-05-06 12:04:28,813:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:04:28,813:INFO:   <<< video_dim: 1024
2024-05-06 12:04:28,813:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:04:28,813:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:04:28,813:INFO:   <<< world_size: 1
2024-05-06 12:04:28,814:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:04:28,952:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:04:29,413:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:04:29,414:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:04:29,414:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:04:29,414:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:04:29,414:WARNING: Test retrieval by loose type.
2024-05-06 12:04:29,415:WARNING: 	 embed_dim: 512
2024-05-06 12:04:29,415:WARNING: 	 image_resolution: 224
2024-05-06 12:04:29,415:WARNING: 	 vision_layers: 12
2024-05-06 12:04:29,415:WARNING: 	 vision_width: 768
2024-05-06 12:04:29,415:WARNING: 	 vision_patch_size: 32
2024-05-06 12:04:29,415:WARNING: 	 context_length: 77
2024-05-06 12:04:29,415:WARNING: 	 vocab_size: 49408
2024-05-06 12:04:29,415:WARNING: 	 transformer_width: 512
2024-05-06 12:04:29,416:WARNING: 	 transformer_heads: 8
2024-05-06 12:04:29,416:WARNING: 	 transformer_layers: 12
2024-05-06 12:04:29,416:WARNING: 		 linear_patch: 2d
2024-05-06 12:04:29,416:WARNING: 	 cut_top_layer: 0
2024-05-06 12:04:30,291:WARNING: 	 sim_header: meanP
2024-05-06 12:04:34,027:INFO: --------------------
2024-05-06 12:04:34,027:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:05:13,240:INFO: Effective parameters:
2024-05-06 12:05:13,240:INFO:   <<< batch_size: 1
2024-05-06 12:05:13,241:INFO:   <<< batch_size_val: 16
2024-05-06 12:05:13,241:INFO:   <<< cache_dir: 
2024-05-06 12:05:13,241:INFO:   <<< coef_lr: 0.001
2024-05-06 12:05:13,241:INFO:   <<< cross_model: cross-base
2024-05-06 12:05:13,241:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:05:13,241:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:05:13,241:INFO:   <<< datatype: msrvtt
2024-05-06 12:05:13,241:INFO:   <<< do_eval: True
2024-05-06 12:05:13,241:INFO:   <<< do_lower_case: False
2024-05-06 12:05:13,241:INFO:   <<< do_pretrain: False
2024-05-06 12:05:13,241:INFO:   <<< do_train: False
2024-05-06 12:05:13,241:INFO:   <<< epochs: 2
2024-05-06 12:05:13,241:INFO:   <<< eval_frame_order: 0
2024-05-06 12:05:13,242:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:05:13,242:INFO:   <<< feature_framerate: 1
2024-05-06 12:05:13,242:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:05:13,242:INFO:   <<< fp16: False
2024-05-06 12:05:13,242:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:05:13,242:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:05:13,242:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:05:13,242:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:05:13,242:INFO:   <<< init_model: None
2024-05-06 12:05:13,242:INFO:   <<< linear_patch: 2d
2024-05-06 12:05:13,242:INFO:   <<< local_rank: 0
2024-05-06 12:05:13,242:INFO:   <<< loose_type: True
2024-05-06 12:05:13,242:INFO:   <<< lr: 0.0001
2024-05-06 12:05:13,242:INFO:   <<< lr_decay: 0.9
2024-05-06 12:05:13,243:INFO:   <<< margin: 0.1
2024-05-06 12:05:13,243:INFO:   <<< max_frames: 90
2024-05-06 12:05:13,243:INFO:   <<< max_words: 32
2024-05-06 12:05:13,243:INFO:   <<< n_display: 100
2024-05-06 12:05:13,243:INFO:   <<< n_gpu: 1
2024-05-06 12:05:13,243:INFO:   <<< n_pair: 1
2024-05-06 12:05:13,243:INFO:   <<< negative_weighting: 1
2024-05-06 12:05:13,243:INFO:   <<< num_thread_reader: 0
2024-05-06 12:05:13,243:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:05:13,243:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:05:13,243:INFO:   <<< rank: 0
2024-05-06 12:05:13,243:INFO:   <<< resume_model: None
2024-05-06 12:05:13,243:INFO:   <<< sampled_use_mil: False
2024-05-06 12:05:13,243:INFO:   <<< seed: 42
2024-05-06 12:05:13,243:INFO:   <<< sim_header: meanP
2024-05-06 12:05:13,243:INFO:   <<< slice_framepos: 2
2024-05-06 12:05:13,243:INFO:   <<< task_type: retrieval
2024-05-06 12:05:13,244:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:05:13,244:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:05:13,244:INFO:   <<< train_frame_order: 0
2024-05-06 12:05:13,244:INFO:   <<< use_mil: False
2024-05-06 12:05:13,244:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:05:13,244:INFO:   <<< video_dim: 1024
2024-05-06 12:05:13,244:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:05:13,244:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:05:13,244:INFO:   <<< world_size: 1
2024-05-06 12:05:13,244:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:05:13,387:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:05:13,877:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:05:13,878:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:05:13,878:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:05:13,879:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:05:13,879:WARNING: Test retrieval by loose type.
2024-05-06 12:05:13,880:WARNING: 	 embed_dim: 512
2024-05-06 12:05:13,880:WARNING: 	 image_resolution: 224
2024-05-06 12:05:13,880:WARNING: 	 vision_layers: 12
2024-05-06 12:05:13,880:WARNING: 	 vision_width: 768
2024-05-06 12:05:13,881:WARNING: 	 vision_patch_size: 32
2024-05-06 12:05:13,881:WARNING: 	 context_length: 77
2024-05-06 12:05:13,881:WARNING: 	 vocab_size: 49408
2024-05-06 12:05:13,881:WARNING: 	 transformer_width: 512
2024-05-06 12:05:13,881:WARNING: 	 transformer_heads: 8
2024-05-06 12:05:13,881:WARNING: 	 transformer_layers: 12
2024-05-06 12:05:13,881:WARNING: 		 linear_patch: 2d
2024-05-06 12:05:13,881:WARNING: 	 cut_top_layer: 0
2024-05-06 12:05:14,756:WARNING: 	 sim_header: meanP
2024-05-06 12:05:18,476:INFO: --------------------
2024-05-06 12:05:18,476:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:12:00,618:INFO: Effective parameters:
2024-05-06 12:12:00,618:INFO:   <<< batch_size: 1
2024-05-06 12:12:00,618:INFO:   <<< batch_size_val: 16
2024-05-06 12:12:00,618:INFO:   <<< cache_dir: 
2024-05-06 12:12:00,618:INFO:   <<< coef_lr: 0.001
2024-05-06 12:12:00,618:INFO:   <<< cross_model: cross-base
2024-05-06 12:12:00,618:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:12:00,618:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:12:00,618:INFO:   <<< datatype: msrvtt
2024-05-06 12:12:00,618:INFO:   <<< do_eval: True
2024-05-06 12:12:00,618:INFO:   <<< do_lower_case: False
2024-05-06 12:12:00,618:INFO:   <<< do_pretrain: False
2024-05-06 12:12:00,618:INFO:   <<< do_train: False
2024-05-06 12:12:00,618:INFO:   <<< epochs: 2
2024-05-06 12:12:00,618:INFO:   <<< eval_frame_order: 0
2024-05-06 12:12:00,618:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:12:00,618:INFO:   <<< feature_framerate: 1
2024-05-06 12:12:00,618:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:12:00,618:INFO:   <<< fp16: False
2024-05-06 12:12:00,618:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:12:00,618:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:12:00,618:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:12:00,618:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:12:00,618:INFO:   <<< init_model: None
2024-05-06 12:12:00,618:INFO:   <<< linear_patch: 2d
2024-05-06 12:12:00,618:INFO:   <<< local_rank: 0
2024-05-06 12:12:00,618:INFO:   <<< loose_type: True
2024-05-06 12:12:00,618:INFO:   <<< lr: 0.0001
2024-05-06 12:12:00,618:INFO:   <<< lr_decay: 0.9
2024-05-06 12:12:00,618:INFO:   <<< margin: 0.1
2024-05-06 12:12:00,618:INFO:   <<< max_frames: 90
2024-05-06 12:12:00,618:INFO:   <<< max_words: 32
2024-05-06 12:12:00,618:INFO:   <<< n_display: 100
2024-05-06 12:12:00,618:INFO:   <<< n_gpu: 1
2024-05-06 12:12:00,618:INFO:   <<< n_pair: 1
2024-05-06 12:12:00,618:INFO:   <<< negative_weighting: 1
2024-05-06 12:12:00,618:INFO:   <<< num_thread_reader: 0
2024-05-06 12:12:00,618:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:12:00,618:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:12:00,618:INFO:   <<< rank: 0
2024-05-06 12:12:00,618:INFO:   <<< resume_model: None
2024-05-06 12:12:00,618:INFO:   <<< sampled_use_mil: False
2024-05-06 12:12:00,618:INFO:   <<< seed: 42
2024-05-06 12:12:00,618:INFO:   <<< sim_header: meanP
2024-05-06 12:12:00,618:INFO:   <<< slice_framepos: 2
2024-05-06 12:12:00,618:INFO:   <<< task_type: retrieval
2024-05-06 12:12:00,618:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:12:00,618:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:12:00,618:INFO:   <<< train_frame_order: 0
2024-05-06 12:12:00,619:INFO:   <<< use_mil: False
2024-05-06 12:12:00,619:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:12:00,619:INFO:   <<< video_dim: 1024
2024-05-06 12:12:00,619:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:12:00,619:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:12:00,619:INFO:   <<< world_size: 1
2024-05-06 12:12:00,619:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:12:00,763:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:12:01,201:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:12:01,202:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:12:01,202:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:12:01,202:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:12:01,202:WARNING: Test retrieval by loose type.
2024-05-06 12:12:01,202:WARNING: 	 embed_dim: 512
2024-05-06 12:12:01,202:WARNING: 	 image_resolution: 224
2024-05-06 12:12:01,202:WARNING: 	 vision_layers: 12
2024-05-06 12:12:01,202:WARNING: 	 vision_width: 768
2024-05-06 12:12:01,202:WARNING: 	 vision_patch_size: 32
2024-05-06 12:12:01,202:WARNING: 	 context_length: 77
2024-05-06 12:12:01,202:WARNING: 	 vocab_size: 49408
2024-05-06 12:12:01,202:WARNING: 	 transformer_width: 512
2024-05-06 12:12:01,202:WARNING: 	 transformer_heads: 8
2024-05-06 12:12:01,202:WARNING: 	 transformer_layers: 12
2024-05-06 12:12:01,202:WARNING: 		 linear_patch: 2d
2024-05-06 12:12:01,202:WARNING: 	 cut_top_layer: 0
2024-05-06 12:12:02,043:WARNING: 	 sim_header: meanP
2024-05-06 12:12:05,763:INFO: --------------------
2024-05-06 12:12:05,763:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:12:28,868:INFO: Effective parameters:
2024-05-06 12:12:28,868:INFO:   <<< batch_size: 1
2024-05-06 12:12:28,868:INFO:   <<< batch_size_val: 16
2024-05-06 12:12:28,868:INFO:   <<< cache_dir: 
2024-05-06 12:12:28,868:INFO:   <<< coef_lr: 0.001
2024-05-06 12:12:28,868:INFO:   <<< cross_model: cross-base
2024-05-06 12:12:28,868:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:12:28,868:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:12:28,868:INFO:   <<< datatype: msrvtt
2024-05-06 12:12:28,868:INFO:   <<< do_eval: True
2024-05-06 12:12:28,868:INFO:   <<< do_lower_case: False
2024-05-06 12:12:28,868:INFO:   <<< do_pretrain: False
2024-05-06 12:12:28,869:INFO:   <<< do_train: False
2024-05-06 12:12:28,869:INFO:   <<< epochs: 2
2024-05-06 12:12:28,869:INFO:   <<< eval_frame_order: 0
2024-05-06 12:12:28,869:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:12:28,869:INFO:   <<< feature_framerate: 1
2024-05-06 12:12:28,869:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:12:28,869:INFO:   <<< fp16: False
2024-05-06 12:12:28,869:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:12:28,869:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:12:28,869:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:12:28,869:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:12:28,869:INFO:   <<< init_model: None
2024-05-06 12:12:28,869:INFO:   <<< linear_patch: 2d
2024-05-06 12:12:28,869:INFO:   <<< local_rank: 0
2024-05-06 12:12:28,869:INFO:   <<< loose_type: True
2024-05-06 12:12:28,869:INFO:   <<< lr: 0.0001
2024-05-06 12:12:28,869:INFO:   <<< lr_decay: 0.9
2024-05-06 12:12:28,869:INFO:   <<< margin: 0.1
2024-05-06 12:12:28,869:INFO:   <<< max_frames: 90
2024-05-06 12:12:28,869:INFO:   <<< max_words: 32
2024-05-06 12:12:28,869:INFO:   <<< n_display: 100
2024-05-06 12:12:28,869:INFO:   <<< n_gpu: 1
2024-05-06 12:12:28,869:INFO:   <<< n_pair: 1
2024-05-06 12:12:28,869:INFO:   <<< negative_weighting: 1
2024-05-06 12:12:28,869:INFO:   <<< num_thread_reader: 0
2024-05-06 12:12:28,869:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:12:28,869:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:12:28,869:INFO:   <<< rank: 0
2024-05-06 12:12:28,869:INFO:   <<< resume_model: None
2024-05-06 12:12:28,869:INFO:   <<< sampled_use_mil: False
2024-05-06 12:12:28,869:INFO:   <<< seed: 42
2024-05-06 12:12:28,869:INFO:   <<< sim_header: meanP
2024-05-06 12:12:28,869:INFO:   <<< slice_framepos: 2
2024-05-06 12:12:28,869:INFO:   <<< task_type: retrieval
2024-05-06 12:12:28,869:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:12:28,869:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:12:28,869:INFO:   <<< train_frame_order: 0
2024-05-06 12:12:28,869:INFO:   <<< use_mil: False
2024-05-06 12:12:28,869:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:12:28,869:INFO:   <<< video_dim: 1024
2024-05-06 12:12:28,869:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:12:28,869:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:12:28,869:INFO:   <<< world_size: 1
2024-05-06 12:12:28,869:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:12:29,014:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:12:29,469:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:12:29,469:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:12:29,469:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:12:29,469:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:12:29,469:WARNING: Test retrieval by loose type.
2024-05-06 12:12:29,469:WARNING: 	 embed_dim: 512
2024-05-06 12:12:29,469:WARNING: 	 image_resolution: 224
2024-05-06 12:12:29,470:WARNING: 	 vision_layers: 12
2024-05-06 12:12:29,470:WARNING: 	 vision_width: 768
2024-05-06 12:12:29,470:WARNING: 	 vision_patch_size: 32
2024-05-06 12:12:29,470:WARNING: 	 context_length: 77
2024-05-06 12:12:29,470:WARNING: 	 vocab_size: 49408
2024-05-06 12:12:29,470:WARNING: 	 transformer_width: 512
2024-05-06 12:12:29,470:WARNING: 	 transformer_heads: 8
2024-05-06 12:12:29,470:WARNING: 	 transformer_layers: 12
2024-05-06 12:12:29,470:WARNING: 		 linear_patch: 2d
2024-05-06 12:12:29,470:WARNING: 	 cut_top_layer: 0
2024-05-06 12:12:30,331:WARNING: 	 sim_header: meanP
2024-05-06 12:12:34,050:INFO: --------------------
2024-05-06 12:12:34,050:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:15:19,276:INFO: Effective parameters:
2024-05-06 12:15:19,276:INFO:   <<< batch_size: 1
2024-05-06 12:15:19,276:INFO:   <<< batch_size_val: 16
2024-05-06 12:15:19,276:INFO:   <<< cache_dir: 
2024-05-06 12:15:19,276:INFO:   <<< coef_lr: 0.001
2024-05-06 12:15:19,276:INFO:   <<< cross_model: cross-base
2024-05-06 12:15:19,276:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:15:19,276:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:15:19,276:INFO:   <<< datatype: msrvtt
2024-05-06 12:15:19,276:INFO:   <<< do_eval: True
2024-05-06 12:15:19,276:INFO:   <<< do_lower_case: False
2024-05-06 12:15:19,276:INFO:   <<< do_pretrain: False
2024-05-06 12:15:19,276:INFO:   <<< do_train: False
2024-05-06 12:15:19,276:INFO:   <<< epochs: 2
2024-05-06 12:15:19,276:INFO:   <<< eval_frame_order: 0
2024-05-06 12:15:19,276:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:15:19,276:INFO:   <<< feature_framerate: 1
2024-05-06 12:15:19,277:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:15:19,277:INFO:   <<< fp16: False
2024-05-06 12:15:19,277:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:15:19,277:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:15:19,277:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:15:19,277:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:15:19,277:INFO:   <<< init_model: None
2024-05-06 12:15:19,277:INFO:   <<< linear_patch: 2d
2024-05-06 12:15:19,277:INFO:   <<< local_rank: 0
2024-05-06 12:15:19,277:INFO:   <<< loose_type: True
2024-05-06 12:15:19,277:INFO:   <<< lr: 0.0001
2024-05-06 12:15:19,277:INFO:   <<< lr_decay: 0.9
2024-05-06 12:15:19,277:INFO:   <<< margin: 0.1
2024-05-06 12:15:19,277:INFO:   <<< max_frames: 90
2024-05-06 12:15:19,277:INFO:   <<< max_words: 32
2024-05-06 12:15:19,277:INFO:   <<< n_display: 100
2024-05-06 12:15:19,277:INFO:   <<< n_gpu: 1
2024-05-06 12:15:19,277:INFO:   <<< n_pair: 1
2024-05-06 12:15:19,277:INFO:   <<< negative_weighting: 1
2024-05-06 12:15:19,277:INFO:   <<< num_thread_reader: 0
2024-05-06 12:15:19,277:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:15:19,277:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:15:19,277:INFO:   <<< rank: 0
2024-05-06 12:15:19,277:INFO:   <<< resume_model: None
2024-05-06 12:15:19,277:INFO:   <<< sampled_use_mil: False
2024-05-06 12:15:19,277:INFO:   <<< seed: 42
2024-05-06 12:15:19,277:INFO:   <<< sim_header: meanP
2024-05-06 12:15:19,277:INFO:   <<< slice_framepos: 2
2024-05-06 12:15:19,277:INFO:   <<< task_type: retrieval
2024-05-06 12:15:19,277:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:15:19,277:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:15:19,277:INFO:   <<< train_frame_order: 0
2024-05-06 12:15:19,277:INFO:   <<< use_mil: False
2024-05-06 12:15:19,277:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:15:19,277:INFO:   <<< video_dim: 1024
2024-05-06 12:15:19,277:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:15:19,277:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:15:19,277:INFO:   <<< world_size: 1
2024-05-06 12:15:19,277:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:15:19,410:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:15:19,863:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:15:19,863:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:15:19,863:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:15:19,863:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:15:19,863:WARNING: Test retrieval by loose type.
2024-05-06 12:15:19,863:WARNING: 	 embed_dim: 512
2024-05-06 12:15:19,863:WARNING: 	 image_resolution: 224
2024-05-06 12:15:19,863:WARNING: 	 vision_layers: 12
2024-05-06 12:15:19,863:WARNING: 	 vision_width: 768
2024-05-06 12:15:19,863:WARNING: 	 vision_patch_size: 32
2024-05-06 12:15:19,863:WARNING: 	 context_length: 77
2024-05-06 12:15:19,863:WARNING: 	 vocab_size: 49408
2024-05-06 12:15:19,863:WARNING: 	 transformer_width: 512
2024-05-06 12:15:19,863:WARNING: 	 transformer_heads: 8
2024-05-06 12:15:19,863:WARNING: 	 transformer_layers: 12
2024-05-06 12:15:19,863:WARNING: 		 linear_patch: 2d
2024-05-06 12:15:19,863:WARNING: 	 cut_top_layer: 0
2024-05-06 12:15:20,697:WARNING: 	 sim_header: meanP
2024-05-06 12:15:24,380:INFO: --------------------
2024-05-06 12:15:24,380:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:16:14,956:INFO: Effective parameters:
2024-05-06 12:16:14,956:INFO:   <<< batch_size: 1
2024-05-06 12:16:14,956:INFO:   <<< batch_size_val: 16
2024-05-06 12:16:14,956:INFO:   <<< cache_dir: 
2024-05-06 12:16:14,956:INFO:   <<< coef_lr: 0.001
2024-05-06 12:16:14,956:INFO:   <<< cross_model: cross-base
2024-05-06 12:16:14,956:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:16:14,957:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:16:14,957:INFO:   <<< datatype: msrvtt
2024-05-06 12:16:14,957:INFO:   <<< do_eval: True
2024-05-06 12:16:14,957:INFO:   <<< do_lower_case: False
2024-05-06 12:16:14,957:INFO:   <<< do_pretrain: False
2024-05-06 12:16:14,957:INFO:   <<< do_train: False
2024-05-06 12:16:14,957:INFO:   <<< epochs: 2
2024-05-06 12:16:14,957:INFO:   <<< eval_frame_order: 0
2024-05-06 12:16:14,957:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:16:14,957:INFO:   <<< feature_framerate: 1
2024-05-06 12:16:14,957:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:16:14,957:INFO:   <<< fp16: False
2024-05-06 12:16:14,957:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:16:14,957:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:16:14,958:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:16:14,958:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:16:14,958:INFO:   <<< init_model: None
2024-05-06 12:16:14,958:INFO:   <<< linear_patch: 2d
2024-05-06 12:16:14,958:INFO:   <<< local_rank: 0
2024-05-06 12:16:14,958:INFO:   <<< loose_type: True
2024-05-06 12:16:14,958:INFO:   <<< lr: 0.0001
2024-05-06 12:16:14,958:INFO:   <<< lr_decay: 0.9
2024-05-06 12:16:14,958:INFO:   <<< margin: 0.1
2024-05-06 12:16:14,958:INFO:   <<< max_frames: 90
2024-05-06 12:16:14,958:INFO:   <<< max_words: 32
2024-05-06 12:16:14,958:INFO:   <<< n_display: 100
2024-05-06 12:16:14,958:INFO:   <<< n_gpu: 1
2024-05-06 12:16:14,958:INFO:   <<< n_pair: 1
2024-05-06 12:16:14,958:INFO:   <<< negative_weighting: 1
2024-05-06 12:16:14,959:INFO:   <<< num_thread_reader: 0
2024-05-06 12:16:14,959:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:16:14,959:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:16:14,959:INFO:   <<< rank: 0
2024-05-06 12:16:14,959:INFO:   <<< resume_model: None
2024-05-06 12:16:14,959:INFO:   <<< sampled_use_mil: False
2024-05-06 12:16:14,959:INFO:   <<< seed: 42
2024-05-06 12:16:14,959:INFO:   <<< sim_header: meanP
2024-05-06 12:16:14,959:INFO:   <<< slice_framepos: 2
2024-05-06 12:16:14,959:INFO:   <<< task_type: retrieval
2024-05-06 12:16:14,959:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:16:14,959:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:16:14,959:INFO:   <<< train_frame_order: 0
2024-05-06 12:16:14,959:INFO:   <<< use_mil: False
2024-05-06 12:16:14,959:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:16:14,959:INFO:   <<< video_dim: 1024
2024-05-06 12:16:14,959:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:16:14,960:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:16:14,960:INFO:   <<< world_size: 1
2024-05-06 12:16:14,960:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:16:15,105:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:16:15,589:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:16:15,590:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:16:15,590:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:16:15,591:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:16:15,591:WARNING: Test retrieval by loose type.
2024-05-06 12:16:15,592:WARNING: 	 embed_dim: 512
2024-05-06 12:16:15,592:WARNING: 	 image_resolution: 224
2024-05-06 12:16:15,592:WARNING: 	 vision_layers: 12
2024-05-06 12:16:15,592:WARNING: 	 vision_width: 768
2024-05-06 12:16:15,593:WARNING: 	 vision_patch_size: 32
2024-05-06 12:16:15,593:WARNING: 	 context_length: 77
2024-05-06 12:16:15,593:WARNING: 	 vocab_size: 49408
2024-05-06 12:16:15,593:WARNING: 	 transformer_width: 512
2024-05-06 12:16:15,593:WARNING: 	 transformer_heads: 8
2024-05-06 12:16:15,593:WARNING: 	 transformer_layers: 12
2024-05-06 12:16:15,593:WARNING: 		 linear_patch: 2d
2024-05-06 12:16:15,593:WARNING: 	 cut_top_layer: 0
2024-05-06 12:16:16,462:WARNING: 	 sim_header: meanP
2024-05-06 12:16:20,161:INFO: --------------------
2024-05-06 12:16:20,161:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:17:21,103:INFO: Effective parameters:
2024-05-06 12:17:21,104:INFO:   <<< batch_size: 1
2024-05-06 12:17:21,104:INFO:   <<< batch_size_val: 16
2024-05-06 12:17:21,104:INFO:   <<< cache_dir: 
2024-05-06 12:17:21,104:INFO:   <<< coef_lr: 0.001
2024-05-06 12:17:21,104:INFO:   <<< cross_model: cross-base
2024-05-06 12:17:21,104:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:17:21,104:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:17:21,104:INFO:   <<< datatype: msrvtt
2024-05-06 12:17:21,104:INFO:   <<< do_eval: True
2024-05-06 12:17:21,104:INFO:   <<< do_lower_case: False
2024-05-06 12:17:21,104:INFO:   <<< do_pretrain: False
2024-05-06 12:17:21,104:INFO:   <<< do_train: False
2024-05-06 12:17:21,104:INFO:   <<< epochs: 2
2024-05-06 12:17:21,104:INFO:   <<< eval_frame_order: 0
2024-05-06 12:17:21,104:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:17:21,105:INFO:   <<< feature_framerate: 1
2024-05-06 12:17:21,105:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:17:21,105:INFO:   <<< fp16: False
2024-05-06 12:17:21,105:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:17:21,105:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:17:21,105:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:17:21,105:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:17:21,105:INFO:   <<< init_model: None
2024-05-06 12:17:21,105:INFO:   <<< linear_patch: 2d
2024-05-06 12:17:21,105:INFO:   <<< local_rank: 0
2024-05-06 12:17:21,105:INFO:   <<< loose_type: True
2024-05-06 12:17:21,105:INFO:   <<< lr: 0.0001
2024-05-06 12:17:21,105:INFO:   <<< lr_decay: 0.9
2024-05-06 12:17:21,105:INFO:   <<< margin: 0.1
2024-05-06 12:17:21,105:INFO:   <<< max_frames: 90
2024-05-06 12:17:21,105:INFO:   <<< max_words: 32
2024-05-06 12:17:21,105:INFO:   <<< n_display: 100
2024-05-06 12:17:21,106:INFO:   <<< n_gpu: 1
2024-05-06 12:17:21,106:INFO:   <<< n_pair: 1
2024-05-06 12:17:21,106:INFO:   <<< negative_weighting: 1
2024-05-06 12:17:21,106:INFO:   <<< num_thread_reader: 0
2024-05-06 12:17:21,106:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:17:21,106:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:17:21,106:INFO:   <<< rank: 0
2024-05-06 12:17:21,106:INFO:   <<< resume_model: None
2024-05-06 12:17:21,106:INFO:   <<< sampled_use_mil: False
2024-05-06 12:17:21,106:INFO:   <<< seed: 42
2024-05-06 12:17:21,106:INFO:   <<< sim_header: meanP
2024-05-06 12:17:21,106:INFO:   <<< slice_framepos: 2
2024-05-06 12:17:21,106:INFO:   <<< task_type: retrieval
2024-05-06 12:17:21,106:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:17:21,106:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:17:21,106:INFO:   <<< train_frame_order: 0
2024-05-06 12:17:21,106:INFO:   <<< use_mil: False
2024-05-06 12:17:21,107:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:17:21,107:INFO:   <<< video_dim: 1024
2024-05-06 12:17:21,107:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:17:21,107:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:17:21,107:INFO:   <<< world_size: 1
2024-05-06 12:17:21,107:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:17:21,256:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:17:21,737:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:17:21,738:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:17:21,738:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:17:21,738:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:17:21,738:WARNING: Test retrieval by loose type.
2024-05-06 12:17:21,739:WARNING: 	 embed_dim: 512
2024-05-06 12:17:21,739:WARNING: 	 image_resolution: 224
2024-05-06 12:17:21,739:WARNING: 	 vision_layers: 12
2024-05-06 12:17:21,740:WARNING: 	 vision_width: 768
2024-05-06 12:17:21,740:WARNING: 	 vision_patch_size: 32
2024-05-06 12:17:21,740:WARNING: 	 context_length: 77
2024-05-06 12:17:21,740:WARNING: 	 vocab_size: 49408
2024-05-06 12:17:21,740:WARNING: 	 transformer_width: 512
2024-05-06 12:17:21,740:WARNING: 	 transformer_heads: 8
2024-05-06 12:17:21,740:WARNING: 	 transformer_layers: 12
2024-05-06 12:17:21,740:WARNING: 		 linear_patch: 2d
2024-05-06 12:17:21,740:WARNING: 	 cut_top_layer: 0
2024-05-06 12:17:22,608:WARNING: 	 sim_header: meanP
2024-05-06 12:17:26,358:INFO: --------------------
2024-05-06 12:17:26,358:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:23:08,073:INFO: Effective parameters:
2024-05-06 12:23:08,073:INFO:   <<< batch_size: 1
2024-05-06 12:23:08,073:INFO:   <<< batch_size_val: 16
2024-05-06 12:23:08,073:INFO:   <<< cache_dir: 
2024-05-06 12:23:08,073:INFO:   <<< coef_lr: 0.001
2024-05-06 12:23:08,073:INFO:   <<< cross_model: cross-base
2024-05-06 12:23:08,073:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:23:08,073:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:23:08,073:INFO:   <<< datatype: msrvtt
2024-05-06 12:23:08,073:INFO:   <<< do_eval: True
2024-05-06 12:23:08,073:INFO:   <<< do_lower_case: False
2024-05-06 12:23:08,073:INFO:   <<< do_pretrain: False
2024-05-06 12:23:08,073:INFO:   <<< do_train: False
2024-05-06 12:23:08,073:INFO:   <<< epochs: 2
2024-05-06 12:23:08,073:INFO:   <<< eval_frame_order: 0
2024-05-06 12:23:08,073:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:23:08,073:INFO:   <<< feature_framerate: 1
2024-05-06 12:23:08,074:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:23:08,074:INFO:   <<< fp16: False
2024-05-06 12:23:08,074:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:23:08,074:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:23:08,074:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:23:08,074:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:23:08,074:INFO:   <<< init_model: None
2024-05-06 12:23:08,074:INFO:   <<< linear_patch: 2d
2024-05-06 12:23:08,074:INFO:   <<< local_rank: 0
2024-05-06 12:23:08,074:INFO:   <<< loose_type: True
2024-05-06 12:23:08,074:INFO:   <<< lr: 0.0001
2024-05-06 12:23:08,074:INFO:   <<< lr_decay: 0.9
2024-05-06 12:23:08,074:INFO:   <<< margin: 0.1
2024-05-06 12:23:08,074:INFO:   <<< max_frames: 90
2024-05-06 12:23:08,074:INFO:   <<< max_words: 32
2024-05-06 12:23:08,074:INFO:   <<< n_display: 100
2024-05-06 12:23:08,074:INFO:   <<< n_gpu: 1
2024-05-06 12:23:08,074:INFO:   <<< n_pair: 1
2024-05-06 12:23:08,074:INFO:   <<< negative_weighting: 1
2024-05-06 12:23:08,074:INFO:   <<< num_thread_reader: 0
2024-05-06 12:23:08,074:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:23:08,074:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:23:08,074:INFO:   <<< rank: 0
2024-05-06 12:23:08,074:INFO:   <<< resume_model: None
2024-05-06 12:23:08,074:INFO:   <<< sampled_use_mil: False
2024-05-06 12:23:08,074:INFO:   <<< seed: 42
2024-05-06 12:23:08,074:INFO:   <<< sim_header: meanP
2024-05-06 12:23:08,074:INFO:   <<< slice_framepos: 2
2024-05-06 12:23:08,074:INFO:   <<< task_type: retrieval
2024-05-06 12:23:08,074:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:23:08,074:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:23:08,074:INFO:   <<< train_frame_order: 0
2024-05-06 12:23:08,074:INFO:   <<< use_mil: False
2024-05-06 12:23:08,074:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:23:08,074:INFO:   <<< video_dim: 1024
2024-05-06 12:23:08,074:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:23:08,074:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:23:08,074:INFO:   <<< world_size: 1
2024-05-06 12:23:08,074:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:23:08,208:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:23:08,660:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:23:08,660:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:23:08,660:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:23:08,660:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:23:08,660:WARNING: Test retrieval by loose type.
2024-05-06 12:23:08,661:WARNING: 	 embed_dim: 512
2024-05-06 12:23:08,661:WARNING: 	 image_resolution: 224
2024-05-06 12:23:08,661:WARNING: 	 vision_layers: 12
2024-05-06 12:23:08,661:WARNING: 	 vision_width: 768
2024-05-06 12:23:08,661:WARNING: 	 vision_patch_size: 32
2024-05-06 12:23:08,661:WARNING: 	 context_length: 77
2024-05-06 12:23:08,661:WARNING: 	 vocab_size: 49408
2024-05-06 12:23:08,661:WARNING: 	 transformer_width: 512
2024-05-06 12:23:08,661:WARNING: 	 transformer_heads: 8
2024-05-06 12:23:08,661:WARNING: 	 transformer_layers: 12
2024-05-06 12:23:08,661:WARNING: 		 linear_patch: 2d
2024-05-06 12:23:08,661:WARNING: 	 cut_top_layer: 0
2024-05-06 12:23:09,515:WARNING: 	 sim_header: meanP
2024-05-06 12:23:13,207:INFO: --------------------
2024-05-06 12:23:13,207:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:25:01,819:INFO: Effective parameters:
2024-05-06 12:25:01,819:INFO:   <<< batch_size: 1
2024-05-06 12:25:01,819:INFO:   <<< batch_size_val: 16
2024-05-06 12:25:01,819:INFO:   <<< cache_dir: 
2024-05-06 12:25:01,819:INFO:   <<< coef_lr: 0.001
2024-05-06 12:25:01,819:INFO:   <<< cross_model: cross-base
2024-05-06 12:25:01,819:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:25:01,819:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:25:01,819:INFO:   <<< datatype: msrvtt
2024-05-06 12:25:01,819:INFO:   <<< do_eval: True
2024-05-06 12:25:01,819:INFO:   <<< do_lower_case: False
2024-05-06 12:25:01,819:INFO:   <<< do_pretrain: False
2024-05-06 12:25:01,819:INFO:   <<< do_train: False
2024-05-06 12:25:01,819:INFO:   <<< epochs: 2
2024-05-06 12:25:01,819:INFO:   <<< eval_frame_order: 0
2024-05-06 12:25:01,819:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:25:01,819:INFO:   <<< feature_framerate: 1
2024-05-06 12:25:01,819:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:25:01,819:INFO:   <<< fp16: False
2024-05-06 12:25:01,819:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:25:01,819:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:25:01,819:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:25:01,819:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:25:01,819:INFO:   <<< init_model: None
2024-05-06 12:25:01,819:INFO:   <<< linear_patch: 2d
2024-05-06 12:25:01,819:INFO:   <<< local_rank: 0
2024-05-06 12:25:01,819:INFO:   <<< loose_type: True
2024-05-06 12:25:01,819:INFO:   <<< lr: 0.0001
2024-05-06 12:25:01,819:INFO:   <<< lr_decay: 0.9
2024-05-06 12:25:01,819:INFO:   <<< margin: 0.1
2024-05-06 12:25:01,819:INFO:   <<< max_frames: 90
2024-05-06 12:25:01,819:INFO:   <<< max_words: 32
2024-05-06 12:25:01,819:INFO:   <<< n_display: 100
2024-05-06 12:25:01,819:INFO:   <<< n_gpu: 1
2024-05-06 12:25:01,819:INFO:   <<< n_pair: 1
2024-05-06 12:25:01,819:INFO:   <<< negative_weighting: 1
2024-05-06 12:25:01,819:INFO:   <<< num_thread_reader: 0
2024-05-06 12:25:01,819:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:25:01,819:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:25:01,819:INFO:   <<< rank: 0
2024-05-06 12:25:01,820:INFO:   <<< resume_model: None
2024-05-06 12:25:01,820:INFO:   <<< sampled_use_mil: False
2024-05-06 12:25:01,820:INFO:   <<< seed: 42
2024-05-06 12:25:01,820:INFO:   <<< sim_header: meanP
2024-05-06 12:25:01,820:INFO:   <<< slice_framepos: 2
2024-05-06 12:25:01,820:INFO:   <<< task_type: retrieval
2024-05-06 12:25:01,820:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:25:01,820:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:25:01,820:INFO:   <<< train_frame_order: 0
2024-05-06 12:25:01,820:INFO:   <<< use_mil: False
2024-05-06 12:25:01,820:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:25:01,820:INFO:   <<< video_dim: 1024
2024-05-06 12:25:01,820:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:25:01,820:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:25:01,820:INFO:   <<< world_size: 1
2024-05-06 12:25:01,820:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:25:01,955:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:25:02,399:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:25:02,399:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:25:02,399:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:25:02,400:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:25:02,400:WARNING: Test retrieval by loose type.
2024-05-06 12:25:02,400:WARNING: 	 embed_dim: 512
2024-05-06 12:25:02,400:WARNING: 	 image_resolution: 224
2024-05-06 12:25:02,400:WARNING: 	 vision_layers: 12
2024-05-06 12:25:02,400:WARNING: 	 vision_width: 768
2024-05-06 12:25:02,400:WARNING: 	 vision_patch_size: 32
2024-05-06 12:25:02,400:WARNING: 	 context_length: 77
2024-05-06 12:25:02,400:WARNING: 	 vocab_size: 49408
2024-05-06 12:25:02,400:WARNING: 	 transformer_width: 512
2024-05-06 12:25:02,400:WARNING: 	 transformer_heads: 8
2024-05-06 12:25:02,400:WARNING: 	 transformer_layers: 12
2024-05-06 12:25:02,400:WARNING: 		 linear_patch: 2d
2024-05-06 12:25:02,400:WARNING: 	 cut_top_layer: 0
2024-05-06 12:25:03,247:WARNING: 	 sim_header: meanP
2024-05-06 12:25:06,970:INFO: --------------------
2024-05-06 12:25:06,970:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:26:32,633:INFO: Effective parameters:
2024-05-06 12:26:32,633:INFO:   <<< batch_size: 1
2024-05-06 12:26:32,633:INFO:   <<< batch_size_val: 16
2024-05-06 12:26:32,633:INFO:   <<< cache_dir: 
2024-05-06 12:26:32,633:INFO:   <<< coef_lr: 0.001
2024-05-06 12:26:32,633:INFO:   <<< cross_model: cross-base
2024-05-06 12:26:32,633:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:26:32,633:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:26:32,633:INFO:   <<< datatype: msrvtt
2024-05-06 12:26:32,633:INFO:   <<< do_eval: True
2024-05-06 12:26:32,633:INFO:   <<< do_lower_case: False
2024-05-06 12:26:32,633:INFO:   <<< do_pretrain: False
2024-05-06 12:26:32,633:INFO:   <<< do_train: False
2024-05-06 12:26:32,633:INFO:   <<< epochs: 2
2024-05-06 12:26:32,633:INFO:   <<< eval_frame_order: 0
2024-05-06 12:26:32,633:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:26:32,633:INFO:   <<< feature_framerate: 1
2024-05-06 12:26:32,633:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:26:32,633:INFO:   <<< fp16: False
2024-05-06 12:26:32,633:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:26:32,633:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:26:32,633:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:26:32,633:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:26:32,633:INFO:   <<< init_model: None
2024-05-06 12:26:32,634:INFO:   <<< linear_patch: 2d
2024-05-06 12:26:32,634:INFO:   <<< local_rank: 0
2024-05-06 12:26:32,634:INFO:   <<< loose_type: True
2024-05-06 12:26:32,634:INFO:   <<< lr: 0.0001
2024-05-06 12:26:32,634:INFO:   <<< lr_decay: 0.9
2024-05-06 12:26:32,634:INFO:   <<< margin: 0.1
2024-05-06 12:26:32,634:INFO:   <<< max_frames: 90
2024-05-06 12:26:32,634:INFO:   <<< max_words: 32
2024-05-06 12:26:32,634:INFO:   <<< n_display: 100
2024-05-06 12:26:32,634:INFO:   <<< n_gpu: 1
2024-05-06 12:26:32,634:INFO:   <<< n_pair: 1
2024-05-06 12:26:32,634:INFO:   <<< negative_weighting: 1
2024-05-06 12:26:32,634:INFO:   <<< num_thread_reader: 0
2024-05-06 12:26:32,634:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:26:32,634:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:26:32,634:INFO:   <<< rank: 0
2024-05-06 12:26:32,634:INFO:   <<< resume_model: None
2024-05-06 12:26:32,634:INFO:   <<< sampled_use_mil: False
2024-05-06 12:26:32,634:INFO:   <<< seed: 42
2024-05-06 12:26:32,634:INFO:   <<< sim_header: meanP
2024-05-06 12:26:32,634:INFO:   <<< slice_framepos: 2
2024-05-06 12:26:32,634:INFO:   <<< task_type: retrieval
2024-05-06 12:26:32,634:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:26:32,634:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:26:32,634:INFO:   <<< train_frame_order: 0
2024-05-06 12:26:32,634:INFO:   <<< use_mil: False
2024-05-06 12:26:32,634:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:26:32,634:INFO:   <<< video_dim: 1024
2024-05-06 12:26:32,634:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:26:32,634:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:26:32,634:INFO:   <<< world_size: 1
2024-05-06 12:26:32,634:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:26:32,775:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:26:33,237:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:26:33,237:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:26:33,237:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:26:33,237:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:26:33,237:WARNING: Test retrieval by loose type.
2024-05-06 12:26:33,237:WARNING: 	 embed_dim: 512
2024-05-06 12:26:33,237:WARNING: 	 image_resolution: 224
2024-05-06 12:26:33,237:WARNING: 	 vision_layers: 12
2024-05-06 12:26:33,237:WARNING: 	 vision_width: 768
2024-05-06 12:26:33,237:WARNING: 	 vision_patch_size: 32
2024-05-06 12:26:33,237:WARNING: 	 context_length: 77
2024-05-06 12:26:33,237:WARNING: 	 vocab_size: 49408
2024-05-06 12:26:33,237:WARNING: 	 transformer_width: 512
2024-05-06 12:26:33,237:WARNING: 	 transformer_heads: 8
2024-05-06 12:26:33,237:WARNING: 	 transformer_layers: 12
2024-05-06 12:26:33,237:WARNING: 		 linear_patch: 2d
2024-05-06 12:26:33,237:WARNING: 	 cut_top_layer: 0
2024-05-06 12:26:34,069:WARNING: 	 sim_header: meanP
2024-05-06 12:26:37,718:INFO: --------------------
2024-05-06 12:26:37,718:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:27:40,867:INFO: Effective parameters:
2024-05-06 12:27:40,867:INFO:   <<< batch_size: 1
2024-05-06 12:27:40,867:INFO:   <<< batch_size_val: 16
2024-05-06 12:27:40,867:INFO:   <<< cache_dir: 
2024-05-06 12:27:40,867:INFO:   <<< coef_lr: 0.001
2024-05-06 12:27:40,867:INFO:   <<< cross_model: cross-base
2024-05-06 12:27:40,867:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:27:40,867:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:27:40,867:INFO:   <<< datatype: msrvtt
2024-05-06 12:27:40,867:INFO:   <<< do_eval: True
2024-05-06 12:27:40,867:INFO:   <<< do_lower_case: False
2024-05-06 12:27:40,867:INFO:   <<< do_pretrain: False
2024-05-06 12:27:40,867:INFO:   <<< do_train: False
2024-05-06 12:27:40,867:INFO:   <<< epochs: 2
2024-05-06 12:27:40,867:INFO:   <<< eval_frame_order: 0
2024-05-06 12:27:40,867:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:27:40,867:INFO:   <<< feature_framerate: 1
2024-05-06 12:27:40,867:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:27:40,867:INFO:   <<< fp16: False
2024-05-06 12:27:40,867:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:27:40,867:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:27:40,867:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:27:40,867:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:27:40,867:INFO:   <<< init_model: None
2024-05-06 12:27:40,867:INFO:   <<< linear_patch: 2d
2024-05-06 12:27:40,867:INFO:   <<< local_rank: 0
2024-05-06 12:27:40,867:INFO:   <<< loose_type: True
2024-05-06 12:27:40,867:INFO:   <<< lr: 0.0001
2024-05-06 12:27:40,867:INFO:   <<< lr_decay: 0.9
2024-05-06 12:27:40,867:INFO:   <<< margin: 0.1
2024-05-06 12:27:40,868:INFO:   <<< max_frames: 90
2024-05-06 12:27:40,868:INFO:   <<< max_words: 32
2024-05-06 12:27:40,868:INFO:   <<< n_display: 100
2024-05-06 12:27:40,868:INFO:   <<< n_gpu: 1
2024-05-06 12:27:40,868:INFO:   <<< n_pair: 1
2024-05-06 12:27:40,868:INFO:   <<< negative_weighting: 1
2024-05-06 12:27:40,868:INFO:   <<< num_thread_reader: 0
2024-05-06 12:27:40,868:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:27:40,868:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:27:40,868:INFO:   <<< rank: 0
2024-05-06 12:27:40,868:INFO:   <<< resume_model: None
2024-05-06 12:27:40,868:INFO:   <<< sampled_use_mil: False
2024-05-06 12:27:40,868:INFO:   <<< seed: 42
2024-05-06 12:27:40,868:INFO:   <<< sim_header: meanP
2024-05-06 12:27:40,868:INFO:   <<< slice_framepos: 2
2024-05-06 12:27:40,868:INFO:   <<< task_type: retrieval
2024-05-06 12:27:40,868:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:27:40,868:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:27:40,868:INFO:   <<< train_frame_order: 0
2024-05-06 12:27:40,868:INFO:   <<< use_mil: False
2024-05-06 12:27:40,868:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:27:40,868:INFO:   <<< video_dim: 1024
2024-05-06 12:27:40,868:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:27:40,868:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:27:40,868:INFO:   <<< world_size: 1
2024-05-06 12:27:40,868:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:27:41,011:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:27:41,469:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:27:41,469:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:27:41,469:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:27:41,469:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:27:41,469:WARNING: Test retrieval by loose type.
2024-05-06 12:27:41,469:WARNING: 	 embed_dim: 512
2024-05-06 12:27:41,469:WARNING: 	 image_resolution: 224
2024-05-06 12:27:41,469:WARNING: 	 vision_layers: 12
2024-05-06 12:27:41,469:WARNING: 	 vision_width: 768
2024-05-06 12:27:41,469:WARNING: 	 vision_patch_size: 32
2024-05-06 12:27:41,469:WARNING: 	 context_length: 77
2024-05-06 12:27:41,469:WARNING: 	 vocab_size: 49408
2024-05-06 12:27:41,469:WARNING: 	 transformer_width: 512
2024-05-06 12:27:41,469:WARNING: 	 transformer_heads: 8
2024-05-06 12:27:41,469:WARNING: 	 transformer_layers: 12
2024-05-06 12:27:41,469:WARNING: 		 linear_patch: 2d
2024-05-06 12:27:41,469:WARNING: 	 cut_top_layer: 0
2024-05-06 12:27:42,327:WARNING: 	 sim_header: meanP
2024-05-06 12:27:46,056:INFO: --------------------
2024-05-06 12:27:46,056:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:32:18,932:INFO: Effective parameters:
2024-05-06 12:32:18,933:INFO:   <<< batch_size: 1
2024-05-06 12:32:18,933:INFO:   <<< batch_size_val: 16
2024-05-06 12:32:18,933:INFO:   <<< cache_dir: 
2024-05-06 12:32:18,933:INFO:   <<< coef_lr: 0.001
2024-05-06 12:32:18,933:INFO:   <<< cross_model: cross-base
2024-05-06 12:32:18,933:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:32:18,933:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:32:18,933:INFO:   <<< datatype: msrvtt
2024-05-06 12:32:18,933:INFO:   <<< do_eval: True
2024-05-06 12:32:18,933:INFO:   <<< do_lower_case: False
2024-05-06 12:32:18,933:INFO:   <<< do_pretrain: False
2024-05-06 12:32:18,933:INFO:   <<< do_train: False
2024-05-06 12:32:18,933:INFO:   <<< epochs: 2
2024-05-06 12:32:18,933:INFO:   <<< eval_frame_order: 0
2024-05-06 12:32:18,933:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:32:18,933:INFO:   <<< feature_framerate: 1
2024-05-06 12:32:18,933:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:32:18,933:INFO:   <<< fp16: False
2024-05-06 12:32:18,933:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:32:18,933:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:32:18,933:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:32:18,933:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:32:18,933:INFO:   <<< init_model: None
2024-05-06 12:32:18,933:INFO:   <<< linear_patch: 2d
2024-05-06 12:32:18,933:INFO:   <<< local_rank: 0
2024-05-06 12:32:18,933:INFO:   <<< loose_type: True
2024-05-06 12:32:18,933:INFO:   <<< lr: 0.0001
2024-05-06 12:32:18,933:INFO:   <<< lr_decay: 0.9
2024-05-06 12:32:18,933:INFO:   <<< margin: 0.1
2024-05-06 12:32:18,933:INFO:   <<< max_frames: 90
2024-05-06 12:32:18,933:INFO:   <<< max_words: 32
2024-05-06 12:32:18,933:INFO:   <<< n_display: 100
2024-05-06 12:32:18,933:INFO:   <<< n_gpu: 1
2024-05-06 12:32:18,933:INFO:   <<< n_pair: 1
2024-05-06 12:32:18,933:INFO:   <<< negative_weighting: 1
2024-05-06 12:32:18,933:INFO:   <<< num_thread_reader: 0
2024-05-06 12:32:18,933:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:32:18,933:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:32:18,933:INFO:   <<< rank: 0
2024-05-06 12:32:18,933:INFO:   <<< resume_model: None
2024-05-06 12:32:18,933:INFO:   <<< sampled_use_mil: False
2024-05-06 12:32:18,933:INFO:   <<< seed: 42
2024-05-06 12:32:18,933:INFO:   <<< sim_header: meanP
2024-05-06 12:32:18,934:INFO:   <<< slice_framepos: 2
2024-05-06 12:32:18,934:INFO:   <<< task_type: retrieval
2024-05-06 12:32:18,934:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:32:18,934:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:32:18,934:INFO:   <<< train_frame_order: 0
2024-05-06 12:32:18,934:INFO:   <<< use_mil: False
2024-05-06 12:32:18,934:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:32:18,934:INFO:   <<< video_dim: 1024
2024-05-06 12:32:18,934:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:32:18,934:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:32:18,934:INFO:   <<< world_size: 1
2024-05-06 12:32:18,934:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:32:19,079:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:32:19,553:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:32:19,553:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:32:19,553:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:32:19,554:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:32:19,554:WARNING: Test retrieval by loose type.
2024-05-06 12:32:19,554:WARNING: 	 embed_dim: 512
2024-05-06 12:32:19,554:WARNING: 	 image_resolution: 224
2024-05-06 12:32:19,554:WARNING: 	 vision_layers: 12
2024-05-06 12:32:19,554:WARNING: 	 vision_width: 768
2024-05-06 12:32:19,554:WARNING: 	 vision_patch_size: 32
2024-05-06 12:32:19,554:WARNING: 	 context_length: 77
2024-05-06 12:32:19,554:WARNING: 	 vocab_size: 49408
2024-05-06 12:32:19,554:WARNING: 	 transformer_width: 512
2024-05-06 12:32:19,554:WARNING: 	 transformer_heads: 8
2024-05-06 12:32:19,554:WARNING: 	 transformer_layers: 12
2024-05-06 12:32:19,554:WARNING: 		 linear_patch: 2d
2024-05-06 12:32:19,554:WARNING: 	 cut_top_layer: 0
2024-05-06 12:32:20,417:WARNING: 	 sim_header: meanP
2024-05-06 12:32:24,118:INFO: --------------------
2024-05-06 12:32:24,118:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:33:36,039:INFO: Effective parameters:
2024-05-06 12:33:36,039:INFO:   <<< batch_size: 1
2024-05-06 12:33:36,039:INFO:   <<< batch_size_val: 16
2024-05-06 12:33:36,039:INFO:   <<< cache_dir: 
2024-05-06 12:33:36,039:INFO:   <<< coef_lr: 0.001
2024-05-06 12:33:36,039:INFO:   <<< cross_model: cross-base
2024-05-06 12:33:36,039:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:33:36,039:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:33:36,039:INFO:   <<< datatype: msrvtt
2024-05-06 12:33:36,039:INFO:   <<< do_eval: True
2024-05-06 12:33:36,039:INFO:   <<< do_lower_case: False
2024-05-06 12:33:36,039:INFO:   <<< do_pretrain: False
2024-05-06 12:33:36,039:INFO:   <<< do_train: False
2024-05-06 12:33:36,039:INFO:   <<< epochs: 2
2024-05-06 12:33:36,039:INFO:   <<< eval_frame_order: 0
2024-05-06 12:33:36,039:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:33:36,039:INFO:   <<< feature_framerate: 1
2024-05-06 12:33:36,039:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:33:36,039:INFO:   <<< fp16: False
2024-05-06 12:33:36,039:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:33:36,039:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:33:36,039:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:33:36,039:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:33:36,039:INFO:   <<< init_model: None
2024-05-06 12:33:36,039:INFO:   <<< linear_patch: 2d
2024-05-06 12:33:36,039:INFO:   <<< local_rank: 0
2024-05-06 12:33:36,039:INFO:   <<< loose_type: True
2024-05-06 12:33:36,039:INFO:   <<< lr: 0.0001
2024-05-06 12:33:36,039:INFO:   <<< lr_decay: 0.9
2024-05-06 12:33:36,040:INFO:   <<< margin: 0.1
2024-05-06 12:33:36,040:INFO:   <<< max_frames: 90
2024-05-06 12:33:36,040:INFO:   <<< max_words: 32
2024-05-06 12:33:36,040:INFO:   <<< n_display: 100
2024-05-06 12:33:36,040:INFO:   <<< n_gpu: 1
2024-05-06 12:33:36,040:INFO:   <<< n_pair: 1
2024-05-06 12:33:36,040:INFO:   <<< negative_weighting: 1
2024-05-06 12:33:36,040:INFO:   <<< num_thread_reader: 0
2024-05-06 12:33:36,040:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:33:36,040:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:33:36,040:INFO:   <<< rank: 0
2024-05-06 12:33:36,040:INFO:   <<< resume_model: None
2024-05-06 12:33:36,040:INFO:   <<< sampled_use_mil: False
2024-05-06 12:33:36,040:INFO:   <<< seed: 42
2024-05-06 12:33:36,040:INFO:   <<< sim_header: meanP
2024-05-06 12:33:36,040:INFO:   <<< slice_framepos: 2
2024-05-06 12:33:36,040:INFO:   <<< task_type: retrieval
2024-05-06 12:33:36,040:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:33:36,040:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:33:36,040:INFO:   <<< train_frame_order: 0
2024-05-06 12:33:36,040:INFO:   <<< use_mil: False
2024-05-06 12:33:36,040:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:33:36,040:INFO:   <<< video_dim: 1024
2024-05-06 12:33:36,040:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:33:36,040:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:33:36,040:INFO:   <<< world_size: 1
2024-05-06 12:33:36,040:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:33:36,174:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:33:36,629:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:33:36,629:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:33:36,629:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:33:36,629:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:33:36,629:WARNING: Test retrieval by loose type.
2024-05-06 12:33:36,630:WARNING: 	 embed_dim: 512
2024-05-06 12:33:36,630:WARNING: 	 image_resolution: 224
2024-05-06 12:33:36,630:WARNING: 	 vision_layers: 12
2024-05-06 12:33:36,630:WARNING: 	 vision_width: 768
2024-05-06 12:33:36,630:WARNING: 	 vision_patch_size: 32
2024-05-06 12:33:36,630:WARNING: 	 context_length: 77
2024-05-06 12:33:36,630:WARNING: 	 vocab_size: 49408
2024-05-06 12:33:36,630:WARNING: 	 transformer_width: 512
2024-05-06 12:33:36,630:WARNING: 	 transformer_heads: 8
2024-05-06 12:33:36,630:WARNING: 	 transformer_layers: 12
2024-05-06 12:33:36,630:WARNING: 		 linear_patch: 2d
2024-05-06 12:33:36,630:WARNING: 	 cut_top_layer: 0
2024-05-06 12:33:37,495:WARNING: 	 sim_header: meanP
2024-05-06 12:33:41,190:INFO: --------------------
2024-05-06 12:33:41,191:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:36:02,614:INFO: Effective parameters:
2024-05-06 12:36:02,614:INFO:   <<< batch_size: 1
2024-05-06 12:36:02,614:INFO:   <<< batch_size_val: 16
2024-05-06 12:36:02,614:INFO:   <<< cache_dir: 
2024-05-06 12:36:02,615:INFO:   <<< coef_lr: 0.001
2024-05-06 12:36:02,615:INFO:   <<< cross_model: cross-base
2024-05-06 12:36:02,615:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:36:02,615:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:36:02,615:INFO:   <<< datatype: msrvtt
2024-05-06 12:36:02,615:INFO:   <<< do_eval: True
2024-05-06 12:36:02,615:INFO:   <<< do_lower_case: False
2024-05-06 12:36:02,615:INFO:   <<< do_pretrain: False
2024-05-06 12:36:02,615:INFO:   <<< do_train: False
2024-05-06 12:36:02,615:INFO:   <<< epochs: 2
2024-05-06 12:36:02,615:INFO:   <<< eval_frame_order: 0
2024-05-06 12:36:02,615:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:36:02,615:INFO:   <<< feature_framerate: 1
2024-05-06 12:36:02,615:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:36:02,615:INFO:   <<< fp16: False
2024-05-06 12:36:02,615:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:36:02,615:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:36:02,615:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:36:02,615:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:36:02,615:INFO:   <<< init_model: None
2024-05-06 12:36:02,615:INFO:   <<< linear_patch: 2d
2024-05-06 12:36:02,615:INFO:   <<< local_rank: 0
2024-05-06 12:36:02,615:INFO:   <<< loose_type: True
2024-05-06 12:36:02,615:INFO:   <<< lr: 0.0001
2024-05-06 12:36:02,615:INFO:   <<< lr_decay: 0.9
2024-05-06 12:36:02,615:INFO:   <<< margin: 0.1
2024-05-06 12:36:02,615:INFO:   <<< max_frames: 90
2024-05-06 12:36:02,615:INFO:   <<< max_words: 32
2024-05-06 12:36:02,615:INFO:   <<< n_display: 100
2024-05-06 12:36:02,615:INFO:   <<< n_gpu: 1
2024-05-06 12:36:02,615:INFO:   <<< n_pair: 1
2024-05-06 12:36:02,615:INFO:   <<< negative_weighting: 1
2024-05-06 12:36:02,615:INFO:   <<< num_thread_reader: 0
2024-05-06 12:36:02,615:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:36:02,615:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:36:02,615:INFO:   <<< rank: 0
2024-05-06 12:36:02,615:INFO:   <<< resume_model: None
2024-05-06 12:36:02,615:INFO:   <<< sampled_use_mil: False
2024-05-06 12:36:02,615:INFO:   <<< seed: 42
2024-05-06 12:36:02,615:INFO:   <<< sim_header: meanP
2024-05-06 12:36:02,615:INFO:   <<< slice_framepos: 2
2024-05-06 12:36:02,615:INFO:   <<< task_type: retrieval
2024-05-06 12:36:02,615:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:36:02,615:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:36:02,615:INFO:   <<< train_frame_order: 0
2024-05-06 12:36:02,615:INFO:   <<< use_mil: False
2024-05-06 12:36:02,615:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:36:02,615:INFO:   <<< video_dim: 1024
2024-05-06 12:36:02,615:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:36:02,615:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:36:02,615:INFO:   <<< world_size: 1
2024-05-06 12:36:02,615:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:36:02,769:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:36:03,237:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:36:03,237:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:36:03,237:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:36:03,237:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:36:03,237:WARNING: Test retrieval by loose type.
2024-05-06 12:36:03,237:WARNING: 	 embed_dim: 512
2024-05-06 12:36:03,237:WARNING: 	 image_resolution: 224
2024-05-06 12:36:03,237:WARNING: 	 vision_layers: 12
2024-05-06 12:36:03,237:WARNING: 	 vision_width: 768
2024-05-06 12:36:03,237:WARNING: 	 vision_patch_size: 32
2024-05-06 12:36:03,237:WARNING: 	 context_length: 77
2024-05-06 12:36:03,237:WARNING: 	 vocab_size: 49408
2024-05-06 12:36:03,237:WARNING: 	 transformer_width: 512
2024-05-06 12:36:03,237:WARNING: 	 transformer_heads: 8
2024-05-06 12:36:03,237:WARNING: 	 transformer_layers: 12
2024-05-06 12:36:03,237:WARNING: 		 linear_patch: 2d
2024-05-06 12:36:03,237:WARNING: 	 cut_top_layer: 0
2024-05-06 12:36:04,109:WARNING: 	 sim_header: meanP
2024-05-06 12:36:07,822:INFO: --------------------
2024-05-06 12:36:07,823:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:37:00,511:INFO: Effective parameters:
2024-05-06 12:37:00,512:INFO:   <<< batch_size: 1
2024-05-06 12:37:00,512:INFO:   <<< batch_size_val: 16
2024-05-06 12:37:00,512:INFO:   <<< cache_dir: 
2024-05-06 12:37:00,512:INFO:   <<< coef_lr: 0.001
2024-05-06 12:37:00,512:INFO:   <<< cross_model: cross-base
2024-05-06 12:37:00,512:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:37:00,512:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:37:00,512:INFO:   <<< datatype: msrvtt
2024-05-06 12:37:00,512:INFO:   <<< do_eval: True
2024-05-06 12:37:00,512:INFO:   <<< do_lower_case: False
2024-05-06 12:37:00,512:INFO:   <<< do_pretrain: False
2024-05-06 12:37:00,512:INFO:   <<< do_train: False
2024-05-06 12:37:00,512:INFO:   <<< epochs: 2
2024-05-06 12:37:00,512:INFO:   <<< eval_frame_order: 0
2024-05-06 12:37:00,512:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:37:00,512:INFO:   <<< feature_framerate: 1
2024-05-06 12:37:00,512:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:37:00,512:INFO:   <<< fp16: False
2024-05-06 12:37:00,512:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:37:00,512:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:37:00,512:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:37:00,512:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:37:00,512:INFO:   <<< init_model: None
2024-05-06 12:37:00,512:INFO:   <<< linear_patch: 2d
2024-05-06 12:37:00,512:INFO:   <<< local_rank: 0
2024-05-06 12:37:00,512:INFO:   <<< loose_type: True
2024-05-06 12:37:00,512:INFO:   <<< lr: 0.0001
2024-05-06 12:37:00,512:INFO:   <<< lr_decay: 0.9
2024-05-06 12:37:00,512:INFO:   <<< margin: 0.1
2024-05-06 12:37:00,512:INFO:   <<< max_frames: 90
2024-05-06 12:37:00,512:INFO:   <<< max_words: 32
2024-05-06 12:37:00,512:INFO:   <<< n_display: 100
2024-05-06 12:37:00,512:INFO:   <<< n_gpu: 1
2024-05-06 12:37:00,512:INFO:   <<< n_pair: 1
2024-05-06 12:37:00,512:INFO:   <<< negative_weighting: 1
2024-05-06 12:37:00,512:INFO:   <<< num_thread_reader: 0
2024-05-06 12:37:00,512:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:37:00,512:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:37:00,512:INFO:   <<< rank: 0
2024-05-06 12:37:00,512:INFO:   <<< resume_model: None
2024-05-06 12:37:00,512:INFO:   <<< sampled_use_mil: False
2024-05-06 12:37:00,512:INFO:   <<< seed: 42
2024-05-06 12:37:00,512:INFO:   <<< sim_header: meanP
2024-05-06 12:37:00,512:INFO:   <<< slice_framepos: 2
2024-05-06 12:37:00,512:INFO:   <<< task_type: retrieval
2024-05-06 12:37:00,512:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:37:00,512:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:37:00,512:INFO:   <<< train_frame_order: 0
2024-05-06 12:37:00,512:INFO:   <<< use_mil: False
2024-05-06 12:37:00,512:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:37:00,512:INFO:   <<< video_dim: 1024
2024-05-06 12:37:00,512:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:37:00,512:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:37:00,512:INFO:   <<< world_size: 1
2024-05-06 12:37:00,513:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:37:00,647:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:37:01,098:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:37:01,098:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:37:01,098:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:37:01,098:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:37:01,098:WARNING: Test retrieval by loose type.
2024-05-06 12:37:01,098:WARNING: 	 embed_dim: 512
2024-05-06 12:37:01,098:WARNING: 	 image_resolution: 224
2024-05-06 12:37:01,098:WARNING: 	 vision_layers: 12
2024-05-06 12:37:01,098:WARNING: 	 vision_width: 768
2024-05-06 12:37:01,098:WARNING: 	 vision_patch_size: 32
2024-05-06 12:37:01,098:WARNING: 	 context_length: 77
2024-05-06 12:37:01,098:WARNING: 	 vocab_size: 49408
2024-05-06 12:37:01,098:WARNING: 	 transformer_width: 512
2024-05-06 12:37:01,098:WARNING: 	 transformer_heads: 8
2024-05-06 12:37:01,098:WARNING: 	 transformer_layers: 12
2024-05-06 12:37:01,098:WARNING: 		 linear_patch: 2d
2024-05-06 12:37:01,098:WARNING: 	 cut_top_layer: 0
2024-05-06 12:37:01,944:WARNING: 	 sim_header: meanP
2024-05-06 12:37:05,629:INFO: --------------------
2024-05-06 12:37:05,629:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:37:23,235:INFO: Effective parameters:
2024-05-06 12:37:23,235:INFO:   <<< batch_size: 1
2024-05-06 12:37:23,235:INFO:   <<< batch_size_val: 16
2024-05-06 12:37:23,235:INFO:   <<< cache_dir: 
2024-05-06 12:37:23,235:INFO:   <<< coef_lr: 0.001
2024-05-06 12:37:23,235:INFO:   <<< cross_model: cross-base
2024-05-06 12:37:23,235:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:37:23,235:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:37:23,235:INFO:   <<< datatype: msrvtt
2024-05-06 12:37:23,235:INFO:   <<< do_eval: True
2024-05-06 12:37:23,235:INFO:   <<< do_lower_case: False
2024-05-06 12:37:23,235:INFO:   <<< do_pretrain: False
2024-05-06 12:37:23,235:INFO:   <<< do_train: False
2024-05-06 12:37:23,235:INFO:   <<< epochs: 2
2024-05-06 12:37:23,235:INFO:   <<< eval_frame_order: 0
2024-05-06 12:37:23,235:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:37:23,235:INFO:   <<< feature_framerate: 1
2024-05-06 12:37:23,235:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:37:23,235:INFO:   <<< fp16: False
2024-05-06 12:37:23,235:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:37:23,235:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:37:23,235:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:37:23,235:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:37:23,235:INFO:   <<< init_model: None
2024-05-06 12:37:23,235:INFO:   <<< linear_patch: 2d
2024-05-06 12:37:23,235:INFO:   <<< local_rank: 0
2024-05-06 12:37:23,235:INFO:   <<< loose_type: True
2024-05-06 12:37:23,235:INFO:   <<< lr: 0.0001
2024-05-06 12:37:23,235:INFO:   <<< lr_decay: 0.9
2024-05-06 12:37:23,235:INFO:   <<< margin: 0.1
2024-05-06 12:37:23,235:INFO:   <<< max_frames: 90
2024-05-06 12:37:23,235:INFO:   <<< max_words: 32
2024-05-06 12:37:23,235:INFO:   <<< n_display: 100
2024-05-06 12:37:23,235:INFO:   <<< n_gpu: 1
2024-05-06 12:37:23,235:INFO:   <<< n_pair: 1
2024-05-06 12:37:23,235:INFO:   <<< negative_weighting: 1
2024-05-06 12:37:23,235:INFO:   <<< num_thread_reader: 0
2024-05-06 12:37:23,235:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:37:23,235:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:37:23,235:INFO:   <<< rank: 0
2024-05-06 12:37:23,235:INFO:   <<< resume_model: None
2024-05-06 12:37:23,235:INFO:   <<< sampled_use_mil: False
2024-05-06 12:37:23,235:INFO:   <<< seed: 42
2024-05-06 12:37:23,235:INFO:   <<< sim_header: meanP
2024-05-06 12:37:23,236:INFO:   <<< slice_framepos: 2
2024-05-06 12:37:23,236:INFO:   <<< task_type: retrieval
2024-05-06 12:37:23,236:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:37:23,236:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:37:23,236:INFO:   <<< train_frame_order: 0
2024-05-06 12:37:23,236:INFO:   <<< use_mil: False
2024-05-06 12:37:23,236:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:37:23,236:INFO:   <<< video_dim: 1024
2024-05-06 12:37:23,236:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:37:23,236:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:37:23,236:INFO:   <<< world_size: 1
2024-05-06 12:37:23,236:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:37:23,371:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:37:23,824:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:37:23,825:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:37:23,825:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:37:23,825:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:37:23,825:WARNING: Test retrieval by loose type.
2024-05-06 12:37:23,825:WARNING: 	 embed_dim: 512
2024-05-06 12:37:23,825:WARNING: 	 image_resolution: 224
2024-05-06 12:37:23,825:WARNING: 	 vision_layers: 12
2024-05-06 12:37:23,825:WARNING: 	 vision_width: 768
2024-05-06 12:37:23,825:WARNING: 	 vision_patch_size: 32
2024-05-06 12:37:23,825:WARNING: 	 context_length: 77
2024-05-06 12:37:23,825:WARNING: 	 vocab_size: 49408
2024-05-06 12:37:23,825:WARNING: 	 transformer_width: 512
2024-05-06 12:37:23,825:WARNING: 	 transformer_heads: 8
2024-05-06 12:37:23,825:WARNING: 	 transformer_layers: 12
2024-05-06 12:37:23,825:WARNING: 		 linear_patch: 2d
2024-05-06 12:37:23,825:WARNING: 	 cut_top_layer: 0
2024-05-06 12:37:24,666:WARNING: 	 sim_header: meanP
2024-05-06 12:37:28,390:INFO: --------------------
2024-05-06 12:37:28,390:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:39:16,237:INFO: Effective parameters:
2024-05-06 12:39:16,237:INFO:   <<< batch_size: 1
2024-05-06 12:39:16,237:INFO:   <<< batch_size_val: 16
2024-05-06 12:39:16,237:INFO:   <<< cache_dir: 
2024-05-06 12:39:16,237:INFO:   <<< coef_lr: 0.001
2024-05-06 12:39:16,237:INFO:   <<< cross_model: cross-base
2024-05-06 12:39:16,237:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:39:16,237:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:39:16,237:INFO:   <<< datatype: msrvtt
2024-05-06 12:39:16,237:INFO:   <<< do_eval: True
2024-05-06 12:39:16,237:INFO:   <<< do_lower_case: False
2024-05-06 12:39:16,237:INFO:   <<< do_pretrain: False
2024-05-06 12:39:16,238:INFO:   <<< do_train: False
2024-05-06 12:39:16,238:INFO:   <<< epochs: 2
2024-05-06 12:39:16,238:INFO:   <<< eval_frame_order: 0
2024-05-06 12:39:16,238:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:39:16,238:INFO:   <<< feature_framerate: 1
2024-05-06 12:39:16,238:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:39:16,238:INFO:   <<< fp16: False
2024-05-06 12:39:16,238:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:39:16,238:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:39:16,238:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:39:16,238:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:39:16,238:INFO:   <<< init_model: None
2024-05-06 12:39:16,238:INFO:   <<< linear_patch: 2d
2024-05-06 12:39:16,238:INFO:   <<< local_rank: 0
2024-05-06 12:39:16,238:INFO:   <<< loose_type: True
2024-05-06 12:39:16,238:INFO:   <<< lr: 0.0001
2024-05-06 12:39:16,238:INFO:   <<< lr_decay: 0.9
2024-05-06 12:39:16,238:INFO:   <<< margin: 0.1
2024-05-06 12:39:16,238:INFO:   <<< max_frames: 90
2024-05-06 12:39:16,238:INFO:   <<< max_words: 32
2024-05-06 12:39:16,238:INFO:   <<< n_display: 100
2024-05-06 12:39:16,238:INFO:   <<< n_gpu: 1
2024-05-06 12:39:16,238:INFO:   <<< n_pair: 1
2024-05-06 12:39:16,238:INFO:   <<< negative_weighting: 1
2024-05-06 12:39:16,238:INFO:   <<< num_thread_reader: 0
2024-05-06 12:39:16,238:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:39:16,238:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:39:16,238:INFO:   <<< rank: 0
2024-05-06 12:39:16,238:INFO:   <<< resume_model: None
2024-05-06 12:39:16,238:INFO:   <<< sampled_use_mil: False
2024-05-06 12:39:16,238:INFO:   <<< seed: 42
2024-05-06 12:39:16,238:INFO:   <<< sim_header: meanP
2024-05-06 12:39:16,238:INFO:   <<< slice_framepos: 2
2024-05-06 12:39:16,238:INFO:   <<< task_type: retrieval
2024-05-06 12:39:16,238:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:39:16,238:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:39:16,238:INFO:   <<< train_frame_order: 0
2024-05-06 12:39:16,238:INFO:   <<< use_mil: False
2024-05-06 12:39:16,238:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:39:16,238:INFO:   <<< video_dim: 1024
2024-05-06 12:39:16,238:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:39:16,238:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:39:16,238:INFO:   <<< world_size: 1
2024-05-06 12:39:16,239:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:39:16,373:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:39:16,820:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:39:16,820:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:39:16,820:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:39:16,820:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:39:16,820:WARNING: Test retrieval by loose type.
2024-05-06 12:39:16,820:WARNING: 	 embed_dim: 512
2024-05-06 12:39:16,820:WARNING: 	 image_resolution: 224
2024-05-06 12:39:16,820:WARNING: 	 vision_layers: 12
2024-05-06 12:39:16,820:WARNING: 	 vision_width: 768
2024-05-06 12:39:16,821:WARNING: 	 vision_patch_size: 32
2024-05-06 12:39:16,821:WARNING: 	 context_length: 77
2024-05-06 12:39:16,821:WARNING: 	 vocab_size: 49408
2024-05-06 12:39:16,821:WARNING: 	 transformer_width: 512
2024-05-06 12:39:16,821:WARNING: 	 transformer_heads: 8
2024-05-06 12:39:16,821:WARNING: 	 transformer_layers: 12
2024-05-06 12:39:16,821:WARNING: 		 linear_patch: 2d
2024-05-06 12:39:16,821:WARNING: 	 cut_top_layer: 0
2024-05-06 12:39:17,662:WARNING: 	 sim_header: meanP
2024-05-06 12:39:21,376:INFO: --------------------
2024-05-06 12:39:21,376:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:43:52,432:INFO: Effective parameters:
2024-05-06 12:43:52,433:INFO:   <<< batch_size: 1
2024-05-06 12:43:52,433:INFO:   <<< batch_size_val: 16
2024-05-06 12:43:52,433:INFO:   <<< cache_dir: 
2024-05-06 12:43:52,433:INFO:   <<< coef_lr: 0.001
2024-05-06 12:43:52,433:INFO:   <<< cross_model: cross-base
2024-05-06 12:43:52,433:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:43:52,433:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:43:52,433:INFO:   <<< datatype: msrvtt
2024-05-06 12:43:52,433:INFO:   <<< do_eval: True
2024-05-06 12:43:52,433:INFO:   <<< do_lower_case: False
2024-05-06 12:43:52,433:INFO:   <<< do_pretrain: False
2024-05-06 12:43:52,433:INFO:   <<< do_train: False
2024-05-06 12:43:52,433:INFO:   <<< epochs: 2
2024-05-06 12:43:52,433:INFO:   <<< eval_frame_order: 0
2024-05-06 12:43:52,433:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:43:52,433:INFO:   <<< feature_framerate: 1
2024-05-06 12:43:52,433:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:43:52,433:INFO:   <<< fp16: False
2024-05-06 12:43:52,433:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:43:52,433:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:43:52,433:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:43:52,433:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:43:52,433:INFO:   <<< init_model: None
2024-05-06 12:43:52,433:INFO:   <<< linear_patch: 2d
2024-05-06 12:43:52,433:INFO:   <<< local_rank: 0
2024-05-06 12:43:52,433:INFO:   <<< loose_type: True
2024-05-06 12:43:52,433:INFO:   <<< lr: 0.0001
2024-05-06 12:43:52,433:INFO:   <<< lr_decay: 0.9
2024-05-06 12:43:52,433:INFO:   <<< margin: 0.1
2024-05-06 12:43:52,433:INFO:   <<< max_frames: 90
2024-05-06 12:43:52,433:INFO:   <<< max_words: 32
2024-05-06 12:43:52,433:INFO:   <<< n_display: 100
2024-05-06 12:43:52,433:INFO:   <<< n_gpu: 1
2024-05-06 12:43:52,433:INFO:   <<< n_pair: 1
2024-05-06 12:43:52,433:INFO:   <<< negative_weighting: 1
2024-05-06 12:43:52,433:INFO:   <<< num_thread_reader: 0
2024-05-06 12:43:52,433:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:43:52,433:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:43:52,433:INFO:   <<< rank: 0
2024-05-06 12:43:52,433:INFO:   <<< resume_model: None
2024-05-06 12:43:52,433:INFO:   <<< sampled_use_mil: False
2024-05-06 12:43:52,433:INFO:   <<< seed: 42
2024-05-06 12:43:52,433:INFO:   <<< sim_header: meanP
2024-05-06 12:43:52,433:INFO:   <<< slice_framepos: 2
2024-05-06 12:43:52,433:INFO:   <<< task_type: retrieval
2024-05-06 12:43:52,433:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:43:52,433:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:43:52,433:INFO:   <<< train_frame_order: 0
2024-05-06 12:43:52,433:INFO:   <<< use_mil: False
2024-05-06 12:43:52,433:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:43:52,433:INFO:   <<< video_dim: 1024
2024-05-06 12:43:52,433:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:43:52,433:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:43:52,433:INFO:   <<< world_size: 1
2024-05-06 12:43:52,434:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:43:52,575:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:43:53,033:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:43:53,033:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:43:53,033:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:43:53,033:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:43:53,033:WARNING: Test retrieval by loose type.
2024-05-06 12:43:53,033:WARNING: 	 embed_dim: 512
2024-05-06 12:43:53,033:WARNING: 	 image_resolution: 224
2024-05-06 12:43:53,033:WARNING: 	 vision_layers: 12
2024-05-06 12:43:53,033:WARNING: 	 vision_width: 768
2024-05-06 12:43:53,033:WARNING: 	 vision_patch_size: 32
2024-05-06 12:43:53,033:WARNING: 	 context_length: 77
2024-05-06 12:43:53,034:WARNING: 	 vocab_size: 49408
2024-05-06 12:43:53,034:WARNING: 	 transformer_width: 512
2024-05-06 12:43:53,034:WARNING: 	 transformer_heads: 8
2024-05-06 12:43:53,034:WARNING: 	 transformer_layers: 12
2024-05-06 12:43:53,034:WARNING: 		 linear_patch: 2d
2024-05-06 12:43:53,034:WARNING: 	 cut_top_layer: 0
2024-05-06 12:43:53,869:WARNING: 	 sim_header: meanP
2024-05-06 12:43:57,569:INFO: --------------------
2024-05-06 12:43:57,569:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:45:54,335:INFO: Effective parameters:
2024-05-06 12:45:54,335:INFO:   <<< batch_size: 1
2024-05-06 12:45:54,335:INFO:   <<< batch_size_val: 16
2024-05-06 12:45:54,335:INFO:   <<< cache_dir: 
2024-05-06 12:45:54,335:INFO:   <<< coef_lr: 0.001
2024-05-06 12:45:54,335:INFO:   <<< cross_model: cross-base
2024-05-06 12:45:54,335:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:45:54,335:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:45:54,335:INFO:   <<< datatype: msrvtt
2024-05-06 12:45:54,335:INFO:   <<< do_eval: True
2024-05-06 12:45:54,335:INFO:   <<< do_lower_case: False
2024-05-06 12:45:54,335:INFO:   <<< do_pretrain: False
2024-05-06 12:45:54,335:INFO:   <<< do_train: False
2024-05-06 12:45:54,335:INFO:   <<< epochs: 2
2024-05-06 12:45:54,336:INFO:   <<< eval_frame_order: 0
2024-05-06 12:45:54,336:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:45:54,336:INFO:   <<< feature_framerate: 1
2024-05-06 12:45:54,336:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:45:54,336:INFO:   <<< fp16: False
2024-05-06 12:45:54,336:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:45:54,336:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:45:54,336:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:45:54,336:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:45:54,336:INFO:   <<< init_model: None
2024-05-06 12:45:54,336:INFO:   <<< linear_patch: 2d
2024-05-06 12:45:54,336:INFO:   <<< local_rank: 0
2024-05-06 12:45:54,336:INFO:   <<< loose_type: True
2024-05-06 12:45:54,336:INFO:   <<< lr: 0.0001
2024-05-06 12:45:54,336:INFO:   <<< lr_decay: 0.9
2024-05-06 12:45:54,336:INFO:   <<< margin: 0.1
2024-05-06 12:45:54,336:INFO:   <<< max_frames: 90
2024-05-06 12:45:54,336:INFO:   <<< max_words: 32
2024-05-06 12:45:54,336:INFO:   <<< n_display: 100
2024-05-06 12:45:54,336:INFO:   <<< n_gpu: 1
2024-05-06 12:45:54,336:INFO:   <<< n_pair: 1
2024-05-06 12:45:54,336:INFO:   <<< negative_weighting: 1
2024-05-06 12:45:54,336:INFO:   <<< num_thread_reader: 0
2024-05-06 12:45:54,336:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:45:54,336:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:45:54,336:INFO:   <<< rank: 0
2024-05-06 12:45:54,336:INFO:   <<< resume_model: None
2024-05-06 12:45:54,336:INFO:   <<< sampled_use_mil: False
2024-05-06 12:45:54,336:INFO:   <<< seed: 42
2024-05-06 12:45:54,336:INFO:   <<< sim_header: meanP
2024-05-06 12:45:54,336:INFO:   <<< slice_framepos: 2
2024-05-06 12:45:54,336:INFO:   <<< task_type: retrieval
2024-05-06 12:45:54,336:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:45:54,336:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:45:54,336:INFO:   <<< train_frame_order: 0
2024-05-06 12:45:54,336:INFO:   <<< use_mil: False
2024-05-06 12:45:54,336:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:45:54,336:INFO:   <<< video_dim: 1024
2024-05-06 12:45:54,336:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:45:54,336:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:45:54,336:INFO:   <<< world_size: 1
2024-05-06 12:45:54,336:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:45:54,476:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-06 12:45:54,957:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:45:54,957:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:45:54,957:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:45:54,957:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:45:54,957:WARNING: Test retrieval by loose type.
2024-05-06 12:45:54,957:WARNING: 	 embed_dim: 512
2024-05-06 12:45:54,957:WARNING: 	 image_resolution: 224
2024-05-06 12:45:54,958:WARNING: 	 vision_layers: 12
2024-05-06 12:45:54,958:WARNING: 	 vision_width: 768
2024-05-06 12:45:54,958:WARNING: 	 vision_patch_size: 32
2024-05-06 12:45:54,958:WARNING: 	 context_length: 77
2024-05-06 12:45:54,958:WARNING: 	 vocab_size: 49408
2024-05-06 12:45:54,958:WARNING: 	 transformer_width: 512
2024-05-06 12:45:54,958:WARNING: 	 transformer_heads: 8
2024-05-06 12:45:54,958:WARNING: 	 transformer_layers: 12
2024-05-06 12:45:54,958:WARNING: 		 linear_patch: 2d
2024-05-06 12:45:54,958:WARNING: 	 cut_top_layer: 0
2024-05-06 12:45:55,805:WARNING: 	 sim_header: meanP
2024-05-06 12:45:59,490:INFO: --------------------
2024-05-06 12:45:59,490:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:47:24,542:INFO: Effective parameters:
2024-05-06 12:47:24,542:INFO:   <<< batch_size: 1
2024-05-06 12:47:24,542:INFO:   <<< batch_size_val: 16
2024-05-06 12:47:24,542:INFO:   <<< cache_dir: 
2024-05-06 12:47:24,542:INFO:   <<< coef_lr: 0.001
2024-05-06 12:47:24,542:INFO:   <<< cross_model: cross-base
2024-05-06 12:47:24,542:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:47:24,542:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:47:24,542:INFO:   <<< datatype: msrvtt
2024-05-06 12:47:24,542:INFO:   <<< do_eval: True
2024-05-06 12:47:24,542:INFO:   <<< do_lower_case: False
2024-05-06 12:47:24,542:INFO:   <<< do_pretrain: False
2024-05-06 12:47:24,542:INFO:   <<< do_train: False
2024-05-06 12:47:24,542:INFO:   <<< epochs: 2
2024-05-06 12:47:24,542:INFO:   <<< eval_frame_order: 0
2024-05-06 12:47:24,542:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:47:24,542:INFO:   <<< feature_framerate: 1
2024-05-06 12:47:24,542:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:47:24,542:INFO:   <<< fp16: False
2024-05-06 12:47:24,542:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:47:24,542:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:47:24,542:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:47:24,542:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:47:24,542:INFO:   <<< init_model: None
2024-05-06 12:47:24,542:INFO:   <<< linear_patch: 2d
2024-05-06 12:47:24,542:INFO:   <<< local_rank: 0
2024-05-06 12:47:24,542:INFO:   <<< loose_type: True
2024-05-06 12:47:24,542:INFO:   <<< lr: 0.0001
2024-05-06 12:47:24,542:INFO:   <<< lr_decay: 0.9
2024-05-06 12:47:24,542:INFO:   <<< margin: 0.1
2024-05-06 12:47:24,542:INFO:   <<< max_frames: 90
2024-05-06 12:47:24,542:INFO:   <<< max_words: 32
2024-05-06 12:47:24,542:INFO:   <<< n_display: 100
2024-05-06 12:47:24,542:INFO:   <<< n_gpu: 1
2024-05-06 12:47:24,542:INFO:   <<< n_pair: 1
2024-05-06 12:47:24,542:INFO:   <<< negative_weighting: 1
2024-05-06 12:47:24,543:INFO:   <<< num_thread_reader: 0
2024-05-06 12:47:24,543:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:47:24,543:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:47:24,543:INFO:   <<< rank: 0
2024-05-06 12:47:24,543:INFO:   <<< resume_model: None
2024-05-06 12:47:24,543:INFO:   <<< sampled_use_mil: False
2024-05-06 12:47:24,543:INFO:   <<< seed: 42
2024-05-06 12:47:24,543:INFO:   <<< sim_header: meanP
2024-05-06 12:47:24,543:INFO:   <<< slice_framepos: 2
2024-05-06 12:47:24,543:INFO:   <<< task_type: retrieval
2024-05-06 12:47:24,543:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:47:24,543:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:47:24,543:INFO:   <<< train_frame_order: 0
2024-05-06 12:47:24,543:INFO:   <<< use_mil: False
2024-05-06 12:47:24,543:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:47:24,543:INFO:   <<< video_dim: 1024
2024-05-06 12:47:24,543:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:47:24,543:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:47:24,543:INFO:   <<< world_size: 1
2024-05-06 12:47:24,543:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:47:25,043:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:47:25,043:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:47:25,043:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:47:25,044:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:47:25,044:WARNING: Test retrieval by loose type.
2024-05-06 12:47:25,044:WARNING: 	 embed_dim: 512
2024-05-06 12:47:25,044:WARNING: 	 image_resolution: 224
2024-05-06 12:47:25,044:WARNING: 	 vision_layers: 12
2024-05-06 12:47:25,044:WARNING: 	 vision_width: 768
2024-05-06 12:47:25,044:WARNING: 	 vision_patch_size: 32
2024-05-06 12:47:25,044:WARNING: 	 context_length: 77
2024-05-06 12:47:25,044:WARNING: 	 vocab_size: 49408
2024-05-06 12:47:25,044:WARNING: 	 transformer_width: 512
2024-05-06 12:47:25,044:WARNING: 	 transformer_heads: 8
2024-05-06 12:47:25,044:WARNING: 	 transformer_layers: 12
2024-05-06 12:47:25,044:WARNING: 		 linear_patch: 2d
2024-05-06 12:47:25,044:WARNING: 	 cut_top_layer: 0
2024-05-06 12:47:25,893:WARNING: 	 sim_header: meanP
2024-05-06 12:47:29,596:INFO: --------------------
2024-05-06 12:47:29,596:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:51:09,343:INFO: Effective parameters:
2024-05-06 12:51:09,343:INFO:   <<< batch_size: 1
2024-05-06 12:51:09,343:INFO:   <<< batch_size_val: 16
2024-05-06 12:51:09,343:INFO:   <<< cache_dir: 
2024-05-06 12:51:09,343:INFO:   <<< coef_lr: 0.001
2024-05-06 12:51:09,343:INFO:   <<< cross_model: cross-base
2024-05-06 12:51:09,343:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:51:09,343:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:51:09,343:INFO:   <<< datatype: msrvtt
2024-05-06 12:51:09,343:INFO:   <<< do_eval: True
2024-05-06 12:51:09,343:INFO:   <<< do_lower_case: False
2024-05-06 12:51:09,343:INFO:   <<< do_pretrain: False
2024-05-06 12:51:09,343:INFO:   <<< do_train: False
2024-05-06 12:51:09,343:INFO:   <<< epochs: 2
2024-05-06 12:51:09,343:INFO:   <<< eval_frame_order: 0
2024-05-06 12:51:09,343:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:51:09,343:INFO:   <<< feature_framerate: 1
2024-05-06 12:51:09,343:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:51:09,343:INFO:   <<< fp16: False
2024-05-06 12:51:09,343:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:51:09,343:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:51:09,343:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:51:09,343:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:51:09,343:INFO:   <<< init_model: None
2024-05-06 12:51:09,343:INFO:   <<< linear_patch: 2d
2024-05-06 12:51:09,343:INFO:   <<< local_rank: 0
2024-05-06 12:51:09,343:INFO:   <<< loose_type: True
2024-05-06 12:51:09,343:INFO:   <<< lr: 0.0001
2024-05-06 12:51:09,343:INFO:   <<< lr_decay: 0.9
2024-05-06 12:51:09,343:INFO:   <<< margin: 0.1
2024-05-06 12:51:09,343:INFO:   <<< max_frames: 90
2024-05-06 12:51:09,343:INFO:   <<< max_words: 32
2024-05-06 12:51:09,343:INFO:   <<< n_display: 100
2024-05-06 12:51:09,343:INFO:   <<< n_gpu: 1
2024-05-06 12:51:09,343:INFO:   <<< n_pair: 1
2024-05-06 12:51:09,343:INFO:   <<< negative_weighting: 1
2024-05-06 12:51:09,343:INFO:   <<< num_thread_reader: 0
2024-05-06 12:51:09,343:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:51:09,343:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:51:09,343:INFO:   <<< rank: 0
2024-05-06 12:51:09,343:INFO:   <<< resume_model: None
2024-05-06 12:51:09,343:INFO:   <<< sampled_use_mil: False
2024-05-06 12:51:09,343:INFO:   <<< seed: 42
2024-05-06 12:51:09,343:INFO:   <<< sim_header: meanP
2024-05-06 12:51:09,343:INFO:   <<< slice_framepos: 2
2024-05-06 12:51:09,343:INFO:   <<< task_type: retrieval
2024-05-06 12:51:09,343:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:51:09,343:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:51:09,344:INFO:   <<< train_frame_order: 0
2024-05-06 12:51:09,344:INFO:   <<< use_mil: False
2024-05-06 12:51:09,344:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:51:09,344:INFO:   <<< video_dim: 1024
2024-05-06 12:51:09,344:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:51:09,344:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:51:09,344:INFO:   <<< world_size: 1
2024-05-06 12:51:09,344:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:51:09,854:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:51:09,855:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:51:09,855:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:51:09,855:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:51:09,855:WARNING: Test retrieval by loose type.
2024-05-06 12:51:09,855:WARNING: 	 embed_dim: 512
2024-05-06 12:51:09,855:WARNING: 	 image_resolution: 224
2024-05-06 12:51:09,855:WARNING: 	 vision_layers: 12
2024-05-06 12:51:09,855:WARNING: 	 vision_width: 768
2024-05-06 12:51:09,855:WARNING: 	 vision_patch_size: 32
2024-05-06 12:51:09,855:WARNING: 	 context_length: 77
2024-05-06 12:51:09,855:WARNING: 	 vocab_size: 49408
2024-05-06 12:51:09,855:WARNING: 	 transformer_width: 512
2024-05-06 12:51:09,855:WARNING: 	 transformer_heads: 8
2024-05-06 12:51:09,855:WARNING: 	 transformer_layers: 12
2024-05-06 12:51:09,855:WARNING: 		 linear_patch: 2d
2024-05-06 12:51:09,855:WARNING: 	 cut_top_layer: 0
2024-05-06 12:51:10,729:WARNING: 	 sim_header: meanP
2024-05-06 12:51:14,447:INFO: --------------------
2024-05-06 12:51:14,448:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:52:40,703:INFO: Effective parameters:
2024-05-06 12:52:40,704:INFO:   <<< batch_size: 1
2024-05-06 12:52:40,704:INFO:   <<< batch_size_val: 16
2024-05-06 12:52:40,704:INFO:   <<< cache_dir: 
2024-05-06 12:52:40,704:INFO:   <<< coef_lr: 0.001
2024-05-06 12:52:40,704:INFO:   <<< cross_model: cross-base
2024-05-06 12:52:40,704:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:52:40,704:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:52:40,704:INFO:   <<< datatype: msrvtt
2024-05-06 12:52:40,704:INFO:   <<< do_eval: True
2024-05-06 12:52:40,704:INFO:   <<< do_lower_case: False
2024-05-06 12:52:40,704:INFO:   <<< do_pretrain: False
2024-05-06 12:52:40,704:INFO:   <<< do_train: False
2024-05-06 12:52:40,705:INFO:   <<< epochs: 2
2024-05-06 12:52:40,705:INFO:   <<< eval_frame_order: 0
2024-05-06 12:52:40,705:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:52:40,705:INFO:   <<< feature_framerate: 1
2024-05-06 12:52:40,705:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:52:40,705:INFO:   <<< fp16: False
2024-05-06 12:52:40,705:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:52:40,705:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:52:40,705:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:52:40,705:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:52:40,705:INFO:   <<< init_model: None
2024-05-06 12:52:40,705:INFO:   <<< linear_patch: 2d
2024-05-06 12:52:40,705:INFO:   <<< local_rank: 0
2024-05-06 12:52:40,705:INFO:   <<< loose_type: True
2024-05-06 12:52:40,706:INFO:   <<< lr: 0.0001
2024-05-06 12:52:40,706:INFO:   <<< lr_decay: 0.9
2024-05-06 12:52:40,706:INFO:   <<< margin: 0.1
2024-05-06 12:52:40,706:INFO:   <<< max_frames: 90
2024-05-06 12:52:40,706:INFO:   <<< max_words: 32
2024-05-06 12:52:40,706:INFO:   <<< n_display: 100
2024-05-06 12:52:40,706:INFO:   <<< n_gpu: 1
2024-05-06 12:52:40,706:INFO:   <<< n_pair: 1
2024-05-06 12:52:40,706:INFO:   <<< negative_weighting: 1
2024-05-06 12:52:40,706:INFO:   <<< num_thread_reader: 0
2024-05-06 12:52:40,706:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:52:40,706:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:52:40,706:INFO:   <<< rank: 0
2024-05-06 12:52:40,706:INFO:   <<< resume_model: None
2024-05-06 12:52:40,706:INFO:   <<< sampled_use_mil: False
2024-05-06 12:52:40,707:INFO:   <<< seed: 42
2024-05-06 12:52:40,707:INFO:   <<< sim_header: meanP
2024-05-06 12:52:40,707:INFO:   <<< slice_framepos: 2
2024-05-06 12:52:40,707:INFO:   <<< task_type: retrieval
2024-05-06 12:52:40,707:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:52:40,707:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:52:40,707:INFO:   <<< train_frame_order: 0
2024-05-06 12:52:40,707:INFO:   <<< use_mil: False
2024-05-06 12:52:40,707:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:52:40,707:INFO:   <<< video_dim: 1024
2024-05-06 12:52:40,707:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:52:40,707:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:52:40,707:INFO:   <<< world_size: 1
2024-05-06 12:52:40,708:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:52:41,231:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:52:41,233:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:52:41,233:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:52:41,233:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:52:41,233:WARNING: Test retrieval by loose type.
2024-05-06 12:52:41,234:WARNING: 	 embed_dim: 512
2024-05-06 12:52:41,234:WARNING: 	 image_resolution: 224
2024-05-06 12:52:41,234:WARNING: 	 vision_layers: 12
2024-05-06 12:52:41,234:WARNING: 	 vision_width: 768
2024-05-06 12:52:41,234:WARNING: 	 vision_patch_size: 32
2024-05-06 12:52:41,234:WARNING: 	 context_length: 77
2024-05-06 12:52:41,235:WARNING: 	 vocab_size: 49408
2024-05-06 12:52:41,235:WARNING: 	 transformer_width: 512
2024-05-06 12:52:41,235:WARNING: 	 transformer_heads: 8
2024-05-06 12:52:41,235:WARNING: 	 transformer_layers: 12
2024-05-06 12:52:41,235:WARNING: 		 linear_patch: 2d
2024-05-06 12:52:41,235:WARNING: 	 cut_top_layer: 0
2024-05-06 12:52:42,103:WARNING: 	 sim_header: meanP
2024-05-06 12:52:45,791:INFO: --------------------
2024-05-06 12:52:45,791:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:54:15,443:INFO: Effective parameters:
2024-05-06 12:54:15,444:INFO:   <<< batch_size: 1
2024-05-06 12:54:15,444:INFO:   <<< batch_size_val: 16
2024-05-06 12:54:15,444:INFO:   <<< cache_dir: 
2024-05-06 12:54:15,444:INFO:   <<< coef_lr: 0.001
2024-05-06 12:54:15,444:INFO:   <<< cross_model: cross-base
2024-05-06 12:54:15,444:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:54:15,444:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:54:15,444:INFO:   <<< datatype: msrvtt
2024-05-06 12:54:15,444:INFO:   <<< do_eval: True
2024-05-06 12:54:15,444:INFO:   <<< do_lower_case: False
2024-05-06 12:54:15,445:INFO:   <<< do_pretrain: False
2024-05-06 12:54:15,445:INFO:   <<< do_train: False
2024-05-06 12:54:15,445:INFO:   <<< epochs: 2
2024-05-06 12:54:15,445:INFO:   <<< eval_frame_order: 0
2024-05-06 12:54:15,445:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:54:15,445:INFO:   <<< feature_framerate: 1
2024-05-06 12:54:15,445:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:54:15,445:INFO:   <<< fp16: False
2024-05-06 12:54:15,445:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:54:15,445:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:54:15,445:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:54:15,445:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:54:15,445:INFO:   <<< init_model: None
2024-05-06 12:54:15,445:INFO:   <<< linear_patch: 2d
2024-05-06 12:54:15,446:INFO:   <<< local_rank: 0
2024-05-06 12:54:15,446:INFO:   <<< loose_type: True
2024-05-06 12:54:15,446:INFO:   <<< lr: 0.0001
2024-05-06 12:54:15,446:INFO:   <<< lr_decay: 0.9
2024-05-06 12:54:15,446:INFO:   <<< margin: 0.1
2024-05-06 12:54:15,446:INFO:   <<< max_frames: 90
2024-05-06 12:54:15,446:INFO:   <<< max_words: 32
2024-05-06 12:54:15,446:INFO:   <<< n_display: 100
2024-05-06 12:54:15,446:INFO:   <<< n_gpu: 1
2024-05-06 12:54:15,446:INFO:   <<< n_pair: 1
2024-05-06 12:54:15,446:INFO:   <<< negative_weighting: 1
2024-05-06 12:54:15,446:INFO:   <<< num_thread_reader: 0
2024-05-06 12:54:15,446:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:54:15,446:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:54:15,447:INFO:   <<< rank: 0
2024-05-06 12:54:15,447:INFO:   <<< resume_model: None
2024-05-06 12:54:15,447:INFO:   <<< sampled_use_mil: False
2024-05-06 12:54:15,447:INFO:   <<< seed: 42
2024-05-06 12:54:15,447:INFO:   <<< sim_header: meanP
2024-05-06 12:54:15,447:INFO:   <<< slice_framepos: 2
2024-05-06 12:54:15,447:INFO:   <<< task_type: retrieval
2024-05-06 12:54:15,447:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:54:15,447:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:54:15,447:INFO:   <<< train_frame_order: 0
2024-05-06 12:54:15,447:INFO:   <<< use_mil: False
2024-05-06 12:54:15,447:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:54:15,448:INFO:   <<< video_dim: 1024
2024-05-06 12:54:15,448:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:54:15,448:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:54:15,448:INFO:   <<< world_size: 1
2024-05-06 12:54:15,448:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:54:15,994:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:54:15,995:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:54:15,995:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:54:15,996:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:54:15,996:WARNING: Test retrieval by loose type.
2024-05-06 12:54:15,996:WARNING: 	 embed_dim: 512
2024-05-06 12:54:15,996:WARNING: 	 image_resolution: 224
2024-05-06 12:54:15,997:WARNING: 	 vision_layers: 12
2024-05-06 12:54:15,997:WARNING: 	 vision_width: 768
2024-05-06 12:54:15,997:WARNING: 	 vision_patch_size: 32
2024-05-06 12:54:15,997:WARNING: 	 context_length: 77
2024-05-06 12:54:15,997:WARNING: 	 vocab_size: 49408
2024-05-06 12:54:15,997:WARNING: 	 transformer_width: 512
2024-05-06 12:54:15,997:WARNING: 	 transformer_heads: 8
2024-05-06 12:54:15,997:WARNING: 	 transformer_layers: 12
2024-05-06 12:54:15,997:WARNING: 		 linear_patch: 2d
2024-05-06 12:54:15,997:WARNING: 	 cut_top_layer: 0
2024-05-06 12:54:16,870:WARNING: 	 sim_header: meanP
2024-05-06 12:54:19,672:INFO: Effective parameters:
2024-05-06 12:54:19,672:INFO:   <<< batch_size: 1
2024-05-06 12:54:19,672:INFO:   <<< batch_size_val: 16
2024-05-06 12:54:19,672:INFO:   <<< cache_dir: 
2024-05-06 12:54:19,672:INFO:   <<< coef_lr: 0.001
2024-05-06 12:54:19,672:INFO:   <<< cross_model: cross-base
2024-05-06 12:54:19,672:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:54:19,672:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:54:19,672:INFO:   <<< datatype: msrvtt
2024-05-06 12:54:19,672:INFO:   <<< do_eval: True
2024-05-06 12:54:19,672:INFO:   <<< do_lower_case: False
2024-05-06 12:54:19,672:INFO:   <<< do_pretrain: False
2024-05-06 12:54:19,672:INFO:   <<< do_train: False
2024-05-06 12:54:19,672:INFO:   <<< epochs: 2
2024-05-06 12:54:19,672:INFO:   <<< eval_frame_order: 0
2024-05-06 12:54:19,672:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:54:19,672:INFO:   <<< feature_framerate: 1
2024-05-06 12:54:19,672:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:54:19,672:INFO:   <<< fp16: False
2024-05-06 12:54:19,673:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:54:19,673:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:54:19,673:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:54:19,673:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:54:19,673:INFO:   <<< init_model: None
2024-05-06 12:54:19,673:INFO:   <<< linear_patch: 2d
2024-05-06 12:54:19,673:INFO:   <<< local_rank: 0
2024-05-06 12:54:19,673:INFO:   <<< loose_type: True
2024-05-06 12:54:19,673:INFO:   <<< lr: 0.0001
2024-05-06 12:54:19,673:INFO:   <<< lr_decay: 0.9
2024-05-06 12:54:19,673:INFO:   <<< margin: 0.1
2024-05-06 12:54:19,673:INFO:   <<< max_frames: 90
2024-05-06 12:54:19,673:INFO:   <<< max_words: 32
2024-05-06 12:54:19,673:INFO:   <<< n_display: 100
2024-05-06 12:54:19,673:INFO:   <<< n_gpu: 1
2024-05-06 12:54:19,673:INFO:   <<< n_pair: 1
2024-05-06 12:54:19,673:INFO:   <<< negative_weighting: 1
2024-05-06 12:54:19,673:INFO:   <<< num_thread_reader: 0
2024-05-06 12:54:19,673:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:54:19,673:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:54:19,673:INFO:   <<< rank: 0
2024-05-06 12:54:19,673:INFO:   <<< resume_model: None
2024-05-06 12:54:19,673:INFO:   <<< sampled_use_mil: False
2024-05-06 12:54:19,673:INFO:   <<< seed: 42
2024-05-06 12:54:19,673:INFO:   <<< sim_header: meanP
2024-05-06 12:54:19,673:INFO:   <<< slice_framepos: 2
2024-05-06 12:54:19,673:INFO:   <<< task_type: retrieval
2024-05-06 12:54:19,673:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:54:19,673:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:54:19,673:INFO:   <<< train_frame_order: 0
2024-05-06 12:54:19,673:INFO:   <<< use_mil: False
2024-05-06 12:54:19,673:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:54:19,673:INFO:   <<< video_dim: 1024
2024-05-06 12:54:19,673:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:54:19,673:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:54:19,673:INFO:   <<< world_size: 1
2024-05-06 12:54:19,673:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:54:20,178:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:54:20,178:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:54:20,179:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:54:20,179:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:54:20,179:WARNING: Test retrieval by loose type.
2024-05-06 12:54:20,179:WARNING: 	 embed_dim: 512
2024-05-06 12:54:20,179:WARNING: 	 image_resolution: 224
2024-05-06 12:54:20,179:WARNING: 	 vision_layers: 12
2024-05-06 12:54:20,179:WARNING: 	 vision_width: 768
2024-05-06 12:54:20,179:WARNING: 	 vision_patch_size: 32
2024-05-06 12:54:20,179:WARNING: 	 context_length: 77
2024-05-06 12:54:20,179:WARNING: 	 vocab_size: 49408
2024-05-06 12:54:20,179:WARNING: 	 transformer_width: 512
2024-05-06 12:54:20,179:WARNING: 	 transformer_heads: 8
2024-05-06 12:54:20,179:WARNING: 	 transformer_layers: 12
2024-05-06 12:54:20,179:WARNING: 		 linear_patch: 2d
2024-05-06 12:54:20,179:WARNING: 	 cut_top_layer: 0
2024-05-06 12:54:21,049:WARNING: 	 sim_header: meanP
2024-05-06 12:54:24,727:INFO: --------------------
2024-05-06 12:54:24,727:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 12:57:32,170:INFO: Effective parameters:
2024-05-06 12:57:32,170:INFO:   <<< batch_size: 1
2024-05-06 12:57:32,170:INFO:   <<< batch_size_val: 16
2024-05-06 12:57:32,170:INFO:   <<< cache_dir: 
2024-05-06 12:57:32,170:INFO:   <<< coef_lr: 0.001
2024-05-06 12:57:32,170:INFO:   <<< cross_model: cross-base
2024-05-06 12:57:32,170:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 12:57:32,170:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 12:57:32,170:INFO:   <<< datatype: msrvtt
2024-05-06 12:57:32,170:INFO:   <<< do_eval: True
2024-05-06 12:57:32,170:INFO:   <<< do_lower_case: False
2024-05-06 12:57:32,170:INFO:   <<< do_pretrain: False
2024-05-06 12:57:32,170:INFO:   <<< do_train: False
2024-05-06 12:57:32,170:INFO:   <<< epochs: 2
2024-05-06 12:57:32,170:INFO:   <<< eval_frame_order: 0
2024-05-06 12:57:32,170:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 12:57:32,170:INFO:   <<< feature_framerate: 1
2024-05-06 12:57:32,170:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 12:57:32,170:INFO:   <<< fp16: False
2024-05-06 12:57:32,170:INFO:   <<< fp16_opt_level: O1
2024-05-06 12:57:32,171:INFO:   <<< freeze_layer_num: 0
2024-05-06 12:57:32,171:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 12:57:32,171:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 12:57:32,171:INFO:   <<< init_model: None
2024-05-06 12:57:32,171:INFO:   <<< linear_patch: 2d
2024-05-06 12:57:32,171:INFO:   <<< local_rank: 0
2024-05-06 12:57:32,171:INFO:   <<< loose_type: True
2024-05-06 12:57:32,171:INFO:   <<< lr: 0.0001
2024-05-06 12:57:32,171:INFO:   <<< lr_decay: 0.9
2024-05-06 12:57:32,171:INFO:   <<< margin: 0.1
2024-05-06 12:57:32,171:INFO:   <<< max_frames: 90
2024-05-06 12:57:32,171:INFO:   <<< max_words: 32
2024-05-06 12:57:32,171:INFO:   <<< n_display: 100
2024-05-06 12:57:32,171:INFO:   <<< n_gpu: 1
2024-05-06 12:57:32,171:INFO:   <<< n_pair: 1
2024-05-06 12:57:32,171:INFO:   <<< negative_weighting: 1
2024-05-06 12:57:32,171:INFO:   <<< num_thread_reader: 0
2024-05-06 12:57:32,171:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 12:57:32,171:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 12:57:32,171:INFO:   <<< rank: 0
2024-05-06 12:57:32,171:INFO:   <<< resume_model: None
2024-05-06 12:57:32,171:INFO:   <<< sampled_use_mil: False
2024-05-06 12:57:32,171:INFO:   <<< seed: 42
2024-05-06 12:57:32,171:INFO:   <<< sim_header: meanP
2024-05-06 12:57:32,171:INFO:   <<< slice_framepos: 2
2024-05-06 12:57:32,171:INFO:   <<< task_type: retrieval
2024-05-06 12:57:32,171:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 12:57:32,171:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 12:57:32,171:INFO:   <<< train_frame_order: 0
2024-05-06 12:57:32,171:INFO:   <<< use_mil: False
2024-05-06 12:57:32,171:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 12:57:32,171:INFO:   <<< video_dim: 1024
2024-05-06 12:57:32,171:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 12:57:32,171:INFO:   <<< warmup_proportion: 0.1
2024-05-06 12:57:32,171:INFO:   <<< world_size: 1
2024-05-06 12:57:32,171:INFO: device: cuda:0 n_gpu: 1
2024-05-06 12:57:32,674:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 12:57:32,674:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 12:57:32,675:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 12:57:32,675:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 12:57:32,675:WARNING: Test retrieval by loose type.
2024-05-06 12:57:32,675:WARNING: 	 embed_dim: 512
2024-05-06 12:57:32,675:WARNING: 	 image_resolution: 224
2024-05-06 12:57:32,675:WARNING: 	 vision_layers: 12
2024-05-06 12:57:32,675:WARNING: 	 vision_width: 768
2024-05-06 12:57:32,675:WARNING: 	 vision_patch_size: 32
2024-05-06 12:57:32,675:WARNING: 	 context_length: 77
2024-05-06 12:57:32,675:WARNING: 	 vocab_size: 49408
2024-05-06 12:57:32,675:WARNING: 	 transformer_width: 512
2024-05-06 12:57:32,675:WARNING: 	 transformer_heads: 8
2024-05-06 12:57:32,675:WARNING: 	 transformer_layers: 12
2024-05-06 12:57:32,675:WARNING: 		 linear_patch: 2d
2024-05-06 12:57:32,675:WARNING: 	 cut_top_layer: 0
2024-05-06 12:57:33,526:WARNING: 	 sim_header: meanP
2024-05-06 12:57:37,248:INFO: --------------------
2024-05-06 12:57:37,248:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:17:22,458:INFO: Effective parameters:
2024-05-06 13:17:22,458:INFO:   <<< batch_size: 1
2024-05-06 13:17:22,458:INFO:   <<< batch_size_val: 16
2024-05-06 13:17:22,459:INFO:   <<< cache_dir: 
2024-05-06 13:17:22,459:INFO:   <<< coef_lr: 0.001
2024-05-06 13:17:22,459:INFO:   <<< cross_model: cross-base
2024-05-06 13:17:22,459:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:17:22,459:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:17:22,459:INFO:   <<< datatype: msrvtt
2024-05-06 13:17:22,459:INFO:   <<< do_eval: True
2024-05-06 13:17:22,459:INFO:   <<< do_lower_case: False
2024-05-06 13:17:22,459:INFO:   <<< do_pretrain: False
2024-05-06 13:17:22,459:INFO:   <<< do_train: False
2024-05-06 13:17:22,459:INFO:   <<< epochs: 2
2024-05-06 13:17:22,459:INFO:   <<< eval_frame_order: 0
2024-05-06 13:17:22,459:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:17:22,459:INFO:   <<< feature_framerate: 1
2024-05-06 13:17:22,459:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:17:22,459:INFO:   <<< fp16: False
2024-05-06 13:17:22,459:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:17:22,460:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:17:22,460:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:17:22,460:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:17:22,460:INFO:   <<< init_model: None
2024-05-06 13:17:22,460:INFO:   <<< linear_patch: 2d
2024-05-06 13:17:22,460:INFO:   <<< local_rank: 0
2024-05-06 13:17:22,460:INFO:   <<< loose_type: True
2024-05-06 13:17:22,460:INFO:   <<< lr: 0.0001
2024-05-06 13:17:22,460:INFO:   <<< lr_decay: 0.9
2024-05-06 13:17:22,460:INFO:   <<< margin: 0.1
2024-05-06 13:17:22,460:INFO:   <<< max_frames: 90
2024-05-06 13:17:22,460:INFO:   <<< max_words: 32
2024-05-06 13:17:22,460:INFO:   <<< n_display: 100
2024-05-06 13:17:22,460:INFO:   <<< n_gpu: 1
2024-05-06 13:17:22,460:INFO:   <<< n_pair: 1
2024-05-06 13:17:22,460:INFO:   <<< negative_weighting: 1
2024-05-06 13:17:22,460:INFO:   <<< num_thread_reader: 0
2024-05-06 13:17:22,461:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:17:22,461:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:17:22,461:INFO:   <<< rank: 0
2024-05-06 13:17:22,461:INFO:   <<< resume_model: None
2024-05-06 13:17:22,461:INFO:   <<< sampled_use_mil: False
2024-05-06 13:17:22,461:INFO:   <<< seed: 42
2024-05-06 13:17:22,461:INFO:   <<< sim_header: meanP
2024-05-06 13:17:22,461:INFO:   <<< slice_framepos: 2
2024-05-06 13:17:22,461:INFO:   <<< task_type: retrieval
2024-05-06 13:17:22,461:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:17:22,461:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:17:22,461:INFO:   <<< train_frame_order: 0
2024-05-06 13:17:22,461:INFO:   <<< use_mil: False
2024-05-06 13:17:22,461:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:17:22,461:INFO:   <<< video_dim: 1024
2024-05-06 13:17:22,461:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:17:22,461:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:17:22,462:INFO:   <<< world_size: 1
2024-05-06 13:17:22,462:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:17:22,995:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:17:22,996:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:17:22,996:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:17:22,996:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:17:22,997:WARNING: Test retrieval by loose type.
2024-05-06 13:17:22,997:WARNING: 	 embed_dim: 512
2024-05-06 13:17:22,997:WARNING: 	 image_resolution: 224
2024-05-06 13:17:22,997:WARNING: 	 vision_layers: 12
2024-05-06 13:17:22,998:WARNING: 	 vision_width: 768
2024-05-06 13:17:22,998:WARNING: 	 vision_patch_size: 32
2024-05-06 13:17:22,998:WARNING: 	 context_length: 77
2024-05-06 13:17:22,998:WARNING: 	 vocab_size: 49408
2024-05-06 13:17:22,998:WARNING: 	 transformer_width: 512
2024-05-06 13:17:22,998:WARNING: 	 transformer_heads: 8
2024-05-06 13:17:22,998:WARNING: 	 transformer_layers: 12
2024-05-06 13:17:22,998:WARNING: 		 linear_patch: 2d
2024-05-06 13:17:22,998:WARNING: 	 cut_top_layer: 0
2024-05-06 13:17:23,867:WARNING: 	 sim_header: meanP
2024-05-06 13:17:27,555:INFO: --------------------
2024-05-06 13:17:27,555:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:19:01,472:INFO: Effective parameters:
2024-05-06 13:19:01,472:INFO:   <<< batch_size: 1
2024-05-06 13:19:01,472:INFO:   <<< batch_size_val: 16
2024-05-06 13:19:01,472:INFO:   <<< cache_dir: 
2024-05-06 13:19:01,472:INFO:   <<< coef_lr: 0.001
2024-05-06 13:19:01,472:INFO:   <<< cross_model: cross-base
2024-05-06 13:19:01,472:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:19:01,472:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:19:01,472:INFO:   <<< datatype: msrvtt
2024-05-06 13:19:01,472:INFO:   <<< do_eval: True
2024-05-06 13:19:01,473:INFO:   <<< do_lower_case: False
2024-05-06 13:19:01,473:INFO:   <<< do_pretrain: False
2024-05-06 13:19:01,473:INFO:   <<< do_train: False
2024-05-06 13:19:01,473:INFO:   <<< epochs: 2
2024-05-06 13:19:01,473:INFO:   <<< eval_frame_order: 0
2024-05-06 13:19:01,473:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:19:01,473:INFO:   <<< feature_framerate: 1
2024-05-06 13:19:01,473:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:19:01,473:INFO:   <<< fp16: False
2024-05-06 13:19:01,473:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:19:01,473:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:19:01,473:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:19:01,473:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:19:01,473:INFO:   <<< init_model: None
2024-05-06 13:19:01,473:INFO:   <<< linear_patch: 2d
2024-05-06 13:19:01,473:INFO:   <<< local_rank: 0
2024-05-06 13:19:01,473:INFO:   <<< loose_type: True
2024-05-06 13:19:01,474:INFO:   <<< lr: 0.0001
2024-05-06 13:19:01,474:INFO:   <<< lr_decay: 0.9
2024-05-06 13:19:01,474:INFO:   <<< margin: 0.1
2024-05-06 13:19:01,474:INFO:   <<< max_frames: 90
2024-05-06 13:19:01,474:INFO:   <<< max_words: 32
2024-05-06 13:19:01,474:INFO:   <<< n_display: 100
2024-05-06 13:19:01,474:INFO:   <<< n_gpu: 1
2024-05-06 13:19:01,474:INFO:   <<< n_pair: 1
2024-05-06 13:19:01,474:INFO:   <<< negative_weighting: 1
2024-05-06 13:19:01,474:INFO:   <<< num_thread_reader: 0
2024-05-06 13:19:01,474:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:19:01,474:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:19:01,474:INFO:   <<< rank: 0
2024-05-06 13:19:01,474:INFO:   <<< resume_model: None
2024-05-06 13:19:01,474:INFO:   <<< sampled_use_mil: False
2024-05-06 13:19:01,474:INFO:   <<< seed: 42
2024-05-06 13:19:01,474:INFO:   <<< sim_header: meanP
2024-05-06 13:19:01,475:INFO:   <<< slice_framepos: 2
2024-05-06 13:19:01,475:INFO:   <<< task_type: retrieval
2024-05-06 13:19:01,475:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:19:01,475:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:19:01,475:INFO:   <<< train_frame_order: 0
2024-05-06 13:19:01,475:INFO:   <<< use_mil: False
2024-05-06 13:19:01,475:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:19:01,475:INFO:   <<< video_dim: 1024
2024-05-06 13:19:01,475:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:19:01,475:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:19:01,475:INFO:   <<< world_size: 1
2024-05-06 13:19:01,475:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:19:02,000:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:19:02,001:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:19:02,001:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:19:02,001:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:19:02,001:WARNING: Test retrieval by loose type.
2024-05-06 13:19:02,002:WARNING: 	 embed_dim: 512
2024-05-06 13:19:02,002:WARNING: 	 image_resolution: 224
2024-05-06 13:19:02,002:WARNING: 	 vision_layers: 12
2024-05-06 13:19:02,002:WARNING: 	 vision_width: 768
2024-05-06 13:19:02,002:WARNING: 	 vision_patch_size: 32
2024-05-06 13:19:02,002:WARNING: 	 context_length: 77
2024-05-06 13:19:02,002:WARNING: 	 vocab_size: 49408
2024-05-06 13:19:02,003:WARNING: 	 transformer_width: 512
2024-05-06 13:19:02,003:WARNING: 	 transformer_heads: 8
2024-05-06 13:19:02,003:WARNING: 	 transformer_layers: 12
2024-05-06 13:19:02,003:WARNING: 		 linear_patch: 2d
2024-05-06 13:19:02,003:WARNING: 	 cut_top_layer: 0
2024-05-06 13:19:02,861:WARNING: 	 sim_header: meanP
2024-05-06 13:19:06,562:INFO: --------------------
2024-05-06 13:19:06,562:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:21:35,397:INFO: Effective parameters:
2024-05-06 13:21:35,397:INFO:   <<< batch_size: 1
2024-05-06 13:21:35,397:INFO:   <<< batch_size_val: 16
2024-05-06 13:21:35,397:INFO:   <<< cache_dir: 
2024-05-06 13:21:35,397:INFO:   <<< coef_lr: 0.001
2024-05-06 13:21:35,397:INFO:   <<< cross_model: cross-base
2024-05-06 13:21:35,397:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:21:35,398:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:21:35,398:INFO:   <<< datatype: msrvtt
2024-05-06 13:21:35,398:INFO:   <<< do_eval: True
2024-05-06 13:21:35,398:INFO:   <<< do_lower_case: False
2024-05-06 13:21:35,398:INFO:   <<< do_pretrain: False
2024-05-06 13:21:35,398:INFO:   <<< do_train: False
2024-05-06 13:21:35,398:INFO:   <<< epochs: 2
2024-05-06 13:21:35,398:INFO:   <<< eval_frame_order: 0
2024-05-06 13:21:35,398:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:21:35,398:INFO:   <<< feature_framerate: 1
2024-05-06 13:21:35,398:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:21:35,398:INFO:   <<< fp16: False
2024-05-06 13:21:35,398:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:21:35,398:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:21:35,398:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:21:35,398:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:21:35,398:INFO:   <<< init_model: None
2024-05-06 13:21:35,398:INFO:   <<< linear_patch: 2d
2024-05-06 13:21:35,398:INFO:   <<< local_rank: 0
2024-05-06 13:21:35,398:INFO:   <<< loose_type: True
2024-05-06 13:21:35,398:INFO:   <<< lr: 0.0001
2024-05-06 13:21:35,398:INFO:   <<< lr_decay: 0.9
2024-05-06 13:21:35,398:INFO:   <<< margin: 0.1
2024-05-06 13:21:35,398:INFO:   <<< max_frames: 90
2024-05-06 13:21:35,398:INFO:   <<< max_words: 32
2024-05-06 13:21:35,398:INFO:   <<< n_display: 100
2024-05-06 13:21:35,398:INFO:   <<< n_gpu: 1
2024-05-06 13:21:35,398:INFO:   <<< n_pair: 1
2024-05-06 13:21:35,398:INFO:   <<< negative_weighting: 1
2024-05-06 13:21:35,398:INFO:   <<< num_thread_reader: 0
2024-05-06 13:21:35,398:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:21:35,398:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:21:35,398:INFO:   <<< rank: 0
2024-05-06 13:21:35,398:INFO:   <<< resume_model: None
2024-05-06 13:21:35,398:INFO:   <<< sampled_use_mil: False
2024-05-06 13:21:35,398:INFO:   <<< seed: 42
2024-05-06 13:21:35,398:INFO:   <<< sim_header: meanP
2024-05-06 13:21:35,398:INFO:   <<< slice_framepos: 2
2024-05-06 13:21:35,398:INFO:   <<< task_type: retrieval
2024-05-06 13:21:35,398:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:21:35,398:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:21:35,398:INFO:   <<< train_frame_order: 0
2024-05-06 13:21:35,398:INFO:   <<< use_mil: False
2024-05-06 13:21:35,398:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:21:35,399:INFO:   <<< video_dim: 1024
2024-05-06 13:21:35,399:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:21:35,399:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:21:35,399:INFO:   <<< world_size: 1
2024-05-06 13:21:35,399:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:21:35,930:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:21:35,930:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:21:35,930:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:21:35,930:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:21:35,930:WARNING: Test retrieval by loose type.
2024-05-06 13:21:35,931:WARNING: 	 embed_dim: 512
2024-05-06 13:21:35,931:WARNING: 	 image_resolution: 224
2024-05-06 13:21:35,931:WARNING: 	 vision_layers: 12
2024-05-06 13:21:35,931:WARNING: 	 vision_width: 768
2024-05-06 13:21:35,931:WARNING: 	 vision_patch_size: 32
2024-05-06 13:21:35,931:WARNING: 	 context_length: 77
2024-05-06 13:21:35,931:WARNING: 	 vocab_size: 49408
2024-05-06 13:21:35,931:WARNING: 	 transformer_width: 512
2024-05-06 13:21:35,931:WARNING: 	 transformer_heads: 8
2024-05-06 13:21:35,931:WARNING: 	 transformer_layers: 12
2024-05-06 13:21:35,932:WARNING: 		 linear_patch: 2d
2024-05-06 13:21:35,932:WARNING: 	 cut_top_layer: 0
2024-05-06 13:21:36,775:WARNING: 	 sim_header: meanP
2024-05-06 13:21:40,486:INFO: --------------------
2024-05-06 13:21:40,486:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:27:12,501:INFO: Effective parameters:
2024-05-06 13:27:12,501:INFO:   <<< batch_size: 1
2024-05-06 13:27:12,501:INFO:   <<< batch_size_val: 16
2024-05-06 13:27:12,501:INFO:   <<< cache_dir: 
2024-05-06 13:27:12,501:INFO:   <<< coef_lr: 0.001
2024-05-06 13:27:12,501:INFO:   <<< cross_model: cross-base
2024-05-06 13:27:12,501:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:27:12,501:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:27:12,501:INFO:   <<< datatype: msrvtt
2024-05-06 13:27:12,501:INFO:   <<< do_eval: True
2024-05-06 13:27:12,501:INFO:   <<< do_lower_case: False
2024-05-06 13:27:12,501:INFO:   <<< do_pretrain: False
2024-05-06 13:27:12,501:INFO:   <<< do_train: False
2024-05-06 13:27:12,501:INFO:   <<< epochs: 2
2024-05-06 13:27:12,501:INFO:   <<< eval_frame_order: 0
2024-05-06 13:27:12,501:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:27:12,501:INFO:   <<< feature_framerate: 1
2024-05-06 13:27:12,501:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:27:12,501:INFO:   <<< fp16: False
2024-05-06 13:27:12,501:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:27:12,501:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:27:12,501:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:27:12,502:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:27:12,502:INFO:   <<< init_model: None
2024-05-06 13:27:12,502:INFO:   <<< linear_patch: 2d
2024-05-06 13:27:12,502:INFO:   <<< local_rank: 0
2024-05-06 13:27:12,502:INFO:   <<< loose_type: True
2024-05-06 13:27:12,502:INFO:   <<< lr: 0.0001
2024-05-06 13:27:12,502:INFO:   <<< lr_decay: 0.9
2024-05-06 13:27:12,502:INFO:   <<< margin: 0.1
2024-05-06 13:27:12,502:INFO:   <<< max_frames: 90
2024-05-06 13:27:12,502:INFO:   <<< max_words: 32
2024-05-06 13:27:12,502:INFO:   <<< n_display: 100
2024-05-06 13:27:12,502:INFO:   <<< n_gpu: 1
2024-05-06 13:27:12,502:INFO:   <<< n_pair: 1
2024-05-06 13:27:12,502:INFO:   <<< negative_weighting: 1
2024-05-06 13:27:12,502:INFO:   <<< num_thread_reader: 0
2024-05-06 13:27:12,502:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:27:12,502:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:27:12,502:INFO:   <<< rank: 0
2024-05-06 13:27:12,502:INFO:   <<< resume_model: None
2024-05-06 13:27:12,502:INFO:   <<< sampled_use_mil: False
2024-05-06 13:27:12,502:INFO:   <<< seed: 42
2024-05-06 13:27:12,502:INFO:   <<< sim_header: meanP
2024-05-06 13:27:12,502:INFO:   <<< slice_framepos: 2
2024-05-06 13:27:12,502:INFO:   <<< task_type: retrieval
2024-05-06 13:27:12,502:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:27:12,502:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:27:12,502:INFO:   <<< train_frame_order: 0
2024-05-06 13:27:12,502:INFO:   <<< use_mil: False
2024-05-06 13:27:12,502:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:27:12,502:INFO:   <<< video_dim: 1024
2024-05-06 13:27:12,502:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:27:12,502:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:27:12,502:INFO:   <<< world_size: 1
2024-05-06 13:27:12,502:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:27:12,995:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:27:12,995:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:27:12,995:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:27:12,995:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:27:12,995:WARNING: Test retrieval by loose type.
2024-05-06 13:27:12,995:WARNING: 	 embed_dim: 512
2024-05-06 13:27:12,996:WARNING: 	 image_resolution: 224
2024-05-06 13:27:12,996:WARNING: 	 vision_layers: 12
2024-05-06 13:27:12,996:WARNING: 	 vision_width: 768
2024-05-06 13:27:12,996:WARNING: 	 vision_patch_size: 32
2024-05-06 13:27:12,996:WARNING: 	 context_length: 77
2024-05-06 13:27:12,996:WARNING: 	 vocab_size: 49408
2024-05-06 13:27:12,996:WARNING: 	 transformer_width: 512
2024-05-06 13:27:12,996:WARNING: 	 transformer_heads: 8
2024-05-06 13:27:12,996:WARNING: 	 transformer_layers: 12
2024-05-06 13:27:12,996:WARNING: 		 linear_patch: 2d
2024-05-06 13:27:12,996:WARNING: 	 cut_top_layer: 0
2024-05-06 13:27:13,831:WARNING: 	 sim_header: meanP
2024-05-06 13:27:17,465:INFO: --------------------
2024-05-06 13:27:17,465:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:29:03,529:INFO: Effective parameters:
2024-05-06 13:29:03,530:INFO:   <<< batch_size: 1
2024-05-06 13:29:03,530:INFO:   <<< batch_size_val: 16
2024-05-06 13:29:03,530:INFO:   <<< cache_dir: 
2024-05-06 13:29:03,530:INFO:   <<< coef_lr: 0.001
2024-05-06 13:29:03,530:INFO:   <<< cross_model: cross-base
2024-05-06 13:29:03,530:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:29:03,530:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:29:03,530:INFO:   <<< datatype: msrvtt
2024-05-06 13:29:03,530:INFO:   <<< do_eval: True
2024-05-06 13:29:03,530:INFO:   <<< do_lower_case: False
2024-05-06 13:29:03,530:INFO:   <<< do_pretrain: False
2024-05-06 13:29:03,530:INFO:   <<< do_train: False
2024-05-06 13:29:03,530:INFO:   <<< epochs: 2
2024-05-06 13:29:03,530:INFO:   <<< eval_frame_order: 0
2024-05-06 13:29:03,530:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:29:03,530:INFO:   <<< feature_framerate: 1
2024-05-06 13:29:03,530:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:29:03,530:INFO:   <<< fp16: False
2024-05-06 13:29:03,530:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:29:03,530:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:29:03,530:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:29:03,530:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:29:03,530:INFO:   <<< init_model: None
2024-05-06 13:29:03,530:INFO:   <<< linear_patch: 2d
2024-05-06 13:29:03,530:INFO:   <<< local_rank: 0
2024-05-06 13:29:03,530:INFO:   <<< loose_type: True
2024-05-06 13:29:03,530:INFO:   <<< lr: 0.0001
2024-05-06 13:29:03,530:INFO:   <<< lr_decay: 0.9
2024-05-06 13:29:03,530:INFO:   <<< margin: 0.1
2024-05-06 13:29:03,530:INFO:   <<< max_frames: 90
2024-05-06 13:29:03,530:INFO:   <<< max_words: 32
2024-05-06 13:29:03,530:INFO:   <<< n_display: 100
2024-05-06 13:29:03,530:INFO:   <<< n_gpu: 1
2024-05-06 13:29:03,530:INFO:   <<< n_pair: 1
2024-05-06 13:29:03,530:INFO:   <<< negative_weighting: 1
2024-05-06 13:29:03,530:INFO:   <<< num_thread_reader: 0
2024-05-06 13:29:03,530:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:29:03,530:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:29:03,530:INFO:   <<< rank: 0
2024-05-06 13:29:03,530:INFO:   <<< resume_model: None
2024-05-06 13:29:03,530:INFO:   <<< sampled_use_mil: False
2024-05-06 13:29:03,530:INFO:   <<< seed: 42
2024-05-06 13:29:03,530:INFO:   <<< sim_header: meanP
2024-05-06 13:29:03,530:INFO:   <<< slice_framepos: 2
2024-05-06 13:29:03,530:INFO:   <<< task_type: retrieval
2024-05-06 13:29:03,530:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:29:03,530:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:29:03,530:INFO:   <<< train_frame_order: 0
2024-05-06 13:29:03,530:INFO:   <<< use_mil: False
2024-05-06 13:29:03,530:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:29:03,530:INFO:   <<< video_dim: 1024
2024-05-06 13:29:03,530:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:29:03,530:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:29:03,530:INFO:   <<< world_size: 1
2024-05-06 13:29:03,531:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:29:04,087:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:29:04,087:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:29:04,087:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:29:04,087:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:29:04,087:WARNING: Test retrieval by loose type.
2024-05-06 13:29:04,088:WARNING: 	 embed_dim: 512
2024-05-06 13:29:04,088:WARNING: 	 image_resolution: 224
2024-05-06 13:29:04,088:WARNING: 	 vision_layers: 12
2024-05-06 13:29:04,088:WARNING: 	 vision_width: 768
2024-05-06 13:29:04,088:WARNING: 	 vision_patch_size: 32
2024-05-06 13:29:04,088:WARNING: 	 context_length: 77
2024-05-06 13:29:04,088:WARNING: 	 vocab_size: 49408
2024-05-06 13:29:04,088:WARNING: 	 transformer_width: 512
2024-05-06 13:29:04,088:WARNING: 	 transformer_heads: 8
2024-05-06 13:29:04,088:WARNING: 	 transformer_layers: 12
2024-05-06 13:29:04,088:WARNING: 		 linear_patch: 2d
2024-05-06 13:29:04,088:WARNING: 	 cut_top_layer: 0
2024-05-06 13:29:04,940:WARNING: 	 sim_header: meanP
2024-05-06 13:29:08,578:INFO: --------------------
2024-05-06 13:29:08,578:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:34:25,008:INFO: Effective parameters:
2024-05-06 13:34:25,008:INFO:   <<< batch_size: 1
2024-05-06 13:34:25,008:INFO:   <<< batch_size_val: 16
2024-05-06 13:34:25,008:INFO:   <<< cache_dir: 
2024-05-06 13:34:25,008:INFO:   <<< coef_lr: 0.001
2024-05-06 13:34:25,009:INFO:   <<< cross_model: cross-base
2024-05-06 13:34:25,009:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:34:25,009:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:34:25,009:INFO:   <<< datatype: msrvtt
2024-05-06 13:34:25,009:INFO:   <<< do_eval: True
2024-05-06 13:34:25,009:INFO:   <<< do_lower_case: False
2024-05-06 13:34:25,009:INFO:   <<< do_pretrain: False
2024-05-06 13:34:25,009:INFO:   <<< do_train: False
2024-05-06 13:34:25,009:INFO:   <<< epochs: 2
2024-05-06 13:34:25,009:INFO:   <<< eval_frame_order: 0
2024-05-06 13:34:25,009:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:34:25,009:INFO:   <<< feature_framerate: 1
2024-05-06 13:34:25,009:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:34:25,009:INFO:   <<< fp16: False
2024-05-06 13:34:25,009:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:34:25,009:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:34:25,009:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:34:25,009:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:34:25,009:INFO:   <<< init_model: None
2024-05-06 13:34:25,009:INFO:   <<< linear_patch: 2d
2024-05-06 13:34:25,009:INFO:   <<< local_rank: 0
2024-05-06 13:34:25,009:INFO:   <<< loose_type: True
2024-05-06 13:34:25,009:INFO:   <<< lr: 0.0001
2024-05-06 13:34:25,009:INFO:   <<< lr_decay: 0.9
2024-05-06 13:34:25,009:INFO:   <<< margin: 0.1
2024-05-06 13:34:25,009:INFO:   <<< max_frames: 90
2024-05-06 13:34:25,009:INFO:   <<< max_words: 32
2024-05-06 13:34:25,009:INFO:   <<< n_display: 100
2024-05-06 13:34:25,009:INFO:   <<< n_gpu: 1
2024-05-06 13:34:25,009:INFO:   <<< n_pair: 1
2024-05-06 13:34:25,009:INFO:   <<< negative_weighting: 1
2024-05-06 13:34:25,009:INFO:   <<< num_thread_reader: 0
2024-05-06 13:34:25,009:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:34:25,009:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:34:25,009:INFO:   <<< rank: 0
2024-05-06 13:34:25,009:INFO:   <<< resume_model: None
2024-05-06 13:34:25,009:INFO:   <<< sampled_use_mil: False
2024-05-06 13:34:25,009:INFO:   <<< seed: 42
2024-05-06 13:34:25,009:INFO:   <<< sim_header: meanP
2024-05-06 13:34:25,009:INFO:   <<< slice_framepos: 2
2024-05-06 13:34:25,009:INFO:   <<< task_type: retrieval
2024-05-06 13:34:25,009:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:34:25,009:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:34:25,009:INFO:   <<< train_frame_order: 0
2024-05-06 13:34:25,009:INFO:   <<< use_mil: False
2024-05-06 13:34:25,009:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:34:25,009:INFO:   <<< video_dim: 1024
2024-05-06 13:34:25,009:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:34:25,009:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:34:25,009:INFO:   <<< world_size: 1
2024-05-06 13:34:25,009:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:34:25,532:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:34:25,532:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:34:25,532:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:34:25,532:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:34:25,532:WARNING: Test retrieval by loose type.
2024-05-06 13:34:25,533:WARNING: 	 embed_dim: 512
2024-05-06 13:34:25,533:WARNING: 	 image_resolution: 224
2024-05-06 13:34:25,533:WARNING: 	 vision_layers: 12
2024-05-06 13:34:25,533:WARNING: 	 vision_width: 768
2024-05-06 13:34:25,533:WARNING: 	 vision_patch_size: 32
2024-05-06 13:34:25,533:WARNING: 	 context_length: 77
2024-05-06 13:34:25,533:WARNING: 	 vocab_size: 49408
2024-05-06 13:34:25,533:WARNING: 	 transformer_width: 512
2024-05-06 13:34:25,533:WARNING: 	 transformer_heads: 8
2024-05-06 13:34:25,533:WARNING: 	 transformer_layers: 12
2024-05-06 13:34:25,533:WARNING: 		 linear_patch: 2d
2024-05-06 13:34:25,533:WARNING: 	 cut_top_layer: 0
2024-05-06 13:34:26,386:WARNING: 	 sim_header: meanP
2024-05-06 13:34:30,055:INFO: --------------------
2024-05-06 13:34:30,056:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:45:23,792:INFO: Effective parameters:
2024-05-06 13:45:23,792:INFO:   <<< batch_size: 1
2024-05-06 13:45:23,792:INFO:   <<< batch_size_val: 16
2024-05-06 13:45:23,792:INFO:   <<< cache_dir: 
2024-05-06 13:45:23,792:INFO:   <<< coef_lr: 0.001
2024-05-06 13:45:23,792:INFO:   <<< cross_model: cross-base
2024-05-06 13:45:23,792:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:45:23,792:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:45:23,792:INFO:   <<< datatype: msrvtt
2024-05-06 13:45:23,792:INFO:   <<< do_eval: True
2024-05-06 13:45:23,792:INFO:   <<< do_lower_case: False
2024-05-06 13:45:23,792:INFO:   <<< do_pretrain: False
2024-05-06 13:45:23,792:INFO:   <<< do_train: False
2024-05-06 13:45:23,792:INFO:   <<< epochs: 2
2024-05-06 13:45:23,792:INFO:   <<< eval_frame_order: 0
2024-05-06 13:45:23,792:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:45:23,792:INFO:   <<< feature_framerate: 1
2024-05-06 13:45:23,792:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:45:23,792:INFO:   <<< fp16: False
2024-05-06 13:45:23,792:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:45:23,792:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:45:23,792:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:45:23,792:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:45:23,792:INFO:   <<< init_model: None
2024-05-06 13:45:23,792:INFO:   <<< linear_patch: 2d
2024-05-06 13:45:23,792:INFO:   <<< local_rank: 0
2024-05-06 13:45:23,792:INFO:   <<< loose_type: True
2024-05-06 13:45:23,792:INFO:   <<< lr: 0.0001
2024-05-06 13:45:23,792:INFO:   <<< lr_decay: 0.9
2024-05-06 13:45:23,792:INFO:   <<< margin: 0.1
2024-05-06 13:45:23,792:INFO:   <<< max_frames: 90
2024-05-06 13:45:23,792:INFO:   <<< max_words: 32
2024-05-06 13:45:23,792:INFO:   <<< n_display: 100
2024-05-06 13:45:23,792:INFO:   <<< n_gpu: 1
2024-05-06 13:45:23,792:INFO:   <<< n_pair: 1
2024-05-06 13:45:23,792:INFO:   <<< negative_weighting: 1
2024-05-06 13:45:23,792:INFO:   <<< num_thread_reader: 0
2024-05-06 13:45:23,793:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:45:23,793:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:45:23,793:INFO:   <<< rank: 0
2024-05-06 13:45:23,793:INFO:   <<< resume_model: None
2024-05-06 13:45:23,793:INFO:   <<< sampled_use_mil: False
2024-05-06 13:45:23,793:INFO:   <<< seed: 42
2024-05-06 13:45:23,793:INFO:   <<< sim_header: meanP
2024-05-06 13:45:23,793:INFO:   <<< slice_framepos: 2
2024-05-06 13:45:23,793:INFO:   <<< task_type: retrieval
2024-05-06 13:45:23,793:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:45:23,793:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:45:23,793:INFO:   <<< train_frame_order: 0
2024-05-06 13:45:23,793:INFO:   <<< use_mil: False
2024-05-06 13:45:23,793:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:45:23,793:INFO:   <<< video_dim: 1024
2024-05-06 13:45:23,793:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:45:23,793:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:45:23,793:INFO:   <<< world_size: 1
2024-05-06 13:45:23,793:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:45:24,292:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:45:24,292:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:45:24,292:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:45:24,293:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:45:24,293:WARNING: Test retrieval by loose type.
2024-05-06 13:45:24,293:WARNING: 	 embed_dim: 512
2024-05-06 13:45:24,293:WARNING: 	 image_resolution: 224
2024-05-06 13:45:24,293:WARNING: 	 vision_layers: 12
2024-05-06 13:45:24,293:WARNING: 	 vision_width: 768
2024-05-06 13:45:24,293:WARNING: 	 vision_patch_size: 32
2024-05-06 13:45:24,293:WARNING: 	 context_length: 77
2024-05-06 13:45:24,293:WARNING: 	 vocab_size: 49408
2024-05-06 13:45:24,293:WARNING: 	 transformer_width: 512
2024-05-06 13:45:24,293:WARNING: 	 transformer_heads: 8
2024-05-06 13:45:24,293:WARNING: 	 transformer_layers: 12
2024-05-06 13:45:24,293:WARNING: 		 linear_patch: 2d
2024-05-06 13:45:24,293:WARNING: 	 cut_top_layer: 0
2024-05-06 13:45:25,136:WARNING: 	 sim_header: meanP
2024-05-06 13:45:28,775:INFO: --------------------
2024-05-06 13:45:28,775:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:46:48,439:INFO: Effective parameters:
2024-05-06 13:46:48,439:INFO:   <<< batch_size: 1
2024-05-06 13:46:48,439:INFO:   <<< batch_size_val: 16
2024-05-06 13:46:48,439:INFO:   <<< cache_dir: 
2024-05-06 13:46:48,439:INFO:   <<< coef_lr: 0.001
2024-05-06 13:46:48,439:INFO:   <<< cross_model: cross-base
2024-05-06 13:46:48,439:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:46:48,439:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:46:48,439:INFO:   <<< datatype: msrvtt
2024-05-06 13:46:48,439:INFO:   <<< do_eval: True
2024-05-06 13:46:48,439:INFO:   <<< do_lower_case: False
2024-05-06 13:46:48,439:INFO:   <<< do_pretrain: False
2024-05-06 13:46:48,439:INFO:   <<< do_train: False
2024-05-06 13:46:48,439:INFO:   <<< epochs: 2
2024-05-06 13:46:48,439:INFO:   <<< eval_frame_order: 0
2024-05-06 13:46:48,439:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:46:48,439:INFO:   <<< feature_framerate: 1
2024-05-06 13:46:48,439:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:46:48,439:INFO:   <<< fp16: False
2024-05-06 13:46:48,439:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:46:48,439:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:46:48,439:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:46:48,439:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:46:48,439:INFO:   <<< init_model: None
2024-05-06 13:46:48,439:INFO:   <<< linear_patch: 2d
2024-05-06 13:46:48,439:INFO:   <<< local_rank: 0
2024-05-06 13:46:48,439:INFO:   <<< loose_type: True
2024-05-06 13:46:48,439:INFO:   <<< lr: 0.0001
2024-05-06 13:46:48,439:INFO:   <<< lr_decay: 0.9
2024-05-06 13:46:48,439:INFO:   <<< margin: 0.1
2024-05-06 13:46:48,439:INFO:   <<< max_frames: 90
2024-05-06 13:46:48,440:INFO:   <<< max_words: 32
2024-05-06 13:46:48,440:INFO:   <<< n_display: 100
2024-05-06 13:46:48,440:INFO:   <<< n_gpu: 1
2024-05-06 13:46:48,440:INFO:   <<< n_pair: 1
2024-05-06 13:46:48,440:INFO:   <<< negative_weighting: 1
2024-05-06 13:46:48,440:INFO:   <<< num_thread_reader: 0
2024-05-06 13:46:48,440:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:46:48,440:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:46:48,440:INFO:   <<< rank: 0
2024-05-06 13:46:48,440:INFO:   <<< resume_model: None
2024-05-06 13:46:48,440:INFO:   <<< sampled_use_mil: False
2024-05-06 13:46:48,440:INFO:   <<< seed: 42
2024-05-06 13:46:48,440:INFO:   <<< sim_header: meanP
2024-05-06 13:46:48,440:INFO:   <<< slice_framepos: 2
2024-05-06 13:46:48,440:INFO:   <<< task_type: retrieval
2024-05-06 13:46:48,440:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:46:48,440:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:46:48,440:INFO:   <<< train_frame_order: 0
2024-05-06 13:46:48,440:INFO:   <<< use_mil: False
2024-05-06 13:46:48,440:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:46:48,440:INFO:   <<< video_dim: 1024
2024-05-06 13:46:48,440:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:46:48,440:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:46:48,440:INFO:   <<< world_size: 1
2024-05-06 13:46:48,440:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:46:48,963:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:46:48,963:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:46:48,963:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:46:48,963:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:46:48,963:WARNING: Test retrieval by loose type.
2024-05-06 13:46:48,963:WARNING: 	 embed_dim: 512
2024-05-06 13:46:48,963:WARNING: 	 image_resolution: 224
2024-05-06 13:46:48,963:WARNING: 	 vision_layers: 12
2024-05-06 13:46:48,963:WARNING: 	 vision_width: 768
2024-05-06 13:46:48,963:WARNING: 	 vision_patch_size: 32
2024-05-06 13:46:48,963:WARNING: 	 context_length: 77
2024-05-06 13:46:48,963:WARNING: 	 vocab_size: 49408
2024-05-06 13:46:48,963:WARNING: 	 transformer_width: 512
2024-05-06 13:46:48,964:WARNING: 	 transformer_heads: 8
2024-05-06 13:46:48,964:WARNING: 	 transformer_layers: 12
2024-05-06 13:46:48,964:WARNING: 		 linear_patch: 2d
2024-05-06 13:46:48,964:WARNING: 	 cut_top_layer: 0
2024-05-06 13:46:49,793:WARNING: 	 sim_header: meanP
2024-05-06 13:46:53,540:INFO: --------------------
2024-05-06 13:46:53,540:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:50:39,100:INFO: Effective parameters:
2024-05-06 13:50:39,100:INFO:   <<< batch_size: 1
2024-05-06 13:50:39,100:INFO:   <<< batch_size_val: 16
2024-05-06 13:50:39,100:INFO:   <<< cache_dir: 
2024-05-06 13:50:39,100:INFO:   <<< coef_lr: 0.001
2024-05-06 13:50:39,100:INFO:   <<< cross_model: cross-base
2024-05-06 13:50:39,100:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:50:39,100:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:50:39,100:INFO:   <<< datatype: msrvtt
2024-05-06 13:50:39,100:INFO:   <<< do_eval: True
2024-05-06 13:50:39,100:INFO:   <<< do_lower_case: False
2024-05-06 13:50:39,100:INFO:   <<< do_pretrain: False
2024-05-06 13:50:39,100:INFO:   <<< do_train: False
2024-05-06 13:50:39,100:INFO:   <<< epochs: 2
2024-05-06 13:50:39,100:INFO:   <<< eval_frame_order: 0
2024-05-06 13:50:39,100:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:50:39,100:INFO:   <<< feature_framerate: 1
2024-05-06 13:50:39,100:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:50:39,100:INFO:   <<< fp16: False
2024-05-06 13:50:39,100:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:50:39,100:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:50:39,100:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:50:39,100:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:50:39,100:INFO:   <<< init_model: None
2024-05-06 13:50:39,100:INFO:   <<< linear_patch: 2d
2024-05-06 13:50:39,100:INFO:   <<< local_rank: 0
2024-05-06 13:50:39,100:INFO:   <<< loose_type: True
2024-05-06 13:50:39,101:INFO:   <<< lr: 0.0001
2024-05-06 13:50:39,101:INFO:   <<< lr_decay: 0.9
2024-05-06 13:50:39,101:INFO:   <<< margin: 0.1
2024-05-06 13:50:39,101:INFO:   <<< max_frames: 90
2024-05-06 13:50:39,101:INFO:   <<< max_words: 32
2024-05-06 13:50:39,101:INFO:   <<< n_display: 100
2024-05-06 13:50:39,101:INFO:   <<< n_gpu: 1
2024-05-06 13:50:39,101:INFO:   <<< n_pair: 1
2024-05-06 13:50:39,101:INFO:   <<< negative_weighting: 1
2024-05-06 13:50:39,101:INFO:   <<< num_thread_reader: 0
2024-05-06 13:50:39,101:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:50:39,101:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:50:39,101:INFO:   <<< rank: 0
2024-05-06 13:50:39,101:INFO:   <<< resume_model: None
2024-05-06 13:50:39,101:INFO:   <<< sampled_use_mil: False
2024-05-06 13:50:39,101:INFO:   <<< seed: 42
2024-05-06 13:50:39,101:INFO:   <<< sim_header: meanP
2024-05-06 13:50:39,101:INFO:   <<< slice_framepos: 2
2024-05-06 13:50:39,101:INFO:   <<< task_type: retrieval
2024-05-06 13:50:39,101:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:50:39,101:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:50:39,101:INFO:   <<< train_frame_order: 0
2024-05-06 13:50:39,101:INFO:   <<< use_mil: False
2024-05-06 13:50:39,101:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:50:39,101:INFO:   <<< video_dim: 1024
2024-05-06 13:50:39,101:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:50:39,101:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:50:39,101:INFO:   <<< world_size: 1
2024-05-06 13:50:39,101:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:50:39,626:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:50:39,626:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:50:39,626:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:50:39,626:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:50:39,627:WARNING: Test retrieval by loose type.
2024-05-06 13:50:39,627:WARNING: 	 embed_dim: 512
2024-05-06 13:50:39,627:WARNING: 	 image_resolution: 224
2024-05-06 13:50:39,627:WARNING: 	 vision_layers: 12
2024-05-06 13:50:39,627:WARNING: 	 vision_width: 768
2024-05-06 13:50:39,627:WARNING: 	 vision_patch_size: 32
2024-05-06 13:50:39,627:WARNING: 	 context_length: 77
2024-05-06 13:50:39,627:WARNING: 	 vocab_size: 49408
2024-05-06 13:50:39,627:WARNING: 	 transformer_width: 512
2024-05-06 13:50:39,627:WARNING: 	 transformer_heads: 8
2024-05-06 13:50:39,627:WARNING: 	 transformer_layers: 12
2024-05-06 13:50:39,627:WARNING: 		 linear_patch: 2d
2024-05-06 13:50:39,627:WARNING: 	 cut_top_layer: 0
2024-05-06 13:50:40,482:WARNING: 	 sim_header: meanP
2024-05-06 13:50:44,197:INFO: --------------------
2024-05-06 13:50:44,197:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-05-06 13:50:57,421:INFO: Effective parameters:
2024-05-06 13:50:57,421:INFO:   <<< batch_size: 1
2024-05-06 13:50:57,421:INFO:   <<< batch_size_val: 16
2024-05-06 13:50:57,421:INFO:   <<< cache_dir: 
2024-05-06 13:50:57,421:INFO:   <<< coef_lr: 0.001
2024-05-06 13:50:57,421:INFO:   <<< cross_model: cross-base
2024-05-06 13:50:57,421:INFO:   <<< cross_num_hidden_layers: 4
2024-05-06 13:50:57,421:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-06 13:50:57,421:INFO:   <<< datatype: msrvtt
2024-05-06 13:50:57,421:INFO:   <<< do_eval: True
2024-05-06 13:50:57,421:INFO:   <<< do_lower_case: False
2024-05-06 13:50:57,421:INFO:   <<< do_pretrain: False
2024-05-06 13:50:57,421:INFO:   <<< do_train: False
2024-05-06 13:50:57,421:INFO:   <<< epochs: 2
2024-05-06 13:50:57,421:INFO:   <<< eval_frame_order: 0
2024-05-06 13:50:57,421:INFO:   <<< expand_msrvtt_sentences: True
2024-05-06 13:50:57,421:INFO:   <<< feature_framerate: 1
2024-05-06 13:50:57,421:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-06 13:50:57,421:INFO:   <<< fp16: False
2024-05-06 13:50:57,421:INFO:   <<< fp16_opt_level: O1
2024-05-06 13:50:57,421:INFO:   <<< freeze_layer_num: 0
2024-05-06 13:50:57,421:INFO:   <<< gradient_accumulation_steps: 1
2024-05-06 13:50:57,421:INFO:   <<< hard_negative_rate: 0.5
2024-05-06 13:50:57,421:INFO:   <<< init_model: None
2024-05-06 13:50:57,421:INFO:   <<< linear_patch: 2d
2024-05-06 13:50:57,421:INFO:   <<< local_rank: 0
2024-05-06 13:50:57,421:INFO:   <<< loose_type: True
2024-05-06 13:50:57,421:INFO:   <<< lr: 0.0001
2024-05-06 13:50:57,421:INFO:   <<< lr_decay: 0.9
2024-05-06 13:50:57,421:INFO:   <<< margin: 0.1
2024-05-06 13:50:57,421:INFO:   <<< max_frames: 90
2024-05-06 13:50:57,421:INFO:   <<< max_words: 32
2024-05-06 13:50:57,421:INFO:   <<< n_display: 100
2024-05-06 13:50:57,421:INFO:   <<< n_gpu: 1
2024-05-06 13:50:57,421:INFO:   <<< n_pair: 1
2024-05-06 13:50:57,421:INFO:   <<< negative_weighting: 1
2024-05-06 13:50:57,421:INFO:   <<< num_thread_reader: 0
2024-05-06 13:50:57,421:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-06 13:50:57,421:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-06 13:50:57,421:INFO:   <<< rank: 0
2024-05-06 13:50:57,421:INFO:   <<< resume_model: None
2024-05-06 13:50:57,421:INFO:   <<< sampled_use_mil: False
2024-05-06 13:50:57,421:INFO:   <<< seed: 42
2024-05-06 13:50:57,421:INFO:   <<< sim_header: meanP
2024-05-06 13:50:57,421:INFO:   <<< slice_framepos: 2
2024-05-06 13:50:57,421:INFO:   <<< task_type: retrieval
2024-05-06 13:50:57,421:INFO:   <<< text_num_hidden_layers: 12
2024-05-06 13:50:57,421:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-06 13:50:57,421:INFO:   <<< train_frame_order: 0
2024-05-06 13:50:57,421:INFO:   <<< use_mil: False
2024-05-06 13:50:57,421:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-06 13:50:57,421:INFO:   <<< video_dim: 1024
2024-05-06 13:50:57,422:INFO:   <<< visual_num_hidden_layers: 12
2024-05-06 13:50:57,422:INFO:   <<< warmup_proportion: 0.1
2024-05-06 13:50:57,422:INFO:   <<< world_size: 1
2024-05-06 13:50:57,422:INFO: device: cuda:0 n_gpu: 1
2024-05-06 13:50:57,931:INFO: loading archive file /workspace/CLIP4Clip/modules/cross-base
2024-05-06 13:50:57,931:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-05-06 13:50:57,931:INFO: Weight doesn't exsits. /workspace/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-05-06 13:50:57,931:WARNING: Stage-One:True, Stage-Two:False
2024-05-06 13:50:57,931:WARNING: Test retrieval by loose type.
2024-05-06 13:50:57,931:WARNING: 	 embed_dim: 512
2024-05-06 13:50:57,931:WARNING: 	 image_resolution: 224
2024-05-06 13:50:57,931:WARNING: 	 vision_layers: 12
2024-05-06 13:50:57,931:WARNING: 	 vision_width: 768
2024-05-06 13:50:57,932:WARNING: 	 vision_patch_size: 32
2024-05-06 13:50:57,932:WARNING: 	 context_length: 77
2024-05-06 13:50:57,932:WARNING: 	 vocab_size: 49408
2024-05-06 13:50:57,932:WARNING: 	 transformer_width: 512
2024-05-06 13:50:57,932:WARNING: 	 transformer_heads: 8
2024-05-06 13:50:57,932:WARNING: 	 transformer_layers: 12
2024-05-06 13:50:57,932:WARNING: 		 linear_patch: 2d
2024-05-06 13:50:57,932:WARNING: 	 cut_top_layer: 0
2024-05-06 13:50:58,793:WARNING: 	 sim_header: meanP
2024-05-06 13:51:02,523:INFO: --------------------
2024-05-06 13:51:02,523:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
