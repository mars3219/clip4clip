2024-04-26 06:37:54,966:INFO: Effective parameters:
2024-04-26 06:37:54,966:INFO:   <<< batch_size: 16
2024-04-26 06:37:54,966:INFO:   <<< batch_size_val: 16
2024-04-26 06:37:54,967:INFO:   <<< cache_dir: 
2024-04-26 06:37:54,967:INFO:   <<< coef_lr: 0.001
2024-04-26 06:37:54,967:INFO:   <<< cross_model: cross-base
2024-04-26 06:37:54,967:INFO:   <<< cross_num_hidden_layers: 4
2024-04-26 06:37:54,967:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-26 06:37:54,967:INFO:   <<< datatype: msrvtt
2024-04-26 06:37:54,967:INFO:   <<< do_eval: False
2024-04-26 06:37:54,967:INFO:   <<< do_lower_case: False
2024-04-26 06:37:54,967:INFO:   <<< do_pretrain: False
2024-04-26 06:37:54,967:INFO:   <<< do_train: True
2024-04-26 06:37:54,967:INFO:   <<< epochs: 5
2024-04-26 06:37:54,967:INFO:   <<< eval_frame_order: 0
2024-04-26 06:37:54,967:INFO:   <<< expand_msrvtt_sentences: True
2024-04-26 06:37:54,967:INFO:   <<< feature_framerate: 1
2024-04-26 06:37:54,967:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-26 06:37:54,968:INFO:   <<< fp16: False
2024-04-26 06:37:54,968:INFO:   <<< fp16_opt_level: O1
2024-04-26 06:37:54,968:INFO:   <<< freeze_layer_num: 0
2024-04-26 06:37:54,968:INFO:   <<< gradient_accumulation_steps: 1
2024-04-26 06:37:54,968:INFO:   <<< hard_negative_rate: 0.5
2024-04-26 06:37:54,968:INFO:   <<< init_model: None
2024-04-26 06:37:54,968:INFO:   <<< linear_patch: 2d
2024-04-26 06:37:54,968:INFO:   <<< local_rank: 0
2024-04-26 06:37:54,968:INFO:   <<< loose_type: True
2024-04-26 06:37:54,968:INFO:   <<< lr: 0.0001
2024-04-26 06:37:54,968:INFO:   <<< lr_decay: 0.9
2024-04-26 06:37:54,968:INFO:   <<< margin: 0.1
2024-04-26 06:37:54,968:INFO:   <<< max_frames: 30
2024-04-26 06:37:54,968:INFO:   <<< max_words: 32
2024-04-26 06:37:54,968:INFO:   <<< n_display: 50
2024-04-26 06:37:54,968:INFO:   <<< n_gpu: 1
2024-04-26 06:37:54,968:INFO:   <<< n_pair: 1
2024-04-26 06:37:54,969:INFO:   <<< negative_weighting: 1
2024-04-26 06:37:54,969:INFO:   <<< num_thread_reader: 0
2024-04-26 06:37:54,969:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-26 06:37:54,969:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-26 06:37:54,969:INFO:   <<< rank: 0
2024-04-26 06:37:54,969:INFO:   <<< resume_model: None
2024-04-26 06:37:54,969:INFO:   <<< sampled_use_mil: False
2024-04-26 06:37:54,969:INFO:   <<< seed: 42
2024-04-26 06:37:54,969:INFO:   <<< sim_header: meanP
2024-04-26 06:37:54,969:INFO:   <<< slice_framepos: 2
2024-04-26 06:37:54,969:INFO:   <<< task_type: retrieval
2024-04-26 06:37:54,969:INFO:   <<< text_num_hidden_layers: 12
2024-04-26 06:37:54,969:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-26 06:37:54,969:INFO:   <<< train_frame_order: 0
2024-04-26 06:37:54,969:INFO:   <<< use_mil: False
2024-04-26 06:37:54,969:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-26 06:37:54,969:INFO:   <<< video_dim: 1024
2024-04-26 06:37:54,970:INFO:   <<< visual_num_hidden_layers: 12
2024-04-26 06:37:54,970:INFO:   <<< warmup_proportion: 0.1
2024-04-26 06:37:54,970:INFO:   <<< world_size: 1
2024-04-26 06:37:54,970:INFO: device: cuda:0 n_gpu: 1
2024-04-26 07:03:10,643:WARNING: Stage-One:True, Stage-Two:False
2024-04-26 07:03:10,643:WARNING: Test retrieval by loose type.
2024-04-26 07:03:10,644:WARNING: 	 embed_dim: 512
2024-04-26 07:03:10,644:WARNING: 	 image_resolution: 224
2024-04-26 07:03:10,645:WARNING: 	 vision_layers: 12
2024-04-26 07:03:10,645:WARNING: 	 vision_width: 768
2024-04-26 07:03:10,645:WARNING: 	 vision_patch_size: 32
2024-04-26 07:03:10,645:WARNING: 	 context_length: 77
2024-04-26 07:03:10,646:WARNING: 	 vocab_size: 49408
2024-04-26 07:03:10,646:WARNING: 	 transformer_width: 512
2024-04-26 07:03:10,646:WARNING: 	 transformer_heads: 8
2024-04-26 07:03:10,646:WARNING: 	 transformer_layers: 12
2024-04-26 07:03:10,646:WARNING: 		 linear_patch: 2d
2024-04-26 07:03:10,647:WARNING: 	 cut_top_layer: 0
2024-04-26 07:03:11,671:WARNING: 	 sim_header: meanP
2024-04-26 07:03:20,460:INFO: ***** Running test *****
2024-04-26 07:03:20,460:INFO:   Num examples = 1000
2024-04-26 07:03:20,460:INFO:   Batch size = 16
2024-04-26 07:03:20,461:INFO:   Num steps = 63
2024-04-26 07:03:20,461:INFO: ***** Running val *****
2024-04-26 07:03:20,461:INFO:   Num examples = 1000
2024-04-26 07:03:21,096:INFO: ***** Running training *****
2024-04-26 07:03:21,097:INFO:   Num examples = 4080
2024-04-26 07:03:21,097:INFO:   Batch size = 16
2024-04-26 07:03:21,097:INFO:   Num steps = 1275
2024-04-26 07:05:31,716:INFO: Epoch: 1/5, Step: 50/255, Lr: 0.000000039, Loss: 0.436528, Time/step: 2.612253
2024-04-26 07:07:42,828:INFO: Epoch: 1/5, Step: 100/255, Lr: 0.000000078, Loss: 0.511769, Time/step: 2.622237
2024-04-26 07:09:51,799:INFO: Epoch: 1/5, Step: 150/255, Lr: 0.000000097, Loss: 0.401003, Time/step: 2.579411
2024-04-26 07:12:03,604:INFO: Epoch: 1/5, Step: 200/255, Lr: 0.000000094, Loss: 0.339629, Time/step: 2.636087
2024-04-26 07:14:17,410:INFO: Epoch: 1/5, Step: 250/255, Lr: 0.000000091, Loss: 0.161009, Time/step: 2.676125
2024-04-26 07:14:31,259:INFO: Epoch 1/5 Finished, Train Loss: 0.452088
2024-04-26 07:14:32,058:INFO: Model saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.0
2024-04-26 07:14:32,058:INFO: Optimizer saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_opt.bin.0
2024-04-26 07:16:56,377:INFO: sim matrix size: 1000, 1000
2024-04-26 07:16:56,404:INFO: 	 Length-T: 1000, Length-V:1000
2024-04-26 07:16:56,404:INFO: Text-to-Video:
2024-04-26 07:16:56,404:INFO: 	>>>  R@1: 37.0 - R@5: 59.2 - R@10: 70.7 - Median R: 3.0 - Mean R: 21.5
2024-04-26 07:16:56,405:INFO: Video-to-Text:
2024-04-26 07:16:56,405:INFO: 	>>>  V2T$R@1: 35.7 - V2T$R@5: 61.6 - V2T$R@10: 70.8 - V2T$Median R: 3.0 - V2T$Mean R: 20.2
2024-04-26 07:16:56,405:INFO: The best model is: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.0, the R1 is: 37.0000
2024-04-26 07:18:54,727:INFO: Epoch: 2/5, Step: 45/255, Lr: 0.000000087, Loss: 0.040735, Time/step: 2.363592
2024-04-26 07:21:06,526:INFO: Epoch: 2/5, Step: 95/255, Lr: 0.000000083, Loss: 0.117501, Time/step: 2.635970
2024-04-26 07:23:15,174:INFO: Epoch: 2/5, Step: 145/255, Lr: 0.000000078, Loss: 0.284938, Time/step: 2.572956
2024-04-26 07:25:23,438:INFO: Epoch: 2/5, Step: 195/255, Lr: 0.000000072, Loss: 0.015964, Time/step: 2.565269
2024-04-26 07:27:37,883:INFO: Epoch: 2/5, Step: 245/255, Lr: 0.000000067, Loss: 0.227363, Time/step: 2.688899
2024-04-26 07:28:04,017:INFO: Epoch 2/5 Finished, Train Loss: 0.206207
2024-04-26 07:28:04,805:INFO: Model saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.1
2024-04-26 07:28:04,806:INFO: Optimizer saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_opt.bin.1
2024-04-26 07:30:29,154:INFO: sim matrix size: 1000, 1000
2024-04-26 07:30:29,180:INFO: 	 Length-T: 1000, Length-V:1000
2024-04-26 07:30:29,180:INFO: Text-to-Video:
2024-04-26 07:30:29,180:INFO: 	>>>  R@1: 36.4 - R@5: 60.1 - R@10: 71.0 - Median R: 3.0 - Mean R: 21.1
2024-04-26 07:30:29,180:INFO: Video-to-Text:
2024-04-26 07:30:29,181:INFO: 	>>>  V2T$R@1: 37.5 - V2T$R@5: 62.3 - V2T$R@10: 72.0 - V2T$Median R: 3.0 - V2T$Mean R: 19.8
2024-04-26 07:30:29,181:INFO: The best model is: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.0, the R1 is: 37.0000
2024-04-26 07:32:14,672:INFO: Epoch: 3/5, Step: 40/255, Lr: 0.000000061, Loss: 0.098913, Time/step: 2.106800
2024-04-26 07:34:23,865:INFO: Epoch: 3/5, Step: 90/255, Lr: 0.000000055, Loss: 0.090821, Time/step: 2.583859
2024-04-26 07:36:34,896:INFO: Epoch: 3/5, Step: 140/255, Lr: 0.000000048, Loss: 0.114720, Time/step: 2.620622
2024-04-26 07:38:45,260:INFO: Epoch: 3/5, Step: 190/255, Lr: 0.000000042, Loss: 0.410963, Time/step: 2.607254
2024-04-26 07:40:58,380:INFO: Epoch: 3/5, Step: 240/255, Lr: 0.000000036, Loss: 0.289129, Time/step: 2.662408
2024-04-26 07:41:37,062:INFO: Epoch 3/5 Finished, Train Loss: 0.154800
2024-04-26 07:41:37,856:INFO: Model saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.2
2024-04-26 07:41:37,856:INFO: Optimizer saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_opt.bin.2
2024-04-26 07:44:01,661:INFO: sim matrix size: 1000, 1000
2024-04-26 07:44:01,687:INFO: 	 Length-T: 1000, Length-V:1000
2024-04-26 07:44:01,687:INFO: Text-to-Video:
2024-04-26 07:44:01,688:INFO: 	>>>  R@1: 36.6 - R@5: 60.3 - R@10: 71.8 - Median R: 3.0 - Mean R: 21.1
2024-04-26 07:44:01,688:INFO: Video-to-Text:
2024-04-26 07:44:01,688:INFO: 	>>>  V2T$R@1: 36.9 - V2T$R@5: 63.0 - V2T$R@10: 73.2 - V2T$Median R: 3.0 - V2T$Mean R: 18.1
2024-04-26 07:44:01,689:INFO: The best model is: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.0, the R1 is: 37.0000
2024-04-26 07:45:32,729:INFO: Epoch: 4/5, Step: 35/255, Lr: 0.000000031, Loss: 0.007298, Time/step: 1.817799
2024-04-26 07:47:42,964:INFO: Epoch: 4/5, Step: 85/255, Lr: 0.000000025, Loss: 0.002227, Time/step: 2.604684
2024-04-26 07:49:53,362:INFO: Epoch: 4/5, Step: 135/255, Lr: 0.000000020, Loss: 0.258980, Time/step: 2.607969
2024-04-26 07:52:05,896:INFO: Epoch: 4/5, Step: 185/255, Lr: 0.000000015, Loss: 0.182913, Time/step: 2.650674
2024-04-26 07:54:16,990:INFO: Epoch: 4/5, Step: 235/255, Lr: 0.000000011, Loss: 0.002942, Time/step: 2.621863
2024-04-26 07:55:08,808:INFO: Epoch 4/5 Finished, Train Loss: 0.115483
2024-04-26 07:55:09,608:INFO: Model saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.3
2024-04-26 07:55:09,609:INFO: Optimizer saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_opt.bin.3
2024-04-26 07:57:33,821:INFO: sim matrix size: 1000, 1000
2024-04-26 07:57:33,847:INFO: 	 Length-T: 1000, Length-V:1000
2024-04-26 07:57:33,847:INFO: Text-to-Video:
2024-04-26 07:57:33,847:INFO: 	>>>  R@1: 37.2 - R@5: 60.6 - R@10: 72.5 - Median R: 3.0 - Mean R: 21.1
2024-04-26 07:57:33,847:INFO: Video-to-Text:
2024-04-26 07:57:33,848:INFO: 	>>>  V2T$R@1: 37.2 - V2T$R@5: 63.0 - V2T$R@10: 73.0 - V2T$Median R: 3.0 - V2T$Mean R: 18.5
2024-04-26 07:57:33,848:INFO: The best model is: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.3, the R1 is: 37.2000
2024-04-26 07:58:53,089:INFO: Epoch: 5/5, Step: 30/255, Lr: 0.000000007, Loss: 0.270733, Time/step: 1.581798
2024-04-26 08:01:04,123:INFO: Epoch: 5/5, Step: 80/255, Lr: 0.000000005, Loss: 0.013147, Time/step: 2.620682
2024-04-26 08:03:15,629:INFO: Epoch: 5/5, Step: 130/255, Lr: 0.000000002, Loss: 0.067512, Time/step: 2.630104
2024-04-26 08:05:25,880:INFO: Epoch: 5/5, Step: 180/255, Lr: 0.000000001, Loss: 0.106504, Time/step: 2.605019
2024-04-26 08:07:39,923:INFO: Epoch: 5/5, Step: 230/255, Lr: 0.000000000, Loss: 0.044099, Time/step: 2.680862
2024-04-26 08:08:44,292:INFO: Epoch 5/5 Finished, Train Loss: 0.116577
2024-04-26 08:08:45,085:INFO: Model saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.4
2024-04-26 08:08:45,085:INFO: Optimizer saved to /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_opt.bin.4
2024-04-26 08:11:10,789:INFO: sim matrix size: 1000, 1000
2024-04-26 08:11:10,816:INFO: 	 Length-T: 1000, Length-V:1000
2024-04-26 08:11:10,816:INFO: Text-to-Video:
2024-04-26 08:11:10,816:INFO: 	>>>  R@1: 37.1 - R@5: 60.7 - R@10: 72.4 - Median R: 3.0 - Mean R: 21.1
2024-04-26 08:11:10,816:INFO: Video-to-Text:
2024-04-26 08:11:10,817:INFO: 	>>>  V2T$R@1: 36.9 - V2T$R@5: 63.0 - V2T$R@10: 72.9 - V2T$Median R: 3.0 - V2T$Mean R: 18.5
2024-04-26 08:11:10,817:INFO: The best model is: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/pytorch_model.bin.3, the R1 is: 37.2000
2024-04-28 23:29:06,706:INFO: Effective parameters:
2024-04-28 23:29:06,706:INFO:   <<< batch_size: 16
2024-04-28 23:29:06,706:INFO:   <<< batch_size_val: 16
2024-04-28 23:29:06,706:INFO:   <<< cache_dir: 
2024-04-28 23:29:06,706:INFO:   <<< coef_lr: 0.001
2024-04-28 23:29:06,706:INFO:   <<< cross_model: cross-base
2024-04-28 23:29:06,706:INFO:   <<< cross_num_hidden_layers: 4
2024-04-28 23:29:06,706:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-28 23:29:06,706:INFO:   <<< datatype: msrvtt
2024-04-28 23:29:06,706:INFO:   <<< do_eval: True
2024-04-28 23:29:06,706:INFO:   <<< do_lower_case: False
2024-04-28 23:29:06,706:INFO:   <<< do_pretrain: False
2024-04-28 23:29:06,706:INFO:   <<< do_train: False
2024-04-28 23:29:06,706:INFO:   <<< epochs: 5
2024-04-28 23:29:06,706:INFO:   <<< eval_frame_order: 0
2024-04-28 23:29:06,706:INFO:   <<< expand_msrvtt_sentences: True
2024-04-28 23:29:06,706:INFO:   <<< feature_framerate: 1
2024-04-28 23:29:06,706:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-28 23:29:06,706:INFO:   <<< fp16: False
2024-04-28 23:29:06,706:INFO:   <<< fp16_opt_level: O1
2024-04-28 23:29:06,706:INFO:   <<< freeze_layer_num: 0
2024-04-28 23:29:06,706:INFO:   <<< gradient_accumulation_steps: 1
2024-04-28 23:29:06,706:INFO:   <<< hard_negative_rate: 0.5
2024-04-28 23:29:06,706:INFO:   <<< init_model: None
2024-04-28 23:29:06,706:INFO:   <<< linear_patch: 2d
2024-04-28 23:29:06,706:INFO:   <<< local_rank: 0
2024-04-28 23:29:06,706:INFO:   <<< loose_type: True
2024-04-28 23:29:06,706:INFO:   <<< lr: 0.0001
2024-04-28 23:29:06,706:INFO:   <<< lr_decay: 0.9
2024-04-28 23:29:06,706:INFO:   <<< margin: 0.1
2024-04-28 23:29:06,706:INFO:   <<< max_frames: 30
2024-04-28 23:29:06,706:INFO:   <<< max_words: 32
2024-04-28 23:29:06,706:INFO:   <<< n_display: 100
2024-04-28 23:29:06,707:INFO:   <<< n_gpu: 1
2024-04-28 23:29:06,707:INFO:   <<< n_pair: 1
2024-04-28 23:29:06,707:INFO:   <<< negative_weighting: 1
2024-04-28 23:29:06,707:INFO:   <<< num_thread_reader: 0
2024-04-28 23:29:06,707:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-28 23:29:06,707:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-28 23:29:06,707:INFO:   <<< rank: 0
2024-04-28 23:29:06,707:INFO:   <<< resume_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-28 23:29:06,707:INFO:   <<< sampled_use_mil: False
2024-04-28 23:29:06,707:INFO:   <<< seed: 42
2024-04-28 23:29:06,707:INFO:   <<< sim_header: meanP
2024-04-28 23:29:06,707:INFO:   <<< slice_framepos: 2
2024-04-28 23:29:06,707:INFO:   <<< task_type: retrieval
2024-04-28 23:29:06,707:INFO:   <<< text_num_hidden_layers: 12
2024-04-28 23:29:06,707:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-28 23:29:06,707:INFO:   <<< train_frame_order: 0
2024-04-28 23:29:06,707:INFO:   <<< use_mil: False
2024-04-28 23:29:06,707:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-28 23:29:06,707:INFO:   <<< video_dim: 1024
2024-04-28 23:29:06,707:INFO:   <<< visual_num_hidden_layers: 12
2024-04-28 23:29:06,707:INFO:   <<< warmup_proportion: 0.1
2024-04-28 23:29:06,707:INFO:   <<< world_size: 1
2024-04-28 23:29:06,707:INFO: device: cuda:0 n_gpu: 1
2024-04-28 23:29:07,450:WARNING: Stage-One:True, Stage-Two:False
2024-04-28 23:29:07,451:WARNING: Test retrieval by loose type.
2024-04-28 23:29:07,451:WARNING: 	 embed_dim: 512
2024-04-28 23:29:07,451:WARNING: 	 image_resolution: 224
2024-04-28 23:29:07,451:WARNING: 	 vision_layers: 12
2024-04-28 23:29:07,451:WARNING: 	 vision_width: 768
2024-04-28 23:29:07,451:WARNING: 	 vision_patch_size: 32
2024-04-28 23:29:07,451:WARNING: 	 context_length: 77
2024-04-28 23:29:07,451:WARNING: 	 vocab_size: 49408
2024-04-28 23:29:07,451:WARNING: 	 transformer_width: 512
2024-04-28 23:29:07,451:WARNING: 	 transformer_heads: 8
2024-04-28 23:29:07,451:WARNING: 	 transformer_layers: 12
2024-04-28 23:29:07,451:WARNING: 		 linear_patch: 2d
2024-04-28 23:29:07,451:WARNING: 	 cut_top_layer: 0
2024-04-28 23:29:08,441:WARNING: 	 sim_header: meanP
2024-04-28 23:29:14,881:INFO: ***** Running test *****
2024-04-28 23:29:14,881:INFO:   Num examples = 1000
2024-04-28 23:29:14,881:INFO:   Batch size = 16
2024-04-28 23:29:14,881:INFO:   Num steps = 63
2024-04-28 23:29:14,881:INFO: ***** Running val *****
2024-04-28 23:29:14,881:INFO:   Num examples = 1000
2024-04-28 23:31:27,930:INFO: sim matrix size: 1000, 1000
2024-04-28 23:31:27,957:INFO: 	 Length-T: 1000, Length-V:1000
2024-04-28 23:31:27,957:INFO: Text-to-Video:
2024-04-28 23:31:27,958:INFO: 	>>>  R@1: 30.7 - R@5: 54.1 - R@10: 63.9 - Median R: 4.0 - Mean R: 38.7
2024-04-28 23:31:27,958:INFO: Video-to-Text:
2024-04-28 23:31:27,958:INFO: 	>>>  V2T$R@1: 26.8 - V2T$R@5: 51.7 - V2T$R@10: 61.9 - V2T$Median R: 5.0 - V2T$Mean R: 37.7
2024-04-28 23:39:00,955:INFO: Effective parameters:
2024-04-28 23:39:00,955:INFO:   <<< batch_size: 16
2024-04-28 23:39:00,955:INFO:   <<< batch_size_val: 16
2024-04-28 23:39:00,955:INFO:   <<< cache_dir: 
2024-04-28 23:39:00,955:INFO:   <<< coef_lr: 0.001
2024-04-28 23:39:00,955:INFO:   <<< cross_model: cross-base
2024-04-28 23:39:00,955:INFO:   <<< cross_num_hidden_layers: 4
2024-04-28 23:39:00,955:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-28 23:39:00,955:INFO:   <<< datatype: msrvtt
2024-04-28 23:39:00,955:INFO:   <<< do_eval: True
2024-04-28 23:39:00,955:INFO:   <<< do_lower_case: False
2024-04-28 23:39:00,955:INFO:   <<< do_pretrain: False
2024-04-28 23:39:00,955:INFO:   <<< do_train: False
2024-04-28 23:39:00,955:INFO:   <<< epochs: 5
2024-04-28 23:39:00,955:INFO:   <<< eval_frame_order: 0
2024-04-28 23:39:00,955:INFO:   <<< expand_msrvtt_sentences: True
2024-04-28 23:39:00,955:INFO:   <<< feature_framerate: 1
2024-04-28 23:39:00,955:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-28 23:39:00,955:INFO:   <<< fp16: False
2024-04-28 23:39:00,955:INFO:   <<< fp16_opt_level: O1
2024-04-28 23:39:00,955:INFO:   <<< freeze_layer_num: 0
2024-04-28 23:39:00,955:INFO:   <<< gradient_accumulation_steps: 1
2024-04-28 23:39:00,955:INFO:   <<< hard_negative_rate: 0.5
2024-04-28 23:39:00,955:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-28 23:39:00,955:INFO:   <<< linear_patch: 2d
2024-04-28 23:39:00,955:INFO:   <<< local_rank: 0
2024-04-28 23:39:00,955:INFO:   <<< loose_type: True
2024-04-28 23:39:00,955:INFO:   <<< lr: 0.0001
2024-04-28 23:39:00,955:INFO:   <<< lr_decay: 0.9
2024-04-28 23:39:00,955:INFO:   <<< margin: 0.1
2024-04-28 23:39:00,955:INFO:   <<< max_frames: 30
2024-04-28 23:39:00,956:INFO:   <<< max_words: 32
2024-04-28 23:39:00,956:INFO:   <<< n_display: 100
2024-04-28 23:39:00,956:INFO:   <<< n_gpu: 1
2024-04-28 23:39:00,956:INFO:   <<< n_pair: 1
2024-04-28 23:39:00,956:INFO:   <<< negative_weighting: 1
2024-04-28 23:39:00,956:INFO:   <<< num_thread_reader: 0
2024-04-28 23:39:00,956:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-28 23:39:00,956:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-28 23:39:00,956:INFO:   <<< rank: 0
2024-04-28 23:39:00,956:INFO:   <<< resume_model: None
2024-04-28 23:39:00,956:INFO:   <<< sampled_use_mil: False
2024-04-28 23:39:00,956:INFO:   <<< seed: 42
2024-04-28 23:39:00,956:INFO:   <<< sim_header: meanP
2024-04-28 23:39:00,956:INFO:   <<< slice_framepos: 2
2024-04-28 23:39:00,956:INFO:   <<< task_type: retrieval
2024-04-28 23:39:00,956:INFO:   <<< text_num_hidden_layers: 12
2024-04-28 23:39:00,956:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-28 23:39:00,956:INFO:   <<< train_frame_order: 0
2024-04-28 23:39:00,956:INFO:   <<< use_mil: False
2024-04-28 23:39:00,956:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-28 23:39:00,956:INFO:   <<< video_dim: 1024
2024-04-28 23:39:00,956:INFO:   <<< visual_num_hidden_layers: 12
2024-04-28 23:39:00,956:INFO:   <<< warmup_proportion: 0.1
2024-04-28 23:39:00,956:INFO:   <<< world_size: 1
2024-04-28 23:39:00,956:INFO: device: cuda:0 n_gpu: 1
2024-04-28 23:39:01,700:WARNING: Stage-One:True, Stage-Two:False
2024-04-28 23:39:01,700:WARNING: Test retrieval by loose type.
2024-04-28 23:39:01,700:WARNING: 	 embed_dim: 512
2024-04-28 23:39:01,700:WARNING: 	 image_resolution: 224
2024-04-28 23:39:01,700:WARNING: 	 vision_layers: 12
2024-04-28 23:39:01,700:WARNING: 	 vision_width: 768
2024-04-28 23:39:01,700:WARNING: 	 vision_patch_size: 32
2024-04-28 23:39:01,700:WARNING: 	 context_length: 77
2024-04-28 23:39:01,700:WARNING: 	 vocab_size: 49408
2024-04-28 23:39:01,700:WARNING: 	 transformer_width: 512
2024-04-28 23:39:01,701:WARNING: 	 transformer_heads: 8
2024-04-28 23:39:01,701:WARNING: 	 transformer_layers: 12
2024-04-28 23:39:01,701:WARNING: 		 linear_patch: 2d
2024-04-28 23:39:01,701:WARNING: 	 cut_top_layer: 0
2024-04-28 23:39:02,664:WARNING: 	 sim_header: meanP
2024-04-28 23:39:08,644:INFO: ***** Running test *****
2024-04-28 23:39:08,644:INFO:   Num examples = 1000
2024-04-28 23:39:08,644:INFO:   Batch size = 16
2024-04-28 23:39:08,644:INFO:   Num steps = 63
2024-04-28 23:39:08,644:INFO: ***** Running val *****
2024-04-28 23:39:08,644:INFO:   Num examples = 1000
2024-04-28 23:41:21,632:INFO: sim matrix size: 1000, 1000
2024-04-28 23:41:21,658:INFO: 	 Length-T: 1000, Length-V:1000
2024-04-28 23:41:21,658:INFO: Text-to-Video:
2024-04-28 23:41:21,658:INFO: 	>>>  R@1: 30.7 - R@5: 54.1 - R@10: 63.9 - Median R: 4.0 - Mean R: 38.7
2024-04-28 23:41:21,658:INFO: Video-to-Text:
2024-04-28 23:41:21,658:INFO: 	>>>  V2T$R@1: 26.8 - V2T$R@5: 51.7 - V2T$R@10: 61.9 - V2T$Median R: 5.0 - V2T$Mean R: 37.7
2024-04-28 23:46:06,848:INFO: Effective parameters:
2024-04-28 23:46:06,848:INFO:   <<< batch_size: 16
2024-04-28 23:46:06,848:INFO:   <<< batch_size_val: 16
2024-04-28 23:46:06,848:INFO:   <<< cache_dir: 
2024-04-28 23:46:06,848:INFO:   <<< coef_lr: 0.001
2024-04-28 23:46:06,848:INFO:   <<< cross_model: cross-base
2024-04-28 23:46:06,848:INFO:   <<< cross_num_hidden_layers: 4
2024-04-28 23:46:06,848:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-28 23:46:06,848:INFO:   <<< datatype: msrvtt
2024-04-28 23:46:06,848:INFO:   <<< do_eval: True
2024-04-28 23:46:06,848:INFO:   <<< do_lower_case: False
2024-04-28 23:46:06,848:INFO:   <<< do_pretrain: False
2024-04-28 23:46:06,848:INFO:   <<< do_train: False
2024-04-28 23:46:06,849:INFO:   <<< epochs: 5
2024-04-28 23:46:06,849:INFO:   <<< eval_frame_order: 0
2024-04-28 23:46:06,849:INFO:   <<< expand_msrvtt_sentences: True
2024-04-28 23:46:06,849:INFO:   <<< feature_framerate: 1
2024-04-28 23:46:06,849:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-28 23:46:06,849:INFO:   <<< fp16: False
2024-04-28 23:46:06,849:INFO:   <<< fp16_opt_level: O1
2024-04-28 23:46:06,849:INFO:   <<< freeze_layer_num: 0
2024-04-28 23:46:06,849:INFO:   <<< gradient_accumulation_steps: 1
2024-04-28 23:46:06,849:INFO:   <<< hard_negative_rate: 0.5
2024-04-28 23:46:06,849:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-28 23:46:06,849:INFO:   <<< linear_patch: 2d
2024-04-28 23:46:06,849:INFO:   <<< local_rank: 0
2024-04-28 23:46:06,849:INFO:   <<< loose_type: True
2024-04-28 23:46:06,849:INFO:   <<< lr: 0.0001
2024-04-28 23:46:06,849:INFO:   <<< lr_decay: 0.9
2024-04-28 23:46:06,849:INFO:   <<< margin: 0.1
2024-04-28 23:46:06,849:INFO:   <<< max_frames: 30
2024-04-28 23:46:06,850:INFO:   <<< max_words: 32
2024-04-28 23:46:06,850:INFO:   <<< n_display: 100
2024-04-28 23:46:06,850:INFO:   <<< n_gpu: 1
2024-04-28 23:46:06,850:INFO:   <<< n_pair: 1
2024-04-28 23:46:06,850:INFO:   <<< negative_weighting: 1
2024-04-28 23:46:06,850:INFO:   <<< num_thread_reader: 0
2024-04-28 23:46:06,850:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-28 23:46:06,850:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-28 23:46:06,850:INFO:   <<< rank: 0
2024-04-28 23:46:06,850:INFO:   <<< resume_model: None
2024-04-28 23:46:06,850:INFO:   <<< sampled_use_mil: False
2024-04-28 23:46:06,850:INFO:   <<< seed: 42
2024-04-28 23:46:06,850:INFO:   <<< sim_header: meanP
2024-04-28 23:46:06,850:INFO:   <<< slice_framepos: 2
2024-04-28 23:46:06,850:INFO:   <<< task_type: retrieval
2024-04-28 23:46:06,850:INFO:   <<< text_num_hidden_layers: 12
2024-04-28 23:46:06,850:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-28 23:46:06,851:INFO:   <<< train_frame_order: 0
2024-04-28 23:46:06,851:INFO:   <<< use_mil: False
2024-04-28 23:46:06,851:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-28 23:46:06,851:INFO:   <<< video_dim: 1024
2024-04-28 23:46:06,851:INFO:   <<< visual_num_hidden_layers: 12
2024-04-28 23:46:06,851:INFO:   <<< warmup_proportion: 0.1
2024-04-28 23:46:06,851:INFO:   <<< world_size: 1
2024-04-28 23:46:06,851:INFO: device: cuda:0 n_gpu: 1
2024-04-28 23:46:40,795:WARNING: Stage-One:True, Stage-Two:False
2024-04-28 23:46:40,796:WARNING: Test retrieval by loose type.
2024-04-28 23:46:40,797:WARNING: 	 embed_dim: 512
2024-04-28 23:46:40,797:WARNING: 	 image_resolution: 224
2024-04-28 23:46:40,797:WARNING: 	 vision_layers: 12
2024-04-28 23:46:40,797:WARNING: 	 vision_width: 768
2024-04-28 23:46:40,798:WARNING: 	 vision_patch_size: 32
2024-04-28 23:46:40,798:WARNING: 	 context_length: 77
2024-04-28 23:46:40,798:WARNING: 	 vocab_size: 49408
2024-04-28 23:46:40,798:WARNING: 	 transformer_width: 512
2024-04-28 23:46:40,798:WARNING: 	 transformer_heads: 8
2024-04-28 23:46:40,799:WARNING: 	 transformer_layers: 12
2024-04-28 23:46:40,799:WARNING: 		 linear_patch: 2d
2024-04-28 23:46:40,799:WARNING: 	 cut_top_layer: 0
2024-04-28 23:46:41,809:WARNING: 	 sim_header: meanP
2024-04-28 23:46:54,074:INFO: ***** Running test *****
2024-04-28 23:46:54,074:INFO:   Num examples = 1000
2024-04-28 23:46:54,074:INFO:   Batch size = 16
2024-04-28 23:46:54,074:INFO:   Num steps = 63
2024-04-28 23:46:54,074:INFO: ***** Running val *****
2024-04-28 23:46:54,075:INFO:   Num examples = 1000
2024-04-28 23:49:16,373:INFO: sim matrix size: 1000, 1000
2024-04-28 23:49:16,400:INFO: 	 Length-T: 1000, Length-V:1000
2024-04-28 23:49:16,400:INFO: Text-to-Video:
2024-04-28 23:49:16,400:INFO: 	>>>  R@1: 42.5 - R@5: 68.8 - R@10: 78.2 - Median R: 2.0 - Mean R: 16.3
2024-04-28 23:49:16,401:INFO: Video-to-Text:
2024-04-28 23:49:16,401:INFO: 	>>>  V2T$R@1: 40.4 - V2T$R@5: 68.6 - V2T$R@10: 79.6 - V2T$Median R: 2.0 - V2T$Mean R: 13.1
2024-04-29 00:05:15,997:INFO: Effective parameters:
2024-04-29 00:05:15,997:INFO:   <<< batch_size: 16
2024-04-29 00:05:15,997:INFO:   <<< batch_size_val: 16
2024-04-29 00:05:15,998:INFO:   <<< cache_dir: 
2024-04-29 00:05:15,998:INFO:   <<< coef_lr: 0.001
2024-04-29 00:05:15,998:INFO:   <<< cross_model: cross-base
2024-04-29 00:05:15,998:INFO:   <<< cross_num_hidden_layers: 4
2024-04-29 00:05:15,998:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-29 00:05:15,998:INFO:   <<< datatype: msrvtt
2024-04-29 00:05:15,998:INFO:   <<< do_eval: True
2024-04-29 00:05:15,998:INFO:   <<< do_lower_case: False
2024-04-29 00:05:15,998:INFO:   <<< do_pretrain: False
2024-04-29 00:05:15,998:INFO:   <<< do_train: False
2024-04-29 00:05:15,998:INFO:   <<< epochs: 5
2024-04-29 00:05:15,998:INFO:   <<< eval_frame_order: 0
2024-04-29 00:05:15,998:INFO:   <<< expand_msrvtt_sentences: True
2024-04-29 00:05:15,999:INFO:   <<< feature_framerate: 1
2024-04-29 00:05:15,999:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-29 00:05:15,999:INFO:   <<< fp16: False
2024-04-29 00:05:15,999:INFO:   <<< fp16_opt_level: O1
2024-04-29 00:05:15,999:INFO:   <<< freeze_layer_num: 0
2024-04-29 00:05:15,999:INFO:   <<< gradient_accumulation_steps: 1
2024-04-29 00:05:15,999:INFO:   <<< hard_negative_rate: 0.5
2024-04-29 00:05:15,999:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-29 00:05:15,999:INFO:   <<< linear_patch: 2d
2024-04-29 00:05:15,999:INFO:   <<< local_rank: 0
2024-04-29 00:05:15,999:INFO:   <<< loose_type: True
2024-04-29 00:05:15,999:INFO:   <<< lr: 0.0001
2024-04-29 00:05:15,999:INFO:   <<< lr_decay: 0.9
2024-04-29 00:05:15,999:INFO:   <<< margin: 0.1
2024-04-29 00:05:16,000:INFO:   <<< max_frames: 30
2024-04-29 00:05:16,000:INFO:   <<< max_words: 32
2024-04-29 00:05:16,000:INFO:   <<< n_display: 100
2024-04-29 00:05:16,000:INFO:   <<< n_gpu: 1
2024-04-29 00:05:16,000:INFO:   <<< n_pair: 1
2024-04-29 00:05:16,000:INFO:   <<< negative_weighting: 1
2024-04-29 00:05:16,000:INFO:   <<< num_thread_reader: 0
2024-04-29 00:05:16,000:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-29 00:05:16,000:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-29 00:05:16,000:INFO:   <<< rank: 0
2024-04-29 00:05:16,000:INFO:   <<< resume_model: None
2024-04-29 00:05:16,000:INFO:   <<< sampled_use_mil: False
2024-04-29 00:05:16,000:INFO:   <<< seed: 42
2024-04-29 00:05:16,001:INFO:   <<< sim_header: meanP
2024-04-29 00:05:16,001:INFO:   <<< slice_framepos: 2
2024-04-29 00:05:16,001:INFO:   <<< task_type: retrieval
2024-04-29 00:05:16,001:INFO:   <<< text_num_hidden_layers: 12
2024-04-29 00:05:16,001:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-29 00:05:16,001:INFO:   <<< train_frame_order: 0
2024-04-29 00:05:16,001:INFO:   <<< use_mil: False
2024-04-29 00:05:16,001:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-29 00:05:16,001:INFO:   <<< video_dim: 1024
2024-04-29 00:05:16,001:INFO:   <<< visual_num_hidden_layers: 12
2024-04-29 00:05:16,001:INFO:   <<< warmup_proportion: 0.1
2024-04-29 00:05:16,001:INFO:   <<< world_size: 1
2024-04-29 00:05:16,001:INFO: device: cuda:0 n_gpu: 1
2024-04-29 00:05:16,223:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-29 00:05:16,760:WARNING: Stage-One:True, Stage-Two:False
2024-04-29 00:05:16,760:WARNING: Test retrieval by loose type.
2024-04-29 00:05:16,761:WARNING: 	 embed_dim: 512
2024-04-29 00:05:16,761:WARNING: 	 image_resolution: 224
2024-04-29 00:05:16,761:WARNING: 	 vision_layers: 12
2024-04-29 00:05:16,761:WARNING: 	 vision_width: 768
2024-04-29 00:05:16,761:WARNING: 	 vision_patch_size: 32
2024-04-29 00:05:16,761:WARNING: 	 context_length: 77
2024-04-29 00:05:16,761:WARNING: 	 vocab_size: 49408
2024-04-29 00:05:16,761:WARNING: 	 transformer_width: 512
2024-04-29 00:05:16,761:WARNING: 	 transformer_heads: 8
2024-04-29 00:05:16,761:WARNING: 	 transformer_layers: 12
2024-04-29 00:05:16,762:WARNING: 		 linear_patch: 2d
2024-04-29 00:05:16,762:WARNING: 	 cut_top_layer: 0
2024-04-29 00:05:17,742:WARNING: 	 sim_header: meanP
2024-04-29 00:09:10,401:INFO: Effective parameters:
2024-04-29 00:09:10,402:INFO:   <<< batch_size: 16
2024-04-29 00:09:10,402:INFO:   <<< batch_size_val: 16
2024-04-29 00:09:10,402:INFO:   <<< cache_dir: 
2024-04-29 00:09:10,402:INFO:   <<< coef_lr: 0.001
2024-04-29 00:09:10,402:INFO:   <<< cross_model: cross-base
2024-04-29 00:09:10,402:INFO:   <<< cross_num_hidden_layers: 4
2024-04-29 00:09:10,402:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-29 00:09:10,402:INFO:   <<< datatype: msrvtt
2024-04-29 00:09:10,402:INFO:   <<< do_eval: True
2024-04-29 00:09:10,402:INFO:   <<< do_lower_case: False
2024-04-29 00:09:10,402:INFO:   <<< do_pretrain: False
2024-04-29 00:09:10,402:INFO:   <<< do_train: False
2024-04-29 00:09:10,402:INFO:   <<< epochs: 5
2024-04-29 00:09:10,402:INFO:   <<< eval_frame_order: 0
2024-04-29 00:09:10,402:INFO:   <<< expand_msrvtt_sentences: True
2024-04-29 00:09:10,402:INFO:   <<< feature_framerate: 1
2024-04-29 00:09:10,402:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-29 00:09:10,402:INFO:   <<< fp16: False
2024-04-29 00:09:10,402:INFO:   <<< fp16_opt_level: O1
2024-04-29 00:09:10,402:INFO:   <<< freeze_layer_num: 0
2024-04-29 00:09:10,402:INFO:   <<< gradient_accumulation_steps: 1
2024-04-29 00:09:10,402:INFO:   <<< hard_negative_rate: 0.5
2024-04-29 00:09:10,402:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-29 00:09:10,402:INFO:   <<< linear_patch: 2d
2024-04-29 00:09:10,402:INFO:   <<< local_rank: 0
2024-04-29 00:09:10,402:INFO:   <<< loose_type: True
2024-04-29 00:09:10,402:INFO:   <<< lr: 0.0001
2024-04-29 00:09:10,402:INFO:   <<< lr_decay: 0.9
2024-04-29 00:09:10,402:INFO:   <<< margin: 0.1
2024-04-29 00:09:10,402:INFO:   <<< max_frames: 30
2024-04-29 00:09:10,402:INFO:   <<< max_words: 32
2024-04-29 00:09:10,402:INFO:   <<< n_display: 100
2024-04-29 00:09:10,402:INFO:   <<< n_gpu: 1
2024-04-29 00:09:10,402:INFO:   <<< n_pair: 1
2024-04-29 00:09:10,402:INFO:   <<< negative_weighting: 1
2024-04-29 00:09:10,402:INFO:   <<< num_thread_reader: 0
2024-04-29 00:09:10,402:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-29 00:09:10,402:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-29 00:09:10,402:INFO:   <<< rank: 0
2024-04-29 00:09:10,402:INFO:   <<< resume_model: None
2024-04-29 00:09:10,402:INFO:   <<< sampled_use_mil: False
2024-04-29 00:09:10,402:INFO:   <<< seed: 42
2024-04-29 00:09:10,402:INFO:   <<< sim_header: meanP
2024-04-29 00:09:10,402:INFO:   <<< slice_framepos: 2
2024-04-29 00:09:10,402:INFO:   <<< task_type: retrieval
2024-04-29 00:09:10,402:INFO:   <<< text_num_hidden_layers: 12
2024-04-29 00:09:10,402:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-29 00:09:10,402:INFO:   <<< train_frame_order: 0
2024-04-29 00:09:10,402:INFO:   <<< use_mil: False
2024-04-29 00:09:10,402:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-29 00:09:10,402:INFO:   <<< video_dim: 1024
2024-04-29 00:09:10,402:INFO:   <<< visual_num_hidden_layers: 12
2024-04-29 00:09:10,402:INFO:   <<< warmup_proportion: 0.1
2024-04-29 00:09:10,402:INFO:   <<< world_size: 1
2024-04-29 00:09:10,402:INFO: device: cuda:0 n_gpu: 1
2024-04-29 00:09:10,592:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-29 00:09:11,106:WARNING: Stage-One:True, Stage-Two:False
2024-04-29 00:09:11,106:WARNING: Test retrieval by loose type.
2024-04-29 00:09:11,106:WARNING: 	 embed_dim: 512
2024-04-29 00:09:11,106:WARNING: 	 image_resolution: 224
2024-04-29 00:09:11,106:WARNING: 	 vision_layers: 12
2024-04-29 00:09:11,106:WARNING: 	 vision_width: 768
2024-04-29 00:09:11,106:WARNING: 	 vision_patch_size: 32
2024-04-29 00:09:11,106:WARNING: 	 context_length: 77
2024-04-29 00:09:11,106:WARNING: 	 vocab_size: 49408
2024-04-29 00:09:11,106:WARNING: 	 transformer_width: 512
2024-04-29 00:09:11,106:WARNING: 	 transformer_heads: 8
2024-04-29 00:09:11,106:WARNING: 	 transformer_layers: 12
2024-04-29 00:09:11,106:WARNING: 		 linear_patch: 2d
2024-04-29 00:09:11,106:WARNING: 	 cut_top_layer: 0
2024-04-29 00:09:12,048:WARNING: 	 sim_header: meanP
2024-04-29 00:09:18,009:INFO: ***** Running test *****
2024-04-29 00:09:18,009:INFO:   Num examples = 29
2024-04-29 00:09:18,009:INFO:   Batch size = 16
2024-04-29 00:09:18,009:INFO:   Num steps = 2
2024-04-29 00:09:18,009:INFO: ***** Running val *****
2024-04-29 00:09:18,009:INFO:   Num examples = 29
2024-04-29 00:09:21,479:INFO: sim matrix size: 29, 29
2024-04-29 00:09:21,479:INFO: 	 Length-T: 29, Length-V:29
2024-04-29 00:09:21,479:INFO: Text-to-Video:
2024-04-29 00:09:21,479:INFO: 	>>>  R@1: 79.3 - R@5: 96.6 - R@10: 100.0 - Median R: 1.0 - Mean R: 1.5
2024-04-29 00:09:21,479:INFO: Video-to-Text:
2024-04-29 00:09:21,479:INFO: 	>>>  V2T$R@1: 79.3 - V2T$R@5: 100.0 - V2T$R@10: 100.0 - V2T$Median R: 1.0 - V2T$Mean R: 1.4
2024-04-29 00:10:30,909:INFO: Effective parameters:
2024-04-29 00:10:30,910:INFO:   <<< batch_size: 16
2024-04-29 00:10:30,910:INFO:   <<< batch_size_val: 16
2024-04-29 00:10:30,910:INFO:   <<< cache_dir: 
2024-04-29 00:10:30,910:INFO:   <<< coef_lr: 0.001
2024-04-29 00:10:30,910:INFO:   <<< cross_model: cross-base
2024-04-29 00:10:30,910:INFO:   <<< cross_num_hidden_layers: 4
2024-04-29 00:10:30,910:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-29 00:10:30,910:INFO:   <<< datatype: msrvtt
2024-04-29 00:10:30,910:INFO:   <<< do_eval: True
2024-04-29 00:10:30,910:INFO:   <<< do_lower_case: False
2024-04-29 00:10:30,910:INFO:   <<< do_pretrain: False
2024-04-29 00:10:30,910:INFO:   <<< do_train: False
2024-04-29 00:10:30,910:INFO:   <<< epochs: 5
2024-04-29 00:10:30,911:INFO:   <<< eval_frame_order: 0
2024-04-29 00:10:30,911:INFO:   <<< expand_msrvtt_sentences: True
2024-04-29 00:10:30,911:INFO:   <<< feature_framerate: 1
2024-04-29 00:10:30,911:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-29 00:10:30,911:INFO:   <<< fp16: False
2024-04-29 00:10:30,911:INFO:   <<< fp16_opt_level: O1
2024-04-29 00:10:30,911:INFO:   <<< freeze_layer_num: 0
2024-04-29 00:10:30,911:INFO:   <<< gradient_accumulation_steps: 1
2024-04-29 00:10:30,911:INFO:   <<< hard_negative_rate: 0.5
2024-04-29 00:10:30,911:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-29 00:10:30,911:INFO:   <<< linear_patch: 2d
2024-04-29 00:10:30,911:INFO:   <<< local_rank: 0
2024-04-29 00:10:30,911:INFO:   <<< loose_type: True
2024-04-29 00:10:30,911:INFO:   <<< lr: 0.0001
2024-04-29 00:10:30,911:INFO:   <<< lr_decay: 0.9
2024-04-29 00:10:30,911:INFO:   <<< margin: 0.1
2024-04-29 00:10:30,911:INFO:   <<< max_frames: 30
2024-04-29 00:10:30,912:INFO:   <<< max_words: 32
2024-04-29 00:10:30,912:INFO:   <<< n_display: 100
2024-04-29 00:10:30,912:INFO:   <<< n_gpu: 1
2024-04-29 00:10:30,912:INFO:   <<< n_pair: 1
2024-04-29 00:10:30,912:INFO:   <<< negative_weighting: 1
2024-04-29 00:10:30,912:INFO:   <<< num_thread_reader: 0
2024-04-29 00:10:30,912:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-29 00:10:30,912:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-29 00:10:30,912:INFO:   <<< rank: 0
2024-04-29 00:10:30,912:INFO:   <<< resume_model: None
2024-04-29 00:10:30,912:INFO:   <<< sampled_use_mil: False
2024-04-29 00:10:30,912:INFO:   <<< seed: 42
2024-04-29 00:10:30,912:INFO:   <<< sim_header: meanP
2024-04-29 00:10:30,912:INFO:   <<< slice_framepos: 2
2024-04-29 00:10:30,912:INFO:   <<< task_type: retrieval
2024-04-29 00:10:30,912:INFO:   <<< text_num_hidden_layers: 12
2024-04-29 00:10:30,912:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-29 00:10:30,913:INFO:   <<< train_frame_order: 0
2024-04-29 00:10:30,913:INFO:   <<< use_mil: False
2024-04-29 00:10:30,913:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-29 00:10:30,913:INFO:   <<< video_dim: 1024
2024-04-29 00:10:30,913:INFO:   <<< visual_num_hidden_layers: 12
2024-04-29 00:10:30,913:INFO:   <<< warmup_proportion: 0.1
2024-04-29 00:10:30,913:INFO:   <<< world_size: 1
2024-04-29 00:10:30,913:INFO: device: cuda:0 n_gpu: 1
2024-04-29 00:10:31,134:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-29 00:10:31,669:WARNING: Stage-One:True, Stage-Two:False
2024-04-29 00:10:31,670:WARNING: Test retrieval by loose type.
2024-04-29 00:10:31,670:WARNING: 	 embed_dim: 512
2024-04-29 00:10:31,670:WARNING: 	 image_resolution: 224
2024-04-29 00:10:31,670:WARNING: 	 vision_layers: 12
2024-04-29 00:10:31,670:WARNING: 	 vision_width: 768
2024-04-29 00:10:31,671:WARNING: 	 vision_patch_size: 32
2024-04-29 00:10:31,671:WARNING: 	 context_length: 77
2024-04-29 00:10:31,671:WARNING: 	 vocab_size: 49408
2024-04-29 00:10:31,671:WARNING: 	 transformer_width: 512
2024-04-29 00:10:31,671:WARNING: 	 transformer_heads: 8
2024-04-29 00:10:31,671:WARNING: 	 transformer_layers: 12
2024-04-29 00:10:31,671:WARNING: 		 linear_patch: 2d
2024-04-29 00:10:31,671:WARNING: 	 cut_top_layer: 0
2024-04-29 00:10:32,645:WARNING: 	 sim_header: meanP
2024-04-29 00:10:38,667:INFO: ***** Running test *****
2024-04-29 00:10:38,667:INFO:   Num examples = 29
2024-04-29 00:10:38,667:INFO:   Batch size = 16
2024-04-29 00:10:38,680:INFO:   Num steps = 2
2024-04-29 00:10:38,680:INFO: ***** Running val *****
2024-04-29 00:10:38,680:INFO:   Num examples = 29
2024-04-29 07:16:26,851:INFO: Effective parameters:
2024-04-29 07:16:26,851:INFO:   <<< batch_size: 16
2024-04-29 07:16:26,851:INFO:   <<< batch_size_val: 16
2024-04-29 07:16:26,851:INFO:   <<< cache_dir: 
2024-04-29 07:16:26,851:INFO:   <<< coef_lr: 0.001
2024-04-29 07:16:26,851:INFO:   <<< cross_model: cross-base
2024-04-29 07:16:26,851:INFO:   <<< cross_num_hidden_layers: 4
2024-04-29 07:16:26,851:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-29 07:16:26,852:INFO:   <<< datatype: msrvtt
2024-04-29 07:16:26,852:INFO:   <<< do_eval: True
2024-04-29 07:16:26,852:INFO:   <<< do_lower_case: False
2024-04-29 07:16:26,852:INFO:   <<< do_pretrain: False
2024-04-29 07:16:26,852:INFO:   <<< do_train: False
2024-04-29 07:16:26,852:INFO:   <<< epochs: 5
2024-04-29 07:16:26,852:INFO:   <<< eval_frame_order: 0
2024-04-29 07:16:26,852:INFO:   <<< expand_msrvtt_sentences: True
2024-04-29 07:16:26,852:INFO:   <<< feature_framerate: 1
2024-04-29 07:16:26,852:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-29 07:16:26,852:INFO:   <<< fp16: False
2024-04-29 07:16:26,852:INFO:   <<< fp16_opt_level: O1
2024-04-29 07:16:26,852:INFO:   <<< freeze_layer_num: 0
2024-04-29 07:16:26,852:INFO:   <<< gradient_accumulation_steps: 1
2024-04-29 07:16:26,852:INFO:   <<< hard_negative_rate: 0.5
2024-04-29 07:16:26,852:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-29 07:16:26,853:INFO:   <<< linear_patch: 2d
2024-04-29 07:16:26,853:INFO:   <<< local_rank: 0
2024-04-29 07:16:26,853:INFO:   <<< loose_type: True
2024-04-29 07:16:26,853:INFO:   <<< lr: 0.0001
2024-04-29 07:16:26,853:INFO:   <<< lr_decay: 0.9
2024-04-29 07:16:26,853:INFO:   <<< margin: 0.1
2024-04-29 07:16:26,853:INFO:   <<< max_frames: 30
2024-04-29 07:16:26,853:INFO:   <<< max_words: 32
2024-04-29 07:16:26,853:INFO:   <<< n_display: 100
2024-04-29 07:16:26,853:INFO:   <<< n_gpu: 1
2024-04-29 07:16:26,853:INFO:   <<< n_pair: 1
2024-04-29 07:16:26,853:INFO:   <<< negative_weighting: 1
2024-04-29 07:16:26,853:INFO:   <<< num_thread_reader: 0
2024-04-29 07:16:26,853:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-29 07:16:26,853:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-29 07:16:26,853:INFO:   <<< rank: 0
2024-04-29 07:16:26,853:INFO:   <<< resume_model: None
2024-04-29 07:16:26,854:INFO:   <<< sampled_use_mil: False
2024-04-29 07:16:26,854:INFO:   <<< seed: 42
2024-04-29 07:16:26,854:INFO:   <<< sim_header: meanP
2024-04-29 07:16:26,854:INFO:   <<< slice_framepos: 2
2024-04-29 07:16:26,854:INFO:   <<< task_type: retrieval
2024-04-29 07:16:26,854:INFO:   <<< text_num_hidden_layers: 12
2024-04-29 07:16:26,854:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-29 07:16:26,854:INFO:   <<< train_frame_order: 0
2024-04-29 07:16:26,854:INFO:   <<< use_mil: False
2024-04-29 07:16:26,854:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-29 07:16:26,854:INFO:   <<< video_dim: 1024
2024-04-29 07:16:26,854:INFO:   <<< visual_num_hidden_layers: 12
2024-04-29 07:16:26,854:INFO:   <<< warmup_proportion: 0.1
2024-04-29 07:16:26,854:INFO:   <<< world_size: 1
2024-04-29 07:16:26,854:INFO: device: cuda:0 n_gpu: 1
2024-04-29 07:16:27,170:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-29 07:16:27,884:WARNING: Stage-One:True, Stage-Two:False
2024-04-29 07:16:27,885:WARNING: Test retrieval by loose type.
2024-04-29 07:16:27,885:WARNING: 	 embed_dim: 512
2024-04-29 07:16:27,885:WARNING: 	 image_resolution: 224
2024-04-29 07:16:27,885:WARNING: 	 vision_layers: 12
2024-04-29 07:16:27,885:WARNING: 	 vision_width: 768
2024-04-29 07:16:27,886:WARNING: 	 vision_patch_size: 32
2024-04-29 07:16:27,886:WARNING: 	 context_length: 77
2024-04-29 07:16:27,886:WARNING: 	 vocab_size: 49408
2024-04-29 07:16:27,886:WARNING: 	 transformer_width: 512
2024-04-29 07:16:27,886:WARNING: 	 transformer_heads: 8
2024-04-29 07:16:27,886:WARNING: 	 transformer_layers: 12
2024-04-29 07:16:27,886:WARNING: 		 linear_patch: 2d
2024-04-29 07:16:27,886:WARNING: 	 cut_top_layer: 0
2024-04-29 07:16:28,884:WARNING: 	 sim_header: meanP
2024-04-29 07:16:35,489:INFO: ***** Running test *****
2024-04-29 07:16:35,489:INFO:   Num examples = 29
2024-04-29 07:16:35,489:INFO:   Batch size = 16
2024-04-29 07:16:35,503:INFO:   Num steps = 2
2024-04-29 07:16:35,503:INFO: ***** Running val *****
2024-04-29 07:16:35,503:INFO:   Num examples = 29
2024-04-30 00:53:39,511:INFO: Effective parameters:
2024-04-30 00:53:39,511:INFO:   <<< batch_size: 16
2024-04-30 00:53:39,511:INFO:   <<< batch_size_val: 16
2024-04-30 00:53:39,512:INFO:   <<< cache_dir: 
2024-04-30 00:53:39,512:INFO:   <<< coef_lr: 0.001
2024-04-30 00:53:39,512:INFO:   <<< cross_model: cross-base
2024-04-30 00:53:39,512:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 00:53:39,512:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 00:53:39,512:INFO:   <<< datatype: msrvtt
2024-04-30 00:53:39,512:INFO:   <<< do_eval: True
2024-04-30 00:53:39,512:INFO:   <<< do_lower_case: False
2024-04-30 00:53:39,512:INFO:   <<< do_pretrain: False
2024-04-30 00:53:39,512:INFO:   <<< do_train: False
2024-04-30 00:53:39,512:INFO:   <<< epochs: 5
2024-04-30 00:53:39,512:INFO:   <<< eval_frame_order: 0
2024-04-30 00:53:39,512:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 00:53:39,512:INFO:   <<< feature_framerate: 1
2024-04-30 00:53:39,512:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 00:53:39,512:INFO:   <<< fp16: False
2024-04-30 00:53:39,512:INFO:   <<< fp16_opt_level: O1
2024-04-30 00:53:39,513:INFO:   <<< freeze_layer_num: 0
2024-04-30 00:53:39,513:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 00:53:39,513:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 00:53:39,513:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 00:53:39,513:INFO:   <<< linear_patch: 2d
2024-04-30 00:53:39,513:INFO:   <<< local_rank: 0
2024-04-30 00:53:39,513:INFO:   <<< loose_type: True
2024-04-30 00:53:39,513:INFO:   <<< lr: 0.0001
2024-04-30 00:53:39,513:INFO:   <<< lr_decay: 0.9
2024-04-30 00:53:39,513:INFO:   <<< margin: 0.1
2024-04-30 00:53:39,513:INFO:   <<< max_frames: 30
2024-04-30 00:53:39,513:INFO:   <<< max_words: 32
2024-04-30 00:53:39,513:INFO:   <<< n_display: 100
2024-04-30 00:53:39,513:INFO:   <<< n_gpu: 1
2024-04-30 00:53:39,513:INFO:   <<< n_pair: 1
2024-04-30 00:53:39,513:INFO:   <<< negative_weighting: 1
2024-04-30 00:53:39,513:INFO:   <<< num_thread_reader: 0
2024-04-30 00:53:39,513:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 00:53:39,514:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 00:53:39,514:INFO:   <<< rank: 0
2024-04-30 00:53:39,514:INFO:   <<< resume_model: None
2024-04-30 00:53:39,514:INFO:   <<< sampled_use_mil: False
2024-04-30 00:53:39,514:INFO:   <<< seed: 42
2024-04-30 00:53:39,514:INFO:   <<< sim_header: meanP
2024-04-30 00:53:39,514:INFO:   <<< slice_framepos: 2
2024-04-30 00:53:39,514:INFO:   <<< task_type: retrieval
2024-04-30 00:53:39,514:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 00:53:39,514:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 00:53:39,514:INFO:   <<< train_frame_order: 0
2024-04-30 00:53:39,514:INFO:   <<< use_mil: False
2024-04-30 00:53:39,514:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 00:53:39,514:INFO:   <<< video_dim: 1024
2024-04-30 00:53:39,514:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 00:53:39,514:INFO:   <<< warmup_proportion: 0.1
2024-04-30 00:53:39,514:INFO:   <<< world_size: 1
2024-04-30 00:53:39,515:INFO: device: cuda:0 n_gpu: 1
2024-04-30 00:53:39,819:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 00:53:40,506:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 00:53:40,506:WARNING: Test retrieval by loose type.
2024-04-30 00:53:40,507:WARNING: 	 embed_dim: 512
2024-04-30 00:53:40,507:WARNING: 	 image_resolution: 224
2024-04-30 00:53:40,507:WARNING: 	 vision_layers: 12
2024-04-30 00:53:40,507:WARNING: 	 vision_width: 768
2024-04-30 00:53:40,507:WARNING: 	 vision_patch_size: 32
2024-04-30 00:53:40,507:WARNING: 	 context_length: 77
2024-04-30 00:53:40,507:WARNING: 	 vocab_size: 49408
2024-04-30 00:53:40,507:WARNING: 	 transformer_width: 512
2024-04-30 00:53:40,507:WARNING: 	 transformer_heads: 8
2024-04-30 00:53:40,507:WARNING: 	 transformer_layers: 12
2024-04-30 00:53:40,507:WARNING: 		 linear_patch: 2d
2024-04-30 00:53:40,507:WARNING: 	 cut_top_layer: 0
2024-04-30 00:53:41,521:WARNING: 	 sim_header: meanP
2024-04-30 00:53:48,120:INFO: ***** Running test *****
2024-04-30 00:53:48,120:INFO:   Num examples = 29
2024-04-30 00:53:48,120:INFO:   Batch size = 16
2024-04-30 00:53:48,132:INFO:   Num steps = 2
2024-04-30 00:53:48,132:INFO: ***** Running val *****
2024-04-30 00:53:48,132:INFO:   Num examples = 29
2024-04-30 01:08:29,443:INFO: Effective parameters:
2024-04-30 01:08:29,443:INFO:   <<< batch_size: 16
2024-04-30 01:08:29,443:INFO:   <<< batch_size_val: 16
2024-04-30 01:08:29,443:INFO:   <<< cache_dir: 
2024-04-30 01:08:29,443:INFO:   <<< coef_lr: 0.001
2024-04-30 01:08:29,443:INFO:   <<< cross_model: cross-base
2024-04-30 01:08:29,443:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 01:08:29,443:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 01:08:29,443:INFO:   <<< datatype: msrvtt
2024-04-30 01:08:29,444:INFO:   <<< do_eval: True
2024-04-30 01:08:29,444:INFO:   <<< do_lower_case: False
2024-04-30 01:08:29,444:INFO:   <<< do_pretrain: False
2024-04-30 01:08:29,444:INFO:   <<< do_train: False
2024-04-30 01:08:29,444:INFO:   <<< epochs: 5
2024-04-30 01:08:29,444:INFO:   <<< eval_frame_order: 0
2024-04-30 01:08:29,444:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 01:08:29,444:INFO:   <<< feature_framerate: 1
2024-04-30 01:08:29,444:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 01:08:29,444:INFO:   <<< fp16: False
2024-04-30 01:08:29,444:INFO:   <<< fp16_opt_level: O1
2024-04-30 01:08:29,444:INFO:   <<< freeze_layer_num: 0
2024-04-30 01:08:29,444:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 01:08:29,444:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 01:08:29,444:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:08:29,444:INFO:   <<< linear_patch: 2d
2024-04-30 01:08:29,444:INFO:   <<< local_rank: 0
2024-04-30 01:08:29,445:INFO:   <<< loose_type: True
2024-04-30 01:08:29,445:INFO:   <<< lr: 0.0001
2024-04-30 01:08:29,445:INFO:   <<< lr_decay: 0.9
2024-04-30 01:08:29,445:INFO:   <<< margin: 0.1
2024-04-30 01:08:29,445:INFO:   <<< max_frames: 30
2024-04-30 01:08:29,445:INFO:   <<< max_words: 32
2024-04-30 01:08:29,445:INFO:   <<< n_display: 100
2024-04-30 01:08:29,445:INFO:   <<< n_gpu: 1
2024-04-30 01:08:29,445:INFO:   <<< n_pair: 1
2024-04-30 01:08:29,445:INFO:   <<< negative_weighting: 1
2024-04-30 01:08:29,445:INFO:   <<< num_thread_reader: 0
2024-04-30 01:08:29,445:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 01:08:29,445:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 01:08:29,445:INFO:   <<< rank: 0
2024-04-30 01:08:29,445:INFO:   <<< resume_model: None
2024-04-30 01:08:29,445:INFO:   <<< sampled_use_mil: False
2024-04-30 01:08:29,445:INFO:   <<< seed: 42
2024-04-30 01:08:29,445:INFO:   <<< sim_header: meanP
2024-04-30 01:08:29,446:INFO:   <<< slice_framepos: 2
2024-04-30 01:08:29,446:INFO:   <<< task_type: retrieval
2024-04-30 01:08:29,446:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 01:08:29,446:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 01:08:29,446:INFO:   <<< train_frame_order: 0
2024-04-30 01:08:29,446:INFO:   <<< use_mil: False
2024-04-30 01:08:29,446:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 01:08:29,446:INFO:   <<< video_dim: 1024
2024-04-30 01:08:29,446:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 01:08:29,446:INFO:   <<< warmup_proportion: 0.1
2024-04-30 01:08:29,446:INFO:   <<< world_size: 1
2024-04-30 01:08:29,446:INFO: device: cuda:0 n_gpu: 1
2024-04-30 01:08:29,679:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:08:30,225:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 01:08:30,225:WARNING: Test retrieval by loose type.
2024-04-30 01:08:30,226:WARNING: 	 embed_dim: 512
2024-04-30 01:08:30,226:WARNING: 	 image_resolution: 224
2024-04-30 01:08:30,226:WARNING: 	 vision_layers: 12
2024-04-30 01:08:30,226:WARNING: 	 vision_width: 768
2024-04-30 01:08:30,226:WARNING: 	 vision_patch_size: 32
2024-04-30 01:08:30,226:WARNING: 	 context_length: 77
2024-04-30 01:08:30,226:WARNING: 	 vocab_size: 49408
2024-04-30 01:08:30,226:WARNING: 	 transformer_width: 512
2024-04-30 01:08:30,226:WARNING: 	 transformer_heads: 8
2024-04-30 01:08:30,226:WARNING: 	 transformer_layers: 12
2024-04-30 01:08:30,226:WARNING: 		 linear_patch: 2d
2024-04-30 01:08:30,226:WARNING: 	 cut_top_layer: 0
2024-04-30 01:08:31,205:WARNING: 	 sim_header: meanP
2024-04-30 01:08:37,241:INFO: ***** Running test *****
2024-04-30 01:08:37,241:INFO:   Num examples = 29
2024-04-30 01:08:37,241:INFO:   Batch size = 16
2024-04-30 01:08:37,241:INFO:   Num steps = 2
2024-04-30 01:08:37,254:INFO: ***** Running val *****
2024-04-30 01:08:37,254:INFO:   Num examples = 29
2024-04-30 01:12:10,671:INFO: Effective parameters:
2024-04-30 01:12:10,671:INFO:   <<< batch_size: 16
2024-04-30 01:12:10,671:INFO:   <<< batch_size_val: 16
2024-04-30 01:12:10,672:INFO:   <<< cache_dir: 
2024-04-30 01:12:10,672:INFO:   <<< coef_lr: 0.001
2024-04-30 01:12:10,672:INFO:   <<< cross_model: cross-base
2024-04-30 01:12:10,672:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 01:12:10,672:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 01:12:10,672:INFO:   <<< datatype: msrvtt
2024-04-30 01:12:10,672:INFO:   <<< do_eval: True
2024-04-30 01:12:10,672:INFO:   <<< do_lower_case: False
2024-04-30 01:12:10,672:INFO:   <<< do_pretrain: False
2024-04-30 01:12:10,672:INFO:   <<< do_train: False
2024-04-30 01:12:10,672:INFO:   <<< epochs: 5
2024-04-30 01:12:10,672:INFO:   <<< eval_frame_order: 0
2024-04-30 01:12:10,672:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 01:12:10,672:INFO:   <<< feature_framerate: 1
2024-04-30 01:12:10,672:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 01:12:10,672:INFO:   <<< fp16: False
2024-04-30 01:12:10,672:INFO:   <<< fp16_opt_level: O1
2024-04-30 01:12:10,673:INFO:   <<< freeze_layer_num: 0
2024-04-30 01:12:10,673:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 01:12:10,673:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 01:12:10,673:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:12:10,673:INFO:   <<< linear_patch: 2d
2024-04-30 01:12:10,673:INFO:   <<< local_rank: 0
2024-04-30 01:12:10,673:INFO:   <<< loose_type: True
2024-04-30 01:12:10,673:INFO:   <<< lr: 0.0001
2024-04-30 01:12:10,673:INFO:   <<< lr_decay: 0.9
2024-04-30 01:12:10,673:INFO:   <<< margin: 0.1
2024-04-30 01:12:10,673:INFO:   <<< max_frames: 30
2024-04-30 01:12:10,673:INFO:   <<< max_words: 32
2024-04-30 01:12:10,673:INFO:   <<< n_display: 100
2024-04-30 01:12:10,673:INFO:   <<< n_gpu: 1
2024-04-30 01:12:10,673:INFO:   <<< n_pair: 1
2024-04-30 01:12:10,673:INFO:   <<< negative_weighting: 1
2024-04-30 01:12:10,673:INFO:   <<< num_thread_reader: 0
2024-04-30 01:12:10,674:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 01:12:10,674:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 01:12:10,674:INFO:   <<< rank: 0
2024-04-30 01:12:10,674:INFO:   <<< resume_model: None
2024-04-30 01:12:10,674:INFO:   <<< sampled_use_mil: False
2024-04-30 01:12:10,674:INFO:   <<< seed: 42
2024-04-30 01:12:10,674:INFO:   <<< sim_header: meanP
2024-04-30 01:12:10,674:INFO:   <<< slice_framepos: 2
2024-04-30 01:12:10,674:INFO:   <<< task_type: retrieval
2024-04-30 01:12:10,674:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 01:12:10,674:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 01:12:10,674:INFO:   <<< train_frame_order: 0
2024-04-30 01:12:10,674:INFO:   <<< use_mil: False
2024-04-30 01:12:10,674:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 01:12:10,674:INFO:   <<< video_dim: 1024
2024-04-30 01:12:10,674:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 01:12:10,674:INFO:   <<< warmup_proportion: 0.1
2024-04-30 01:12:10,675:INFO:   <<< world_size: 1
2024-04-30 01:12:10,675:INFO: device: cuda:0 n_gpu: 1
2024-04-30 01:12:10,894:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:12:11,435:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 01:12:11,436:WARNING: Test retrieval by loose type.
2024-04-30 01:12:11,436:WARNING: 	 embed_dim: 512
2024-04-30 01:12:11,436:WARNING: 	 image_resolution: 224
2024-04-30 01:12:11,437:WARNING: 	 vision_layers: 12
2024-04-30 01:12:11,437:WARNING: 	 vision_width: 768
2024-04-30 01:12:11,437:WARNING: 	 vision_patch_size: 32
2024-04-30 01:12:11,437:WARNING: 	 context_length: 77
2024-04-30 01:12:11,437:WARNING: 	 vocab_size: 49408
2024-04-30 01:12:11,437:WARNING: 	 transformer_width: 512
2024-04-30 01:12:11,437:WARNING: 	 transformer_heads: 8
2024-04-30 01:12:11,437:WARNING: 	 transformer_layers: 12
2024-04-30 01:12:11,437:WARNING: 		 linear_patch: 2d
2024-04-30 01:12:11,437:WARNING: 	 cut_top_layer: 0
2024-04-30 01:12:12,437:WARNING: 	 sim_header: meanP
2024-04-30 01:12:18,510:INFO: ***** Running test *****
2024-04-30 01:12:18,511:INFO:   Num examples = 29
2024-04-30 01:12:18,511:INFO:   Batch size = 16
2024-04-30 01:12:18,524:INFO:   Num steps = 2
2024-04-30 01:12:18,524:INFO: ***** Running val *****
2024-04-30 01:12:18,524:INFO:   Num examples = 29
2024-04-30 01:12:48,527:INFO: Effective parameters:
2024-04-30 01:12:48,527:INFO:   <<< batch_size: 16
2024-04-30 01:12:48,527:INFO:   <<< batch_size_val: 16
2024-04-30 01:12:48,527:INFO:   <<< cache_dir: 
2024-04-30 01:12:48,527:INFO:   <<< coef_lr: 0.001
2024-04-30 01:12:48,527:INFO:   <<< cross_model: cross-base
2024-04-30 01:12:48,527:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 01:12:48,527:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 01:12:48,527:INFO:   <<< datatype: msrvtt
2024-04-30 01:12:48,527:INFO:   <<< do_eval: True
2024-04-30 01:12:48,527:INFO:   <<< do_lower_case: False
2024-04-30 01:12:48,528:INFO:   <<< do_pretrain: False
2024-04-30 01:12:48,528:INFO:   <<< do_train: False
2024-04-30 01:12:48,528:INFO:   <<< epochs: 5
2024-04-30 01:12:48,528:INFO:   <<< eval_frame_order: 0
2024-04-30 01:12:48,528:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 01:12:48,528:INFO:   <<< feature_framerate: 1
2024-04-30 01:12:48,528:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 01:12:48,528:INFO:   <<< fp16: False
2024-04-30 01:12:48,528:INFO:   <<< fp16_opt_level: O1
2024-04-30 01:12:48,528:INFO:   <<< freeze_layer_num: 0
2024-04-30 01:12:48,528:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 01:12:48,528:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 01:12:48,528:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:12:48,528:INFO:   <<< linear_patch: 2d
2024-04-30 01:12:48,528:INFO:   <<< local_rank: 0
2024-04-30 01:12:48,528:INFO:   <<< loose_type: True
2024-04-30 01:12:48,528:INFO:   <<< lr: 0.0001
2024-04-30 01:12:48,529:INFO:   <<< lr_decay: 0.9
2024-04-30 01:12:48,529:INFO:   <<< margin: 0.1
2024-04-30 01:12:48,529:INFO:   <<< max_frames: 30
2024-04-30 01:12:48,529:INFO:   <<< max_words: 32
2024-04-30 01:12:48,529:INFO:   <<< n_display: 100
2024-04-30 01:12:48,529:INFO:   <<< n_gpu: 1
2024-04-30 01:12:48,529:INFO:   <<< n_pair: 1
2024-04-30 01:12:48,529:INFO:   <<< negative_weighting: 1
2024-04-30 01:12:48,529:INFO:   <<< num_thread_reader: 0
2024-04-30 01:12:48,529:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 01:12:48,529:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 01:12:48,529:INFO:   <<< rank: 0
2024-04-30 01:12:48,529:INFO:   <<< resume_model: None
2024-04-30 01:12:48,529:INFO:   <<< sampled_use_mil: False
2024-04-30 01:12:48,529:INFO:   <<< seed: 42
2024-04-30 01:12:48,529:INFO:   <<< sim_header: meanP
2024-04-30 01:12:48,530:INFO:   <<< slice_framepos: 2
2024-04-30 01:12:48,530:INFO:   <<< task_type: retrieval
2024-04-30 01:12:48,530:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 01:12:48,530:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 01:12:48,530:INFO:   <<< train_frame_order: 0
2024-04-30 01:12:48,530:INFO:   <<< use_mil: False
2024-04-30 01:12:48,530:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 01:12:48,530:INFO:   <<< video_dim: 1024
2024-04-30 01:12:48,530:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 01:12:48,530:INFO:   <<< warmup_proportion: 0.1
2024-04-30 01:12:48,530:INFO:   <<< world_size: 1
2024-04-30 01:12:48,530:INFO: device: cuda:0 n_gpu: 1
2024-04-30 01:12:48,756:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:12:49,303:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 01:12:49,303:WARNING: Test retrieval by loose type.
2024-04-30 01:12:49,304:WARNING: 	 embed_dim: 512
2024-04-30 01:12:49,304:WARNING: 	 image_resolution: 224
2024-04-30 01:12:49,304:WARNING: 	 vision_layers: 12
2024-04-30 01:12:49,304:WARNING: 	 vision_width: 768
2024-04-30 01:12:49,304:WARNING: 	 vision_patch_size: 32
2024-04-30 01:12:49,305:WARNING: 	 context_length: 77
2024-04-30 01:12:49,305:WARNING: 	 vocab_size: 49408
2024-04-30 01:12:49,305:WARNING: 	 transformer_width: 512
2024-04-30 01:12:49,305:WARNING: 	 transformer_heads: 8
2024-04-30 01:12:49,305:WARNING: 	 transformer_layers: 12
2024-04-30 01:12:49,305:WARNING: 		 linear_patch: 2d
2024-04-30 01:12:49,305:WARNING: 	 cut_top_layer: 0
2024-04-30 01:12:50,296:WARNING: 	 sim_header: meanP
2024-04-30 01:12:56,350:INFO: ***** Running test *****
2024-04-30 01:12:56,350:INFO:   Num examples = 29
2024-04-30 01:12:56,350:INFO:   Batch size = 16
2024-04-30 01:12:56,350:INFO:   Num steps = 2
2024-04-30 01:12:56,350:INFO: ***** Running val *****
2024-04-30 01:12:56,350:INFO:   Num examples = 29
2024-04-30 01:22:46,999:INFO: Effective parameters:
2024-04-30 01:22:46,999:INFO:   <<< batch_size: 16
2024-04-30 01:22:46,999:INFO:   <<< batch_size_val: 16
2024-04-30 01:22:46,999:INFO:   <<< cache_dir: 
2024-04-30 01:22:46,999:INFO:   <<< coef_lr: 0.001
2024-04-30 01:22:46,999:INFO:   <<< cross_model: cross-base
2024-04-30 01:22:46,999:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 01:22:46,999:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 01:22:47,000:INFO:   <<< datatype: msrvtt
2024-04-30 01:22:47,000:INFO:   <<< do_eval: True
2024-04-30 01:22:47,000:INFO:   <<< do_lower_case: False
2024-04-30 01:22:47,000:INFO:   <<< do_pretrain: False
2024-04-30 01:22:47,000:INFO:   <<< do_train: False
2024-04-30 01:22:47,000:INFO:   <<< epochs: 5
2024-04-30 01:22:47,000:INFO:   <<< eval_frame_order: 0
2024-04-30 01:22:47,000:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 01:22:47,000:INFO:   <<< feature_framerate: 1
2024-04-30 01:22:47,000:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 01:22:47,000:INFO:   <<< fp16: False
2024-04-30 01:22:47,000:INFO:   <<< fp16_opt_level: O1
2024-04-30 01:22:47,000:INFO:   <<< freeze_layer_num: 0
2024-04-30 01:22:47,000:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 01:22:47,000:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 01:22:47,000:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:22:47,000:INFO:   <<< linear_patch: 2d
2024-04-30 01:22:47,001:INFO:   <<< local_rank: 0
2024-04-30 01:22:47,001:INFO:   <<< loose_type: True
2024-04-30 01:22:47,001:INFO:   <<< lr: 0.0001
2024-04-30 01:22:47,001:INFO:   <<< lr_decay: 0.9
2024-04-30 01:22:47,001:INFO:   <<< margin: 0.1
2024-04-30 01:22:47,001:INFO:   <<< max_frames: 30
2024-04-30 01:22:47,001:INFO:   <<< max_words: 32
2024-04-30 01:22:47,001:INFO:   <<< n_display: 100
2024-04-30 01:22:47,001:INFO:   <<< n_gpu: 1
2024-04-30 01:22:47,001:INFO:   <<< n_pair: 1
2024-04-30 01:22:47,001:INFO:   <<< negative_weighting: 1
2024-04-30 01:22:47,001:INFO:   <<< num_thread_reader: 0
2024-04-30 01:22:47,001:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 01:22:47,001:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 01:22:47,001:INFO:   <<< rank: 0
2024-04-30 01:22:47,001:INFO:   <<< resume_model: None
2024-04-30 01:22:47,002:INFO:   <<< sampled_use_mil: False
2024-04-30 01:22:47,002:INFO:   <<< seed: 42
2024-04-30 01:22:47,002:INFO:   <<< sim_header: meanP
2024-04-30 01:22:47,002:INFO:   <<< slice_framepos: 2
2024-04-30 01:22:47,002:INFO:   <<< task_type: retrieval
2024-04-30 01:22:47,002:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 01:22:47,002:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 01:22:47,002:INFO:   <<< train_frame_order: 0
2024-04-30 01:22:47,002:INFO:   <<< use_mil: False
2024-04-30 01:22:47,002:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 01:22:47,002:INFO:   <<< video_dim: 1024
2024-04-30 01:22:47,002:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 01:22:47,002:INFO:   <<< warmup_proportion: 0.1
2024-04-30 01:22:47,003:INFO:   <<< world_size: 1
2024-04-30 01:22:47,003:INFO: device: cuda:0 n_gpu: 1
2024-04-30 01:22:47,226:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:22:47,770:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 01:22:47,770:WARNING: Test retrieval by loose type.
2024-04-30 01:22:47,771:WARNING: 	 embed_dim: 512
2024-04-30 01:22:47,771:WARNING: 	 image_resolution: 224
2024-04-30 01:22:47,771:WARNING: 	 vision_layers: 12
2024-04-30 01:22:47,771:WARNING: 	 vision_width: 768
2024-04-30 01:22:47,771:WARNING: 	 vision_patch_size: 32
2024-04-30 01:22:47,771:WARNING: 	 context_length: 77
2024-04-30 01:22:47,771:WARNING: 	 vocab_size: 49408
2024-04-30 01:22:47,771:WARNING: 	 transformer_width: 512
2024-04-30 01:22:47,771:WARNING: 	 transformer_heads: 8
2024-04-30 01:22:47,771:WARNING: 	 transformer_layers: 12
2024-04-30 01:22:47,771:WARNING: 		 linear_patch: 2d
2024-04-30 01:22:47,772:WARNING: 	 cut_top_layer: 0
2024-04-30 01:22:48,757:WARNING: 	 sim_header: meanP
2024-04-30 01:22:54,880:INFO: ***** Running test *****
2024-04-30 01:22:54,881:INFO:   Num examples = 29
2024-04-30 01:22:54,881:INFO:   Batch size = 16
2024-04-30 01:22:54,881:INFO:   Num steps = 2
2024-04-30 01:22:54,881:INFO: ***** Running val *****
2024-04-30 01:22:54,881:INFO:   Num examples = 29
2024-04-30 01:28:39,049:INFO: sim matrix size: 29, 29
2024-04-30 01:28:43,528:INFO: 	 Length-T: 29, Length-V:29
2024-04-30 01:28:45,712:INFO: Text-to-Video:
2024-04-30 01:28:53,593:INFO: 	>>>  R@1: 79.3 - R@5: 96.6 - R@10: 100.0 - Median R: 1.0 - Mean R: 1.5
2024-04-30 01:28:55,419:INFO: Video-to-Text:
2024-04-30 01:28:57,205:INFO: 	>>>  V2T$R@1: 79.3 - V2T$R@5: 100.0 - V2T$R@10: 100.0 - V2T$Median R: 1.0 - V2T$Mean R: 1.4
2024-04-30 01:32:43,630:INFO: Effective parameters:
2024-04-30 01:32:43,631:INFO:   <<< batch_size: 16
2024-04-30 01:32:43,631:INFO:   <<< batch_size_val: 16
2024-04-30 01:32:43,631:INFO:   <<< cache_dir: 
2024-04-30 01:32:43,631:INFO:   <<< coef_lr: 0.001
2024-04-30 01:32:43,631:INFO:   <<< cross_model: cross-base
2024-04-30 01:32:43,631:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 01:32:43,631:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 01:32:43,631:INFO:   <<< datatype: msrvtt
2024-04-30 01:32:43,631:INFO:   <<< do_eval: True
2024-04-30 01:32:43,631:INFO:   <<< do_lower_case: False
2024-04-30 01:32:43,631:INFO:   <<< do_pretrain: False
2024-04-30 01:32:43,631:INFO:   <<< do_train: False
2024-04-30 01:32:43,631:INFO:   <<< epochs: 5
2024-04-30 01:32:43,632:INFO:   <<< eval_frame_order: 0
2024-04-30 01:32:43,632:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 01:32:43,632:INFO:   <<< feature_framerate: 1
2024-04-30 01:32:43,632:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 01:32:43,632:INFO:   <<< fp16: False
2024-04-30 01:32:43,632:INFO:   <<< fp16_opt_level: O1
2024-04-30 01:32:43,632:INFO:   <<< freeze_layer_num: 0
2024-04-30 01:32:43,632:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 01:32:43,632:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 01:32:43,632:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:32:43,632:INFO:   <<< linear_patch: 2d
2024-04-30 01:32:43,632:INFO:   <<< local_rank: 0
2024-04-30 01:32:43,632:INFO:   <<< loose_type: True
2024-04-30 01:32:43,632:INFO:   <<< lr: 0.0001
2024-04-30 01:32:43,632:INFO:   <<< lr_decay: 0.9
2024-04-30 01:32:43,632:INFO:   <<< margin: 0.1
2024-04-30 01:32:43,633:INFO:   <<< max_frames: 30
2024-04-30 01:32:43,633:INFO:   <<< max_words: 32
2024-04-30 01:32:43,633:INFO:   <<< n_display: 100
2024-04-30 01:32:43,633:INFO:   <<< n_gpu: 1
2024-04-30 01:32:43,633:INFO:   <<< n_pair: 1
2024-04-30 01:32:43,633:INFO:   <<< negative_weighting: 1
2024-04-30 01:32:43,633:INFO:   <<< num_thread_reader: 0
2024-04-30 01:32:43,633:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 01:32:43,633:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 01:32:43,633:INFO:   <<< rank: 0
2024-04-30 01:32:43,633:INFO:   <<< resume_model: None
2024-04-30 01:32:43,633:INFO:   <<< sampled_use_mil: False
2024-04-30 01:32:43,633:INFO:   <<< seed: 42
2024-04-30 01:32:43,633:INFO:   <<< sim_header: meanP
2024-04-30 01:32:43,633:INFO:   <<< slice_framepos: 2
2024-04-30 01:32:43,633:INFO:   <<< task_type: retrieval
2024-04-30 01:32:43,633:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 01:32:43,633:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 01:32:43,634:INFO:   <<< train_frame_order: 0
2024-04-30 01:32:43,634:INFO:   <<< use_mil: False
2024-04-30 01:32:43,634:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 01:32:43,634:INFO:   <<< video_dim: 1024
2024-04-30 01:32:43,634:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 01:32:43,634:INFO:   <<< warmup_proportion: 0.1
2024-04-30 01:32:43,634:INFO:   <<< world_size: 1
2024-04-30 01:32:43,634:INFO: device: cuda:0 n_gpu: 1
2024-04-30 01:32:43,856:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:32:44,396:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 01:32:44,397:WARNING: Test retrieval by loose type.
2024-04-30 01:32:44,397:WARNING: 	 embed_dim: 512
2024-04-30 01:32:44,397:WARNING: 	 image_resolution: 224
2024-04-30 01:32:44,397:WARNING: 	 vision_layers: 12
2024-04-30 01:32:44,398:WARNING: 	 vision_width: 768
2024-04-30 01:32:44,398:WARNING: 	 vision_patch_size: 32
2024-04-30 01:32:44,398:WARNING: 	 context_length: 77
2024-04-30 01:32:44,398:WARNING: 	 vocab_size: 49408
2024-04-30 01:32:44,398:WARNING: 	 transformer_width: 512
2024-04-30 01:32:44,398:WARNING: 	 transformer_heads: 8
2024-04-30 01:32:44,398:WARNING: 	 transformer_layers: 12
2024-04-30 01:32:44,398:WARNING: 		 linear_patch: 2d
2024-04-30 01:32:44,398:WARNING: 	 cut_top_layer: 0
2024-04-30 01:32:45,404:WARNING: 	 sim_header: meanP
2024-04-30 01:32:51,507:INFO: ***** Running test *****
2024-04-30 01:32:51,507:INFO:   Num examples = 29
2024-04-30 01:32:51,507:INFO:   Batch size = 16
2024-04-30 01:32:51,522:INFO:   Num steps = 2
2024-04-30 01:32:51,522:INFO: ***** Running val *****
2024-04-30 01:32:51,523:INFO:   Num examples = 29
2024-04-30 01:41:56,757:INFO: Effective parameters:
2024-04-30 01:41:56,757:INFO:   <<< batch_size: 16
2024-04-30 01:41:56,758:INFO:   <<< batch_size_val: 16
2024-04-30 01:41:56,758:INFO:   <<< cache_dir: 
2024-04-30 01:41:56,758:INFO:   <<< coef_lr: 0.001
2024-04-30 01:41:56,758:INFO:   <<< cross_model: cross-base
2024-04-30 01:41:56,758:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 01:41:56,758:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 01:41:56,758:INFO:   <<< datatype: msrvtt
2024-04-30 01:41:56,758:INFO:   <<< do_eval: True
2024-04-30 01:41:56,758:INFO:   <<< do_lower_case: False
2024-04-30 01:41:56,758:INFO:   <<< do_pretrain: False
2024-04-30 01:41:56,758:INFO:   <<< do_train: False
2024-04-30 01:41:56,758:INFO:   <<< epochs: 5
2024-04-30 01:41:56,758:INFO:   <<< eval_frame_order: 0
2024-04-30 01:41:56,759:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 01:41:56,759:INFO:   <<< feature_framerate: 1
2024-04-30 01:41:56,759:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 01:41:56,759:INFO:   <<< fp16: False
2024-04-30 01:41:56,759:INFO:   <<< fp16_opt_level: O1
2024-04-30 01:41:56,759:INFO:   <<< freeze_layer_num: 0
2024-04-30 01:41:56,759:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 01:41:56,759:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 01:41:56,759:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:41:56,759:INFO:   <<< linear_patch: 2d
2024-04-30 01:41:56,759:INFO:   <<< local_rank: 0
2024-04-30 01:41:56,759:INFO:   <<< loose_type: True
2024-04-30 01:41:56,759:INFO:   <<< lr: 0.0001
2024-04-30 01:41:56,760:INFO:   <<< lr_decay: 0.9
2024-04-30 01:41:56,760:INFO:   <<< margin: 0.1
2024-04-30 01:41:56,760:INFO:   <<< max_frames: 30
2024-04-30 01:41:56,760:INFO:   <<< max_words: 32
2024-04-30 01:41:56,760:INFO:   <<< n_display: 100
2024-04-30 01:41:56,760:INFO:   <<< n_gpu: 1
2024-04-30 01:41:56,760:INFO:   <<< n_pair: 1
2024-04-30 01:41:56,760:INFO:   <<< negative_weighting: 1
2024-04-30 01:41:56,760:INFO:   <<< num_thread_reader: 0
2024-04-30 01:41:56,760:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 01:41:56,760:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 01:41:56,760:INFO:   <<< rank: 0
2024-04-30 01:41:56,760:INFO:   <<< resume_model: None
2024-04-30 01:41:56,761:INFO:   <<< sampled_use_mil: False
2024-04-30 01:41:56,761:INFO:   <<< seed: 42
2024-04-30 01:41:56,761:INFO:   <<< sim_header: meanP
2024-04-30 01:41:56,761:INFO:   <<< slice_framepos: 2
2024-04-30 01:41:56,761:INFO:   <<< task_type: retrieval
2024-04-30 01:41:56,761:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 01:41:56,761:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 01:41:56,761:INFO:   <<< train_frame_order: 0
2024-04-30 01:41:56,761:INFO:   <<< use_mil: False
2024-04-30 01:41:56,761:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 01:41:56,761:INFO:   <<< video_dim: 1024
2024-04-30 01:41:56,761:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 01:41:56,761:INFO:   <<< warmup_proportion: 0.1
2024-04-30 01:41:56,761:INFO:   <<< world_size: 1
2024-04-30 01:41:56,762:INFO: device: cuda:0 n_gpu: 1
2024-04-30 01:41:56,985:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 01:41:57,532:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 01:41:57,533:WARNING: Test retrieval by loose type.
2024-04-30 01:41:57,533:WARNING: 	 embed_dim: 512
2024-04-30 01:41:57,533:WARNING: 	 image_resolution: 224
2024-04-30 01:41:57,533:WARNING: 	 vision_layers: 12
2024-04-30 01:41:57,533:WARNING: 	 vision_width: 768
2024-04-30 01:41:57,534:WARNING: 	 vision_patch_size: 32
2024-04-30 01:41:57,534:WARNING: 	 context_length: 77
2024-04-30 01:41:57,534:WARNING: 	 vocab_size: 49408
2024-04-30 01:41:57,534:WARNING: 	 transformer_width: 512
2024-04-30 01:41:57,534:WARNING: 	 transformer_heads: 8
2024-04-30 01:41:57,534:WARNING: 	 transformer_layers: 12
2024-04-30 01:41:57,534:WARNING: 		 linear_patch: 2d
2024-04-30 01:41:57,534:WARNING: 	 cut_top_layer: 0
2024-04-30 01:41:58,535:WARNING: 	 sim_header: meanP
2024-04-30 01:42:04,668:INFO: ***** Running test *****
2024-04-30 01:42:04,668:INFO:   Num examples = 29
2024-04-30 01:42:04,668:INFO:   Batch size = 16
2024-04-30 01:42:04,682:INFO:   Num steps = 2
2024-04-30 01:42:04,682:INFO: ***** Running val *****
2024-04-30 01:42:04,682:INFO:   Num examples = 29
2024-04-30 03:03:07,867:INFO: Effective parameters:
2024-04-30 03:03:07,867:INFO:   <<< batch_size: 16
2024-04-30 03:03:07,867:INFO:   <<< batch_size_val: 16
2024-04-30 03:03:07,867:INFO:   <<< cache_dir: 
2024-04-30 03:03:07,867:INFO:   <<< coef_lr: 0.001
2024-04-30 03:03:07,867:INFO:   <<< cross_model: cross-base
2024-04-30 03:03:07,867:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 03:03:07,867:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 03:03:07,868:INFO:   <<< datatype: msrvtt
2024-04-30 03:03:07,868:INFO:   <<< do_eval: True
2024-04-30 03:03:07,868:INFO:   <<< do_lower_case: False
2024-04-30 03:03:07,868:INFO:   <<< do_pretrain: False
2024-04-30 03:03:07,868:INFO:   <<< do_train: False
2024-04-30 03:03:07,868:INFO:   <<< epochs: 5
2024-04-30 03:03:07,868:INFO:   <<< eval_frame_order: 0
2024-04-30 03:03:07,868:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 03:03:07,868:INFO:   <<< feature_framerate: 1
2024-04-30 03:03:07,868:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 03:03:07,868:INFO:   <<< fp16: False
2024-04-30 03:03:07,868:INFO:   <<< fp16_opt_level: O1
2024-04-30 03:03:07,868:INFO:   <<< freeze_layer_num: 0
2024-04-30 03:03:07,868:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 03:03:07,868:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 03:03:07,868:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 03:03:07,868:INFO:   <<< linear_patch: 2d
2024-04-30 03:03:07,869:INFO:   <<< local_rank: 0
2024-04-30 03:03:07,869:INFO:   <<< loose_type: True
2024-04-30 03:03:07,869:INFO:   <<< lr: 0.0001
2024-04-30 03:03:07,869:INFO:   <<< lr_decay: 0.9
2024-04-30 03:03:07,869:INFO:   <<< margin: 0.1
2024-04-30 03:03:07,869:INFO:   <<< max_frames: 30
2024-04-30 03:03:07,869:INFO:   <<< max_words: 32
2024-04-30 03:03:07,869:INFO:   <<< n_display: 100
2024-04-30 03:03:07,869:INFO:   <<< n_gpu: 1
2024-04-30 03:03:07,869:INFO:   <<< n_pair: 1
2024-04-30 03:03:07,869:INFO:   <<< negative_weighting: 1
2024-04-30 03:03:07,869:INFO:   <<< num_thread_reader: 0
2024-04-30 03:03:07,869:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 03:03:07,869:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 03:03:07,869:INFO:   <<< rank: 0
2024-04-30 03:03:07,869:INFO:   <<< resume_model: None
2024-04-30 03:03:07,869:INFO:   <<< sampled_use_mil: False
2024-04-30 03:03:07,869:INFO:   <<< seed: 42
2024-04-30 03:03:07,870:INFO:   <<< sim_header: meanP
2024-04-30 03:03:07,870:INFO:   <<< slice_framepos: 2
2024-04-30 03:03:07,870:INFO:   <<< task_type: retrieval
2024-04-30 03:03:07,870:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 03:03:07,870:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 03:03:07,870:INFO:   <<< train_frame_order: 0
2024-04-30 03:03:07,870:INFO:   <<< use_mil: False
2024-04-30 03:03:07,870:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 03:03:07,870:INFO:   <<< video_dim: 1024
2024-04-30 03:03:07,870:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 03:03:07,870:INFO:   <<< warmup_proportion: 0.1
2024-04-30 03:03:07,870:INFO:   <<< world_size: 1
2024-04-30 03:03:07,870:INFO: device: cuda:0 n_gpu: 1
2024-04-30 03:03:08,094:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 03:03:08,638:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 03:03:08,638:WARNING: Test retrieval by loose type.
2024-04-30 03:03:08,639:WARNING: 	 embed_dim: 512
2024-04-30 03:03:08,639:WARNING: 	 image_resolution: 224
2024-04-30 03:03:08,639:WARNING: 	 vision_layers: 12
2024-04-30 03:03:08,639:WARNING: 	 vision_width: 768
2024-04-30 03:03:08,639:WARNING: 	 vision_patch_size: 32
2024-04-30 03:03:08,639:WARNING: 	 context_length: 77
2024-04-30 03:03:08,639:WARNING: 	 vocab_size: 49408
2024-04-30 03:03:08,639:WARNING: 	 transformer_width: 512
2024-04-30 03:03:08,639:WARNING: 	 transformer_heads: 8
2024-04-30 03:03:08,639:WARNING: 	 transformer_layers: 12
2024-04-30 03:03:08,639:WARNING: 		 linear_patch: 2d
2024-04-30 03:03:08,640:WARNING: 	 cut_top_layer: 0
2024-04-30 03:03:09,612:WARNING: 	 sim_header: meanP
2024-04-30 03:03:15,660:INFO: ***** Running test *****
2024-04-30 03:03:15,660:INFO:   Num examples = 29
2024-04-30 03:03:15,660:INFO:   Batch size = 16
2024-04-30 03:03:15,674:INFO:   Num steps = 2
2024-04-30 03:03:15,674:INFO: ***** Running val *****
2024-04-30 03:03:15,674:INFO:   Num examples = 29
2024-04-30 08:42:15,504:INFO: Effective parameters:
2024-04-30 08:42:15,505:INFO:   <<< batch_size: 16
2024-04-30 08:42:15,505:INFO:   <<< batch_size_val: 16
2024-04-30 08:42:15,505:INFO:   <<< cache_dir: 
2024-04-30 08:42:15,505:INFO:   <<< coef_lr: 0.001
2024-04-30 08:42:15,505:INFO:   <<< cross_model: cross-base
2024-04-30 08:42:15,505:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 08:42:15,505:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 08:42:15,505:INFO:   <<< datatype: msrvtt
2024-04-30 08:42:15,505:INFO:   <<< do_eval: True
2024-04-30 08:42:15,505:INFO:   <<< do_lower_case: False
2024-04-30 08:42:15,505:INFO:   <<< do_pretrain: False
2024-04-30 08:42:15,505:INFO:   <<< do_train: False
2024-04-30 08:42:15,506:INFO:   <<< epochs: 5
2024-04-30 08:42:15,506:INFO:   <<< eval_frame_order: 0
2024-04-30 08:42:15,506:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 08:42:15,506:INFO:   <<< feature_framerate: 1
2024-04-30 08:42:15,506:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 08:42:15,506:INFO:   <<< fp16: False
2024-04-30 08:42:15,506:INFO:   <<< fp16_opt_level: O1
2024-04-30 08:42:15,506:INFO:   <<< freeze_layer_num: 0
2024-04-30 08:42:15,506:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 08:42:15,506:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 08:42:15,506:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 08:42:15,506:INFO:   <<< linear_patch: 2d
2024-04-30 08:42:15,506:INFO:   <<< local_rank: 0
2024-04-30 08:42:15,506:INFO:   <<< loose_type: True
2024-04-30 08:42:15,506:INFO:   <<< lr: 0.0001
2024-04-30 08:42:15,506:INFO:   <<< lr_decay: 0.9
2024-04-30 08:42:15,506:INFO:   <<< margin: 0.1
2024-04-30 08:42:15,507:INFO:   <<< max_frames: 30
2024-04-30 08:42:15,507:INFO:   <<< max_words: 32
2024-04-30 08:42:15,507:INFO:   <<< n_display: 100
2024-04-30 08:42:15,507:INFO:   <<< n_gpu: 1
2024-04-30 08:42:15,507:INFO:   <<< n_pair: 1
2024-04-30 08:42:15,507:INFO:   <<< negative_weighting: 1
2024-04-30 08:42:15,507:INFO:   <<< num_thread_reader: 0
2024-04-30 08:42:15,507:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 08:42:15,507:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 08:42:15,507:INFO:   <<< rank: 0
2024-04-30 08:42:15,507:INFO:   <<< resume_model: None
2024-04-30 08:42:15,507:INFO:   <<< sampled_use_mil: False
2024-04-30 08:42:15,507:INFO:   <<< seed: 42
2024-04-30 08:42:15,507:INFO:   <<< sim_header: meanP
2024-04-30 08:42:15,507:INFO:   <<< slice_framepos: 2
2024-04-30 08:42:15,507:INFO:   <<< task_type: retrieval
2024-04-30 08:42:15,507:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 08:42:15,508:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 08:42:15,508:INFO:   <<< train_frame_order: 0
2024-04-30 08:42:15,508:INFO:   <<< use_mil: False
2024-04-30 08:42:15,508:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 08:42:15,508:INFO:   <<< video_dim: 1024
2024-04-30 08:42:15,508:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 08:42:15,508:INFO:   <<< warmup_proportion: 0.1
2024-04-30 08:42:15,508:INFO:   <<< world_size: 1
2024-04-30 08:42:15,508:INFO: device: cuda:0 n_gpu: 1
2024-04-30 08:42:15,843:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 08:42:16,501:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 08:42:16,501:WARNING: Test retrieval by loose type.
2024-04-30 08:42:16,502:WARNING: 	 embed_dim: 512
2024-04-30 08:42:16,502:WARNING: 	 image_resolution: 224
2024-04-30 08:42:16,502:WARNING: 	 vision_layers: 12
2024-04-30 08:42:16,502:WARNING: 	 vision_width: 768
2024-04-30 08:42:16,502:WARNING: 	 vision_patch_size: 32
2024-04-30 08:42:16,502:WARNING: 	 context_length: 77
2024-04-30 08:42:16,502:WARNING: 	 vocab_size: 49408
2024-04-30 08:42:16,502:WARNING: 	 transformer_width: 512
2024-04-30 08:42:16,502:WARNING: 	 transformer_heads: 8
2024-04-30 08:42:16,503:WARNING: 	 transformer_layers: 12
2024-04-30 08:42:16,503:WARNING: 		 linear_patch: 2d
2024-04-30 08:42:16,503:WARNING: 	 cut_top_layer: 0
2024-04-30 08:42:17,501:WARNING: 	 sim_header: meanP
2024-04-30 08:42:24,038:INFO: ***** Running test *****
2024-04-30 08:42:24,038:INFO:   Num examples = 29
2024-04-30 08:42:24,038:INFO:   Batch size = 16
2024-04-30 08:42:24,053:INFO:   Num steps = 2
2024-04-30 08:42:24,054:INFO: ***** Running val *****
2024-04-30 08:42:24,054:INFO:   Num examples = 29
2024-04-30 08:47:06,352:INFO: Effective parameters:
2024-04-30 08:47:06,353:INFO:   <<< batch_size: 16
2024-04-30 08:47:06,353:INFO:   <<< batch_size_val: 16
2024-04-30 08:47:06,353:INFO:   <<< cache_dir: 
2024-04-30 08:47:06,353:INFO:   <<< coef_lr: 0.001
2024-04-30 08:47:06,353:INFO:   <<< cross_model: cross-base
2024-04-30 08:47:06,353:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 08:47:06,353:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 08:47:06,353:INFO:   <<< datatype: msrvtt
2024-04-30 08:47:06,353:INFO:   <<< do_eval: True
2024-04-30 08:47:06,353:INFO:   <<< do_lower_case: False
2024-04-30 08:47:06,353:INFO:   <<< do_pretrain: False
2024-04-30 08:47:06,353:INFO:   <<< do_train: False
2024-04-30 08:47:06,353:INFO:   <<< epochs: 5
2024-04-30 08:47:06,353:INFO:   <<< eval_frame_order: 0
2024-04-30 08:47:06,353:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 08:47:06,354:INFO:   <<< feature_framerate: 1
2024-04-30 08:47:06,354:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 08:47:06,354:INFO:   <<< fp16: False
2024-04-30 08:47:06,354:INFO:   <<< fp16_opt_level: O1
2024-04-30 08:47:06,354:INFO:   <<< freeze_layer_num: 0
2024-04-30 08:47:06,354:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 08:47:06,354:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 08:47:06,354:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 08:47:06,354:INFO:   <<< linear_patch: 2d
2024-04-30 08:47:06,354:INFO:   <<< local_rank: 0
2024-04-30 08:47:06,354:INFO:   <<< loose_type: True
2024-04-30 08:47:06,354:INFO:   <<< lr: 0.0001
2024-04-30 08:47:06,354:INFO:   <<< lr_decay: 0.9
2024-04-30 08:47:06,354:INFO:   <<< margin: 0.1
2024-04-30 08:47:06,354:INFO:   <<< max_frames: 30
2024-04-30 08:47:06,354:INFO:   <<< max_words: 32
2024-04-30 08:47:06,354:INFO:   <<< n_display: 100
2024-04-30 08:47:06,354:INFO:   <<< n_gpu: 1
2024-04-30 08:47:06,355:INFO:   <<< n_pair: 1
2024-04-30 08:47:06,355:INFO:   <<< negative_weighting: 1
2024-04-30 08:47:06,355:INFO:   <<< num_thread_reader: 0
2024-04-30 08:47:06,355:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 08:47:06,355:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 08:47:06,355:INFO:   <<< rank: 0
2024-04-30 08:47:06,355:INFO:   <<< resume_model: None
2024-04-30 08:47:06,355:INFO:   <<< sampled_use_mil: False
2024-04-30 08:47:06,355:INFO:   <<< seed: 42
2024-04-30 08:47:06,355:INFO:   <<< sim_header: meanP
2024-04-30 08:47:06,355:INFO:   <<< slice_framepos: 2
2024-04-30 08:47:06,355:INFO:   <<< task_type: retrieval
2024-04-30 08:47:06,355:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 08:47:06,355:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 08:47:06,355:INFO:   <<< train_frame_order: 0
2024-04-30 08:47:06,355:INFO:   <<< use_mil: False
2024-04-30 08:47:06,355:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 08:47:06,356:INFO:   <<< video_dim: 1024
2024-04-30 08:47:06,356:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 08:47:06,356:INFO:   <<< warmup_proportion: 0.1
2024-04-30 08:47:06,356:INFO:   <<< world_size: 1
2024-04-30 08:47:06,356:INFO: device: cuda:0 n_gpu: 1
2024-04-30 08:47:06,599:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 08:47:07,149:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 08:47:07,149:WARNING: Test retrieval by loose type.
2024-04-30 08:47:07,150:WARNING: 	 embed_dim: 512
2024-04-30 08:47:07,150:WARNING: 	 image_resolution: 224
2024-04-30 08:47:07,150:WARNING: 	 vision_layers: 12
2024-04-30 08:47:07,150:WARNING: 	 vision_width: 768
2024-04-30 08:47:07,150:WARNING: 	 vision_patch_size: 32
2024-04-30 08:47:07,150:WARNING: 	 context_length: 77
2024-04-30 08:47:07,150:WARNING: 	 vocab_size: 49408
2024-04-30 08:47:07,151:WARNING: 	 transformer_width: 512
2024-04-30 08:47:07,151:WARNING: 	 transformer_heads: 8
2024-04-30 08:47:07,151:WARNING: 	 transformer_layers: 12
2024-04-30 08:47:07,151:WARNING: 		 linear_patch: 2d
2024-04-30 08:47:07,151:WARNING: 	 cut_top_layer: 0
2024-04-30 08:47:08,141:WARNING: 	 sim_header: meanP
2024-04-30 08:47:14,165:INFO: ***** Running test *****
2024-04-30 08:47:14,166:INFO:   Num examples = 29
2024-04-30 08:47:14,166:INFO:   Batch size = 16
2024-04-30 08:47:14,166:INFO:   Num steps = 2
2024-04-30 08:47:14,182:INFO: ***** Running val *****
2024-04-30 08:47:14,182:INFO:   Num examples = 29
2024-04-30 08:47:30,911:INFO: Effective parameters:
2024-04-30 08:47:30,911:INFO:   <<< batch_size: 16
2024-04-30 08:47:30,911:INFO:   <<< batch_size_val: 16
2024-04-30 08:47:30,911:INFO:   <<< cache_dir: 
2024-04-30 08:47:30,912:INFO:   <<< coef_lr: 0.001
2024-04-30 08:47:30,912:INFO:   <<< cross_model: cross-base
2024-04-30 08:47:30,912:INFO:   <<< cross_num_hidden_layers: 4
2024-04-30 08:47:30,912:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-04-30 08:47:30,912:INFO:   <<< datatype: msrvtt
2024-04-30 08:47:30,912:INFO:   <<< do_eval: True
2024-04-30 08:47:30,912:INFO:   <<< do_lower_case: False
2024-04-30 08:47:30,912:INFO:   <<< do_pretrain: False
2024-04-30 08:47:30,912:INFO:   <<< do_train: False
2024-04-30 08:47:30,912:INFO:   <<< epochs: 5
2024-04-30 08:47:30,912:INFO:   <<< eval_frame_order: 0
2024-04-30 08:47:30,912:INFO:   <<< expand_msrvtt_sentences: True
2024-04-30 08:47:30,912:INFO:   <<< feature_framerate: 1
2024-04-30 08:47:30,912:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-04-30 08:47:30,912:INFO:   <<< fp16: False
2024-04-30 08:47:30,912:INFO:   <<< fp16_opt_level: O1
2024-04-30 08:47:30,912:INFO:   <<< freeze_layer_num: 0
2024-04-30 08:47:30,913:INFO:   <<< gradient_accumulation_steps: 1
2024-04-30 08:47:30,913:INFO:   <<< hard_negative_rate: 0.5
2024-04-30 08:47:30,913:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 08:47:30,913:INFO:   <<< linear_patch: 2d
2024-04-30 08:47:30,913:INFO:   <<< local_rank: 0
2024-04-30 08:47:30,913:INFO:   <<< loose_type: True
2024-04-30 08:47:30,913:INFO:   <<< lr: 0.0001
2024-04-30 08:47:30,913:INFO:   <<< lr_decay: 0.9
2024-04-30 08:47:30,913:INFO:   <<< margin: 0.1
2024-04-30 08:47:30,913:INFO:   <<< max_frames: 30
2024-04-30 08:47:30,913:INFO:   <<< max_words: 32
2024-04-30 08:47:30,913:INFO:   <<< n_display: 100
2024-04-30 08:47:30,913:INFO:   <<< n_gpu: 1
2024-04-30 08:47:30,913:INFO:   <<< n_pair: 1
2024-04-30 08:47:30,913:INFO:   <<< negative_weighting: 1
2024-04-30 08:47:30,913:INFO:   <<< num_thread_reader: 0
2024-04-30 08:47:30,913:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-04-30 08:47:30,914:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-04-30 08:47:30,914:INFO:   <<< rank: 0
2024-04-30 08:47:30,914:INFO:   <<< resume_model: None
2024-04-30 08:47:30,914:INFO:   <<< sampled_use_mil: False
2024-04-30 08:47:30,914:INFO:   <<< seed: 42
2024-04-30 08:47:30,914:INFO:   <<< sim_header: meanP
2024-04-30 08:47:30,914:INFO:   <<< slice_framepos: 2
2024-04-30 08:47:30,914:INFO:   <<< task_type: retrieval
2024-04-30 08:47:30,914:INFO:   <<< text_num_hidden_layers: 12
2024-04-30 08:47:30,914:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-04-30 08:47:30,914:INFO:   <<< train_frame_order: 0
2024-04-30 08:47:30,914:INFO:   <<< use_mil: False
2024-04-30 08:47:30,914:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-04-30 08:47:30,914:INFO:   <<< video_dim: 1024
2024-04-30 08:47:30,914:INFO:   <<< visual_num_hidden_layers: 12
2024-04-30 08:47:30,914:INFO:   <<< warmup_proportion: 0.1
2024-04-30 08:47:30,915:INFO:   <<< world_size: 1
2024-04-30 08:47:30,915:INFO: device: cuda:0 n_gpu: 1
2024-04-30 08:47:31,144:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-04-30 08:47:31,685:WARNING: Stage-One:True, Stage-Two:False
2024-04-30 08:47:31,685:WARNING: Test retrieval by loose type.
2024-04-30 08:47:31,686:WARNING: 	 embed_dim: 512
2024-04-30 08:47:31,686:WARNING: 	 image_resolution: 224
2024-04-30 08:47:31,686:WARNING: 	 vision_layers: 12
2024-04-30 08:47:31,686:WARNING: 	 vision_width: 768
2024-04-30 08:47:31,686:WARNING: 	 vision_patch_size: 32
2024-04-30 08:47:31,686:WARNING: 	 context_length: 77
2024-04-30 08:47:31,686:WARNING: 	 vocab_size: 49408
2024-04-30 08:47:31,686:WARNING: 	 transformer_width: 512
2024-04-30 08:47:31,686:WARNING: 	 transformer_heads: 8
2024-04-30 08:47:31,686:WARNING: 	 transformer_layers: 12
2024-04-30 08:47:31,686:WARNING: 		 linear_patch: 2d
2024-04-30 08:47:31,686:WARNING: 	 cut_top_layer: 0
2024-04-30 08:47:32,678:WARNING: 	 sim_header: meanP
2024-04-30 08:47:38,704:INFO: ***** Running test *****
2024-04-30 08:47:38,704:INFO:   Num examples = 29
2024-04-30 08:47:38,704:INFO:   Batch size = 16
2024-04-30 08:47:38,704:INFO:   Num steps = 2
2024-04-30 08:47:38,721:INFO: ***** Running val *****
2024-04-30 08:47:38,721:INFO:   Num examples = 29
2024-05-02 01:14:55,752:INFO: Effective parameters:
2024-05-02 01:14:55,752:INFO:   <<< batch_size: 16
2024-05-02 01:14:55,752:INFO:   <<< batch_size_val: 16
2024-05-02 01:14:55,752:INFO:   <<< cache_dir: 
2024-05-02 01:14:55,752:INFO:   <<< coef_lr: 0.001
2024-05-02 01:14:55,752:INFO:   <<< cross_model: cross-base
2024-05-02 01:14:55,752:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 01:14:55,752:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 01:14:55,753:INFO:   <<< datatype: msrvtt
2024-05-02 01:14:55,753:INFO:   <<< do_eval: True
2024-05-02 01:14:55,753:INFO:   <<< do_lower_case: False
2024-05-02 01:14:55,753:INFO:   <<< do_pretrain: False
2024-05-02 01:14:55,753:INFO:   <<< do_train: False
2024-05-02 01:14:55,753:INFO:   <<< epochs: 5
2024-05-02 01:14:55,753:INFO:   <<< eval_frame_order: 0
2024-05-02 01:14:55,753:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 01:14:55,753:INFO:   <<< feature_framerate: 1
2024-05-02 01:14:55,753:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 01:14:55,753:INFO:   <<< fp16: False
2024-05-02 01:14:55,753:INFO:   <<< fp16_opt_level: O1
2024-05-02 01:14:55,753:INFO:   <<< freeze_layer_num: 0
2024-05-02 01:14:55,753:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 01:14:55,753:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 01:14:55,753:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 01:14:55,753:INFO:   <<< linear_patch: 2d
2024-05-02 01:14:55,754:INFO:   <<< local_rank: 0
2024-05-02 01:14:55,754:INFO:   <<< loose_type: True
2024-05-02 01:14:55,754:INFO:   <<< lr: 0.0001
2024-05-02 01:14:55,754:INFO:   <<< lr_decay: 0.9
2024-05-02 01:14:55,754:INFO:   <<< margin: 0.1
2024-05-02 01:14:55,754:INFO:   <<< max_frames: 30
2024-05-02 01:14:55,754:INFO:   <<< max_words: 32
2024-05-02 01:14:55,754:INFO:   <<< n_display: 100
2024-05-02 01:14:55,754:INFO:   <<< n_gpu: 1
2024-05-02 01:14:55,754:INFO:   <<< n_pair: 1
2024-05-02 01:14:55,754:INFO:   <<< negative_weighting: 1
2024-05-02 01:14:55,754:INFO:   <<< num_thread_reader: 0
2024-05-02 01:14:55,754:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 01:14:55,754:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 01:14:55,754:INFO:   <<< rank: 0
2024-05-02 01:14:55,754:INFO:   <<< resume_model: None
2024-05-02 01:14:55,754:INFO:   <<< sampled_use_mil: False
2024-05-02 01:14:55,754:INFO:   <<< seed: 42
2024-05-02 01:14:55,755:INFO:   <<< sim_header: meanP
2024-05-02 01:14:55,755:INFO:   <<< slice_framepos: 2
2024-05-02 01:14:55,755:INFO:   <<< task_type: retrieval
2024-05-02 01:14:55,755:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 01:14:55,755:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 01:14:55,755:INFO:   <<< train_frame_order: 0
2024-05-02 01:14:55,755:INFO:   <<< use_mil: False
2024-05-02 01:14:55,755:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 01:14:55,755:INFO:   <<< video_dim: 1024
2024-05-02 01:14:55,755:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 01:14:55,755:INFO:   <<< warmup_proportion: 0.1
2024-05-02 01:14:55,755:INFO:   <<< world_size: 1
2024-05-02 01:14:55,755:INFO: device: cuda:0 n_gpu: 1
2024-05-02 01:14:56,065:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 01:14:56,756:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 01:14:56,756:WARNING: Test retrieval by loose type.
2024-05-02 01:14:56,756:WARNING: 	 embed_dim: 512
2024-05-02 01:14:56,757:WARNING: 	 image_resolution: 224
2024-05-02 01:14:56,757:WARNING: 	 vision_layers: 12
2024-05-02 01:14:56,757:WARNING: 	 vision_width: 768
2024-05-02 01:14:56,757:WARNING: 	 vision_patch_size: 32
2024-05-02 01:14:56,757:WARNING: 	 context_length: 77
2024-05-02 01:14:56,757:WARNING: 	 vocab_size: 49408
2024-05-02 01:14:56,757:WARNING: 	 transformer_width: 512
2024-05-02 01:14:56,757:WARNING: 	 transformer_heads: 8
2024-05-02 01:14:56,757:WARNING: 	 transformer_layers: 12
2024-05-02 01:14:56,757:WARNING: 		 linear_patch: 2d
2024-05-02 01:14:56,757:WARNING: 	 cut_top_layer: 0
2024-05-02 01:14:57,763:WARNING: 	 sim_header: meanP
2024-05-02 01:15:04,261:INFO: ***** Running test *****
2024-05-02 01:15:04,261:INFO:   Num examples = 29
2024-05-02 01:15:04,261:INFO:   Batch size = 16
2024-05-02 01:15:04,273:INFO:   Num steps = 2
2024-05-02 01:15:04,273:INFO: ***** Running val *****
2024-05-02 01:15:04,273:INFO:   Num examples = 29
2024-05-02 02:03:41,206:INFO: sim matrix size: 29, 29
2024-05-02 02:03:41,208:INFO: 	 Length-T: 29, Length-V:29
2024-05-02 02:03:41,208:INFO: Text-to-Video:
2024-05-02 02:03:41,209:INFO: 	>>>  R@1: 79.3 - R@5: 96.6 - R@10: 100.0 - Median R: 1.0 - Mean R: 1.5
2024-05-02 02:03:41,209:INFO: Video-to-Text:
2024-05-02 02:03:41,210:INFO: 	>>>  V2T$R@1: 79.3 - V2T$R@5: 100.0 - V2T$R@10: 100.0 - V2T$Median R: 1.0 - V2T$Mean R: 1.4
2024-05-02 02:04:09,398:INFO: Effective parameters:
2024-05-02 02:04:09,398:INFO:   <<< batch_size: 16
2024-05-02 02:04:09,398:INFO:   <<< batch_size_val: 16
2024-05-02 02:04:09,399:INFO:   <<< cache_dir: 
2024-05-02 02:04:09,399:INFO:   <<< coef_lr: 0.001
2024-05-02 02:04:09,399:INFO:   <<< cross_model: cross-base
2024-05-02 02:04:09,399:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 02:04:09,399:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 02:04:09,399:INFO:   <<< datatype: msrvtt
2024-05-02 02:04:09,399:INFO:   <<< do_eval: True
2024-05-02 02:04:09,399:INFO:   <<< do_lower_case: False
2024-05-02 02:04:09,399:INFO:   <<< do_pretrain: False
2024-05-02 02:04:09,399:INFO:   <<< do_train: False
2024-05-02 02:04:09,399:INFO:   <<< epochs: 5
2024-05-02 02:04:09,399:INFO:   <<< eval_frame_order: 0
2024-05-02 02:04:09,399:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 02:04:09,399:INFO:   <<< feature_framerate: 1
2024-05-02 02:04:09,399:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 02:04:09,399:INFO:   <<< fp16: False
2024-05-02 02:04:09,399:INFO:   <<< fp16_opt_level: O1
2024-05-02 02:04:09,399:INFO:   <<< freeze_layer_num: 0
2024-05-02 02:04:09,400:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 02:04:09,400:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 02:04:09,400:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:04:09,400:INFO:   <<< linear_patch: 2d
2024-05-02 02:04:09,400:INFO:   <<< local_rank: 0
2024-05-02 02:04:09,400:INFO:   <<< loose_type: True
2024-05-02 02:04:09,400:INFO:   <<< lr: 0.0001
2024-05-02 02:04:09,400:INFO:   <<< lr_decay: 0.9
2024-05-02 02:04:09,400:INFO:   <<< margin: 0.1
2024-05-02 02:04:09,400:INFO:   <<< max_frames: 30
2024-05-02 02:04:09,400:INFO:   <<< max_words: 32
2024-05-02 02:04:09,400:INFO:   <<< n_display: 100
2024-05-02 02:04:09,400:INFO:   <<< n_gpu: 1
2024-05-02 02:04:09,400:INFO:   <<< n_pair: 1
2024-05-02 02:04:09,400:INFO:   <<< negative_weighting: 1
2024-05-02 02:04:09,400:INFO:   <<< num_thread_reader: 0
2024-05-02 02:04:09,400:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 02:04:09,401:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 02:04:09,401:INFO:   <<< rank: 0
2024-05-02 02:04:09,401:INFO:   <<< resume_model: None
2024-05-02 02:04:09,401:INFO:   <<< sampled_use_mil: False
2024-05-02 02:04:09,401:INFO:   <<< seed: 42
2024-05-02 02:04:09,401:INFO:   <<< sim_header: meanP
2024-05-02 02:04:09,401:INFO:   <<< slice_framepos: 2
2024-05-02 02:04:09,401:INFO:   <<< task_type: retrieval
2024-05-02 02:04:09,401:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 02:04:09,401:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 02:04:09,401:INFO:   <<< train_frame_order: 0
2024-05-02 02:04:09,401:INFO:   <<< use_mil: False
2024-05-02 02:04:09,401:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 02:04:09,401:INFO:   <<< video_dim: 1024
2024-05-02 02:04:09,401:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 02:04:09,401:INFO:   <<< warmup_proportion: 0.1
2024-05-02 02:04:09,401:INFO:   <<< world_size: 1
2024-05-02 02:04:09,402:INFO: device: cuda:0 n_gpu: 1
2024-05-02 02:04:09,628:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:04:10,187:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 02:04:10,187:WARNING: Test retrieval by loose type.
2024-05-02 02:04:10,188:WARNING: 	 embed_dim: 512
2024-05-02 02:04:10,188:WARNING: 	 image_resolution: 224
2024-05-02 02:04:10,188:WARNING: 	 vision_layers: 12
2024-05-02 02:04:10,188:WARNING: 	 vision_width: 768
2024-05-02 02:04:10,188:WARNING: 	 vision_patch_size: 32
2024-05-02 02:04:10,188:WARNING: 	 context_length: 77
2024-05-02 02:04:10,189:WARNING: 	 vocab_size: 49408
2024-05-02 02:04:10,189:WARNING: 	 transformer_width: 512
2024-05-02 02:04:10,189:WARNING: 	 transformer_heads: 8
2024-05-02 02:04:10,189:WARNING: 	 transformer_layers: 12
2024-05-02 02:04:10,189:WARNING: 		 linear_patch: 2d
2024-05-02 02:04:10,189:WARNING: 	 cut_top_layer: 0
2024-05-02 02:04:11,174:WARNING: 	 sim_header: meanP
2024-05-02 02:04:17,192:INFO: ***** Running test *****
2024-05-02 02:04:17,197:INFO:   Num examples = 29
2024-05-02 02:04:17,197:INFO:   Batch size = 16
2024-05-02 02:04:17,197:INFO:   Num steps = 2
2024-05-02 02:04:17,211:INFO: ***** Running val *****
2024-05-02 02:04:17,211:INFO:   Num examples = 29
2024-05-02 02:07:29,075:INFO: Effective parameters:
2024-05-02 02:07:29,075:INFO:   <<< batch_size: 16
2024-05-02 02:07:29,075:INFO:   <<< batch_size_val: 16
2024-05-02 02:07:29,075:INFO:   <<< cache_dir: 
2024-05-02 02:07:29,075:INFO:   <<< coef_lr: 0.001
2024-05-02 02:07:29,075:INFO:   <<< cross_model: cross-base
2024-05-02 02:07:29,075:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 02:07:29,075:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 02:07:29,075:INFO:   <<< datatype: msrvtt
2024-05-02 02:07:29,076:INFO:   <<< do_eval: True
2024-05-02 02:07:29,076:INFO:   <<< do_lower_case: False
2024-05-02 02:07:29,076:INFO:   <<< do_pretrain: False
2024-05-02 02:07:29,076:INFO:   <<< do_train: False
2024-05-02 02:07:29,076:INFO:   <<< epochs: 5
2024-05-02 02:07:29,076:INFO:   <<< eval_frame_order: 0
2024-05-02 02:07:29,076:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 02:07:29,076:INFO:   <<< feature_framerate: 1
2024-05-02 02:07:29,076:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 02:07:29,076:INFO:   <<< fp16: False
2024-05-02 02:07:29,076:INFO:   <<< fp16_opt_level: O1
2024-05-02 02:07:29,076:INFO:   <<< freeze_layer_num: 0
2024-05-02 02:07:29,076:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 02:07:29,076:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 02:07:29,076:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:07:29,076:INFO:   <<< linear_patch: 2d
2024-05-02 02:07:29,076:INFO:   <<< local_rank: 0
2024-05-02 02:07:29,077:INFO:   <<< loose_type: True
2024-05-02 02:07:29,077:INFO:   <<< lr: 0.0001
2024-05-02 02:07:29,077:INFO:   <<< lr_decay: 0.9
2024-05-02 02:07:29,077:INFO:   <<< margin: 0.1
2024-05-02 02:07:29,077:INFO:   <<< max_frames: 30
2024-05-02 02:07:29,077:INFO:   <<< max_words: 32
2024-05-02 02:07:29,077:INFO:   <<< n_display: 100
2024-05-02 02:07:29,077:INFO:   <<< n_gpu: 1
2024-05-02 02:07:29,077:INFO:   <<< n_pair: 1
2024-05-02 02:07:29,077:INFO:   <<< negative_weighting: 1
2024-05-02 02:07:29,077:INFO:   <<< num_thread_reader: 0
2024-05-02 02:07:29,077:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 02:07:29,077:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 02:07:29,077:INFO:   <<< rank: 0
2024-05-02 02:07:29,077:INFO:   <<< resume_model: None
2024-05-02 02:07:29,077:INFO:   <<< sampled_use_mil: False
2024-05-02 02:07:29,077:INFO:   <<< seed: 42
2024-05-02 02:07:29,078:INFO:   <<< sim_header: meanP
2024-05-02 02:07:29,078:INFO:   <<< slice_framepos: 2
2024-05-02 02:07:29,078:INFO:   <<< task_type: retrieval
2024-05-02 02:07:29,078:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 02:07:29,078:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 02:07:29,078:INFO:   <<< train_frame_order: 0
2024-05-02 02:07:29,078:INFO:   <<< use_mil: False
2024-05-02 02:07:29,078:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 02:07:29,078:INFO:   <<< video_dim: 1024
2024-05-02 02:07:29,078:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 02:07:29,078:INFO:   <<< warmup_proportion: 0.1
2024-05-02 02:07:29,078:INFO:   <<< world_size: 1
2024-05-02 02:07:29,078:INFO: device: cuda:0 n_gpu: 1
2024-05-02 02:07:29,306:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:07:29,847:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 02:07:29,847:WARNING: Test retrieval by loose type.
2024-05-02 02:07:29,848:WARNING: 	 embed_dim: 512
2024-05-02 02:07:29,848:WARNING: 	 image_resolution: 224
2024-05-02 02:07:29,848:WARNING: 	 vision_layers: 12
2024-05-02 02:07:29,848:WARNING: 	 vision_width: 768
2024-05-02 02:07:29,848:WARNING: 	 vision_patch_size: 32
2024-05-02 02:07:29,848:WARNING: 	 context_length: 77
2024-05-02 02:07:29,848:WARNING: 	 vocab_size: 49408
2024-05-02 02:07:29,848:WARNING: 	 transformer_width: 512
2024-05-02 02:07:29,848:WARNING: 	 transformer_heads: 8
2024-05-02 02:07:29,848:WARNING: 	 transformer_layers: 12
2024-05-02 02:07:29,848:WARNING: 		 linear_patch: 2d
2024-05-02 02:07:29,848:WARNING: 	 cut_top_layer: 0
2024-05-02 02:07:30,827:WARNING: 	 sim_header: meanP
2024-05-02 02:07:36,860:INFO: ***** Running test *****
2024-05-02 02:07:36,860:INFO:   Num examples = 29
2024-05-02 02:07:36,860:INFO:   Batch size = 16
2024-05-02 02:07:36,860:INFO:   Num steps = 2
2024-05-02 02:07:36,874:INFO: ***** Running val *****
2024-05-02 02:07:36,874:INFO:   Num examples = 29
2024-05-02 02:08:54,751:INFO: Effective parameters:
2024-05-02 02:08:54,751:INFO:   <<< batch_size: 16
2024-05-02 02:08:54,751:INFO:   <<< batch_size_val: 16
2024-05-02 02:08:54,751:INFO:   <<< cache_dir: 
2024-05-02 02:08:54,752:INFO:   <<< coef_lr: 0.001
2024-05-02 02:08:54,752:INFO:   <<< cross_model: cross-base
2024-05-02 02:08:54,752:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 02:08:54,752:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 02:08:54,752:INFO:   <<< datatype: msrvtt
2024-05-02 02:08:54,752:INFO:   <<< do_eval: True
2024-05-02 02:08:54,752:INFO:   <<< do_lower_case: False
2024-05-02 02:08:54,752:INFO:   <<< do_pretrain: False
2024-05-02 02:08:54,752:INFO:   <<< do_train: False
2024-05-02 02:08:54,752:INFO:   <<< epochs: 5
2024-05-02 02:08:54,752:INFO:   <<< eval_frame_order: 0
2024-05-02 02:08:54,752:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 02:08:54,752:INFO:   <<< feature_framerate: 1
2024-05-02 02:08:54,752:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 02:08:54,752:INFO:   <<< fp16: False
2024-05-02 02:08:54,752:INFO:   <<< fp16_opt_level: O1
2024-05-02 02:08:54,753:INFO:   <<< freeze_layer_num: 0
2024-05-02 02:08:54,753:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 02:08:54,753:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 02:08:54,753:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:08:54,753:INFO:   <<< linear_patch: 2d
2024-05-02 02:08:54,753:INFO:   <<< local_rank: 0
2024-05-02 02:08:54,753:INFO:   <<< loose_type: True
2024-05-02 02:08:54,753:INFO:   <<< lr: 0.0001
2024-05-02 02:08:54,753:INFO:   <<< lr_decay: 0.9
2024-05-02 02:08:54,753:INFO:   <<< margin: 0.1
2024-05-02 02:08:54,753:INFO:   <<< max_frames: 30
2024-05-02 02:08:54,753:INFO:   <<< max_words: 32
2024-05-02 02:08:54,753:INFO:   <<< n_display: 100
2024-05-02 02:08:54,753:INFO:   <<< n_gpu: 1
2024-05-02 02:08:54,753:INFO:   <<< n_pair: 1
2024-05-02 02:08:54,753:INFO:   <<< negative_weighting: 1
2024-05-02 02:08:54,753:INFO:   <<< num_thread_reader: 0
2024-05-02 02:08:54,753:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 02:08:54,754:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 02:08:54,754:INFO:   <<< rank: 0
2024-05-02 02:08:54,754:INFO:   <<< resume_model: None
2024-05-02 02:08:54,754:INFO:   <<< sampled_use_mil: False
2024-05-02 02:08:54,754:INFO:   <<< seed: 42
2024-05-02 02:08:54,754:INFO:   <<< sim_header: meanP
2024-05-02 02:08:54,754:INFO:   <<< slice_framepos: 2
2024-05-02 02:08:54,754:INFO:   <<< task_type: retrieval
2024-05-02 02:08:54,754:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 02:08:54,754:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 02:08:54,754:INFO:   <<< train_frame_order: 0
2024-05-02 02:08:54,754:INFO:   <<< use_mil: False
2024-05-02 02:08:54,754:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 02:08:54,754:INFO:   <<< video_dim: 1024
2024-05-02 02:08:54,754:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 02:08:54,754:INFO:   <<< warmup_proportion: 0.1
2024-05-02 02:08:54,754:INFO:   <<< world_size: 1
2024-05-02 02:08:54,755:INFO: device: cuda:0 n_gpu: 1
2024-05-02 02:08:54,984:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:08:55,529:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 02:08:55,529:WARNING: Test retrieval by loose type.
2024-05-02 02:08:55,530:WARNING: 	 embed_dim: 512
2024-05-02 02:08:55,530:WARNING: 	 image_resolution: 224
2024-05-02 02:08:55,530:WARNING: 	 vision_layers: 12
2024-05-02 02:08:55,530:WARNING: 	 vision_width: 768
2024-05-02 02:08:55,530:WARNING: 	 vision_patch_size: 32
2024-05-02 02:08:55,530:WARNING: 	 context_length: 77
2024-05-02 02:08:55,530:WARNING: 	 vocab_size: 49408
2024-05-02 02:08:55,530:WARNING: 	 transformer_width: 512
2024-05-02 02:08:55,530:WARNING: 	 transformer_heads: 8
2024-05-02 02:08:55,531:WARNING: 	 transformer_layers: 12
2024-05-02 02:08:55,531:WARNING: 		 linear_patch: 2d
2024-05-02 02:08:55,531:WARNING: 	 cut_top_layer: 0
2024-05-02 02:08:56,525:WARNING: 	 sim_header: meanP
2024-05-02 02:09:02,544:INFO: ***** Running test *****
2024-05-02 02:09:02,544:INFO:   Num examples = 29
2024-05-02 02:09:02,544:INFO:   Batch size = 16
2024-05-02 02:09:02,544:INFO:   Num steps = 2
2024-05-02 02:09:02,558:INFO: ***** Running val *****
2024-05-02 02:09:02,558:INFO:   Num examples = 29
2024-05-02 02:09:41,422:INFO: Effective parameters:
2024-05-02 02:09:41,423:INFO:   <<< batch_size: 16
2024-05-02 02:09:41,423:INFO:   <<< batch_size_val: 16
2024-05-02 02:09:41,423:INFO:   <<< cache_dir: 
2024-05-02 02:09:41,423:INFO:   <<< coef_lr: 0.001
2024-05-02 02:09:41,423:INFO:   <<< cross_model: cross-base
2024-05-02 02:09:41,423:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 02:09:41,423:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 02:09:41,423:INFO:   <<< datatype: msrvtt
2024-05-02 02:09:41,423:INFO:   <<< do_eval: True
2024-05-02 02:09:41,423:INFO:   <<< do_lower_case: False
2024-05-02 02:09:41,423:INFO:   <<< do_pretrain: False
2024-05-02 02:09:41,423:INFO:   <<< do_train: False
2024-05-02 02:09:41,423:INFO:   <<< epochs: 5
2024-05-02 02:09:41,423:INFO:   <<< eval_frame_order: 0
2024-05-02 02:09:41,424:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 02:09:41,424:INFO:   <<< feature_framerate: 1
2024-05-02 02:09:41,424:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 02:09:41,424:INFO:   <<< fp16: False
2024-05-02 02:09:41,424:INFO:   <<< fp16_opt_level: O1
2024-05-02 02:09:41,424:INFO:   <<< freeze_layer_num: 0
2024-05-02 02:09:41,424:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 02:09:41,424:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 02:09:41,424:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:09:41,424:INFO:   <<< linear_patch: 2d
2024-05-02 02:09:41,424:INFO:   <<< local_rank: 0
2024-05-02 02:09:41,424:INFO:   <<< loose_type: True
2024-05-02 02:09:41,424:INFO:   <<< lr: 0.0001
2024-05-02 02:09:41,424:INFO:   <<< lr_decay: 0.9
2024-05-02 02:09:41,424:INFO:   <<< margin: 0.1
2024-05-02 02:09:41,424:INFO:   <<< max_frames: 30
2024-05-02 02:09:41,424:INFO:   <<< max_words: 32
2024-05-02 02:09:41,425:INFO:   <<< n_display: 100
2024-05-02 02:09:41,425:INFO:   <<< n_gpu: 1
2024-05-02 02:09:41,425:INFO:   <<< n_pair: 1
2024-05-02 02:09:41,425:INFO:   <<< negative_weighting: 1
2024-05-02 02:09:41,425:INFO:   <<< num_thread_reader: 0
2024-05-02 02:09:41,425:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 02:09:41,425:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 02:09:41,425:INFO:   <<< rank: 0
2024-05-02 02:09:41,425:INFO:   <<< resume_model: None
2024-05-02 02:09:41,425:INFO:   <<< sampled_use_mil: False
2024-05-02 02:09:41,425:INFO:   <<< seed: 42
2024-05-02 02:09:41,425:INFO:   <<< sim_header: meanP
2024-05-02 02:09:41,425:INFO:   <<< slice_framepos: 2
2024-05-02 02:09:41,425:INFO:   <<< task_type: retrieval
2024-05-02 02:09:41,425:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 02:09:41,425:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 02:09:41,425:INFO:   <<< train_frame_order: 0
2024-05-02 02:09:41,426:INFO:   <<< use_mil: False
2024-05-02 02:09:41,426:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 02:09:41,426:INFO:   <<< video_dim: 1024
2024-05-02 02:09:41,426:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 02:09:41,426:INFO:   <<< warmup_proportion: 0.1
2024-05-02 02:09:41,426:INFO:   <<< world_size: 1
2024-05-02 02:09:41,426:INFO: device: cuda:0 n_gpu: 1
2024-05-02 02:09:41,650:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:09:42,194:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 02:09:42,194:WARNING: Test retrieval by loose type.
2024-05-02 02:09:42,194:WARNING: 	 embed_dim: 512
2024-05-02 02:09:42,194:WARNING: 	 image_resolution: 224
2024-05-02 02:09:42,195:WARNING: 	 vision_layers: 12
2024-05-02 02:09:42,195:WARNING: 	 vision_width: 768
2024-05-02 02:09:42,195:WARNING: 	 vision_patch_size: 32
2024-05-02 02:09:42,195:WARNING: 	 context_length: 77
2024-05-02 02:09:42,195:WARNING: 	 vocab_size: 49408
2024-05-02 02:09:42,195:WARNING: 	 transformer_width: 512
2024-05-02 02:09:42,195:WARNING: 	 transformer_heads: 8
2024-05-02 02:09:42,195:WARNING: 	 transformer_layers: 12
2024-05-02 02:09:42,195:WARNING: 		 linear_patch: 2d
2024-05-02 02:09:42,195:WARNING: 	 cut_top_layer: 0
2024-05-02 02:11:37,991:INFO: Effective parameters:
2024-05-02 02:11:37,991:INFO:   <<< batch_size: 16
2024-05-02 02:11:37,991:INFO:   <<< batch_size_val: 16
2024-05-02 02:11:37,991:INFO:   <<< cache_dir: 
2024-05-02 02:11:37,991:INFO:   <<< coef_lr: 0.001
2024-05-02 02:11:37,991:INFO:   <<< cross_model: cross-base
2024-05-02 02:11:37,991:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 02:11:37,991:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 02:11:37,991:INFO:   <<< datatype: msrvtt
2024-05-02 02:11:37,991:INFO:   <<< do_eval: True
2024-05-02 02:11:37,991:INFO:   <<< do_lower_case: False
2024-05-02 02:11:37,991:INFO:   <<< do_pretrain: False
2024-05-02 02:11:37,991:INFO:   <<< do_train: False
2024-05-02 02:11:37,992:INFO:   <<< epochs: 5
2024-05-02 02:11:37,992:INFO:   <<< eval_frame_order: 0
2024-05-02 02:11:37,992:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 02:11:37,992:INFO:   <<< feature_framerate: 1
2024-05-02 02:11:37,992:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 02:11:37,992:INFO:   <<< fp16: False
2024-05-02 02:11:37,992:INFO:   <<< fp16_opt_level: O1
2024-05-02 02:11:37,992:INFO:   <<< freeze_layer_num: 0
2024-05-02 02:11:37,992:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 02:11:37,992:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 02:11:37,992:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:11:37,992:INFO:   <<< linear_patch: 2d
2024-05-02 02:11:37,992:INFO:   <<< local_rank: 0
2024-05-02 02:11:37,992:INFO:   <<< loose_type: True
2024-05-02 02:11:37,992:INFO:   <<< lr: 0.0001
2024-05-02 02:11:37,992:INFO:   <<< lr_decay: 0.9
2024-05-02 02:11:37,992:INFO:   <<< margin: 0.1
2024-05-02 02:11:37,993:INFO:   <<< max_frames: 30
2024-05-02 02:11:37,993:INFO:   <<< max_words: 32
2024-05-02 02:11:37,993:INFO:   <<< n_display: 100
2024-05-02 02:11:37,993:INFO:   <<< n_gpu: 1
2024-05-02 02:11:37,993:INFO:   <<< n_pair: 1
2024-05-02 02:11:37,993:INFO:   <<< negative_weighting: 1
2024-05-02 02:11:37,993:INFO:   <<< num_thread_reader: 0
2024-05-02 02:11:37,993:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 02:11:37,993:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 02:11:37,993:INFO:   <<< rank: 0
2024-05-02 02:11:37,993:INFO:   <<< resume_model: None
2024-05-02 02:11:37,993:INFO:   <<< sampled_use_mil: False
2024-05-02 02:11:37,993:INFO:   <<< seed: 42
2024-05-02 02:11:37,993:INFO:   <<< sim_header: meanP
2024-05-02 02:11:37,993:INFO:   <<< slice_framepos: 2
2024-05-02 02:11:37,993:INFO:   <<< task_type: retrieval
2024-05-02 02:11:37,993:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 02:11:37,994:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 02:11:37,994:INFO:   <<< train_frame_order: 0
2024-05-02 02:11:37,994:INFO:   <<< use_mil: False
2024-05-02 02:11:37,994:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 02:11:37,994:INFO:   <<< video_dim: 1024
2024-05-02 02:11:37,994:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 02:11:37,994:INFO:   <<< warmup_proportion: 0.1
2024-05-02 02:11:37,994:INFO:   <<< world_size: 1
2024-05-02 02:11:37,994:INFO: device: cuda:0 n_gpu: 1
2024-05-02 02:11:38,217:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:11:38,762:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 02:11:38,763:WARNING: Test retrieval by loose type.
2024-05-02 02:11:38,763:WARNING: 	 embed_dim: 512
2024-05-02 02:11:38,763:WARNING: 	 image_resolution: 224
2024-05-02 02:11:38,763:WARNING: 	 vision_layers: 12
2024-05-02 02:11:38,764:WARNING: 	 vision_width: 768
2024-05-02 02:11:38,764:WARNING: 	 vision_patch_size: 32
2024-05-02 02:11:38,764:WARNING: 	 context_length: 77
2024-05-02 02:11:38,764:WARNING: 	 vocab_size: 49408
2024-05-02 02:11:38,764:WARNING: 	 transformer_width: 512
2024-05-02 02:11:38,764:WARNING: 	 transformer_heads: 8
2024-05-02 02:11:38,764:WARNING: 	 transformer_layers: 12
2024-05-02 02:11:38,764:WARNING: 		 linear_patch: 2d
2024-05-02 02:11:38,764:WARNING: 	 cut_top_layer: 0
2024-05-02 02:11:39,757:WARNING: 	 sim_header: meanP
2024-05-02 02:11:45,797:INFO: ***** Running test *****
2024-05-02 02:11:45,798:INFO:   Num examples = 29
2024-05-02 02:11:45,798:INFO:   Batch size = 16
2024-05-02 02:11:45,798:INFO:   Num steps = 2
2024-05-02 02:11:45,814:INFO: ***** Running val *****
2024-05-02 02:11:45,814:INFO:   Num examples = 29
2024-05-02 02:26:22,311:INFO: Effective parameters:
2024-05-02 02:26:22,312:INFO:   <<< batch_size: 16
2024-05-02 02:26:22,312:INFO:   <<< batch_size_val: 16
2024-05-02 02:26:22,312:INFO:   <<< cache_dir: 
2024-05-02 02:26:22,312:INFO:   <<< coef_lr: 0.001
2024-05-02 02:26:22,312:INFO:   <<< cross_model: cross-base
2024-05-02 02:26:22,312:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 02:26:22,312:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 02:26:22,312:INFO:   <<< datatype: msrvtt
2024-05-02 02:26:22,312:INFO:   <<< do_eval: True
2024-05-02 02:26:22,312:INFO:   <<< do_lower_case: False
2024-05-02 02:26:22,312:INFO:   <<< do_pretrain: False
2024-05-02 02:26:22,313:INFO:   <<< do_train: False
2024-05-02 02:26:22,313:INFO:   <<< epochs: 5
2024-05-02 02:26:22,313:INFO:   <<< eval_frame_order: 0
2024-05-02 02:26:22,313:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 02:26:22,313:INFO:   <<< feature_framerate: 1
2024-05-02 02:26:22,313:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 02:26:22,313:INFO:   <<< fp16: False
2024-05-02 02:26:22,313:INFO:   <<< fp16_opt_level: O1
2024-05-02 02:26:22,313:INFO:   <<< freeze_layer_num: 0
2024-05-02 02:26:22,313:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 02:26:22,313:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 02:26:22,313:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:26:22,313:INFO:   <<< linear_patch: 2d
2024-05-02 02:26:22,313:INFO:   <<< local_rank: 0
2024-05-02 02:26:22,314:INFO:   <<< loose_type: True
2024-05-02 02:26:22,314:INFO:   <<< lr: 0.0001
2024-05-02 02:26:22,314:INFO:   <<< lr_decay: 0.9
2024-05-02 02:26:22,314:INFO:   <<< margin: 0.1
2024-05-02 02:26:22,314:INFO:   <<< max_frames: 30
2024-05-02 02:26:22,314:INFO:   <<< max_words: 32
2024-05-02 02:26:22,314:INFO:   <<< n_display: 100
2024-05-02 02:26:22,314:INFO:   <<< n_gpu: 1
2024-05-02 02:26:22,314:INFO:   <<< n_pair: 1
2024-05-02 02:26:22,314:INFO:   <<< negative_weighting: 1
2024-05-02 02:26:22,314:INFO:   <<< num_thread_reader: 0
2024-05-02 02:26:22,314:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 02:26:22,314:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 02:26:22,314:INFO:   <<< rank: 0
2024-05-02 02:26:22,315:INFO:   <<< resume_model: None
2024-05-02 02:26:22,315:INFO:   <<< sampled_use_mil: False
2024-05-02 02:26:22,315:INFO:   <<< seed: 42
2024-05-02 02:26:22,315:INFO:   <<< sim_header: meanP
2024-05-02 02:26:22,315:INFO:   <<< slice_framepos: 2
2024-05-02 02:26:22,315:INFO:   <<< task_type: retrieval
2024-05-02 02:26:22,315:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 02:26:22,315:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 02:26:22,315:INFO:   <<< train_frame_order: 0
2024-05-02 02:26:22,315:INFO:   <<< use_mil: False
2024-05-02 02:26:22,315:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 02:26:22,315:INFO:   <<< video_dim: 1024
2024-05-02 02:26:22,315:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 02:26:22,316:INFO:   <<< warmup_proportion: 0.1
2024-05-02 02:26:22,316:INFO:   <<< world_size: 1
2024-05-02 02:26:22,316:INFO: device: cuda:0 n_gpu: 1
2024-05-02 02:26:22,536:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:26:23,080:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 02:26:23,080:WARNING: Test retrieval by loose type.
2024-05-02 02:26:23,081:WARNING: 	 embed_dim: 512
2024-05-02 02:26:23,081:WARNING: 	 image_resolution: 224
2024-05-02 02:26:23,081:WARNING: 	 vision_layers: 12
2024-05-02 02:26:23,081:WARNING: 	 vision_width: 768
2024-05-02 02:26:23,081:WARNING: 	 vision_patch_size: 32
2024-05-02 02:26:23,081:WARNING: 	 context_length: 77
2024-05-02 02:26:23,081:WARNING: 	 vocab_size: 49408
2024-05-02 02:26:23,081:WARNING: 	 transformer_width: 512
2024-05-02 02:26:23,081:WARNING: 	 transformer_heads: 8
2024-05-02 02:26:23,081:WARNING: 	 transformer_layers: 12
2024-05-02 02:26:23,081:WARNING: 		 linear_patch: 2d
2024-05-02 02:26:23,081:WARNING: 	 cut_top_layer: 0
2024-05-02 02:27:18,599:INFO: Effective parameters:
2024-05-02 02:27:18,599:INFO:   <<< batch_size: 16
2024-05-02 02:27:18,600:INFO:   <<< batch_size_val: 16
2024-05-02 02:27:18,600:INFO:   <<< cache_dir: 
2024-05-02 02:27:18,600:INFO:   <<< coef_lr: 0.001
2024-05-02 02:27:18,600:INFO:   <<< cross_model: cross-base
2024-05-02 02:27:18,600:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 02:27:18,600:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 02:27:18,600:INFO:   <<< datatype: msrvtt
2024-05-02 02:27:18,600:INFO:   <<< do_eval: True
2024-05-02 02:27:18,600:INFO:   <<< do_lower_case: False
2024-05-02 02:27:18,600:INFO:   <<< do_pretrain: False
2024-05-02 02:27:18,600:INFO:   <<< do_train: False
2024-05-02 02:27:18,600:INFO:   <<< epochs: 5
2024-05-02 02:27:18,600:INFO:   <<< eval_frame_order: 0
2024-05-02 02:27:18,600:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 02:27:18,601:INFO:   <<< feature_framerate: 1
2024-05-02 02:27:18,601:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 02:27:18,601:INFO:   <<< fp16: False
2024-05-02 02:27:18,601:INFO:   <<< fp16_opt_level: O1
2024-05-02 02:27:18,601:INFO:   <<< freeze_layer_num: 0
2024-05-02 02:27:18,601:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 02:27:18,601:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 02:27:18,601:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:27:18,601:INFO:   <<< linear_patch: 2d
2024-05-02 02:27:18,601:INFO:   <<< local_rank: 0
2024-05-02 02:27:18,601:INFO:   <<< loose_type: True
2024-05-02 02:27:18,601:INFO:   <<< lr: 0.0001
2024-05-02 02:27:18,601:INFO:   <<< lr_decay: 0.9
2024-05-02 02:27:18,601:INFO:   <<< margin: 0.1
2024-05-02 02:27:18,601:INFO:   <<< max_frames: 30
2024-05-02 02:27:18,602:INFO:   <<< max_words: 32
2024-05-02 02:27:18,602:INFO:   <<< n_display: 100
2024-05-02 02:27:18,602:INFO:   <<< n_gpu: 1
2024-05-02 02:27:18,602:INFO:   <<< n_pair: 1
2024-05-02 02:27:18,602:INFO:   <<< negative_weighting: 1
2024-05-02 02:27:18,602:INFO:   <<< num_thread_reader: 0
2024-05-02 02:27:18,602:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 02:27:18,602:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 02:27:18,602:INFO:   <<< rank: 0
2024-05-02 02:27:18,602:INFO:   <<< resume_model: None
2024-05-02 02:27:18,602:INFO:   <<< sampled_use_mil: False
2024-05-02 02:27:18,602:INFO:   <<< seed: 42
2024-05-02 02:27:18,602:INFO:   <<< sim_header: meanP
2024-05-02 02:27:18,602:INFO:   <<< slice_framepos: 2
2024-05-02 02:27:18,602:INFO:   <<< task_type: retrieval
2024-05-02 02:27:18,603:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 02:27:18,603:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 02:27:18,603:INFO:   <<< train_frame_order: 0
2024-05-02 02:27:18,603:INFO:   <<< use_mil: False
2024-05-02 02:27:18,603:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 02:27:18,603:INFO:   <<< video_dim: 1024
2024-05-02 02:27:18,603:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 02:27:18,603:INFO:   <<< warmup_proportion: 0.1
2024-05-02 02:27:18,603:INFO:   <<< world_size: 1
2024-05-02 02:27:18,603:INFO: device: cuda:0 n_gpu: 1
2024-05-02 02:27:18,823:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:27:19,361:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 02:27:19,361:WARNING: Test retrieval by loose type.
2024-05-02 02:27:19,362:WARNING: 	 embed_dim: 512
2024-05-02 02:27:19,362:WARNING: 	 image_resolution: 224
2024-05-02 02:27:19,362:WARNING: 	 vision_layers: 12
2024-05-02 02:27:19,362:WARNING: 	 vision_width: 768
2024-05-02 02:27:19,362:WARNING: 	 vision_patch_size: 32
2024-05-02 02:27:19,362:WARNING: 	 context_length: 77
2024-05-02 02:27:19,362:WARNING: 	 vocab_size: 49408
2024-05-02 02:27:19,362:WARNING: 	 transformer_width: 512
2024-05-02 02:27:19,362:WARNING: 	 transformer_heads: 8
2024-05-02 02:27:19,362:WARNING: 	 transformer_layers: 12
2024-05-02 02:27:19,362:WARNING: 		 linear_patch: 2d
2024-05-02 02:27:19,362:WARNING: 	 cut_top_layer: 0
2024-05-02 02:27:20,342:WARNING: 	 sim_header: meanP
2024-05-02 02:27:26,359:INFO: ***** Running test *****
2024-05-02 02:27:26,359:INFO:   Num examples = 29
2024-05-02 02:27:26,359:INFO:   Batch size = 16
2024-05-02 02:27:26,360:INFO:   Num steps = 2
2024-05-02 02:27:26,374:INFO: ***** Running val *****
2024-05-02 02:27:26,374:INFO:   Num examples = 29
2024-05-02 02:28:08,532:INFO: Effective parameters:
2024-05-02 02:28:08,533:INFO:   <<< batch_size: 16
2024-05-02 02:28:08,533:INFO:   <<< batch_size_val: 16
2024-05-02 02:28:08,533:INFO:   <<< cache_dir: 
2024-05-02 02:28:08,533:INFO:   <<< coef_lr: 0.001
2024-05-02 02:28:08,533:INFO:   <<< cross_model: cross-base
2024-05-02 02:28:08,533:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 02:28:08,533:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 02:28:08,533:INFO:   <<< datatype: msrvtt
2024-05-02 02:28:08,533:INFO:   <<< do_eval: True
2024-05-02 02:28:08,533:INFO:   <<< do_lower_case: False
2024-05-02 02:28:08,533:INFO:   <<< do_pretrain: False
2024-05-02 02:28:08,533:INFO:   <<< do_train: False
2024-05-02 02:28:08,533:INFO:   <<< epochs: 5
2024-05-02 02:28:08,533:INFO:   <<< eval_frame_order: 0
2024-05-02 02:28:08,533:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 02:28:08,533:INFO:   <<< feature_framerate: 1
2024-05-02 02:28:08,534:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 02:28:08,534:INFO:   <<< fp16: False
2024-05-02 02:28:08,534:INFO:   <<< fp16_opt_level: O1
2024-05-02 02:28:08,534:INFO:   <<< freeze_layer_num: 0
2024-05-02 02:28:08,534:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 02:28:08,534:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 02:28:08,534:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:28:08,534:INFO:   <<< linear_patch: 2d
2024-05-02 02:28:08,534:INFO:   <<< local_rank: 0
2024-05-02 02:28:08,534:INFO:   <<< loose_type: True
2024-05-02 02:28:08,534:INFO:   <<< lr: 0.0001
2024-05-02 02:28:08,534:INFO:   <<< lr_decay: 0.9
2024-05-02 02:28:08,534:INFO:   <<< margin: 0.1
2024-05-02 02:28:08,534:INFO:   <<< max_frames: 30
2024-05-02 02:28:08,534:INFO:   <<< max_words: 32
2024-05-02 02:28:08,534:INFO:   <<< n_display: 100
2024-05-02 02:28:08,534:INFO:   <<< n_gpu: 1
2024-05-02 02:28:08,535:INFO:   <<< n_pair: 1
2024-05-02 02:28:08,535:INFO:   <<< negative_weighting: 1
2024-05-02 02:28:08,535:INFO:   <<< num_thread_reader: 0
2024-05-02 02:28:08,535:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 02:28:08,535:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 02:28:08,535:INFO:   <<< rank: 0
2024-05-02 02:28:08,535:INFO:   <<< resume_model: None
2024-05-02 02:28:08,535:INFO:   <<< sampled_use_mil: False
2024-05-02 02:28:08,535:INFO:   <<< seed: 42
2024-05-02 02:28:08,535:INFO:   <<< sim_header: meanP
2024-05-02 02:28:08,535:INFO:   <<< slice_framepos: 2
2024-05-02 02:28:08,535:INFO:   <<< task_type: retrieval
2024-05-02 02:28:08,535:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 02:28:08,535:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 02:28:08,536:INFO:   <<< train_frame_order: 0
2024-05-02 02:28:08,536:INFO:   <<< use_mil: False
2024-05-02 02:28:08,536:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 02:28:08,536:INFO:   <<< video_dim: 1024
2024-05-02 02:28:08,536:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 02:28:08,536:INFO:   <<< warmup_proportion: 0.1
2024-05-02 02:28:08,536:INFO:   <<< world_size: 1
2024-05-02 02:28:08,536:INFO: device: cuda:0 n_gpu: 1
2024-05-02 02:28:08,761:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 02:28:09,300:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 02:28:09,300:WARNING: Test retrieval by loose type.
2024-05-02 02:28:09,301:WARNING: 	 embed_dim: 512
2024-05-02 02:28:09,301:WARNING: 	 image_resolution: 224
2024-05-02 02:28:09,301:WARNING: 	 vision_layers: 12
2024-05-02 02:28:09,301:WARNING: 	 vision_width: 768
2024-05-02 02:28:09,301:WARNING: 	 vision_patch_size: 32
2024-05-02 02:28:09,301:WARNING: 	 context_length: 77
2024-05-02 02:28:09,301:WARNING: 	 vocab_size: 49408
2024-05-02 02:28:09,301:WARNING: 	 transformer_width: 512
2024-05-02 02:28:09,301:WARNING: 	 transformer_heads: 8
2024-05-02 02:28:09,302:WARNING: 	 transformer_layers: 12
2024-05-02 02:28:09,302:WARNING: 		 linear_patch: 2d
2024-05-02 02:28:09,302:WARNING: 	 cut_top_layer: 0
2024-05-02 02:28:10,279:WARNING: 	 sim_header: meanP
2024-05-02 02:28:16,297:INFO: ***** Running test *****
2024-05-02 02:28:16,297:INFO:   Num examples = 29
2024-05-02 02:28:16,297:INFO:   Batch size = 16
2024-05-02 02:28:16,312:INFO:   Num steps = 2
2024-05-02 02:28:16,312:INFO: ***** Running val *****
2024-05-02 02:28:16,312:INFO:   Num examples = 29
2024-05-02 03:35:39,016:INFO: Effective parameters:
2024-05-02 03:35:39,016:INFO:   <<< batch_size: 16
2024-05-02 03:35:39,016:INFO:   <<< batch_size_val: 16
2024-05-02 03:35:39,016:INFO:   <<< cache_dir: 
2024-05-02 03:35:39,016:INFO:   <<< coef_lr: 0.001
2024-05-02 03:35:39,016:INFO:   <<< cross_model: cross-base
2024-05-02 03:35:39,016:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 03:35:39,016:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 03:35:39,016:INFO:   <<< datatype: msrvtt
2024-05-02 03:35:39,016:INFO:   <<< do_eval: True
2024-05-02 03:35:39,016:INFO:   <<< do_lower_case: False
2024-05-02 03:35:39,016:INFO:   <<< do_pretrain: False
2024-05-02 03:35:39,017:INFO:   <<< do_train: False
2024-05-02 03:35:39,017:INFO:   <<< epochs: 5
2024-05-02 03:35:39,017:INFO:   <<< eval_frame_order: 0
2024-05-02 03:35:39,017:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 03:35:39,017:INFO:   <<< feature_framerate: 1
2024-05-02 03:35:39,017:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 03:35:39,017:INFO:   <<< fp16: False
2024-05-02 03:35:39,017:INFO:   <<< fp16_opt_level: O1
2024-05-02 03:35:39,017:INFO:   <<< freeze_layer_num: 0
2024-05-02 03:35:39,017:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 03:35:39,017:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 03:35:39,017:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 03:35:39,017:INFO:   <<< linear_patch: 2d
2024-05-02 03:35:39,017:INFO:   <<< local_rank: 0
2024-05-02 03:35:39,017:INFO:   <<< loose_type: True
2024-05-02 03:35:39,017:INFO:   <<< lr: 0.0001
2024-05-02 03:35:39,017:INFO:   <<< lr_decay: 0.9
2024-05-02 03:35:39,018:INFO:   <<< margin: 0.1
2024-05-02 03:35:39,018:INFO:   <<< max_frames: 30
2024-05-02 03:35:39,018:INFO:   <<< max_words: 32
2024-05-02 03:35:39,018:INFO:   <<< n_display: 100
2024-05-02 03:35:39,018:INFO:   <<< n_gpu: 1
2024-05-02 03:35:39,018:INFO:   <<< n_pair: 1
2024-05-02 03:35:39,018:INFO:   <<< negative_weighting: 1
2024-05-02 03:35:39,018:INFO:   <<< num_thread_reader: 0
2024-05-02 03:35:39,018:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 03:35:39,018:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 03:35:39,018:INFO:   <<< rank: 0
2024-05-02 03:35:39,018:INFO:   <<< resume_model: None
2024-05-02 03:35:39,018:INFO:   <<< sampled_use_mil: False
2024-05-02 03:35:39,018:INFO:   <<< seed: 42
2024-05-02 03:35:39,018:INFO:   <<< sim_header: meanP
2024-05-02 03:35:39,018:INFO:   <<< slice_framepos: 2
2024-05-02 03:35:39,018:INFO:   <<< task_type: retrieval
2024-05-02 03:35:39,018:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 03:35:39,019:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 03:35:39,019:INFO:   <<< train_frame_order: 0
2024-05-02 03:35:39,019:INFO:   <<< use_mil: False
2024-05-02 03:35:39,019:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 03:35:39,019:INFO:   <<< video_dim: 1024
2024-05-02 03:35:39,019:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 03:35:39,019:INFO:   <<< warmup_proportion: 0.1
2024-05-02 03:35:39,019:INFO:   <<< world_size: 1
2024-05-02 03:35:39,019:INFO: device: cuda:0 n_gpu: 1
2024-05-02 03:35:39,247:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 03:35:39,792:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 03:35:39,792:WARNING: Test retrieval by loose type.
2024-05-02 03:35:39,792:WARNING: 	 embed_dim: 512
2024-05-02 03:35:39,793:WARNING: 	 image_resolution: 224
2024-05-02 03:35:39,793:WARNING: 	 vision_layers: 12
2024-05-02 03:35:39,793:WARNING: 	 vision_width: 768
2024-05-02 03:35:39,793:WARNING: 	 vision_patch_size: 32
2024-05-02 03:35:39,793:WARNING: 	 context_length: 77
2024-05-02 03:35:39,793:WARNING: 	 vocab_size: 49408
2024-05-02 03:35:39,793:WARNING: 	 transformer_width: 512
2024-05-02 03:35:39,793:WARNING: 	 transformer_heads: 8
2024-05-02 03:35:39,793:WARNING: 	 transformer_layers: 12
2024-05-02 03:35:39,793:WARNING: 		 linear_patch: 2d
2024-05-02 03:35:39,793:WARNING: 	 cut_top_layer: 0
2024-05-02 03:35:40,782:WARNING: 	 sim_header: meanP
2024-05-02 03:35:46,806:INFO: ***** Running test *****
2024-05-02 03:35:46,806:INFO:   Num examples = 29
2024-05-02 03:35:46,806:INFO:   Batch size = 16
2024-05-02 03:35:46,807:INFO:   Num steps = 2
2024-05-02 03:35:46,821:INFO: ***** Running val *****
2024-05-02 03:35:46,821:INFO:   Num examples = 29
2024-05-02 03:53:11,450:INFO: Effective parameters:
2024-05-02 03:53:11,450:INFO:   <<< batch_size: 16
2024-05-02 03:53:11,450:INFO:   <<< batch_size_val: 16
2024-05-02 03:53:11,450:INFO:   <<< cache_dir: 
2024-05-02 03:53:11,450:INFO:   <<< coef_lr: 0.001
2024-05-02 03:53:11,450:INFO:   <<< cross_model: cross-base
2024-05-02 03:53:11,450:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 03:53:11,451:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 03:53:11,451:INFO:   <<< datatype: msrvtt
2024-05-02 03:53:11,451:INFO:   <<< do_eval: True
2024-05-02 03:53:11,451:INFO:   <<< do_lower_case: False
2024-05-02 03:53:11,451:INFO:   <<< do_pretrain: False
2024-05-02 03:53:11,451:INFO:   <<< do_train: False
2024-05-02 03:53:11,451:INFO:   <<< epochs: 5
2024-05-02 03:53:11,451:INFO:   <<< eval_frame_order: 0
2024-05-02 03:53:11,451:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 03:53:11,451:INFO:   <<< feature_framerate: 1
2024-05-02 03:53:11,451:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 03:53:11,451:INFO:   <<< fp16: False
2024-05-02 03:53:11,451:INFO:   <<< fp16_opt_level: O1
2024-05-02 03:53:11,451:INFO:   <<< freeze_layer_num: 0
2024-05-02 03:53:11,451:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 03:53:11,451:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 03:53:11,452:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 03:53:11,452:INFO:   <<< linear_patch: 2d
2024-05-02 03:53:11,452:INFO:   <<< local_rank: 0
2024-05-02 03:53:11,452:INFO:   <<< loose_type: True
2024-05-02 03:53:11,452:INFO:   <<< lr: 0.0001
2024-05-02 03:53:11,452:INFO:   <<< lr_decay: 0.9
2024-05-02 03:53:11,452:INFO:   <<< margin: 0.1
2024-05-02 03:53:11,452:INFO:   <<< max_frames: 30
2024-05-02 03:53:11,452:INFO:   <<< max_words: 32
2024-05-02 03:53:11,452:INFO:   <<< n_display: 100
2024-05-02 03:53:11,452:INFO:   <<< n_gpu: 1
2024-05-02 03:53:11,452:INFO:   <<< n_pair: 1
2024-05-02 03:53:11,452:INFO:   <<< negative_weighting: 1
2024-05-02 03:53:11,452:INFO:   <<< num_thread_reader: 0
2024-05-02 03:53:11,452:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 03:53:11,452:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 03:53:11,453:INFO:   <<< rank: 0
2024-05-02 03:53:11,453:INFO:   <<< resume_model: None
2024-05-02 03:53:11,453:INFO:   <<< sampled_use_mil: False
2024-05-02 03:53:11,453:INFO:   <<< seed: 42
2024-05-02 03:53:11,453:INFO:   <<< sim_header: meanP
2024-05-02 03:53:11,453:INFO:   <<< slice_framepos: 2
2024-05-02 03:53:11,453:INFO:   <<< task_type: retrieval
2024-05-02 03:53:11,453:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 03:53:11,453:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 03:53:11,453:INFO:   <<< train_frame_order: 0
2024-05-02 03:53:11,453:INFO:   <<< use_mil: False
2024-05-02 03:53:11,453:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 03:53:11,453:INFO:   <<< video_dim: 1024
2024-05-02 03:53:11,453:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 03:53:11,453:INFO:   <<< warmup_proportion: 0.1
2024-05-02 03:53:11,453:INFO:   <<< world_size: 1
2024-05-02 03:53:11,454:INFO: device: cuda:0 n_gpu: 1
2024-05-02 03:53:11,797:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 03:53:12,500:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 03:53:12,500:WARNING: Test retrieval by loose type.
2024-05-02 03:53:12,501:WARNING: 	 embed_dim: 512
2024-05-02 03:53:12,501:WARNING: 	 image_resolution: 224
2024-05-02 03:53:12,501:WARNING: 	 vision_layers: 12
2024-05-02 03:53:12,501:WARNING: 	 vision_width: 768
2024-05-02 03:53:12,501:WARNING: 	 vision_patch_size: 32
2024-05-02 03:53:12,501:WARNING: 	 context_length: 77
2024-05-02 03:53:12,501:WARNING: 	 vocab_size: 49408
2024-05-02 03:53:12,501:WARNING: 	 transformer_width: 512
2024-05-02 03:53:12,501:WARNING: 	 transformer_heads: 8
2024-05-02 03:53:12,501:WARNING: 	 transformer_layers: 12
2024-05-02 03:53:12,501:WARNING: 		 linear_patch: 2d
2024-05-02 03:53:12,501:WARNING: 	 cut_top_layer: 0
2024-05-02 03:53:13,519:WARNING: 	 sim_header: meanP
2024-05-02 03:53:20,042:INFO: ***** Running test *****
2024-05-02 03:53:20,042:INFO:   Num examples = 29
2024-05-02 03:53:20,042:INFO:   Batch size = 16
2024-05-02 03:53:20,061:INFO:   Num steps = 2
2024-05-02 03:53:20,061:INFO: ***** Running val *****
2024-05-02 03:53:20,061:INFO:   Num examples = 29
2024-05-02 03:59:46,420:INFO: Effective parameters:
2024-05-02 03:59:46,421:INFO:   <<< batch_size: 16
2024-05-02 03:59:46,421:INFO:   <<< batch_size_val: 16
2024-05-02 03:59:46,421:INFO:   <<< cache_dir: 
2024-05-02 03:59:46,421:INFO:   <<< coef_lr: 0.001
2024-05-02 03:59:46,421:INFO:   <<< cross_model: cross-base
2024-05-02 03:59:46,421:INFO:   <<< cross_num_hidden_layers: 4
2024-05-02 03:59:46,421:INFO:   <<< data_path: /workspace/CLIP4Clip/data/MSRVTT_data.json
2024-05-02 03:59:46,421:INFO:   <<< datatype: msrvtt
2024-05-02 03:59:46,421:INFO:   <<< do_eval: True
2024-05-02 03:59:46,421:INFO:   <<< do_lower_case: False
2024-05-02 03:59:46,421:INFO:   <<< do_pretrain: False
2024-05-02 03:59:46,421:INFO:   <<< do_train: False
2024-05-02 03:59:46,421:INFO:   <<< epochs: 5
2024-05-02 03:59:46,421:INFO:   <<< eval_frame_order: 0
2024-05-02 03:59:46,422:INFO:   <<< expand_msrvtt_sentences: True
2024-05-02 03:59:46,422:INFO:   <<< feature_framerate: 1
2024-05-02 03:59:46,422:INFO:   <<< features_path: /workspace/CLIP4Clip/data/MSRVTT_Videos
2024-05-02 03:59:46,422:INFO:   <<< fp16: False
2024-05-02 03:59:46,422:INFO:   <<< fp16_opt_level: O1
2024-05-02 03:59:46,422:INFO:   <<< freeze_layer_num: 0
2024-05-02 03:59:46,422:INFO:   <<< gradient_accumulation_steps: 1
2024-05-02 03:59:46,422:INFO:   <<< hard_negative_rate: 0.5
2024-05-02 03:59:46,422:INFO:   <<< init_model: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 03:59:46,422:INFO:   <<< linear_patch: 2d
2024-05-02 03:59:46,422:INFO:   <<< local_rank: 0
2024-05-02 03:59:46,422:INFO:   <<< loose_type: True
2024-05-02 03:59:46,422:INFO:   <<< lr: 0.0001
2024-05-02 03:59:46,422:INFO:   <<< lr_decay: 0.9
2024-05-02 03:59:46,422:INFO:   <<< margin: 0.1
2024-05-02 03:59:46,422:INFO:   <<< max_frames: 30
2024-05-02 03:59:46,423:INFO:   <<< max_words: 32
2024-05-02 03:59:46,423:INFO:   <<< n_display: 100
2024-05-02 03:59:46,423:INFO:   <<< n_gpu: 1
2024-05-02 03:59:46,423:INFO:   <<< n_pair: 1
2024-05-02 03:59:46,423:INFO:   <<< negative_weighting: 1
2024-05-02 03:59:46,423:INFO:   <<< num_thread_reader: 0
2024-05-02 03:59:46,423:INFO:   <<< output_dir: /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType
2024-05-02 03:59:46,423:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-05-02 03:59:46,423:INFO:   <<< rank: 0
2024-05-02 03:59:46,423:INFO:   <<< resume_model: None
2024-05-02 03:59:46,423:INFO:   <<< sampled_use_mil: False
2024-05-02 03:59:46,423:INFO:   <<< seed: 42
2024-05-02 03:59:46,423:INFO:   <<< sim_header: meanP
2024-05-02 03:59:46,423:INFO:   <<< slice_framepos: 2
2024-05-02 03:59:46,423:INFO:   <<< task_type: retrieval
2024-05-02 03:59:46,423:INFO:   <<< text_num_hidden_layers: 12
2024-05-02 03:59:46,423:INFO:   <<< train_csv: /workspace/CLIP4Clip/data/MSRVTT_train.9k.csv
2024-05-02 03:59:46,424:INFO:   <<< train_frame_order: 0
2024-05-02 03:59:46,424:INFO:   <<< use_mil: False
2024-05-02 03:59:46,424:INFO:   <<< val_csv: /workspace/CLIP4Clip/data/MSRVTT_JSFUSION_test.csv
2024-05-02 03:59:46,424:INFO:   <<< video_dim: 1024
2024-05-02 03:59:46,424:INFO:   <<< visual_num_hidden_layers: 12
2024-05-02 03:59:46,424:INFO:   <<< warmup_proportion: 0.1
2024-05-02 03:59:46,424:INFO:   <<< world_size: 1
2024-05-02 03:59:46,424:INFO: device: cuda:0 n_gpu: 1
2024-05-02 03:59:46,676:INFO: Model loaded from /workspace/CLIP4Clip/ckpts/ckpt_msrvtt_retrieval_looseType/clip4clip_vit-base-p32-res224-clip-pre_8xb16-u12-5e_msrvtt-9k-rgb.pth
2024-05-02 03:59:47,259:WARNING: Stage-One:True, Stage-Two:False
2024-05-02 03:59:47,259:WARNING: Test retrieval by loose type.
2024-05-02 03:59:47,259:WARNING: 	 embed_dim: 512
2024-05-02 03:59:47,259:WARNING: 	 image_resolution: 224
2024-05-02 03:59:47,260:WARNING: 	 vision_layers: 12
2024-05-02 03:59:47,260:WARNING: 	 vision_width: 768
2024-05-02 03:59:47,260:WARNING: 	 vision_patch_size: 32
2024-05-02 03:59:47,260:WARNING: 	 context_length: 77
2024-05-02 03:59:47,260:WARNING: 	 vocab_size: 49408
2024-05-02 03:59:47,260:WARNING: 	 transformer_width: 512
2024-05-02 03:59:47,260:WARNING: 	 transformer_heads: 8
2024-05-02 03:59:47,260:WARNING: 	 transformer_layers: 12
2024-05-02 03:59:47,260:WARNING: 		 linear_patch: 2d
2024-05-02 03:59:47,260:WARNING: 	 cut_top_layer: 0
2024-05-02 03:59:48,265:WARNING: 	 sim_header: meanP
2024-05-02 03:59:54,352:INFO: ***** Running test *****
2024-05-02 03:59:54,352:INFO:   Num examples = 29
2024-05-02 03:59:54,352:INFO:   Batch size = 16
2024-05-02 03:59:54,352:INFO:   Num steps = 2
2024-05-02 03:59:54,370:INFO: ***** Running val *****
2024-05-02 03:59:54,371:INFO:   Num examples = 29
